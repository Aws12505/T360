import{r as T,y as F,w as P,b as U,e as l,f as d,X as s,G as N,C as h,F as i,E as _,z as u,u as g,S as y,U as c,H as w,O as k,al as G,Y as H,ah as I,D as R}from"./vendor-Bl7QtHDZ.js";import{_ as j}from"./Card.vue_vue_type_script_setup_true_lang-1bmPyW_M.js";import{_ as D}from"./Label.vue_vue_type_script_setup_true_lang-B8UEvjKs.js";import{_ as Z}from"./Button.vue_vue_type_script_setup_true_lang-CmY1RpaM.js";import{_ as X}from"./Badge.vue_vue_type_script_setup_true_lang-DAxI-zSb.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./utils-DnnPsXYS.js";import"./vendor-ui-B_LrUle4.js";const q={class:"grid gap-4"},J={class:"flex flex-col sm:flex-row sm:items-center justify-between gap-3"},K={class:"font-mono"},Q={class:"flex flex-wrap gap-2 mb-2"},W=["onClick","title"],ee={class:"font-mono text-xs"},te={key:0,class:"text-sm text-destructive mt-1"},se={key:1,class:"text-sm text-destructive mt-1"},ae={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4"},oe=["id","onUpdate:modelValue"],ne=["value"],re={key:0,class:"text-sm text-destructive"},le={class:"flex items-center gap-4"},ie={key:0,class:"animate-spin h-5 w-5 mr-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},ce={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor"},de={class:"text-sm text-muted-foreground"},me={__name:"Form",props:{form:Object,recentlySuccessful:Boolean},emits:["submit"],setup(n,{emit:M}){const p=n,S=M,E={acceptance:"Acceptance",ontime:"On-Time",greenzone:"Green Zone",severe_alerts:"Severe Alerts"},A=["good","bad","minor_improvement"],x=[{value:"{driver_first_name}",label:"First Name",description:"Driver's first name"},{value:"{driver_last_name}",label:"Last Name",description:"Driver's last name"},{value:"{driver_ontime_score}",label:"On-Time %",description:"Driver's on-time score percentage"},{value:"{driver_acceptance_score}",label:"Acceptance %",description:"Driver's acceptance score percentage"},{value:"{driver_greenzone_score}",label:"Green Zone",description:"Driver's greenzone score number"},{value:"{driver_severe_alerts}",label:"Severe Alerts",description:"Driver's severe alerts number"},{value:"{company_avg_ontime}",label:"Avg On-Time %",description:"Company's average on-time score percentage"},{value:"{company_avg_acceptance}",label:"Avg Acceptance %",description:"Company's average acceptance score percentage"},{value:"{company_avg_greenzone}",label:"Avg Green Zone",description:"Company's average greenzone score number"}],m=T(null),v=T(0),z=a=>a.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),O=a=>{var b;const e=document.createElement("span"),t=((b=x.find(V=>V.value===a))==null?void 0:b.label)||a;e.innerHTML=`<span class='placeholder-token'>&lt;${t}&gt;</span>`,e.contentEditable="false",e.dataset.placeholder=a,e.className="placeholder-token";const o=window.getSelection();if(!o||!m.value)return;const r=o.getRangeAt(0);r.deleteContents(),r.insertNode(e),r.collapse(!1),o.removeAllRanges(),o.addRange(r),C(),f()};F(()=>{$()});const $=()=>{const a=p.form.coaching_message||"";if(!m.value)return;const e=a.replace(/{[^}]+}/g,t=>{var r;const o=((r=x.find(b=>b.value===t))==null?void 0:r.label)||t;return`<span class="placeholder-token" contenteditable="false" data-placeholder="${t}">&lt;${o}&gt;</span>`});m.value.innerHTML=e,f()},C=()=>{const a=m.value;if(!a)return;let e="";for(const t of a.childNodes)t.nodeType===Node.TEXT_NODE?e+=t.textContent:t.nodeType===Node.ELEMENT_NODE&&t.classList.contains("placeholder-token")?e+=t.dataset.placeholder:t.nodeType===Node.ELEMENT_NODE&&t.tagName==="BR"&&(e+=`
`);p.form.coaching_message=e},B=()=>{C(),f()},L=a=>{const e=a.clipboardData.getData("text/plain");document.execCommand("insertText",!1,e)},f=()=>{const a=p.form.coaching_message||"",t=(a.match(/{[^}]+}/g)||[]).length;v.value=a.replace(/{[^}]+}/g,"").length+t*5};return P(()=>p.form.coaching_message,f),(a,e)=>(l(),U(g(j),{class:"overflow-hidden rounded-xl shadow-md border border-gray-200 dark:border-gray-700 max-w-2xl"},{default:d(()=>[s("form",{onSubmit:e[1]||(e[1]=N(t=>S("submit"),["prevent"])),class:"p-6 space-y-6"},[s("div",q,[s("div",J,[u(g(D),{for:"coaching_message",class:"text-lg font-bold"},{default:d(()=>e[2]||(e[2]=[y("Coaching Message")])),_:1}),u(g(X),{variant:"outline",class:"bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 px-3 py-1.5 font-medium"},{default:d(()=>[s("span",K,c(v.value),1),e[3]||(e[3]=y(" / 160 characters "))]),_:1})]),s("div",Q,[(l(),i(w,null,k(x,t=>s("button",{key:t.value,type:"button",onClick:o=>O(t.value),class:"inline-flex items-center gap-1 px-2.5 py-1.5 rounded-md bg-blue-100 dark:bg-blue-900/40 text-blue-800 dark:text-blue-200 hover:bg-blue-200 dark:hover:bg-blue-800 text-xs transition-colors",title:t.description},[s("span",ee,c(t.label),1)],8,W)),64))]),s("div",{contenteditable:"",ref_key:"editableDiv",ref:m,class:"w-full border border-gray-200 dark:border-gray-700 rounded-xl p-6 bg-white dark:bg-gray-800 min-h-[200px] resize-y focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring font-sans whitespace-pre-wrap",onInput:B,onPaste:N(L,["prevent"]),placeholder:"Type your SMS message here (max 160 characters)..."},null,544),h(s("textarea",{"onUpdate:modelValue":e[0]||(e[0]=t=>n.form.coaching_message=t),class:"hidden"},null,512),[[G,n.form.coaching_message]]),e[4]||(e[4]=s("p",{class:"text-sm text-muted-foreground mt-1"}," Placeholders will be replaced with actual values when sent ",-1)),v.value>160?(l(),i("p",te," Message exceeds 160 character limit ")):_("",!0),n.form.errors.coaching_message?(l(),i("p",se,c(n.form.errors.coaching_message),1)):_("",!0)]),s("div",null,[e[6]||(e[6]=s("h3",{class:"text-lg font-bold mb-4 text-gray-800 dark:text-gray-200"},"Performance Categories",-1)),s("div",ae,[(l(),i(w,null,k(E,(t,o)=>s("div",{key:o,class:"grid gap-2"},[u(g(D),{for:o,class:"font-medium text-gray-700 dark:text-gray-300"},{default:d(()=>[y(c(t),1)]),_:2},1032,["for"]),h(s("select",{id:o,"onUpdate:modelValue":r=>n.form[o]=r,class:"w-full border rounded-md p-2 bg-background text-foreground border-input focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring"},[e[5]||(e[5]=s("option",{value:""},"Select...",-1)),(l(),i(w,null,k(A,r=>s("option",{key:r,value:r,class:"capitalize"},c(z(r)),9,ne)),64))],8,oe),[[H,n.form[o]]]),n.form.errors[o]?(l(),i("p",re,c(n.form.errors[o]),1)):_("",!0)])),64))])]),s("div",le,[u(g(Z),{type:"submit",disabled:n.form.processing||v.value>160,class:"bg-blue-600 hover:bg-blue-700 text-white px-5 py-2.5 transition-colors"},{default:d(()=>[n.form.processing?(l(),i("svg",ie,e[7]||(e[7]=[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(l(),i("svg",ce,e[8]||(e[8]=[s("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"},null,-1)]))),s("span",null,c(n.form.processing?"Saving...":"Save Template"),1)]),_:1},8,["disabled"]),u(I,{"enter-active-class":"transition ease-in-out duration-300","enter-from-class":"opacity-0","leave-active-class":"transition ease-in-out duration-300","leave-to-class":"opacity-0"},{default:d(()=>[h(s("p",de," Template saved successfully. ",512),[[R,n.form.recentlySuccessful]])]),_:1})])],32)]),_:1}))}},_e=Y(me,[["__scopeId","data-v-d8d322cb"]]);export{_e as default};
