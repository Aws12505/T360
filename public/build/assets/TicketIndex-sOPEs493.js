import{B as k,A as pe,E as ge,L as f,N as i,O as a,a1 as t,an as l,I as s,a6 as v,ae as r,af as b,a2 as ve,a4 as V,ao as L,aS as O,a7 as B,a9 as I,aa as R,aR as q,a8 as be,aT as xe}from"./vendor-DW_gyfXE.js";import{x as _e,g as ke,W as S}from"./vendor-vue-BIhQdEdd.js";import{_ as we}from"./AppLayout.vue_vue_type_script_setup_true_lang-DnDcxt42.js";import{_ as d}from"./Icon.vue_vue_type_script_setup_true_lang-C-mirX2J.js";import{_ as ye,a as Se,b as N,c as $,d as he,e as h}from"./TableRow.vue_vue_type_script_setup_true_lang-CgXPUvWo.js";import{_ as p}from"./Button.vue_vue_type_script_setup_true_lang-CZMgI4AI.js";import{_ as E}from"./Card.vue_vue_type_script_setup_true_lang-Cv_RhfZi.js";import{_ as $e,a as Ce}from"./CardTitle.vue_vue_type_script_setup_true_lang-DvbDsVuE.js";import{_ as H}from"./CardContent.vue_vue_type_script_setup_true_lang-CJoJj2cM.js";import{_ as K,a as W,b as Y,c as G,d as J}from"./DialogTitle.vue_vue_type_script_setup_true_lang-BAHS8JjQ.js";import{_ as Q}from"./DialogFooter.vue_vue_type_script_setup_true_lang-CMVRlm2Q.js";import{_ as D,a as X}from"./Label.vue_vue_type_script_setup_true_lang-gg10UQW6.js";import{_ as Te,a as je,b as Ve}from"./AlertDescription.vue_vue_type_script_setup_true_lang-faxB04Ew.js";import{_ as Z}from"./Badge.vue_vue_type_script_setup_true_lang-CnxAYvm1.js";import"./vendor-d3-CjigyTW8.js";import"./vendor-axios-xsH4HHeE.js";import"./utils-BCw79v42.js";import"./vendor-ui-m5Us76-N.js";import"./app-B0NuZhfC.js";import"./vendor-icons-DY85x-Wz.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BHAHC43q.js";const De={class:"max-w-7xl mx-auto p-6 space-y-8"},Ue={class:"flex flex-col sm:flex-row justify-between items-center gap-4 mb-6"},Ae={class:"flex items-center gap-3"},Me={class:"flex gap-3"},Be={class:"flex flex-col gap-4"},Ne={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},Fe={class:"relative"},Pe={class:"flex items-end"},ze={class:"flex items-center gap-2 h-10 cursor-pointer"},Le={class:"flex justify-end"},Oe={class:"overflow-x-auto bg-background dark:bg-background border-t border-border"},Ie={class:"flex items-center justify-center"},Re=["checked"],qe={class:"flex items-center gap-1"},Ee={class:"flex items-center gap-1"},He={class:"flex items-center gap-1"},Ke={class:"flex flex-col items-center justify-center text-muted-foreground"},We=["value"],Ye={class:"flex items-center gap-2"},Ge={class:"font-medium"},Je={class:"flex flex-col"},Qe={class:"text-xs text-muted-foreground"},Xe={class:"flex gap-2"},Ze={key:0,class:"bg-muted/20 px-4 py-3 border-t"},et={class:"flex flex-col sm:flex-row justify-between items-center gap-4"},tt={class:"text-sm text-muted-foreground"},st={class:"flex items-center gap-4"},at={class:"flex items-center gap-2"},lt={class:"flex"},nt=["innerHTML"],Tt={__name:"TicketIndex",props:{tickets:Object,tenantSlug:{type:String,default:null},SuperAdmin:Boolean,filters:Object},setup(m){var z;const u=m,w=k(""),C=k(!1),y=_e({subject:"",message:""}),c=k({...u.filters}),g=k([]),T=k(!1),j=k(((z=u.tickets)==null?void 0:z.per_page)||10),_=k("created_at"),x=k("desc"),ee=[{title:u.tenantSlug?"Dashboard":"Admin Dashboard",href:u.tenantSlug?route("dashboard",{tenantSlug:u.tenantSlug}):route("admin.dashboard")},{title:"Support Tickets",href:u.tenantSlug?route("support.index",{tenantSlug:u.tenantSlug}):route("support.index.admin")}],F=pe(()=>u.tickets.data.length>0&&g.value.length===u.tickets.data.length);function te(){F.value?g.value=[]:g.value=u.tickets.data.map(o=>o.id)}function se(o){return g.value.includes(o)}function ae(o){return u.SuperAdmin?!o.seen_by_admin:!o.seen_by_user}function le(o){switch(o){case"open":return"default";case"in_progress":return"warning";case"closed":return"secondary";default:return"outline"}}function M(o){_.value===o?x.value=x.value==="asc"?"desc":"asc":(_.value=o,x.value="asc");const e=u.tenantSlug?route("support.index",{tenantSlug:u.tenantSlug}):route("support.index.admin");S.get(e,{...c.value,sort:_.value,direction:x.value,per_page:j.value},{preserveState:!0})}function ne(){T.value=!1,w.value="Selected tickets deleted.",g.value=[]}function oe(){const o=u.tenantSlug?route("support.index",{tenantSlug:u.tenantSlug}):route("support.index.admin");S.get(o,{...c.value,sort:_.value,direction:x.value,per_page:j.value},{preserveState:!0})}function re(){c.value={search:"",status:"",unseen:!1},U()}function ue(o){o&&S.get(new URL(o).href,{},{preserveState:!0})}function U(){const o=u.tenantSlug?route("support.index",{tenantSlug:u.tenantSlug}):route("support.index.admin");S.get(o,{search:c.value.search,status:c.value.status,unseen:c.value.unseen?"true":void 0,sort:_.value,direction:x.value,per_page:j.value},{preserveState:!0})}function P(){y.reset(),C.value=!0}function ie(){const o=u.tenantSlug?route("support.store",{tenantSlug:u.tenantSlug}):route("support.store.admin");y.post(o,{onSuccess:()=>{w.value="Ticket created.",C.value=!1,y.reset()}})}function de(o){const e=u.tenantSlug?route("support.show",{tenantSlug:u.tenantSlug,ticket:o}):route("support.show.admin",o);S.get(e)}function ce(o){S.delete(u.tenantSlug?route("support.destroy",{tenantSlug:u.tenantSlug,ticket:o}):route("support.destroy.admin",o),{onSuccess:()=>{w.value="Ticket deleted.",S.reload()}})}function fe(o){const e=new Date(o);return`${e.getMonth()+1}-${e.getDate()}-${e.getFullYear()}`}function me(o){return new Date(o).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}return ge(w,o=>{o&&setTimeout(()=>w.value="",5e3)}),(o,e)=>(i(),f(we,{breadcrumbs:ee,tenantSlug:m.tenantSlug},{default:a(()=>[t(s(ke),{title:"Support Tickets"}),l("div",De,[w.value?(i(),f(s(Te),{key:0,variant:"success",class:"animate-in fade-in duration-300"},{default:a(()=>[t(s(je),{class:"flex items-center gap-2"},{default:a(()=>[t(d,{name:"check-circle",class:"h-5 w-5 text-green-500"}),e[16]||(e[16]=r(" Success "))]),_:1}),t(s(Ve),null,{default:a(()=>[r(b(w.value),1)]),_:1})]),_:1})):v("",!0),l("div",Ue,[l("div",Ae,[t(d,{name:"help-circle",class:"h-7 w-7 text-primary"}),e[17]||(e[17]=l("h1",{class:"text-2xl font-bold text-gray-800 dark:text-gray-200"},"Support Tickets",-1))]),l("div",Me,[t(s(p),{onClick:P,variant:"default",class:"shadow-sm hover:shadow transition-all"},{default:a(()=>[t(d,{name:"plus",class:"mr-2 h-4 w-4"}),e[18]||(e[18]=r(" New Ticket "))]),_:1}),g.value.length>0?(i(),f(s(p),{key:0,onClick:e[0]||(e[0]=n=>T.value=!0),variant:"destructive",class:"shadow-sm hover:shadow transition-all"},{default:a(()=>[t(d,{name:"trash",class:"mr-2 h-4 w-4"}),r(" Delete Selected ("+b(g.value.length)+") ",1)]),_:1})):v("",!0)])]),t(s(E),{class:"shadow-sm hover:shadow transition-all duration-300"},{default:a(()=>[t(s($e),{class:"pb-2"},{default:a(()=>[t(s(Ce),{class:"text-lg flex items-center gap-2"},{default:a(()=>[t(d,{name:"filter",class:"h-5 w-5 text-muted-foreground"}),e[19]||(e[19]=r(" Filters "))]),_:1})]),_:1}),t(s(H),{class:"p-4 pt-2"},{default:a(()=>[l("div",Be,[l("div",Ne,[l("div",null,[t(s(D),{for:"search",class:"text-sm font-medium mb-1 block"},{default:a(()=>e[20]||(e[20]=[r("Search")])),_:1}),l("div",Fe,[t(d,{name:"search",class:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),t(s(X),{id:"search",modelValue:c.value.search,"onUpdate:modelValue":e[1]||(e[1]=n=>c.value.search=n),placeholder:"Search subject or messageâ€¦",onKeydown:ve(U,["enter"]),class:"pl-9"},null,8,["modelValue"])])]),l("div",null,[t(s(D),{for:"status",class:"text-sm font-medium mb-1 block"},{default:a(()=>e[21]||(e[21]=[r("Status")])),_:1}),V(l("select",{id:"status","onUpdate:modelValue":e[2]||(e[2]=n=>c.value.status=n),onChange:U,class:"h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background"},e[22]||(e[22]=[l("option",{value:""},"All Statuses",-1),l("option",{value:"open"},"Open",-1),l("option",{value:"in_progress"},"In Progress",-1),l("option",{value:"closed"},"Closed",-1)]),544),[[L,c.value.status]])]),l("div",Pe,[l("label",ze,[V(l("input",{type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=n=>c.value.unseen=n),onChange:U,class:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"},null,544),[[O,c.value.unseen]]),e[23]||(e[23]=l("span",null,"Unseen Only",-1))])])]),l("div",Le,[t(s(p),{onClick:re,variant:"ghost",size:"sm",class:"gap-1"},{default:a(()=>[t(d,{name:"rotate-ccw",class:"h-4 w-4"}),e[24]||(e[24]=r(" Reset Filters "))]),_:1})])])]),_:1})]),_:1}),t(s(E),{class:"shadow-sm hover:shadow transition-all duration-300"},{default:a(()=>[t(s(H),{class:"p-0"},{default:a(()=>[l("div",Oe,[t(s(ye),{class:"relative h-[600px] overflow-auto"},{default:a(()=>[t(s(Se),null,{default:a(()=>[t(s(N),{class:"sticky top-0 bg-background border-b z-10 hover:bg-background"},{default:a(()=>[t(s($),{class:"w-[50px]"},{default:a(()=>[l("div",Ie,[l("input",{type:"checkbox",onChange:te,checked:F.value,class:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"},null,40,Re)])]),_:1}),m.SuperAdmin?(i(),f(s($),{key:0},{default:a(()=>e[25]||(e[25]=[r("User")])),_:1})):v("",!0),t(s($),{class:"cursor-pointer",onClick:e[4]||(e[4]=n=>M("subject"))},{default:a(()=>[l("div",qe,[e[26]||(e[26]=r(" Subject ")),_.value==="subject"?(i(),f(d,{key:0,name:x.value==="asc"?"arrow-up":"arrow-down",class:"h-3 w-3"},null,8,["name"])):v("",!0)])]),_:1}),t(s($),{class:"cursor-pointer",onClick:e[5]||(e[5]=n=>M("status"))},{default:a(()=>[l("div",Ee,[e[27]||(e[27]=r(" Status ")),_.value==="status"?(i(),f(d,{key:0,name:x.value==="asc"?"arrow-up":"arrow-down",class:"h-3 w-3"},null,8,["name"])):v("",!0)])]),_:1}),t(s($),{class:"cursor-pointer",onClick:e[6]||(e[6]=n=>M("created_at"))},{default:a(()=>[l("div",He,[e[28]||(e[28]=r(" Created ")),_.value==="created_at"?(i(),f(d,{key:0,name:x.value==="asc"?"arrow-up":"arrow-down",class:"h-3 w-3"},null,8,["name"])):v("",!0)])]),_:1}),t(s($),null,{default:a(()=>e[29]||(e[29]=[r("Actions")])),_:1})]),_:1})]),_:1}),t(s(he),null,{default:a(()=>[m.tickets.data.length===0?(i(),f(s(N),{key:0},{default:a(()=>[t(s(h),{colspan:m.SuperAdmin?6:5,class:"py-8 text-center"},{default:a(()=>[l("div",Ke,[t(d,{name:"inbox",class:"h-12 w-12 mb-2 opacity-20"}),e[31]||(e[31]=l("p",null,"No tickets found",-1)),t(s(p),{onClick:P,variant:"link",class:"mt-2"},{default:a(()=>e[30]||(e[30]=[r("Create your first ticket")])),_:1})])]),_:1},8,["colspan"])]),_:1})):v("",!0),(i(!0),B(I,null,R(m.tickets.data,n=>(i(),f(s(N),{key:n.id,class:q(["hover:bg-muted/50 transition-colors",{"bg-primary/5":se(n.id)}])},{default:a(()=>[t(s(h),{class:"text-center"},{default:a(()=>[V(l("input",{type:"checkbox",value:n.id,"onUpdate:modelValue":e[7]||(e[7]=A=>g.value=A),class:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"},null,8,We),[[O,g.value]])]),_:2},1024),m.SuperAdmin?(i(),f(s(h),{key:0},{default:a(()=>[r(b(n.user.name),1)]),_:2},1024)):v("",!0),t(s(h),null,{default:a(()=>[l("div",Ye,[l("span",Ge,b(n.subject),1),ae(n)?(i(),f(s(Z),{key:0,variant:"destructive",class:"ml-2 animate-pulse"},{default:a(()=>e[32]||(e[32]=[r("New")])),_:1})):v("",!0)])]),_:2},1024),t(s(h),null,{default:a(()=>[t(s(Z),{variant:le(n.status),class:"capitalize"},{default:a(()=>[r(b(n.status.replace("_"," ")),1)]),_:2},1032,["variant"])]),_:2},1024),t(s(h),null,{default:a(()=>[l("div",Je,[l("span",null,b(fe(n.created_at)),1),l("span",Qe,b(me(n.created_at)),1)])]),_:2},1024),t(s(h),null,{default:a(()=>[l("div",Xe,[t(s(p),{onClick:A=>de(n.id),size:"sm",class:"shadow-sm hover:shadow transition-all"},{default:a(()=>[t(d,{name:"eye",class:"mr-1 h-4 w-4"}),e[33]||(e[33]=r("View "))]),_:2},1032,["onClick"]),t(s(p),{onClick:A=>ce(n.id),variant:"destructive",size:"sm",class:"shadow-sm hover:shadow transition-all"},{default:a(()=>[t(d,{name:"trash",class:"mr-1 h-4 w-4"}),e[34]||(e[34]=r("Delete "))]),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1})]),_:1})]),m.tickets.links?(i(),B("div",Ze,[l("div",et,[l("div",tt," Showing "+b(m.tickets.data.length)+" of "+b(m.tickets.total),1),l("div",st,[l("div",at,[t(s(D),{for:"perPage",class:"text-sm"},{default:a(()=>e[35]||(e[35]=[r("Per page:")])),_:1}),V(l("select",{id:"perPage","onUpdate:modelValue":e[8]||(e[8]=n=>j.value=n),onChange:oe,class:"h-8 rounded-md border border-input bg-background px-2 py-1 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"},e[36]||(e[36]=[l("option",{value:"10"},"10",-1),l("option",{value:"25"},"25",-1),l("option",{value:"50"},"50",-1),l("option",{value:"100"},"100",-1)]),544),[[L,j.value]])]),l("div",lt,[(i(!0),B(I,null,R(m.tickets.links,n=>(i(),f(s(p),{key:n.label,onClick:A=>ue(n.url),disabled:!n.url,size:"sm",variant:"ghost",class:q(["mx-1",{"bg-primary/10 text-primary border-primary":n.active}])},{default:a(()=>[l("span",{innerHTML:n.label},null,8,nt)]),_:2},1032,["onClick","disabled","class"]))),128))])])])])):v("",!0)]),_:1})]),_:1}),t(s(K),{open:T.value,"onUpdate:open":e[11]||(e[11]=n=>T.value=n)},{default:a(()=>[t(s(W),null,{default:a(()=>[t(s(Y),null,{default:a(()=>[t(s(G),{class:"flex items-center gap-2"},{default:a(()=>[t(d,{name:"alert-triangle",class:"h-5 w-5 text-destructive"}),e[37]||(e[37]=r(" Confirm Bulk Deletion "))]),_:1}),t(s(J),null,{default:a(()=>[r(" Are you sure you want to delete "+b(g.value.length)+" tickets? This action cannot be undone. ",1)]),_:1})]),_:1}),t(s(Q),{class:"mt-4"},{default:a(()=>[t(s(p),{type:"button",onClick:e[9]||(e[9]=n=>T.value=!1),variant:"outline"},{default:a(()=>e[38]||(e[38]=[r(" Cancel ")])),_:1}),t(s(p),{type:"button",onClick:e[10]||(e[10]=n=>ne()),variant:"destructive"},{default:a(()=>e[39]||(e[39]=[r(" Delete Selected ")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),t(s(K),{open:C.value,"onUpdate:open":e[15]||(e[15]=n=>C.value=n)},{default:a(()=>[t(s(W),{class:"sm:max-w-lg w-[90vw]"},{default:a(()=>[t(s(Y),null,{default:a(()=>[t(s(G),{class:"flex items-center gap-2"},{default:a(()=>[t(d,{name:"plus-circle",class:"h-5 w-5 text-primary"}),e[40]||(e[40]=r(" New Ticket "))]),_:1}),t(s(J),null,{default:a(()=>e[41]||(e[41]=[r(" Fill in the details to create a new support ticket. ")])),_:1})]),_:1}),l("form",{onSubmit:be(ie,["prevent"]),class:"space-y-4 p-4"},[l("div",null,[t(s(D),{for:"subject"},{default:a(()=>e[42]||(e[42]=[r("Subject")])),_:1}),t(s(X),{id:"subject",modelValue:s(y).subject,"onUpdate:modelValue":e[12]||(e[12]=n=>s(y).subject=n),required:"",placeholder:"Brief description of your issue"},null,8,["modelValue"])]),l("div",null,[t(s(D),{for:"message"},{default:a(()=>e[43]||(e[43]=[r("Message")])),_:1}),V(l("textarea",{id:"message","onUpdate:modelValue":e[13]||(e[13]=n=>s(y).message=n),rows:"4",placeholder:"Describe your issue in detail...",class:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",required:""},null,512),[[xe,s(y).message]])]),t(s(Q),{class:"flex justify-end gap-2"},{default:a(()=>[t(s(p),{type:"button",onClick:e[14]||(e[14]=n=>C.value=!1),variant:"outline"},{default:a(()=>e[44]||(e[44]=[r(" Cancel ")])),_:1}),t(s(p),{type:"submit",class:"shadow-sm hover:shadow transition-all"},{default:a(()=>e[45]||(e[45]=[r("Create")])),_:1})]),_:1})],32)]),_:1})]),_:1},8,["open"])])]),_:1},8,["tenantSlug"]))}};export{Tt as default};
