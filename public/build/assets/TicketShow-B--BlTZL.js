import{r as z,A as F,f,i as r,j as n,B as s,X as a,u as t,G as p,O as d,P as u,H as g,I as j,E as N,Y as U,an as H,J as I,K as O,ak as Y,am as q}from"./vendor-BFuKjz45.js";import{x as A,g as E,S as G,W as B}from"./vendor-vue-BLQkEQ_D.js";import{_ as P}from"./AppLayout.vue_vue_type_script_setup_true_lang-CvhbqXcl.js";import{_ as c}from"./Icon.vue_vue_type_script_setup_true_lang-Bvtx7n_2.js";import{_ as S}from"./Button.vue_vue_type_script_setup_true_lang-BbwYdLlm.js";import{_ as v}from"./Card.vue_vue_type_script_setup_true_lang-kUJ1jh19.js";import{_ as C,a as D}from"./CardTitle.vue_vue_type_script_setup_true_lang-B4PiGnOE.js";import{_}from"./CardContent.vue_vue_type_script_setup_true_lang-CaXnTGJw.js";import{_ as W}from"./DialogFooter.vue_vue_type_script_setup_true_lang-B6J1QtuW.js";import{_ as J,a as K,b as L}from"./AlertDescription.vue_vue_type_script_setup_true_lang-DfRKwC2v.js";import{_ as k}from"./Badge.vue_vue_type_script_setup_true_lang-Cbc7GIY_.js";import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vendor-axios-xsH4HHeE.js";import"./utils-7fX89-0C.js";import"./vendor-ui-CqNqovUm.js";import"./app-CGq9Auu4.js";import"./vendor-icons-ILJ_3fu6.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CZUnzYQk.js";const Q={class:"max-w-3xl mx-auto p-6 space-y-6"},Z={class:"flex items-center gap-2"},ee={class:"text-sm text-muted-foreground mt-1 flex items-center gap-1"},te={key:0,class:"flex items-center gap-1 ml-2"},se={key:0,class:"flex-shrink-0"},ae={class:"bg-muted/30 p-4 rounded-md border border-border/50 hover:border-primary/20 transition-colors"},ne={class:"whitespace-pre-line"},oe={class:"flex justify-between items-center mb-4"},re={class:"text-xl font-bold text-gray-800 dark:text-gray-200 flex items-center gap-2"},ie={key:0,class:"bg-muted/20 p-6 rounded-md text-center text-muted-foreground border border-dashed border-border"},le={class:"flex flex-col items-center"},de={key:0,class:"text-sm mt-2"},ue={class:"space-y-4 mt-4"},ce={class:"flex justify-between items-center mb-2"},me={class:"flex items-center gap-2"},fe={class:"h-8 w-8 rounded-full bg-primary/10 flex items-center justify-center text-primary font-semibold"},pe={class:"font-semibold"},ge={class:"text-xs text-muted-foreground flex items-center gap-1"},be={class:"bg-background/50 p-3 rounded-md border border-border/50 mt-2 hover:border-primary/20 transition-colors"},he={class:"whitespace-pre-line"},ke={key:0,class:"text-xs text-right mt-2 text-muted-foreground"},xe={key:0},ve={key:1},_e={class:"flex flex-col items-center justify-center py-4"},ye={class:"flex justify-center mt-8"},we={__name:"TicketShow",props:{ticket:Object,tenantSlug:{type:String,default:null},SuperAdmin:Boolean},setup(o){const i=o,x=z(""),M=[{title:i.tenantSlug?"Dashboard":"Admin Dashboard",href:i.tenantSlug?route("dashboard",{tenantSlug:i.tenantSlug}):route("admin.dashboard")},{title:"Support Tickets",href:i.tenantSlug?route("support.index",{tenantSlug:i.tenantSlug}):route("support.index.admin")},{title:`Ticket #${i.ticket.id}`,href:""}],b=A({status:i.ticket.status}),h=A({ticket_id:i.ticket.id,message:""});function $(m){switch(m){case"open":return"default";case"in_progress":return"warning";case"closed":return"secondary";default:return"outline"}}function T(){const m=i.tenantSlug?route("support.update.status",{tenantSlug:i.tenantSlug,ticket:i.ticket.id}):route("support.update.status.admin",i.ticket.id);b.put(m,{onSuccess:()=>{x.value=`Ticket status updated to ${b.status.replace("_"," ")}.`,setTimeout(()=>B.reload(),1500)}})}function V(){b.status="open",T()}function R(){const m=i.tenantSlug?route("support.responses.store",{tenantSlug:i.tenantSlug}):route("support.responses.store.admin");h.post(m,{onSuccess:()=>{x.value="Response added successfully.",setTimeout(()=>B.reload(),1500)}})}function y(m){if(!m)return"N/A";const e=new Date(m),l=String(e.getHours()).padStart(2,"0"),w=String(e.getMinutes()).padStart(2,"0");return`${e.getMonth()+1}-${e.getDate()}-${e.getFullYear()} ${l}:${w}`}return F(()=>{i.ticket.responses&&i.ticket.responses.length>0&&setTimeout(()=>{window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"})},500)}),(m,e)=>(r(),f(P,{breadcrumbs:M,tenantSlug:o.tenantSlug},{default:n(()=>[s(t(E),{title:`Ticket #${o.ticket.id}`},null,8,["title"]),a("div",Q,[x.value?(r(),f(t(J),{key:0,variant:"success",class:"animate-in fade-in duration-300"},{default:n(()=>[s(t(K),{class:"flex items-center gap-2"},{default:n(()=>[s(c,{name:"check-circle",class:"h-5 w-5 text-green-500"}),e[2]||(e[2]=d(" Success "))]),_:1}),s(t(L),null,{default:n(()=>[d(u(x.value),1)]),_:1})]),_:1})):p("",!0),s(t(v),{class:"shadow-sm hover:shadow transition-all duration-300"},{default:n(()=>[s(t(C),{class:"flex flex-col sm:flex-row justify-between items-start gap-4 pb-3 border-b"},{default:n(()=>[a("div",null,[a("div",Z,[s(c,{name:"ticket",class:"h-5 w-5 text-primary"}),s(t(D),{class:"text-xl"},{default:n(()=>[d(u(o.ticket.subject),1)]),_:1}),o.ticket.status==="open"?(r(),f(t(k),{key:0,variant:$(o.ticket.status),class:"capitalize animate-pulse"},{default:n(()=>[d(u(o.ticket.status.replace("_"," ")),1)]),_:1},8,["variant"])):(r(),f(t(k),{key:1,variant:$(o.ticket.status),class:"capitalize"},{default:n(()=>[d(u(o.ticket.status.replace("_"," ")),1)]),_:1},8,["variant"]))]),a("p",ee,[s(c,{name:"calendar",class:"h-3.5 w-3.5"}),d(" Created: "+u(y(o.ticket.created_at))+" ",1),o.ticket.user?(r(),g("span",te,[s(c,{name:"user",class:"h-3.5 w-3.5"}),d(" by "+u(o.ticket.user.name),1)])):p("",!0)])]),o.SuperAdmin?(r(),g("div",se,[a("form",{onSubmit:j(T,["prevent"]),class:"flex gap-2"},[N(a("select",{"onUpdate:modelValue":e[0]||(e[0]=l=>t(b).status=l),required:"",class:"h-10 rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:ring-2 focus:ring-primary/30 transition-all"},e[3]||(e[3]=[a("option",{value:"open"},"Open",-1),a("option",{value:"in_progress"},"In Progress",-1),a("option",{value:"closed"},"Closed",-1)]),512),[[U,t(b).status]]),s(t(S),{type:"submit",size:"sm",class:"shadow-sm hover:shadow transition-all"},{default:n(()=>[s(c,{name:"save",class:"mr-2 h-4 w-4"}),e[4]||(e[4]=d(" Update Status "))]),_:1})],32)])):p("",!0)]),_:1}),s(t(_),{class:"pt-4"},{default:n(()=>[a("div",ae,[a("p",ne,u(o.ticket.message),1)])]),_:1})]),_:1}),a("div",null,[a("div",oe,[a("h2",re,[s(c,{name:"message-circle",class:"h-5 w-5 text-primary"}),e[5]||(e[5]=d(" Responses "))]),o.ticket.responses.length?(r(),f(t(k),{key:0,variant:"outline",class:"animate-in slide-in-from-right"},{default:n(()=>[d(u(o.ticket.responses.length)+" "+u(o.ticket.responses.length===1?"response":"responses"),1)]),_:1})):p("",!0)]),o.ticket.responses.length?p("",!0):(r(),g("div",ie,[a("div",le,[s(c,{name:"inbox",class:"h-12 w-12 mb-3 opacity-20"}),e[6]||(e[6]=a("p",null,"No responses yet.",-1)),o.ticket.status!=="closed"?(r(),g("p",de,"Be the first to respond below.")):p("",!0)])])),a("div",ue,[s(H,{name:"list",tag:"div",class:"space-y-4"},{default:n(()=>[(r(!0),g(I,null,O(o.ticket.responses,(l,w)=>(r(),f(t(v),{key:l.id,class:Y([{"border-primary/20 bg-primary/5":l.is_admin,"border-l-4 border-l-primary":l.is_admin&&!l.seen_at},"shadow-sm hover:shadow transition-all duration-300"])},{default:n(()=>[s(t(_),{class:"p-4"},{default:n(()=>[a("div",ce,[a("div",me,[a("div",fe,u(l.user.name.charAt(0).toUpperCase()),1),a("div",null,[a("span",pe,u(l.user.name),1),l.is_admin?(r(),f(t(k),{key:0,variant:"outline",class:"text-xs ml-1"},{default:n(()=>e[7]||(e[7]=[d("Staff")])),_:1})):p("",!0),l.seen_at?p("",!0):(r(),f(t(k),{key:1,variant:"destructive",class:"text-xs ml-1 animate-pulse"},{default:n(()=>e[8]||(e[8]=[d("New")])),_:1}))])]),a("span",ge,[s(c,{name:"clock",class:"h-3.5 w-3.5"}),d(" "+u(y(l.created_at)),1)])]),a("div",be,[a("p",he,u(l.message),1)]),w===o.ticket.responses.length-1?(r(),g("div",ke,[l.seen_at?(r(),g("span",xe,"Seen "+u(y(l.seen_at)),1)):(r(),g("span",ve,"Not seen yet"))])):p("",!0)]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1})])]),o.ticket.status!=="closed"?(r(),f(t(v),{key:1,class:"shadow-sm hover:shadow transition-all duration-300 border-primary/10"},{default:n(()=>[s(t(C),{class:"pb-2"},{default:n(()=>[s(t(D),{class:"flex items-center gap-2"},{default:n(()=>[s(c,{name:"reply",class:"h-5 w-5 text-primary"}),e[9]||(e[9]=d(" Add Response "))]),_:1})]),_:1}),s(t(_),null,{default:n(()=>[a("form",{onSubmit:j(R,["prevent"]),class:"space-y-4"},[N(a("textarea",{"onUpdate:modelValue":e[1]||(e[1]=l=>t(h).message=l),rows:"4",class:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 transition-all focus:border-primary",placeholder:"Your responseâ€¦",required:""},null,512),[[q,t(h).message]]),s(t(W),{class:"flex justify-end"},{default:n(()=>[s(t(S),{type:"submit",class:"shadow-sm hover:shadow transition-all",disabled:t(h).processing},{default:n(()=>[s(c,{name:"send",class:"mr-2 h-4 w-4"}),d(" "+u(t(h).processing?"Sending...":"Send Response"),1)]),_:1},8,["disabled"])]),_:1})],32)]),_:1})]),_:1})):(r(),f(t(v),{key:2,class:"border-muted bg-muted/10 shadow-sm"},{default:n(()=>[s(t(_),{class:"p-4 text-center"},{default:n(()=>[a("div",_e,[s(c,{name:"check-circle",class:"h-12 w-12 text-muted-foreground mb-2"}),e[11]||(e[11]=a("p",{class:"text-muted-foreground"},"This ticket is closed. No further responses can be added.",-1)),o.SuperAdmin?(r(),f(t(S),{key:0,onClick:V,variant:"outline",size:"sm",class:"mt-4 shadow-sm hover:shadow transition-all"},{default:n(()=>[s(c,{name:"refresh-cw",class:"mr-2 h-4 w-4"}),e[10]||(e[10]=d(" Reopen Ticket "))]),_:1})):p("",!0)])]),_:1})]),_:1})),a("div",ye,[s(t(G),{href:i.tenantSlug?m.route("support.index",{tenantSlug:i.tenantSlug}):m.route("support.index.admin"),class:"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2 shadow-sm hover:shadow transition-all"},{default:n(()=>[s(c,{name:"arrow-left",class:"mr-2 h-4 w-4"}),e[12]||(e[12]=d(" Back to Tickets "))]),_:1},8,["href"])])])]),_:1},8,["tenantSlug"]))}},Ye=X(we,[["__scopeId","data-v-d70e2881"]]);export{Ye as default};
