import{H as p,i as d,X as l,G as $,J as z,K as M,P as w,B as t,f as k,j as o,O as v,u as e,e as B,r as U,a as T,w as Q,an as P,I as Y,as as N}from"./vendor-DQlNQ5gH.js";import{S as fe,W as Z,x as H,g as pe}from"./vendor-vue-CQn6KzTb.js";import{_ as ve}from"./AppLayout.vue_vue_type_script_setup_true_lang-DSyDamtW.js";import{_ as A,a as R}from"./Label.vue_vue_type_script_setup_true_lang-BRq5T-WA.js";import{_}from"./Button.vue_vue_type_script_setup_true_lang-B-8911bK.js";import{_ as K}from"./Checkbox.vue_vue_type_script_setup_true_lang-BXBwirKi.js";import{_ as ge,a as _e,b as xe,c as ye,d as ee}from"./SelectValue.vue_vue_type_script_setup_true_lang-C7iTUKa-.js";import{_ as E}from"./InputError.vue_vue_type_script_setup_true_lang-D_fiBgOZ.js";import{L as be,S as he,U as $e,P as I,a as we,B as ke}from"./vendor-icons-pKobgiP0.js";import{_ as W}from"./Card.vue_vue_type_script_setup_true_lang-yOexdr0W.js";import{_ as q}from"./CardContent.vue_vue_type_script_setup_true_lang-Dh-7LYTR.js";import{_ as G}from"./CardHeader.vue_vue_type_script_setup_true_lang-BXftwvVe.js";import{_ as J}from"./CardTitle.vue_vue_type_script_setup_true_lang-OH7QXspQ.js";import{_ as Se}from"./Separator.vue_vue_type_script_setup_true_lang-C1-m9AbW.js";import{_ as Ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vendor-axios-xsH4HHeE.js";import"./utils-D2wO_Ovf.js";import"./vendor-ui-CGEGZLyF.js";import"./Icon.vue_vue_type_script_setup_true_lang-D_7hXODg.js";import"./app-C-NdXJ4B.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BpTGIYrD.js";const Ue={class:"mx-auto max-w-[95vw] md:max-w-[64vw] lg:max-w-full overflow-x-auto"},Ae={class:"rounded-md border"},je={class:"w-full caption-bottom text-sm"},ze={class:"[&_tr:last-child]:border-0"},Le={class:"p-4 align-middle font-medium"},Ve={class:"p-4 align-middle"},Me={class:"p-4 align-middle text-right"},Ee={class:"flex justify-end space-x-2"},Re={key:0,class:"mt-6 flex justify-center"},De={class:"flex items-center space-x-1"},Te={__name:"UserList",props:{users:Object,isSuperAdmin:{type:Boolean,default:!1}},setup(f){const x=n=>{n&&Z.get(n,{},{only:["users"]})};return(n,u)=>(d(),p("div",Ue,[l("div",Ae,[l("table",je,[u[3]||(u[3]=l("thead",{class:"[&_tr]:border-b"},[l("tr",{class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},[l("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Name"),l("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Email"),l("th",{class:"h-12 px-4 text-right pr-16 align-middle font-medium text-muted-foreground"},"Actions")])],-1)),l("tbody",ze,[(d(!0),p(z,null,M(f.users.data,s=>(d(),p("tr",{key:s.id,class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},[l("td",Le,w(s.name),1),l("td",Ve,w(s.email),1),l("td",Me,[l("div",Ee,[t(e(_),{onClick:i=>n.$emit("edit",s),variant:"outline",size:"sm"},{default:o(()=>u[0]||(u[0]=[v(" Edit ")])),_:2},1032,["onClick"]),t(e(_),{onClick:i=>n.$emit("delete",s),variant:"destructive",size:"sm"},{default:o(()=>u[1]||(u[1]=[v(" Delete ")])),_:2},1032,["onClick"]),f.isSuperAdmin?(d(),k(e(fe),{key:0,href:n.route("impersonate.start",s.id),as:"button"},{default:o(()=>[t(e(_),{variant:"secondary",size:"sm"},{default:o(()=>u[2]||(u[2]=[v(" Impersonate ")])),_:1})]),_:2},1032,["href"])):$("",!0)])])]))),128))])])]),f.users.links?(d(),p("div",Re,[l("nav",De,[(d(!0),p(z,null,M(f.users.links,s=>(d(),k(e(_),{key:s.label,onClick:i=>x(s.url),disabled:!s.url,variant:s.active?"default":"outline",size:"sm",class:"min-w-[40px]",innerHTML:s.label},null,8,["onClick","disabled","variant","innerHTML"]))),128))])])):$("",!0)]))}},Pe={class:"mx-auto max-w-[95vw] md:max-w-[64vw] lg:max-w-full overflow-x-auto"},Oe={class:"rounded-md border"},Be={class:"w-full caption-bottom text-sm"},Ne={class:"[&_tr:last-child]:border-0"},He={class:"p-4 align-middle font-medium"},Xe={class:"p-4 align-middle"},Fe={class:"flex flex-wrap gap-1"},Ie={class:"p-4 align-middle text-right"},We={class:"flex justify-end space-x-2"},qe={key:0,class:"mt-6 flex justify-center"},Ge={class:"flex items-center space-x-1"},Je={__name:"RoleList",props:{roles:Object},setup(f){const x=n=>{n&&Z.get(n,{},{only:["roles"]})};return(n,u)=>(d(),p("div",Pe,[l("div",Oe,[l("table",Be,[u[2]||(u[2]=l("thead",{class:"[&_tr]:border-b"},[l("tr",{class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},[l("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Role Name"),l("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Permissions"),l("th",{class:"h-12 px-4 text-right pr-16 align-middle font-medium text-muted-foreground"},"Actions")])],-1)),l("tbody",Ne,[(d(!0),p(z,null,M(f.roles.data,s=>(d(),p("tr",{key:s.id,class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},[l("td",He,w(s.name),1),l("td",Xe,[l("div",Fe,[(d(!0),p(z,null,M(s.permissions,i=>(d(),p("span",{key:i.id,class:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-muted text-muted-foreground"},w(i.name),1))),128))])]),l("td",Ie,[l("div",We,[t(e(_),{onClick:i=>n.$emit("edit",s),variant:"outline",size:"sm"},{default:o(()=>u[0]||(u[0]=[v(" Edit ")])),_:2},1032,["onClick"]),t(e(_),{onClick:i=>n.$emit("delete",s),variant:"destructive",size:"sm"},{default:o(()=>u[1]||(u[1]=[v(" Delete ")])),_:2},1032,["onClick"])])])]))),128))])])]),f.roles.links?(d(),p("div",qe,[l("nav",Ge,[(d(!0),p(z,null,M(f.roles.links,s=>(d(),k(e(_),{key:s.label,onClick:i=>x(s.url),disabled:!s.url,variant:s.active?"default":"outline",size:"sm",class:"min-w-[40px]",innerHTML:s.label},null,8,["onClick","disabled","variant","innerHTML"]))),128))])])):$("",!0)]))}},Ke={class:"fixed inset-0 z-50"},Qe={class:"absolute inset-0 flex items-center justify-center p-4"},Ye={class:"bg-background p-6 rounded-lg shadow-xl w-full sm:max-w-lg md:max-w-2xl lg:max-w-3xl overflow-y-auto max-h-[90vh] animate-in fade-in zoom-in-95 duration-200 border border-border"},Ze={class:"flex justify-between items-center mb-4"},es={class:"text-2xl font-bold text-foreground"},ss={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ts={class:"space-y-2"},ls={class:"space-y-2"},ns={key:0,class:"space-y-2 md:col-span-2"},as={key:1,class:"space-y-2 md:col-span-2"},os={class:"grid grid-cols-1 md:grid-cols-2 gap-4 pt-2"},rs={class:"space-y-2"},is={class:"relative"},ds={class:"flex items-center space-x-2"},us={class:"h-60 border rounded-md p-2 overflow-y-auto"},ms={class:"space-y-2"},cs={class:"relative"},fs={class:"flex items-center space-x-2"},ps={class:"h-60 border rounded-md p-2 overflow-y-auto"},vs={key:0,class:"ml-2 text-xs px-2 py-0.5 rounded-full border border-gray-200 bg-gray-100 dark:border-gray-700 dark:bg-gray-800 text-gray-600 dark:text-gray-300"},gs={class:"flex justify-end space-x-3 pt-4"},_s=B({__name:"UserForm",props:{user:{type:Object,default:null},tenants:{type:Array,default:()=>[]},roles:{type:Array,default:()=>[]},permissions:{type:Array,default:()=>[]},isSuperAdmin:{type:Boolean,default:!1},tenantSlug:{type:String,default:null}},emits:["close","saved"],setup(f,{emit:x}){const n=f,u=x,s=H({name:n.user?n.user.name:"",email:n.user?n.user.email:"",password:"",tenant_id:n.user?n.user.tenant_id:n.tenants.length?n.tenants[0].id:null,roles:n.user&&n.user.roles?n.user.roles.map(r=>r.id):[],user_permissions:n.user&&n.user.permissions?n.user.permissions.map(r=>r.name):[]}),i=U(""),m=U(""),g=T(()=>{if(!i.value.trim())return n.roles;const r=i.value.toLowerCase();return n.roles.filter(a=>a.name.toLowerCase().includes(r))}),C=T(()=>{if(!m.value.trim())return n.permissions;const r=m.value.toLowerCase();return n.permissions.filter(a=>a.name.toLowerCase().includes(r))}),L=T(()=>{const r=new Set;return n.roles.forEach(a=>{s.roles.includes(a.id)&&a.permissions&&a.permissions.forEach(D=>{r.add(D.name)})}),Array.from(r)});Q(()=>n.user,r=>{r?(s.name=r.name,s.email=r.email,s.tenant_id=r.tenant_id,s.roles=r.roles?r.roles.map(a=>a.id):[],s.user_permissions=r.permissions?r.permissions.map(a=>a.name):[]):(s.name="",s.email="",s.password="",s.tenant_id=n.tenants.length?n.tenants[0].id:null,s.roles=[],s.user_permissions=[])},{immediate:!0});const j=()=>{n.user?n.isSuperAdmin?s.put(route("admin.users.update",n.user),{onSuccess:()=>{u("saved")}}):s.put(route("users.update",[n.tenantSlug,n.user]),{onSuccess:()=>{u("saved")}}):n.isSuperAdmin?s.post(route("admin.users.store"),{onSuccess:()=>{u("saved")}}):s.post(route("users.store",n.tenantSlug),{onSuccess:()=>{u("saved")}})},V=r=>{const a=s.roles.indexOf(r);a===-1?s.roles.push(r):s.roles.splice(a,1)},y=r=>{if(L.value.includes(r))return;const a=s.user_permissions.indexOf(r);a===-1?s.user_permissions.push(r):s.user_permissions.splice(a,1)};return(r,a)=>{const D=P("X"),S=P("Loader2");return d(),p("div",Ke,[l("div",Qe,[l("div",Ye,[l("div",Ze,[l("h2",es,w(f.user?"Edit User":"Create User"),1),t(e(_),{variant:"ghost",size:"icon",onClick:a[0]||(a[0]=()=>u("close"))},{default:o(()=>[t(D,{class:"h-5 w-5"})]),_:1})]),l("form",{onSubmit:Y(j,["prevent"]),class:"space-y-4"},[l("div",ss,[l("div",ts,[t(e(A),{for:"name"},{default:o(()=>a[10]||(a[10]=[v("Name")])),_:1}),t(e(R),{id:"name",modelValue:e(s).name,"onUpdate:modelValue":a[1]||(a[1]=c=>e(s).name=c),placeholder:"Enter name",class:"w-full"},null,8,["modelValue"]),t(E,{message:e(s).errors.name},null,8,["message"])]),l("div",ls,[t(e(A),{for:"email"},{default:o(()=>a[11]||(a[11]=[v("Email")])),_:1}),t(e(R),{id:"email",modelValue:e(s).email,"onUpdate:modelValue":a[2]||(a[2]=c=>e(s).email=c),type:"email",placeholder:"Enter email",class:"w-full"},null,8,["modelValue"]),t(E,{message:e(s).errors.email},null,8,["message"])]),f.user?$("",!0):(d(),p("div",ns,[t(e(A),{for:"password"},{default:o(()=>a[12]||(a[12]=[v("Password")])),_:1}),t(e(R),{id:"password",modelValue:e(s).password,"onUpdate:modelValue":a[3]||(a[3]=c=>e(s).password=c),type:"password",placeholder:"Enter password",class:"w-full"},null,8,["modelValue"]),t(E,{message:e(s).errors.password},null,8,["message"])])),f.isSuperAdmin?(d(),p("div",as,[t(e(A),{for:"tenant"},{default:o(()=>a[13]||(a[13]=[v("Company Name")])),_:1}),t(e(ge),{modelValue:e(s).tenant_id,"onUpdate:modelValue":a[4]||(a[4]=c=>e(s).tenant_id=c)},{default:o(()=>[t(e(_e),null,{default:o(()=>[t(e(xe),{placeholder:"Select a company"})]),_:1}),t(e(ye),null,{default:o(()=>[t(e(ee),{value:null},{default:o(()=>a[14]||(a[14]=[v("None")])),_:1}),(d(!0),p(z,null,M(f.tenants,c=>(d(),k(e(ee),{value:c.id,key:c.id},{default:o(()=>[v(w(c.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),t(E,{message:e(s).errors.tenant_id},null,8,["message"])])):$("",!0)]),l("div",os,[l("div",rs,[t(e(A),null,{default:o(()=>a[15]||(a[15]=[v("Roles")])),_:1}),l("div",is,[l("div",ds,[t(e(R),{modelValue:i.value,"onUpdate:modelValue":a[5]||(a[5]=c=>i.value=c),placeholder:"Search roles...",class:"w-full"},null,8,["modelValue"]),i.value?(d(),k(e(_),{key:0,type:"button",variant:"ghost",size:"icon",onClick:a[6]||(a[6]=c=>i.value=""),class:"absolute right-2"},{default:o(()=>[t(D,{class:"h-4 w-4"})]),_:1})):$("",!0)])]),l("div",us,[(d(!0),p(z,null,M(g.value,c=>(d(),p("div",{key:c.id,class:"flex items-center py-1 px-2 hover:bg-muted/50 rounded transition-colors"},[t(e(K),{id:`role-${c.id}`,checked:e(s).roles.includes(c.id),"onUpdate:checked":X=>V(c.id),class:"mr-2"},null,8,["id","checked","onUpdate:checked"]),t(e(A),{for:`role-${c.id}`,class:"cursor-pointer"},{default:o(()=>[v(w(c.name),1)]),_:2},1032,["for"])]))),128))]),t(E,{message:e(s).errors.roles},null,8,["message"])]),l("div",ms,[t(e(A),null,{default:o(()=>a[16]||(a[16]=[v("Permissions")])),_:1}),l("div",cs,[l("div",fs,[t(e(R),{modelValue:m.value,"onUpdate:modelValue":a[7]||(a[7]=c=>m.value=c),placeholder:"Search permissions...",class:"w-full"},null,8,["modelValue"]),m.value?(d(),k(e(_),{key:0,type:"button",variant:"ghost",size:"icon",onClick:a[8]||(a[8]=c=>m.value=""),class:"absolute right-2"},{default:o(()=>[t(D,{class:"h-4 w-4"})]),_:1})):$("",!0)])]),l("div",ps,[(d(!0),p(z,null,M(C.value,c=>(d(),p("div",{key:c.id,class:"flex items-center py-1 px-2 hover:bg-muted/50 rounded transition-colors"},[t(e(K),{id:`permission-${c.name}`,checked:e(s).user_permissions.includes(c.name),"onUpdate:checked":X=>y(c.name),disabled:L.value.includes(c.name),class:"mr-2"},null,8,["id","checked","onUpdate:checked","disabled"]),t(e(A),{for:`permission-${c.name}`,class:"cursor-pointer"},{default:o(()=>[v(w(c.name)+" ",1),L.value.includes(c.name)?(d(),p("span",vs," inherited ")):$("",!0)]),_:2},1032,["for"])]))),128))]),t(E,{message:e(s).errors.user_permissions},null,8,["message"])])]),l("div",gs,[t(e(_),{type:"button",onClick:a[9]||(a[9]=()=>u("close")),variant:"outline"},{default:o(()=>a[17]||(a[17]=[v(" Cancel ")])),_:1}),t(e(_),{type:"submit",disabled:e(s).processing},{default:o(()=>[e(s).processing?(d(),k(S,{key:0,class:"mr-2 h-4 w-4 animate-spin"})):$("",!0),v(" "+w(e(s).processing?"Saving...":"Save"),1)]),_:1},8,["disabled"])])],32)])])])}}}),xs={class:"rounded-md border"},ys={class:"w-full caption-bottom text-sm"},bs={class:"[&_tr:last-child]:border-0"},hs={class:"p-4 align-middle font-medium"},$s={class:"p-4 align-middle"},ws={class:"p-4 align-middle text-right"},ks={class:"flex justify-end space-x-2"},Ss={key:0,class:"mt-6 flex justify-center"},Cs={class:"flex items-center space-x-1"},Us={__name:"TenantList",props:{tenants:{type:Object,default:()=>({data:[],links:[]})}},setup(f){const x=f,n=Array.isArray(x.tenants)?x.tenants:x.tenants.data||[],u=s=>{s&&Z.get(s,{},{only:["tenants"]})};return(s,i)=>(d(),p("div",null,[l("div",xs,[l("table",ys,[i[2]||(i[2]=l("thead",{class:"[&_tr]:border-b"},[l("tr",{class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},[l("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Company Name"),l("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Slug"),l("th",{class:"h-12 px-4 text-right pr-16 align-middle font-medium text-muted-foreground"},"Actions")])],-1)),l("tbody",bs,[(d(!0),p(z,null,M(e(n),m=>(d(),p("tr",{key:m.id,class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},[l("td",hs,w(m.name),1),l("td",$s,w(m.slug),1),l("td",ws,[l("div",ks,[t(e(_),{onClick:g=>s.$emit("edit",m),variant:"outline",size:"sm"},{default:o(()=>i[0]||(i[0]=[v(" Edit ")])),_:2},1032,["onClick"]),t(e(_),{onClick:g=>s.$emit("delete",m),variant:"destructive",size:"sm"},{default:o(()=>i[1]||(i[1]=[v(" Delete ")])),_:2},1032,["onClick"])])])]))),128))])])]),f.tenants.links?(d(),p("div",Ss,[l("nav",Cs,[(d(!0),p(z,null,M(f.tenants.links,m=>(d(),k(e(_),{key:m.label,onClick:g=>u(m.url),disabled:!m.url,variant:m.active?"default":"outline",size:"sm",class:"min-w-[40px]",innerHTML:m.label},null,8,["onClick","disabled","variant","innerHTML"]))),128))])])):$("",!0)]))}},As={class:"fixed inset-0 flex items-center justify-center bg-black/50 backdrop-blur-sm z-50 p-4"},js={class:"bg-background p-6 rounded-lg shadow-xl w-full max-w-md overflow-y-auto max-h-[90vh] animate-in fade-in zoom-in-95 duration-200 border border-border"},zs={class:"flex justify-between items-center mb-4"},Ls={class:"text-2xl font-bold text-foreground"},Vs={class:"space-y-2"},Ms={key:0,class:"space-y-2"},Es={class:"flex justify-end space-x-3 pt-4"},Rs=B({__name:"TenantForm",props:{tenant:{type:Object,default:null}},emits:["close","saved"],setup(f,{emit:x}){const n=f,u=x,s=H({name:n.tenant?n.tenant.name:"",slug:n.tenant?n.tenant.slug:""});Q(()=>n.tenant,m=>{m?(s.name=m.name,s.slug=m.slug):(s.name="",s.slug="")},{immediate:!0});const i=()=>{n.tenant?s.put(route("admin.tenants.update",n.tenant),{onSuccess:()=>{u("saved")}}):s.post(route("admin.tenants.store"),{onSuccess:()=>{u("saved")}})};return(m,g)=>{const C=P("X"),L=P("Loader2");return d(),p("div",As,[l("div",js,[l("div",zs,[l("h2",Ls,w(f.tenant?"Edit Company":"Create Company"),1),t(e(_),{variant:"ghost",size:"icon",onClick:g[0]||(g[0]=()=>u("close"))},{default:o(()=>[t(C,{class:"h-5 w-5"})]),_:1})]),l("form",{onSubmit:Y(i,["prevent"]),class:"space-y-4"},[l("div",Vs,[t(e(A),{for:"name"},{default:o(()=>g[4]||(g[4]=[v("Company Name")])),_:1}),t(e(R),{id:"name",modelValue:e(s).name,"onUpdate:modelValue":g[1]||(g[1]=j=>e(s).name=j),placeholder:"Enter company name",class:"w-full"},null,8,["modelValue"]),t(E,{message:e(s).errors.name},null,8,["message"])]),f.tenant?(d(),p("div",Ms,[t(e(A),{for:"slug"},{default:o(()=>g[5]||(g[5]=[v("Slug")])),_:1}),t(e(R),{id:"slug",modelValue:e(s).slug,"onUpdate:modelValue":g[2]||(g[2]=j=>e(s).slug=j),placeholder:"Enter company slug",class:"w-full"},null,8,["modelValue"]),t(E,{message:e(s).errors.slug},null,8,["message"])])):$("",!0),l("div",Es,[t(e(_),{type:"button",onClick:g[3]||(g[3]=()=>u("close")),variant:"outline"},{default:o(()=>g[6]||(g[6]=[v(" Cancel ")])),_:1}),t(e(_),{type:"submit",disabled:e(s).processing},{default:o(()=>[e(s).processing?(d(),k(L,{key:0,class:"mr-2 h-4 w-4 animate-spin"})):$("",!0),v(" "+w(e(s).processing?"Saving...":"Save"),1)]),_:1},8,["disabled"])])],32)])])}}}),Ds={class:"fixed inset-0 flex items-center justify-center z-50"},Ts={class:"bg-background p-6 rounded-lg shadow-xl w-full max-w-md overflow-y-auto max-h-[90vh] animate-in fade-in zoom-in-95 duration-200 border border-border"},Ps={class:"flex justify-between items-center mb-4"},Os={class:"text-2xl font-bold text-foreground"},Bs={class:"space-y-2"},Ns={class:"space-y-2"},Hs={class:"relative"},Xs={class:"flex items-center space-x-2"},Fs={class:"h-40 border rounded-md p-2 overflow-y-auto"},Is={class:"flex justify-end space-x-3 pt-4"},Ws=B({__name:"RoleForm",props:{role:{type:Object,default:null},permissions:{type:Array,default:()=>[]},isSuperAdmin:{type:Boolean,default:!1},tenantSlug:{type:String,default:null}},emits:["saved","close"],setup(f,{emit:x}){var j,V;const n=x,u=f,{tenantSlug:s}=u,i=H({name:u.role?u.role.name:"",permissions:((V=(j=u.role)==null?void 0:j.permissions)==null?void 0:V.map(y=>y.name))||[]}),m=U(""),g=T(()=>{if(!m.value.trim())return u.permissions;const y=m.value.toLowerCase();return u.permissions.filter(r=>r.name.toLowerCase().includes(y))});Q(()=>u.role,y=>{var r;y?(i.name=y.name,i.permissions=((r=y.permissions)==null?void 0:r.map(a=>a.name))||[]):(i.name="",i.permissions=[])},{immediate:!0});const C=()=>{u.role?u.isSuperAdmin?i.put(route("admin.roles.update",u.role.id),{onSuccess:()=>{n("saved")}}):i.put(route("roles.update",[s,u.role.id]),{onSuccess:()=>{n("saved")}}):u.isSuperAdmin?i.post(route("admin.roles.store"),{onSuccess:()=>{n("saved")}}):i.post(route("roles.store",s),{onSuccess:()=>{n("saved")}})},L=y=>{const r=i.permissions.indexOf(y);r===-1?i.permissions.push(y):i.permissions.splice(r,1)};return(y,r)=>{const a=P("X"),D=P("Loader2");return d(),p("div",Ds,[l("div",Ts,[l("div",Ps,[l("h2",Os,w(f.role?"Edit Role":"Create Role"),1),t(e(_),{variant:"ghost",size:"icon",onClick:r[0]||(r[0]=()=>n("close"))},{default:o(()=>[t(a,{class:"h-5 w-5"})]),_:1})]),l("form",{onSubmit:Y(C,["prevent"]),class:"space-y-4"},[l("div",Bs,[t(e(A),{for:"name"},{default:o(()=>r[5]||(r[5]=[v("Role Name")])),_:1}),t(e(R),{id:"name",modelValue:e(i).name,"onUpdate:modelValue":r[1]||(r[1]=S=>e(i).name=S),placeholder:"Enter role name",class:"w-full"},null,8,["modelValue"]),t(E,{message:e(i).errors.name},null,8,["message"])]),l("div",Ns,[t(e(A),null,{default:o(()=>r[6]||(r[6]=[v("Permissions")])),_:1}),l("div",Hs,[l("div",Xs,[t(e(R),{modelValue:m.value,"onUpdate:modelValue":r[2]||(r[2]=S=>m.value=S),placeholder:"Search permissions...",class:"w-full"},null,8,["modelValue"]),m.value?(d(),k(e(_),{key:0,type:"button",variant:"ghost",size:"icon",onClick:r[3]||(r[3]=S=>m.value=""),class:"absolute right-2"},{default:o(()=>[t(a,{class:"h-4 w-4"})]),_:1})):$("",!0)])]),l("div",Fs,[(d(!0),p(z,null,M(g.value,S=>(d(),p("div",{key:S.id,class:"flex items-center py-1 px-2 hover:bg-muted/50 rounded transition-colors"},[t(e(K),{id:`permission-${S.name}`,checked:e(i).permissions.includes(S.name),"onUpdate:checked":c=>L(S.name),class:"mr-2"},null,8,["id","checked","onUpdate:checked"]),t(e(A),{for:`permission-${S.name}`,class:"cursor-pointer"},{default:o(()=>[v(w(S.name),1)]),_:2},1032,["for"])]))),128))]),t(E,{message:e(i).errors.permissions},null,8,["message"])]),l("div",Is,[t(e(_),{type:"button",onClick:r[4]||(r[4]=()=>n("close")),variant:"outline"},{default:o(()=>r[7]||(r[7]=[v(" Cancel ")])),_:1}),t(e(_),{type:"submit",disabled:e(i).processing},{default:o(()=>[e(i).processing?(d(),k(D,{key:0,class:"mr-2 h-4 w-4 animate-spin"})):$("",!0),v(" "+w(e(i).processing?"Saving...":"Save"),1)]),_:1},8,["disabled"])])],32)])])}}}),qs={class:"fixed inset-0 flex items-center justify-center bg-black/50 backdrop-blur-sm z-50 p-4"},Gs={class:"bg-background p-6 rounded-lg shadow-xl w-full max-w-md animate-in fade-in zoom-in-95 duration-200 border border-border"},Js={class:"flex flex-col space-y-4"},Ks={class:"text-muted-foreground"},Qs={class:"flex justify-end space-x-3 pt-2"},Ys=B({__name:"ConfirmDeleteModal",props:{message:{type:String,default:"Are you sure you want to delete this item?"},deleteUrl:{type:String,required:!0},tenantSlug:{type:String,default:null}},emits:["cancel","confirmed"],setup(f,{emit:x}){const n=f,u=x,s=H({}),i=()=>{s.delete(n.deleteUrl,{onSuccess:()=>{u("confirmed")}})},m=()=>{u("cancel")};return(g,C)=>(d(),p("div",qs,[l("div",Gs,[l("div",Js,[C[1]||(C[1]=l("h2",{class:"text-xl font-bold text-foreground"},"Confirm Deletion",-1)),l("p",Ks,w(f.message),1),l("div",Qs,[t(e(_),{type:"button",onClick:m,variant:"outline"},{default:o(()=>C[0]||(C[0]=[v(" Cancel ")])),_:1}),t(e(_),{type:"button",variant:"destructive",onClick:i,disabled:e(s).processing},{default:o(()=>[e(s).processing?(d(),k(e(be),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):$("",!0),v(" "+w(e(s).processing?"Deleting...":"Delete"),1)]),_:1},8,["disabled"])])])])]))}}),Zs={class:"container w-full m-0 p-2 md:p-4 lg:p-6 space-y-2 md:space-y-4 lg:space-y-6"},et={class:"relative max-w-md"},st={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},tt={class:"flex items-center space-x-2"},lt={class:"flex items-center space-x-2"},nt={class:"flex items-center space-x-2"},at=B({__name:"UserRolesManagement",props:{users:{type:Object,default:()=>({data:[],links:[]})},roles:{type:Object,default:()=>({data:[],links:[]})},tenants:{type:Object,default:()=>({data:[],links:[]})},permissions:Array,search:String,tenantSlug:{type:String,default:null},SuperAdmin:Boolean},setup(f){const x=f,{tenantSlug:n}=x,u=[{title:n?"Dashboard":"Admin Dashboard",href:n?`/${n}/dashboard`:"/dashboard"},{title:"User Management",href:n?`/${n}/admin/user-management`:"/admin/user-management"}],s=U(x.search||""),i=U(!1),m=U(!1),g=U(!1),C=U(null),L=U(null),j=U(null),V=x.SuperAdmin,y=U(!1),r=U(""),a=U(""),D=T(()=>{if(!s.value.trim())return x.users;const b=s.value.toLowerCase(),h=x.users.data.filter(O=>O.name.toLowerCase().includes(b)||O.email.toLowerCase().includes(b));return{...x.users,data:h}}),S=()=>{C.value=null,i.value=!0},c=()=>{i.value=!1},X=()=>{j.value=null,g.value=!0},se=()=>{g.value=!1},te=()=>{L.value=null,m.value=!0},le=()=>{m.value=!1},ne=b=>{C.value=b,i.value=!0},ae=b=>{j.value=b,g.value=!0},oe=b=>{L.value=b,m.value=!0},re=b=>{r.value=V?route("admin.users.destroy",b):route("users.destroy",[n,b]),a.value=`Are you sure you want to delete user ${b.name}?`,y.value=!0},ie=b=>{r.value=V?route("admin.roles.destroy",b):route("roles.destroy",[n,b]),a.value=`Are you sure you want to delete role ${b.name}?`,y.value=!0},de=b=>{r.value=route("admin.tenants.destroy",b),a.value=`Are you sure you want to delete tenant ${b.name}?`,y.value=!0},ue=()=>{y.value=!1},F=()=>{m.value=!1,i.value=!1,g.value=!1},me=T(()=>x.roles.data),ce=T(()=>x.tenants.data);return(b,h)=>(d(),p(z,null,[t(e(pe),{title:"Users Management"}),t(ve,{breadcrumbs:u,tenantSlug:e(n)},{default:o(()=>[l("div",Zs,[h[8]||(h[8]=l("div",{class:"space-y-2"},[l("h1",{class:"text-lg md:text-xl lg:text-2xl font-bold text-gray-900 dark:text-gray-100"}," User and Role Management "),l("p",{class:"text-gray-500 dark:text-gray-400"}," Manage users, roles, and permissions for your application. ")],-1)),t(e(Se)),l("div",et,[l("div",st,[t(e(he),{class:"h-5 w-5 text-gray-400"})]),t(R,{modelValue:s.value,"onUpdate:modelValue":h[0]||(h[0]=O=>s.value=O),placeholder:"Search users...",class:"w-full pl-10 rounded-md"},null,8,["modelValue"])]),t(e(W),null,{default:o(()=>[t(e(G),{class:"p-2 md:p-4 lg:p-6 flex flex-row items-center justify-between space-y-0 pb-2"},{default:o(()=>[t(e(J),{class:"text-xl font-semibold"},{default:o(()=>[l("div",tt,[t(e($e),{class:"h-5 w-5"}),h[2]||(h[2]=l("span",null,"Users",-1))])]),_:1}),t(_,{onClick:S,variant:"default",size:"sm",class:"gap-1"},{default:o(()=>[t(e(I),{class:"h-4 w-4"}),h[3]||(h[3]=l("span",null,"Add User",-1))]),_:1})]),_:1}),t(e(q),{class:"p-2 md:p-4 lg:p-6"},{default:o(()=>[t(Te,{users:D.value,isSuperAdmin:e(V),onEdit:ne,onDelete:re},null,8,["users","isSuperAdmin"])]),_:1})]),_:1}),t(e(W),null,{default:o(()=>[t(e(G),{class:"p-2 md:p-4 lg:p-6 flex flex-row items-center justify-between space-y-0 pb-2"},{default:o(()=>[t(e(J),{class:"text-xl font-semibold"},{default:o(()=>[l("div",lt,[t(e(we),{class:"h-5 w-5"}),h[4]||(h[4]=l("span",null,"Roles",-1))])]),_:1}),t(_,{onClick:te,variant:"default",size:"sm",class:"gap-1"},{default:o(()=>[t(e(I),{class:"h-4 w-4"}),h[5]||(h[5]=l("span",null,"Add Role",-1))]),_:1})]),_:1}),t(e(q),{class:"p-2 md:p-4 lg:p-6"},{default:o(()=>[t(Je,{roles:f.roles,onEdit:oe,onDelete:ie},null,8,["roles"])]),_:1})]),_:1}),e(V)?(d(),k(e(W),{key:0},{default:o(()=>[t(e(G),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:o(()=>[t(e(J),{class:"text-xl font-semibold"},{default:o(()=>[l("div",nt,[t(e(ke),{class:"h-5 w-5"}),h[6]||(h[6]=l("span",null,"Companies",-1))])]),_:1}),t(_,{onClick:X,variant:"default",size:"sm",class:"gap-1"},{default:o(()=>[t(e(I),{class:"h-4 w-4"}),h[7]||(h[7]=l("span",null,"Add Company",-1))]),_:1})]),_:1}),t(e(q),null,{default:o(()=>[t(Us,{tenants:f.tenants,onEdit:ae,onDelete:de},null,8,["tenants"])]),_:1})]),_:1})):$("",!0),t(N,{name:"fade"},{default:o(()=>[i.value?(d(),k(_s,{key:0,user:C.value,roles:me.value,permissions:f.permissions,tenants:ce.value,isSuperAdmin:e(V),tenantSlug:e(n),onClose:c,onSaved:F},null,8,["user","roles","permissions","tenants","isSuperAdmin","tenantSlug"])):$("",!0)]),_:1}),t(N,{name:"fade"},{default:o(()=>[g.value?(d(),k(Rs,{key:0,tenants:f.tenants,tenant:j.value,onClose:se,onSaved:F},null,8,["tenants","tenant"])):$("",!0)]),_:1}),t(N,{name:"fade"},{default:o(()=>[m.value?(d(),k(Ws,{key:0,role:L.value,permissions:f.permissions,isSuperAdmin:e(V),tenantSlug:e(n),onClose:le,onSaved:F},null,8,["role","permissions","isSuperAdmin","tenantSlug"])):$("",!0)]),_:1}),t(N,{name:"fade"},{default:o(()=>[y.value?(d(),k(Ys,{key:0,deleteUrl:r.value,message:a.value,tenantSlug:e(n),onCancel:h[1]||(h[1]=O=>y.value=!1),onConfirmed:ue},null,8,["deleteUrl","message","tenantSlug"])):$("",!0)]),_:1})])]),_:1},8,["tenantSlug"])],64))}}),Ut=Ce(at,[["__scopeId","data-v-7663ae8e"]]);export{Ut as default};
