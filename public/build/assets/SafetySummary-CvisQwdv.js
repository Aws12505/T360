import{_ as B}from"./Button.vue_vue_type_script_setup_true_lang-CzZBifQk.js";import{_ as tt}from"./Card.vue_vue_type_script_setup_true_lang-aMwvZFez.js";import{_ as et}from"./CardContent.vue_vue_type_script_setup_true_lang-Bj6hH48Z.js";import{_ as N}from"./Icon.vue_vue_type_script_setup_true_lang-CCQAf4zh.js";import{r as y,a as m,w as O,A as ot,f as st,i as r,j as C,B as v,u as k,X as t,H as n,G,P as i,J as b,K as p,O as E,aj as F}from"./vendor-DwH8xScK.js";import"./utils-BsI0tD0G.js";import"./vendor-ui-DoCXuQZy.js";import"./vendor-icons-BYt1eATw.js";const at={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},rt={class:"bg-gradient-to-br from-muted/10 to-muted/30 rounded-lg p-4 shadow-md border border-muted/20 hover:shadow-lg transition-shadow"},nt={class:"text-4xl font-bold text-primary"},dt={class:"mt-3 pt-3 border-t border-muted/30"},it={class:"flex items-center justify-between"},lt={class:"text-2xl font-bold text-indigo-600"},ct={class:"bg-gradient-to-br from-muted/10 to-muted/30 rounded-lg p-4 shadow-md border border-muted/20 hover:shadow-lg transition-shadow"},ut={class:"space-y-2"},mt={key:0},ht={class:"text-foreground"},gt={class:"text-primary font-medium"},ft={key:1,class:"text-center text-muted-foreground italic"},vt={class:"bg-gradient-to-br from-muted/10 to-muted/30 rounded-lg p-4 shadow-md border border-muted/20 hover:shadow-lg transition-shadow"},bt={class:"space-y-2"},pt={key:0},xt={class:"text-foreground"},_t={class:"text-destructive font-medium"},wt={key:1,class:"text-center text-muted-foreground italic"},yt={class:"mt-6"},Ct={class:"grid grid-cols-2 md:grid-cols-5 gap-4"},kt={class:"text-sm text-muted-foreground mb-2"},St={class:"text-2xl font-bold text-primary"},Mt={class:"mt-6"},Dt={class:"grid grid-cols-2 md:grid-cols-5 gap-4"},Tt={class:"text-sm text-muted-foreground mb-2"},$t={class:"text-2xl font-bold text-primary"},At={key:0,class:"mt-4 text-center"},Vt={key:1,class:"mt-4"},jt={class:"grid grid-cols-2 md:grid-cols-5 gap-4"},Zt={class:"text-sm text-muted-foreground mb-2"},Gt={class:"text-2xl font-bold text-primary"},It={class:"mt-6 text-center"},Bt={key:0,class:"mt-6"},Nt={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ot={class:"bg-gradient-to-br from-muted/10 to-muted/30 rounded-lg p-4 shadow-lg border border-muted/20"},Et={class:"w-full h-64"},Ft={class:"bg-gradient-to-br from-muted/10 to-muted/30 rounded-lg p-4 shadow-lg border border-muted/20"},Lt={class:"flex justify-center items-center h-72"},zt={class:"w-full h-full"},qt={__name:"SafetySummary",props:{data:{type:Object,default:()=>({})}},setup(l){const u=l,S=y(null),M=y(null);let D=null,T=null;const L=s=>s.replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase()).trim(),I=s=>s.replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase()).trim(),h=y(!1),c=y(!1),$=m(()=>Object.entries(u.data.infractions||{}).sort((e,d)=>d[1]-e[1])),z=m(()=>{const s={};return $.value.filter(([e])=>e!=="driverStar").slice(0,5).forEach(([e,d])=>{s[e]=d}),s});m(()=>{const s={};return $.value.slice(0,5).forEach(([e,d])=>{s[e]=d}),s});const A=m(()=>{const s={};return $.value.filter(([e])=>e!=="driverStar").slice(5).forEach(([e,d])=>{s[e]=d}),s}),R=m(()=>Object.keys(A.value).length>0),U=m(()=>Object.keys(A.value).length),H=()=>{h.value=!h.value},P=()=>{c.value=!c.value,c.value&&setTimeout(()=>{x()},100)},W=[45,25,15,10,5],J=["Distracted Driving","Speeding","Sign Violations","Traffic Light Violations","Following Distance"],x=()=>{var s,e;if(D&&D.destroy(),T&&T.destroy(),S.value){const d=S.value.getContext("2d");if(d){const o=((s=u.data.lineChartData)==null?void 0:s.map(f=>f.greenZoneScore))||[],a=o.length>0?Math.min(...o):0,g=o.length>0?Math.max(...o):100,_=g-a,w=_*.1,j=Math.max(0,a-w),Z=g+w;D=new F(d,{type:"line",data:{labels:((e=u.data.lineChartData)==null?void 0:e.map(f=>f.date))||[],datasets:[{label:"Green Zone Score",data:o,borderColor:"#10b981",backgroundColor:"rgba(16, 185, 129, 0.1)",tension:.3}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!(a>10),min:Math.min(Math.floor(j-75),0),max:Math.max(Math.ceil(Z+75),1050),ticks:{stepSize:Math.ceil(_/5)}}},plugins:{tooltip:{callbacks:{label:function(f){const X=f.raw||0,q=u.data.greenZoneScore||0,Q=u.data.dateRangeLabel||"selected period",Y=Number(q).toFixed(2);return[`Green Zone Score: ${X}`,`Average Score Over ${Q}: ${Y}`]}}}}}})}}if(M.value){const d=M.value.getContext("2d");d&&(T=new F(d,{type:"doughnut",data:{labels:J,datasets:[{data:W,backgroundColor:["#061455","#1911B2","#678AC6","#EA0E45","#FF9898"],borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,cutout:"60%",plugins:{legend:{position:"bottom",labels:{padding:20,usePointStyle:!0,pointStyle:"circle",boxWidth:10}},tooltip:{callbacks:{label:function(o){const a=o.label||"",g=o.raw||0,_=o.dataset.data.reduce((j,Z)=>j+Z,0),w=Math.round(g/_*100);return`${a}: ${g} (${w}%)`}}}}}}))}};O(c,s=>{s&&setTimeout(()=>{x()},100)});let V=null;const K=()=>{V&&clearTimeout(V),V=setTimeout(()=>{x()},100)};return O(()=>u.data,()=>{c.value&&K()},{deep:!0}),ot(()=>{c.value&&setTimeout(()=>{x()},100)}),(s,e)=>(r(),st(k(tt),{class:"bg-background dark:bg-background border border-muted/30"},{default:C(()=>[v(k(et),{class:"p-4"},{default:C(()=>{var d;return[t("div",at,[t("div",rt,[e[1]||(e[1]=t("h3",{class:"text-lg font-semibold text-foreground mb-2"},"Green Zone Score",-1)),t("div",nt,i(Math.round(l.data.greenZoneScore)),1),t("div",dt,[t("div",it,[e[0]||(e[0]=t("span",{class:"text-sm text-muted-foreground"},"Driver Star",-1)),t("span",lt,i(((d=l.data.infractions)==null?void 0:d.driverStar)||0),1)])])]),t("div",ct,[e[2]||(e[2]=t("h3",{class:"text-lg font-semibold text-foreground mb-2"},"Top 5 Drivers",-1)),t("div",ut,[l.data.topDrivers&&l.data.topDrivers.length>0?(r(),n("div",mt,[(r(!0),n(b,null,p(l.data.topDrivers,(o,a)=>(r(),n("div",{key:a,class:"flex justify-between items-center"},[t("span",ht,i(o.name),1),t("span",gt,i(Math.round(o.score)),1)]))),128))])):(r(),n("div",ft," No driver data available "))])]),t("div",vt,[e[3]||(e[3]=t("h3",{class:"text-lg font-semibold text-foreground mb-2"},"Bottom 5 Drivers",-1)),t("div",bt,[l.data.bottomDrivers&&l.data.bottomDrivers.length>0?(r(),n("div",pt,[(r(!0),n(b,null,p(l.data.bottomDrivers,(o,a)=>(r(),n("div",{key:a,class:"flex justify-between items-center"},[t("span",xt,i(o.name),1),t("span",_t,i(Math.round(o.score)),1)]))),128))])):(r(),n("div",wt," No driver data available "))])])]),t("div",yt,[e[4]||(e[4]=t("h3",{class:"text-lg font-semibold text-foreground mb-4"},"Total Severe Alerts",-1)),t("div",Ct,[(r(!0),n(b,null,p(l.data.alerts,(o,a)=>(r(),n("div",{key:a,class:"bg-gradient-to-br from-muted/10 to-muted/30 rounded-lg p-4 text-center shadow-md border border-muted/20 hover:shadow-lg transition-shadow"},[t("div",kt,i(L(a)),1),t("div",St,i(Math.floor(o)),1)]))),128))])]),t("div",Mt,[e[5]||(e[5]=t("h3",{class:"text-lg font-semibold text-foreground mb-4"},"Other Severe Safety Infractions",-1)),t("div",Dt,[(r(!0),n(b,null,p(z.value,(o,a)=>(r(),n("div",{key:a,class:"bg-gradient-to-br from-muted/10 to-muted/30 rounded-lg p-4 text-center shadow-md border border-muted/20 hover:shadow-lg transition-shadow"},[t("div",Tt,i(I(a)),1),t("div",$t,i(Math.round(o)),1)]))),128))]),R.value?(r(),n("div",At,[v(k(B),{onClick:H,variant:"outline",class:"w-full md:w-auto shadow-sm hover:shadow transition-shadow"},{default:C(()=>[v(N,{name:h.value?"chevron-up":"chevron-down",class:"mr-2 h-4 w-4"},null,8,["name"]),E(" "+i(h.value?"Show Less":`Show ${U.value} More`),1)]),_:1})])):G("",!0),h.value?(r(),n("div",Vt,[t("div",jt,[(r(!0),n(b,null,p(A.value,(o,a)=>(r(),n("div",{key:a,class:"bg-gradient-to-br from-muted/10 to-muted/30 rounded-lg p-4 text-center shadow-md border border-muted/20 hover:shadow-lg transition-shadow"},[t("div",Zt,i(I(a)),1),t("div",Gt,i(Math.round(o)),1)]))),128))])])):G("",!0)]),t("div",It,[v(k(B),{onClick:P,variant:"outline",class:"w-full md:w-auto shadow-sm hover:shadow transition-shadow"},{default:C(()=>[v(N,{name:c.value?"eye-off":"eye",class:"mr-2 h-4 w-4"},null,8,["name"]),E(" "+i(c.value?"Hide Graphs":"Show Graphs"),1)]),_:1})]),c.value?(r(),n("div",Bt,[t("div",Nt,[t("div",Ot,[e[6]||(e[6]=t("h3",{class:"text-lg font-semibold text-foreground mb-4"},"Safety Trends",-1)),t("div",Et,[t("canvas",{ref_key:"lineChartCanvas",ref:S,width:"400",height:"200"},null,512)])]),t("div",Ft,[e[7]||(e[7]=t("h3",{class:"text-lg font-semibold text-foreground mb-4"},"Alert Distribution",-1)),t("div",Lt,[t("div",zt,[t("canvas",{ref_key:"doughnutChartCanvas",ref:M,width:"200",height:"200"},null,512)])])])])])):G("",!0)]}),_:1})]),_:1}))}};export{qt as default};
