import{g as q,W as H}from"./vendor-vue-CQn6KzTb.js";import{_ as K}from"./AppLayout.vue_vue_type_script_setup_true_lang-DZFOoCwO.js";import{_ as L}from"./Icon.vue_vue_type_script_setup_true_lang-D_7hXODg.js";import{_ as R}from"./Badge.vue_vue_type_script_setup_true_lang-BgyirVRP.js";import{e as A,a as N,H as x,i as f,X as e,P as s,ak as j,r as F,A as I,G as W,J as P,K as M,B as v,j as _,O as S,u as h,f as O}from"./vendor-DQlNQ5gH.js";import"./vendor-axios-xsH4HHeE.js";import"./utils-D2wO_Ovf.js";import"./vendor-ui-CGEGZLyF.js";import"./app-DgIy8214.js";import"./vendor-icons-pKobgiP0.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BpTGIYrD.js";import"./Button.vue_vue_type_script_setup_true_lang-B-8911bK.js";const U={class:"mb-6"},z=A({__name:"DashboardHeader",props:{operationalExcellenceScore:{type:String,default:"Not Available"}},setup(n){const i=n,c=N(()=>{switch(i.operationalExcellenceScore){case"Fantastic +":return"text-green-600";case"Fantastic":return"text-emerald-600";case"Good":return"text-blue-600";case"Fair":return"text-amber-600";case"Poor":return"text-red-600";default:return"text-gray-600"}});return(y,u)=>(f(),x("div",U,[e("h2",{class:j(["text-4xl font-bold tracking-tight",[c.value,"transition-colors duration-300"]])},s(n.operationalExcellenceScore),3)]))}}),J={class:"mb-6"},Q={class:"border-b"},X={class:"flex -mb-px space-x-8"},Y=["onClick"],Z={key:0,class:"mt-2 text-sm text-muted-foreground"},ee={key:0,class:"ml-1"},te=A({__name:"TimePeriodTabs",props:{dateRangeText:{type:String,default:""},weekNumber:{type:Number,default:null},startWeekNumber:{type:Number,default:null},endWeekNumber:{type:Number,default:null},year:{type:Number,default:null},activeTabId:{type:String,default:"yesterday"}},emits:["tab-change"],setup(n,{emit:i}){const c=n,y=[{id:"yesterday",label:"Yesterday"},{id:"current-week",label:"WTD"},{id:"t6w",label:"T6W Scores"},{id:"quarterly",label:"Quarterly Scores"}],u=F(c.activeTabId),o=i,l=N(()=>(u.value==="yesterday"||u.value==="current-week")&&c.weekNumber&&c.year?`Week ${c.weekNumber}, ${c.year}`:(u.value==="t6w"||u.value==="quarterly")&&c.startWeekNumber&&c.endWeekNumber&&c.year?`Weeks ${c.startWeekNumber}-${c.endWeekNumber}, ${c.year}`:""),T=p=>{u.value=p,o("tab-change",p)};return I(()=>{o("tab-change",u.value)}),(p,$)=>(f(),x("div",J,[e("div",Q,[e("div",X,[(f(),x(P,null,M(y,D=>e("button",{key:D.id,onClick:g=>T(D.id),class:j(["py-2 px-1 border-b-2 text-sm font-medium transition-colors",u.value===D.id?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground hover:border-muted-foreground"])},s(D.label),11,Y)),64))])]),n.dateRangeText?(f(),x("div",Z,[e("span",null,s(n.dateRangeText),1),l.value?(f(),x("span",ee,"("+s(l.value)+")",1)):W("",!0)])):W("",!0)]))}}),ae={class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6 mb-6"},ne={class:"bg-card rounded-lg border shadow-sm p-4"},se={class:"flex items-center justify-between gap-3 mb-4"},re={class:"space-y-2 text-sm max-h-40 overflow-y-auto"},oe={class:"bg-card rounded-lg border shadow-sm p-4"},ie={class:"flex items-center justify-between gap-3 mb-4"},le={class:"space-y-2 text-sm max-h-40 overflow-y-auto"},ce={class:"bg-card rounded-lg border shadow-sm p-4"},de={class:"flex items-center justify-between gap-3 mb-4"},ue={class:"text-sm mb-2 space-y-2"},me={class:"flex justify-between"},fe={class:"flex justify-between"},ge={class:"flex justify-between"},be={class:"flex justify-between"},ve={class:"bg-card rounded-lg border shadow-sm p-4"},xe={class:"flex items-center justify-between gap-3 mb-4"},ye={class:"text-4xl font-bold text-indigo-600"},pe={class:"space-y-2 text-sm"},we={class:"flex justify-between items-center"},_e={class:"flex items-center gap-2"},he={class:"w-12 text-right"},De={class:"w-16 text-right"},ke={class:"flex justify-between items-center"},Re={class:"flex items-center gap-2"},Se={class:"w-12 text-right"},Ne={class:"w-16 text-right"},je={class:"flex justify-between items-center"},$e={class:"flex items-center gap-2"},Te={class:"w-12 text-right"},Be={class:"w-16 text-right"},Ce={class:"flex justify-between items-center"},Fe={class:"flex items-center gap-2"},Ae={class:"w-12 text-right"},We={class:"w-16 text-right"},Oe={class:"flex justify-between items-center"},Pe={class:"flex items-center gap-2"},Me={class:"w-12 text-right"},Ve={class:"w-16 text-right"},Ee={class:"text-sm text-muted-foreground mt-3"},Ge=A({__name:"PerformanceCards",props:{performanceData:{type:Object,default:()=>({})},performanceRatings:{type:Object,default:()=>({})},safetyData:{type:Object,default:()=>({})},delayBreakdowns:{type:Array,default:()=>[]},rejectionBreakdowns:{type:Array,default:()=>[]},maintenanceBreakdowns:{type:Object,default:()=>({})}},setup(n){const i=n,c=N(()=>[...i.delayBreakdowns].sort((t,a)=>a.total_delays-t.total_delays).slice(0,3)),y=N(()=>[...i.rejectionBreakdowns].sort((t,a)=>a.total_rejections-t.total_rejections).slice(0,3)),u=t=>t==null?"0%":`${Math.round(parseFloat(t))}%`,o=t=>(typeof t=="string"&&(t=parseFloat(t)),t==null||isNaN(t)?"0":Math.round(t).toString()),l=t=>(typeof t=="string"&&(t=parseFloat(t)),t==null||isNaN(t)?"0.00":t.toFixed(2)),T=t=>(typeof t=="string"&&(t=parseFloat(t)),t==null||isNaN(t)?"0.00":t.toFixed(2)),p=t=>{if(!t)return"Not Available";switch(t){case"gold":return"Gold Tier";case"silver":return"Silver Tier";case"not_eligible":return"Not Eligible";case"fantastic_plus":return"Fantastic +";case"fantastic":return"Fantastic";case"good":return"Good";case"fair":return"Fair";case"poor":return"Poor";default:return t}},$=t=>{if(!t)return"outline";switch(t){case"gold":return"gold";case"silver":return"silver";case"not_eligible":return"not-eligible";case"fantastic_plus":return"fantastic-plus";case"fantastic":return"fantastic";case"good":return"good";case"fair":return"fair";case"poor":return"poor";default:return"outline"}},D=t=>t?t==="Gold Tier"?"gold":t==="Silver Tier"?"silver":t==="Not Eligible"?"not-eligible":"outline":"outline",g=N(()=>{var r;if(!((r=i.safetyData)!=null&&r.ratings))return null;const t=i.safetyData.ratings,a={gold:3,silver:2,not_eligible:1},b=["traffic_light_violation","speeding_violations","following_distance","driver_distraction","sign_violations"];let m="gold";for(const d of b)t[d]&&a[t[d]]<a[m]&&(m=t[d]);switch(m){case"gold":return"Gold Tier";case"silver":return"Silver Tier";case"not_eligible":return"Not Eligible";default:return"Not Available"}}),C=t=>{if(!t)return"text-gray-600";switch(t){case"gold":return"text-amber-600";case"silver":return"text-slate-600";case"not_eligible":return"text-red-600";case"fantastic_plus":return"text-green-600";case"fantastic":return"text-emerald-600";case"good":return"text-blue-600";case"fair":return"text-amber-600";case"poor":return"text-red-600";default:return"text-indigo-600"}};return(t,a)=>{var b,m,r,d,w;return f(),x("div",ae,[e("div",ne,[a[0]||(a[0]=e("h3",{class:"text-base font-semibold mb-1"},"Acceptance",-1)),a[1]||(a[1]=e("div",{class:"text-xs text-muted-foreground mb-1"},"Total Score",-1)),e("div",se,[e("div",{class:j(["text-4xl font-bold",C(n.performanceRatings.average_acceptance)])},s(u(n.performanceData.average_acceptance)),3),v(h(R),{variant:$(n.performanceRatings.average_acceptance),class:"text-xs"},{default:_(()=>[S(s(p(n.performanceRatings.average_acceptance)),1)]),_:1},8,["variant"])]),a[2]||(a[2]=e("div",{class:"text-sm mb-2 flex justify-between"},[e("span",{class:"font-semibold"},"Rejections by Reason"),e("span",{class:"font-semibold"},"Total")],-1)),e("div",re,[(f(!0),x(P,null,M(y.value,(k,B)=>(f(),x("div",{key:B,class:"flex justify-between"},[e("span",null,s(k.reason_code),1),e("span",null,s(k.total_rejections),1)]))),128))])]),e("div",oe,[a[3]||(a[3]=e("h3",{class:"text-base font-semibold mb-1"},"On-Time",-1)),a[4]||(a[4]=e("div",{class:"text-xs text-muted-foreground mb-1"},"Total Score",-1)),e("div",ie,[e("div",{class:j(["text-4xl font-bold",C(n.performanceRatings.average_on_time)])},s(u(n.performanceData.average_on_time)),3),v(h(R),{variant:$(n.performanceRatings.average_on_time),class:"text-xs"},{default:_(()=>[S(s(p(n.performanceRatings.average_on_time)),1)]),_:1},8,["variant"])]),a[5]||(a[5]=e("div",{class:"text-sm mb-2 flex justify-between"},[e("span",{class:"font-semibold"},"Delays by Reason"),e("span",{class:"font-semibold"},"Total")],-1)),e("div",le,[(f(!0),x(P,null,M(c.value,(k,B)=>(f(),x("div",{key:B,class:"flex justify-between"},[e("span",null,s(k.code),1),e("span",null,s(k.total_delays),1)]))),128))])]),e("div",ce,[a[10]||(a[10]=e("h3",{class:"text-base font-semibold mb-1"},"Maintenance",-1)),a[11]||(a[11]=e("div",{class:"text-xs text-muted-foreground mb-1"},"MVtS Score",-1)),e("div",de,[e("div",{class:j(["text-4xl font-bold",C(n.performanceRatings.average_maintenance_variance_to_spend)])},s(u(n.performanceData.average_maintenance_variance_to_spend)),3),v(h(R),{variant:$(n.performanceRatings.average_maintenance_variance_to_spend),class:"text-xs"},{default:_(()=>[S(s(p(n.performanceRatings.average_maintenance_variance_to_spend)),1)]),_:1},8,["variant"])]),e("div",ue,[e("div",me,[a[6]||(a[6]=e("span",null,"Cost per mile",-1)),e("span",null,"$"+s(T(n.maintenanceBreakdowns.cpm)),1)]),e("div",fe,[a[7]||(a[7]=e("span",null,"Num of WOs",-1)),e("span",null,s(n.maintenanceBreakdowns.total_repair_orders),1)]),e("div",ge,[a[8]||(a[8]=e("span",null,"Current Costs",-1)),e("span",null,"$"+s(T(n.maintenanceBreakdowns.total_invoice_amount)),1)]),e("div",be,[a[9]||(a[9]=e("span",null,"Missing Invoices",-1)),e("span",null,s(n.maintenanceBreakdowns.missing_invoices_count||0),1)])])]),e("div",ve,[a[17]||(a[17]=e("h3",{class:"text-base font-semibold mb-1"},"Netradyne Alerts Bonus Criteria",-1)),a[18]||(a[18]=e("div",{class:"text-xs text-muted-foreground mb-1"},"Green Zone Score",-1)),e("div",xe,[e("div",ye,s(o(n.safetyData.average_driver_score||"N/A")),1),v(h(R),{variant:D(g.value),class:"text-xs"},{default:_(()=>[S(s(p(g.value)),1)]),_:1},8,["variant"])]),a[19]||(a[19]=e("div",{class:"flex justify-between items-center text-sm font-semibold mb-2"},[e("span",null,"Alert Type"),e("div",{class:"flex items-center gap-2"},[e("span",{class:"w-12 text-right"},"Total"),e("span",{class:"w-16 text-right"},"P1KH")])],-1)),e("div",pe,[e("div",we,[a[12]||(a[12]=e("span",null,"Distracted Driving",-1)),e("div",_e,[e("span",he,s(o(n.safetyData.driver_distraction)),1),e("span",De,s(l((b=n.safetyData.rates)==null?void 0:b.driver_distraction)),1)])]),e("div",ke,[a[13]||(a[13]=e("span",null,"Speeding",-1)),e("div",Re,[e("span",Se,s(o(n.safetyData.speeding_violations)),1),e("span",Ne,s(l((m=n.safetyData.rates)==null?void 0:m.speeding_violations)),1)])]),e("div",je,[a[14]||(a[14]=e("span",null,"Sign Violation",-1)),e("div",$e,[e("span",Te,s(o(n.safetyData.sign_violations)),1),e("span",Be,s(l((r=n.safetyData.rates)==null?void 0:r.sign_violations)),1)])]),e("div",Ce,[a[15]||(a[15]=e("span",null,"Traffic Light Violation",-1)),e("div",Fe,[e("span",Ae,s(o(n.safetyData.traffic_light_violation)),1),e("span",We,s(l((d=n.safetyData.rates)==null?void 0:d.traffic_light_violation)),1)])]),e("div",Oe,[a[16]||(a[16]=e("span",null,"Following Distance",-1)),e("div",Pe,[e("span",Me,s(o(n.safetyData.following_distance)),1),e("span",Ve,s(l((w=n.safetyData.rates)==null?void 0:w.following_distance)),1)])])]),e("div",Ee,[e("div",null,"Total Hours Analyzed: "+s(o(n.safetyData.total_hours||0)),1)])])])}}}),Ie={class:"bg-card rounded-lg border shadow-sm p-6 mb-6"},qe={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},He={class:"p-4 border rounded-lg"},Ke={class:"flex items-center justify-between gap-3 mb-3"},Le={class:"p-4 border rounded-lg"},Ue={class:"flex items-center justify-between gap-3 mb-3"},ze={class:"p-4 border rounded-lg"},Je={class:"flex items-center justify-between gap-3 mb-3"},Qe=A({__name:"AdditionalMetricsCard",props:{performanceData:{type:Object,default:()=>({})},performanceRatings:{type:Object,default:()=>({})}},setup(n){const i=o=>o==null?"0":Math.round(parseFloat(o)).toString(),c=o=>{if(!o)return"Not Available";switch(o){case"fantastic_plus":return"Fantastic +";case"fantastic":return"Fantastic";case"good":return"Good";case"fair":return"Fair";case"poor":return"Poor";default:return o.charAt(0).toUpperCase()+o.slice(1).replace(/_/g," ")}},y=o=>{if(!o)return"outline";switch(o){case"fantastic_plus":return"fantastic-plus";case"fantastic":return"fantastic";case"good":return"good";case"fair":return"fair";case"poor":return"poor";default:return"outline"}},u=o=>{if(!o)return"text-gray-600";switch(o){case"fantastic_plus":return"text-green-600";case"fantastic":return"text-emerald-600";case"good":return"text-blue-600";case"fair":return"text-amber-600";case"poor":return"text-red-600";default:return"text-indigo-600"}};return(o,l)=>(f(),x("div",Ie,[l[6]||(l[6]=e("h3",{class:"text-xl font-semibold mb-4"},"Additional Performance Metrics",-1)),e("div",qe,[e("div",He,[l[0]||(l[0]=e("h4",{class:"text-lg font-medium mb-2"},"VCR-P",-1)),l[1]||(l[1]=e("div",{class:"text-sm text-muted-foreground mb-1"},"Count",-1)),e("div",Ke,[e("div",{class:j(["text-3xl font-bold",u(n.performanceRatings.vcr_preventable)])},s(i(n.performanceData.vcr_preventable)),3),v(h(R),{variant:y(n.performanceRatings.vcr_preventable),class:"text-xs"},{default:_(()=>[S(s(c(n.performanceRatings.vcr_preventable)),1)]),_:1},8,["variant"])])]),e("div",Le,[l[2]||(l[2]=e("h4",{class:"text-lg font-medium mb-2"},"VMCR-P",-1)),l[3]||(l[3]=e("div",{class:"text-sm text-muted-foreground mb-1"},"Count",-1)),e("div",Ue,[e("div",{class:j(["text-3xl font-bold",u(n.performanceRatings.vmcr_p)])},s(i(n.performanceData.vmcr_p)),3),v(h(R),{variant:y(n.performanceRatings.vmcr_p),class:"text-xs"},{default:_(()=>[S(s(c(n.performanceRatings.vmcr_p)),1)]),_:1},8,["variant"])])]),e("div",ze,[l[4]||(l[4]=e("h4",{class:"text-lg font-medium mb-2"},"Open BOC",-1)),l[5]||(l[5]=e("div",{class:"text-sm text-muted-foreground mb-1"},"Count",-1)),e("div",Je,[e("div",{class:j(["text-3xl font-bold",u(n.performanceRatings.open_boc)])},s(i(n.performanceData.open_boc)),3),v(h(R),{variant:y(n.performanceRatings.open_boc),class:"text-xs"},{default:_(()=>[S(s(c(n.performanceRatings.open_boc)),1)]),_:1},8,["variant"])])])])]))}}),Xe={class:"container w-full m-0 p-2 md:p-4 lg:p-6 space-y-2 md:space-y-4 lg:space-y-6"},Ye={class:"flex items-center justify-between mb-6"},ut=A({__name:"Summary",props:{tenantSlug:String,summaries:Object,delayBreakdowns:Object,rejectionBreakdowns:Object,maintenanceBreakdowns:Object,dateFilter:String,dateRange:Object},setup(n){const i=n;F("on-time");const c=F(i.dateFilter||"t6w"),y=F(null),u=F(null);I(()=>{});const o=N(()=>{const a={yesterday:"yesterday","current-week":"current_week",t6w:"rolling_6_weeks",quarterly:"quarterly"}[c.value]||c.value;return D(a)}),l=t=>{c.value=t,H.visit(route("dashboard",{tenantSlug:i.tenantSlug,dateFilter:t,minInvoiceAmount:y.value||null,outstandingDate:u.value||null}),{preserveState:!0,preserveScroll:!0,only:["summaries","delayBreakdowns","rejectionBreakdowns","maintenanceBreakdowns","dateFilter","dateRange"]})},T=[{title:i.tenantSlug?"Dashboard":"Admin Dashboard",href:i.tenantSlug?route("dashboard",{tenantSlug:i.tenantSlug}):route("admin.dashboard")},{title:"Performance Summary",href:route("dashboard",{tenantSlug:i.tenantSlug})}],p=N(()=>{var t,a;return(a=(t=i.summaries)==null?void 0:t.performance)!=null&&a.last_updated?$(new Date(i.summaries.performance.last_updated)):$(new Date)}),$=t=>new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(t),D=t=>{var b,m;if((m=(b=i.summaries)==null?void 0:b[t])!=null&&m.date_range){const r=new Date(i.summaries[t].date_range.start+"T12:00:00"),d=new Date(i.summaries[t].date_range.end+"T12:00:00");return`${g(r)} - ${g(d)}`}const a=new Date;switch(t){case"yesterday":{const r=new Date(a);return r.setDate(r.getDate()-1),g(r)}case"current_week":{const r=new Date(a);r.setDate(a.getDate()-a.getDay());const d=new Date(r);return d.setDate(r.getDate()+6),`${g(r)} - ${g(d)}`}case"rolling_6_weeks":{const r=new Date(a);r.setDate(a.getDate()-a.getDay()+6);const d=new Date(r);return d.setDate(r.getDate()-6*7+1),`${g(d)} - ${g(r)}`}case"quarterly":{const r=new Date(a),d=new Date(a);return d.setMonth(d.getMonth()-3),`${g(d)} - ${g(r)}`}default:return""}},g=t=>new Intl.DateTimeFormat("en-US",{month:"numeric",day:"numeric",year:"numeric"}).format(t),C=N(()=>{var r,d;if(!((d=(r=i.summaries)==null?void 0:r.performance)!=null&&d.ratings))return"Not Available";const t=i.summaries.performance.ratings,a={fantastic_plus:5,fantastic:4,good:3,fair:2,poor:1},b=["average_acceptance","average_on_time","average_maintenance_variance_to_spend","open_boc","vcr_preventable","vmcr_p"];let m="fantastic_plus";for(const w of b)t[w]&&a[t[w]]<a[m]&&(m=t[w]);switch(m){case"fantastic_plus":return"Fantastic +";case"fantastic":return"Fantastic";case"good":return"Good";case"fair":return"Fair";case"poor":return"Poor";default:return"Not Available"}});return(t,a)=>(f(),O(K,{breadcrumbs:T,tenantSlug:n.tenantSlug},{default:_(()=>{var b,m,r,d,w,k,B,V,E,G;return[v(h(q),{title:"Performance Summary Dashboard"}),e("div",Xe,[e("div",Ye,[a[0]||(a[0]=e("h1",{class:"text-2xl font-bold"},null,-1)),v(h(R),{variant:"outline",class:"text-sm"},{default:_(()=>[v(L,{name:"calendar",class:"mr-1 h-4 w-4"}),S(" Last updated: "+s(p.value),1)]),_:1})]),v(z,{operationalExcellenceScore:C.value},null,8,["operationalExcellenceScore"]),v(te,{onTabChange:l,dateRangeText:o.value,weekNumber:(b=n.dateRange)==null?void 0:b.weekNumber,startWeekNumber:(m=n.dateRange)==null?void 0:m.startWeekNumber,endWeekNumber:(r=n.dateRange)==null?void 0:r.endWeekNumber,year:(d=n.dateRange)==null?void 0:d.year,activeTabId:c.value},null,8,["dateRangeText","weekNumber","startWeekNumber","endWeekNumber","year","activeTabId"]),n.summaries?(f(),O(Ge,{key:0,performanceData:((w=n.summaries.performance)==null?void 0:w.data)||{},performanceRatings:((k=n.summaries.performance)==null?void 0:k.ratings)||{},safetyData:n.summaries.safety||{},delayBreakdowns:((B=n.delayBreakdowns)==null?void 0:B.by_code)||[],rejectionBreakdowns:((V=n.rejectionBreakdowns)==null?void 0:V.by_reason)||[],maintenanceBreakdowns:n.maintenanceBreakdowns||{}},null,8,["performanceData","performanceRatings","safetyData","delayBreakdowns","rejectionBreakdowns","maintenanceBreakdowns"])):W("",!0),n.summaries?(f(),O(Qe,{key:1,performanceData:((E=n.summaries.performance)==null?void 0:E.data)||{},performanceRatings:((G=n.summaries.performance)==null?void 0:G.ratings)||{}},null,8,["performanceData","performanceRatings"])):W("",!0)])]}),_:1},8,["tenantSlug"]))}});export{ut as default};
