import{k as g,C as I,c as ge,f as ye,l as C,o as m,w as l,e as a,b as r,u as t,m as be,g as w,i,t as u,j as Q,a as p,n as V,F as T,r as B,h as W,v as J,p as xe,W as Y}from"./app-B91Zl0Oo.js";import{_ as ke}from"./AppLayout.vue_vue_type_script_setup_true_lang-B7AKyEh7.js";import{_ as E}from"./Icon.vue_vue_type_script_setup_true_lang-D1rnNBp_.js";import{_ as Ce,a as we,b as h,c as H,d as Se,e as v}from"./TableRow.vue_vue_type_script_setup_true_lang-CPbVIJtt.js";import{_}from"./Button.vue_vue_type_script_setup_true_lang-PJXKnqlO.js";import{_ as K}from"./Card.vue_vue_type_script_setup_true_lang-BJWyaRE5.js";import{_ as X}from"./CardContent.vue_vue_type_script_setup_true_lang-NmazK22E.js";import{_ as Z,a as ee,b as te,c as ne,d as ae,e as le}from"./DialogTitle.vue_vue_type_script_setup_true_lang-DFI7N8AN.js";import{_ as y,a as S}from"./Label.vue_vue_type_script_setup_true_lang-ChWoabUD.js";import{_ as $e,a as Ve,b as Pe}from"./AlertDescription.vue_vue_type_script_setup_true_lang-CUV_fE8p.js";import"./index-BwX3HRAb.js";import"./createLucideIcon-CMlEOo_P.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-d3MMgUIc.js";import"./shield-Bc7egZTN.js";import"./check-Cp0bzDxk.js";import"./loader-circle-DQaJYqkb.js";import"./sun-Dzok2l92.js";const Ae={class:"max-w-7xl mx-auto p-6 space-y-8"},Me={class:"flex flex-col sm:flex-row justify-between items-center mb-6 gap-4"},Fe={class:"flex flex-wrap gap-3"},De={class:"cursor-pointer"},Ne={class:"flex flex-col gap-2"},Ue={class:"flex flex-wrap gap-2"},Te={key:0,class:"text-sm text-muted-foreground"},Be={key:0},Ee={key:1},qe={class:"overflow-x-auto"},ze={class:"flex items-center"},Re={key:0,class:"ml-2"},je={key:0,class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Le={key:1,class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Oe={key:1,class:"ml-2 opacity-50"},Ie={class:"text-xs italic text-gray-500"},We={class:"text-xs italic text-gray-500"},Ye={class:"text-xs italic text-gray-500"},he={class:"text-xs italic text-gray-500"},He={class:"text-xs italic text-gray-500"},Ge={class:"text-xs italic text-gray-500"},Qe={class:"text-xs italic text-gray-500"},Je={class:"flex space-x-2"},Ke={key:0,class:"bg-muted/20 px-4 py-3 border-t"},Xe={class:"flex justify-between items-center"},Ze={class:"text-sm text-muted-foreground flex items-center gap-4"},et={class:"flex items-center gap-2"},tt=["value"],nt={class:"flex"},at=["innerHTML"],lt={key:0},rt={class:"relative"},ot=["value"],st={class:"flex items-center gap-2"},$t={__name:"Index",props:{performances:{type:Object,default:()=>({data:[],links:[]})},tenantSlug:{type:String,default:null},SuperAdmin:{type:Boolean,default:!1},tenants:{type:Array,default:()=>[]},dateFilter:{type:String,default:"full"},dateRange:{type:Object,default:()=>({label:"All Time"})},perPage:{type:Number,default:10}},setup(c){const d=c,P=g(d.perPage||10);function re(){const o=d.tenantSlug?route("performance.index",{tenantSlug:d.tenantSlug}):route("performance.index.admin");Y.get(o,{dateFilter:b.value,perPage:P.value},{preserveState:!0})}function oe(o){if(o){const e=new URL(o);e.searchParams.set("perPage",P.value),e.searchParams.set("dateFilter",b.value),Y.get(e.href,{},{only:["performances"]})}}const x=g(""),A=g(!1),M=g(!1),q=g("Create Performance"),F=g("Create"),z=g(null),D=g(null),b=g(d.dateFilter||"full"),N=g("date"),$=g("desc");g({search:"",dateFrom:"",dateTo:""});const se=[{title:d.tenantSlug?"Dashboard":"Admin Dashboard",href:d.tenantSlug?route("dashboard",{tenantSlug:d.tenantSlug}):route("admin.dashboard")},{title:"Performance",href:d.tenantSlug?route("performance.index",{tenantSlug:d.tenantSlug}):route("performance.index.admin")}],R=["date","acceptance","on_time_to_origin","on_time_to_destination","on_time","maintenance_variance_to_spend","open_boc","meets_safety_bonus_criteria","vcr_preventable","vmcr_p"],s=I({tenant_id:null,date:"",acceptance:"",on_time_to_origin:"",on_time_to_destination:"",maintenance_variance_to_spend:"",open_boc:"",meets_safety_bonus_criteria:!1,vcr_preventable:"",vmcr_p:"",id:null}),ie=I({}),j=I({csv_file:null}),L=ge(()=>{let o=[...d.performances.data];return o.sort((e,n)=>{let f=e[N.value],k=n[N.value];return f===null?1:k===null?-1:(typeof f=="string"&&(f=f.toLowerCase(),k=k.toLowerCase()),f<k?$.value==="asc"?-1:1:f>k?$.value==="asc"?1:-1:0)}),o});function ue(o){N.value===o?$.value=$.value==="asc"?"desc":"asc":(N.value=o,$.value="asc")}function U(o){b.value=o;const e=d.tenantSlug?route("performance.index",{tenantSlug:d.tenantSlug}):route("performance.index.admin");Y.get(e,{dateFilter:o,perPage:P.value},{preserveState:!0})}function de(){const o=F.value==="Create",e=o?d.SuperAdmin?route("performance.store.admin"):route("performance.store",d.tenantSlug):d.SuperAdmin?route("performance.update.admin",[s.id]):route("performance.update",[d.tenantSlug,s.id]);s[o?"post":"put"](e,{onSuccess:()=>{x.value=o?"Performance created successfully.":"Performance updated successfully.",G()},onError:()=>{alert("Something went wrong.")}})}function me(o){var f;const e=(f=o.target.files)==null?void 0:f[0];if(!e)return;j.csv_file=e;const n=d.SuperAdmin?route("performance.import.admin"):route("performance.import",d.tenantSlug);j.post(n,{forceFormData:!0,preserveScroll:!0,onSuccess:()=>{j.reset(),x.value="CSV Imported successfully."},onError:()=>{alert("Import failed.")}})}function fe(){var e,n;const o=d.SuperAdmin?route("performance.export.admin"):route("performance.export",d.tenantSlug);(e=z.value)==null||e.setAttribute("action",o),(n=z.value)==null||n.submit()}ye(x,o=>{o&&setTimeout(()=>{x.value=""},5e3)});function O(o){if(!o)return"";const e=new Date(o+"T12:00:00"),n=e.getMonth()+1,f=e.getDate(),k=e.getFullYear();return`${n}-${f}-${k}`}function ce(){q.value="Create Performance",F.value="Create",s.reset(),s.clearErrors(),d.SuperAdmin&&d.tenants.length>0&&(s.tenant_id=""),A.value=!0}function pe(o){q.value="Edit Performance",F.value="Update",s.reset(),s.clearErrors(),s.id=o.id,s.tenant_id=o.tenant_id,s.date=o.date,s.acceptance=o.acceptance,s.on_time_to_origin=o.on_time_to_origin,s.on_time_to_destination=o.on_time_to_destination,s.maintenance_variance_to_spend=o.maintenance_variance_to_spend,s.open_boc=o.open_boc,s.meets_safety_bonus_criteria=o.meets_safety_bonus_criteria,s.vcr_preventable=o.vcr_preventable,A.value=!0}function G(){A.value=!1,s.reset(),s.clearErrors()}function _e(o){D.value=o,M.value=!0}function ve(){if(!D.value)return;const o=d.SuperAdmin?route("performance.destroy.admin",[D.value]):route("performance.destroy",[d.tenantSlug,D.value]);ie.delete(o,{onSuccess:()=>{x.value="Performance deleted successfully.",M.value=!1,D.value=null},onError:()=>{alert("Failed to delete performance record.")}})}return(o,e)=>(m(),C(ke,{breadcrumbs:se,tenantSlug:c.tenantSlug},{default:l(()=>[a(t(be),{title:"Performance"}),r("div",Ae,[x.value?(m(),C(t($e),{key:0,variant:"success"},{default:l(()=>[a(t(Ve),null,{default:l(()=>e[18]||(e[18]=[i("Success")])),_:1}),a(t(Pe),null,{default:l(()=>[i(u(x.value),1)]),_:1})]),_:1})):w("",!0),r("div",Me,[e[22]||(e[22]=r("h1",{class:"text-2xl font-bold text-gray-800 dark:text-gray-200"},"Performance Management",-1)),r("div",Fe,[a(t(_),{onClick:ce,variant:"default"},{default:l(()=>[a(E,{name:"plus",class:"mr-2 h-4 w-4"}),e[19]||(e[19]=i(" Create New Performance "))]),_:1}),r("label",De,[a(t(_),{variant:"secondary",as:"span"},{default:l(()=>[a(E,{name:"upload",class:"mr-2 h-4 w-4"}),e[20]||(e[20]=i(" Import CSV "))]),_:1}),r("input",{type:"file",class:"hidden",onChange:me,accept:".csv"},null,32)]),a(t(_),{onClick:Q(fe,["prevent"]),variant:"outline"},{default:l(()=>[a(E,{name:"download",class:"mr-2 h-4 w-4"}),e[21]||(e[21]=i(" Export CSV "))]),_:1})])]),a(t(K),null,{default:l(()=>[a(t(X),{class:"p-4"},{default:l(()=>[r("div",Ne,[r("div",Ue,[a(t(_),{onClick:e[0]||(e[0]=n=>U("yesterday")),variant:"outline",size:"sm",class:V({"bg-primary/10 text-primary border-primary":b.value==="yesterday"})},{default:l(()=>e[23]||(e[23]=[i(" Yesterday ")])),_:1},8,["class"]),a(t(_),{onClick:e[1]||(e[1]=n=>U("current-week")),variant:"outline",size:"sm",class:V({"bg-primary/10 text-primary border-primary":b.value==="current-week"})},{default:l(()=>e[24]||(e[24]=[i(" Current Week ")])),_:1},8,["class"]),a(t(_),{onClick:e[2]||(e[2]=n=>U("6w")),variant:"outline",size:"sm",class:V({"bg-primary/10 text-primary border-primary":b.value==="6w"})},{default:l(()=>e[25]||(e[25]=[i(" 6 Weeks ")])),_:1},8,["class"]),a(t(_),{onClick:e[3]||(e[3]=n=>U("quarterly")),variant:"outline",size:"sm",class:V({"bg-primary/10 text-primary border-primary":b.value==="quarterly"})},{default:l(()=>e[26]||(e[26]=[i(" Quarterly ")])),_:1},8,["class"]),a(t(_),{onClick:e[4]||(e[4]=n=>U("full")),variant:"outline",size:"sm",class:V({"bg-primary/10 text-primary border-primary":b.value==="full"})},{default:l(()=>e[27]||(e[27]=[i(" Full ")])),_:1},8,["class"])]),c.dateRange?(m(),p("div",Te,[c.dateRange.start&&c.dateRange.end?(m(),p("span",Be," Showing data from "+u(O(c.dateRange.start))+" to "+u(O(c.dateRange.end)),1)):(m(),p("span",Ee,u(c.dateRange.label),1))])):w("",!0)])]),_:1})]),_:1}),a(t(K),null,{default:l(()=>[a(t(X),{class:"p-0"},{default:l(()=>[r("div",qe,[a(t(Ce),{class:"relative h-[600px] overflow-auto"},{default:l(()=>[a(t(we),null,{default:l(()=>[a(t(h),{class:"sticky top-0 bg-background border-b z-10"},{default:l(()=>[c.SuperAdmin?(m(),C(t(H),{key:0},{default:l(()=>e[28]||(e[28]=[i("Company Name")])),_:1})):w("",!0),(m(),p(T,null,B(R,n=>a(t(H),{key:n,class:"cursor-pointer",onClick:f=>ue(n)},{default:l(()=>[r("div",ze,[i(u(n.replace(/_/g," ").split(" ").map(f=>f.charAt(0).toUpperCase()+f.slice(1)).join(" "))+" ",1),N.value===n?(m(),p("div",Re,[$.value==="asc"?(m(),p("svg",je,e[29]||(e[29]=[r("path",{d:"M8 15l4-4 4 4"},null,-1)]))):(m(),p("svg",Le,e[30]||(e[30]=[r("path",{d:"M16 9l-4 4-4-4"},null,-1)])))])):(m(),p("div",Oe,e[31]||(e[31]=[r("svg",{class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("path",{d:"M8 10l4-4 4 4"}),r("path",{d:"M16 14l-4 4-4-4"})],-1)])))])]),_:2},1032,["onClick"])),64)),a(t(H),null,{default:l(()=>e[32]||(e[32]=[i("Actions")])),_:1})]),_:1})]),_:1}),a(t(Se),null,{default:l(()=>[L.value.length===0?(m(),C(t(h),{key:0},{default:l(()=>[a(t(v),{colspan:c.SuperAdmin?R.length+2:R.length+1,class:"text-center py-8"},{default:l(()=>e[33]||(e[33]=[i(" No performance records found matching your criteria ")])),_:1},8,["colspan"])]),_:1})):w("",!0),(m(!0),p(T,null,B(L.value,n=>(m(),C(t(h),{key:n.id,class:"hover:bg-muted/50"},{default:l(()=>[c.SuperAdmin?(m(),C(t(v),{key:0},{default:l(()=>{var f;return[i(u(((f=n.tenant)==null?void 0:f.name)??"—"),1)]}),_:2},1024)):w("",!0),a(t(v),null,{default:l(()=>[i(u(O(n.date)),1)]),_:2},1024),a(t(v),null,{default:l(()=>[r("div",null,u(n.acceptance),1),r("div",Ie,"("+u(n.acceptance_rating)+")",1)]),_:2},1024),a(t(v),null,{default:l(()=>[i(u(n.on_time_to_origin),1)]),_:2},1024),a(t(v),null,{default:l(()=>[i(u(n.on_time_to_destination),1)]),_:2},1024),a(t(v),null,{default:l(()=>[r("div",null,u(n.on_time),1),r("div",We,"("+u(n.on_time_rating)+")",1)]),_:2},1024),a(t(v),null,{default:l(()=>[r("div",null,u(n.maintenance_variance_to_spend),1),r("div",Ye,"("+u(n.maintenance_variance_to_spend_rating)+")",1)]),_:2},1024),a(t(v),null,{default:l(()=>[r("div",null,u(n.open_boc),1),r("div",he,"("+u(n.open_boc_rating)+")",1)]),_:2},1024),a(t(v),null,{default:l(()=>[r("div",null,u(n.meets_safety_bonus_criteria?"Yes":"No"),1),r("div",He,"("+u(n.meets_safety_bonus_criteria_rating)+")",1)]),_:2},1024),a(t(v),null,{default:l(()=>[r("div",null,u(n.vcr_preventable),1),r("div",Ge,"("+u(n.vcr_preventable_rating)+")",1)]),_:2},1024),a(t(v),null,{default:l(()=>[r("div",null,u(n.vmcr_p),1),r("div",Qe,"("+u(n.vmcr_p_rating)+")",1)]),_:2},1024),a(t(v),null,{default:l(()=>[r("div",Je,[a(t(_),{onClick:f=>pe(n),variant:"warning",size:"sm"},{default:l(()=>[a(E,{name:"pencil",class:"mr-1 h-4 w-4"}),e[34]||(e[34]=i(" Edit "))]),_:2},1032,["onClick"]),a(t(_),{onClick:f=>_e(n.id),variant:"destructive",size:"sm"},{default:l(()=>[a(E,{name:"trash",class:"mr-1 h-4 w-4"}),e[35]||(e[35]=i(" Delete "))]),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),c.performances.links?(m(),p("div",Ke,[r("div",Xe,[r("div",Ze,[r("span",null,"Showing "+u(L.value.length)+" of "+u(c.performances.data.length)+" entries",1),r("div",et,[e[36]||(e[36]=r("span",{class:"text-sm"},"Show:",-1)),W(r("select",{"onUpdate:modelValue":e[5]||(e[5]=n=>P.value=n),onChange:re,class:"h-8 rounded-md border border-input bg-background px-2 py-1 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2"},[(m(),p(T,null,B([10,25,50,100],n=>r("option",{key:n,value:n},u(n),9,tt)),64))],544),[[J,P.value]])])]),r("div",nt,[(m(!0),p(T,null,B(c.performances.links,n=>(m(),C(t(_),{key:n.label,onClick:f=>oe(n.url),disabled:!n.url,variant:"ghost",size:"sm",class:V(["mx-1",{"bg-primary/10 text-primary border-primary":n.active}])},{default:l(()=>[r("span",{innerHTML:n.label},null,8,at)]),_:2},1032,["onClick","disabled","class"]))),128))])])])):w("",!0)]),_:1})]),_:1}),a(t(Z),{open:A.value,"onUpdate:open":e[15]||(e[15]=n=>A.value=n)},{default:l(()=>[a(t(ee),{class:"sm:max-w-lg"},{default:l(()=>[a(t(te),null,{default:l(()=>[a(t(ne),null,{default:l(()=>[i(u(q.value),1)]),_:1}),a(t(ae),null,{default:l(()=>[i(" Fill in the details to "+u(F.value.toLowerCase())+" a performance record. ",1)]),_:1})]),_:1}),r("form",{onSubmit:Q(de,["prevent"]),class:"space-y-4"},[c.SuperAdmin?(m(),p("div",lt,[a(t(y),{for:"tenant"},{default:l(()=>e[37]||(e[37]=[i("Company Name")])),_:1}),r("div",rt,[W(r("select",{id:"tenant","onUpdate:modelValue":e[6]||(e[6]=n=>t(s).tenant_id=n),required:"",class:"flex h-10 w-full items-center rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 appearance-none"},[e[38]||(e[38]=r("option",{disabled:"",value:""},"Select a Company",-1)),(m(!0),p(T,null,B(c.tenants,n=>(m(),p("option",{key:n.id,value:n.id},u(n.name),9,ot))),128))],512),[[J,t(s).tenant_id]]),e[39]||(e[39]=r("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[r("svg",{class:"h-4 w-4 opacity-50",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[r("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])],-1))])])):w("",!0),r("div",null,[a(t(y),{for:"date"},{default:l(()=>e[40]||(e[40]=[i("Date")])),_:1}),a(t(S),{id:"date",modelValue:t(s).date,"onUpdate:modelValue":e[7]||(e[7]=n=>t(s).date=n),type:"date",required:""},null,8,["modelValue"])]),r("div",null,[a(t(y),{for:"acceptance"},{default:l(()=>e[41]||(e[41]=[i("Acceptance")])),_:1}),a(t(S),{id:"acceptance",modelValue:t(s).acceptance,"onUpdate:modelValue":e[8]||(e[8]=n=>t(s).acceptance=n),type:"number",step:"0.01",required:""},null,8,["modelValue"])]),r("div",null,[a(t(y),{for:"on_time_to_origin"},{default:l(()=>e[42]||(e[42]=[i("On Time to Origin")])),_:1}),a(t(S),{id:"on_time_to_origin",modelValue:t(s).on_time_to_origin,"onUpdate:modelValue":e[9]||(e[9]=n=>t(s).on_time_to_origin=n),type:"number",step:"0.01",required:""},null,8,["modelValue"])]),r("div",null,[a(t(y),{for:"on_time_to_destination"},{default:l(()=>e[43]||(e[43]=[i("On Time to Destination")])),_:1}),a(t(S),{id:"on_time_to_destination",modelValue:t(s).on_time_to_destination,"onUpdate:modelValue":e[10]||(e[10]=n=>t(s).on_time_to_destination=n),type:"number",step:"0.01",required:""},null,8,["modelValue"])]),r("div",null,[a(t(y),{for:"maintenance_variance_to_spend"},{default:l(()=>e[44]||(e[44]=[i("Maintenance Variance to Spend")])),_:1}),a(t(S),{id:"maintenance_variance_to_spend",modelValue:t(s).maintenance_variance_to_spend,"onUpdate:modelValue":e[11]||(e[11]=n=>t(s).maintenance_variance_to_spend=n),type:"number",step:"0.01",required:""},null,8,["modelValue"])]),r("div",null,[a(t(y),{for:"open_boc"},{default:l(()=>e[45]||(e[45]=[i("Open BOC")])),_:1}),a(t(S),{id:"open_boc",modelValue:t(s).open_boc,"onUpdate:modelValue":e[12]||(e[12]=n=>t(s).open_boc=n),type:"number",step:"1",required:""},null,8,["modelValue"])]),r("div",st,[W(r("input",{id:"meets_safety_bonus_criteria","onUpdate:modelValue":e[13]||(e[13]=n=>t(s).meets_safety_bonus_criteria=n),type:"checkbox",class:"h-4 w-4 rounded border-gray-300 focus:ring-blue-500"},null,512),[[xe,t(s).meets_safety_bonus_criteria]]),a(t(y),{for:"meets_safety_bonus_criteria"},{default:l(()=>e[46]||(e[46]=[i(" Meets Safety Bonus Criteria ")])),_:1})]),r("div",null,[a(t(y),{for:"vcr_preventable"},{default:l(()=>e[47]||(e[47]=[i("VCR Preventable")])),_:1}),a(t(S),{id:"vcr_preventable",modelValue:t(s).vcr_preventable,"onUpdate:modelValue":e[14]||(e[14]=n=>t(s).vcr_preventable=n),type:"number",step:"1",required:""},null,8,["modelValue"])]),a(t(le),null,{default:l(()=>[a(t(_),{type:"button",onClick:G,variant:"outline"},{default:l(()=>e[48]||(e[48]=[i(" Cancel ")])),_:1}),a(t(_),{type:"submit",variant:"default"},{default:l(()=>[i(u(F.value),1)]),_:1})]),_:1})],32)]),_:1})]),_:1},8,["open"]),a(t(Z),{open:M.value,"onUpdate:open":e[17]||(e[17]=n=>M.value=n)},{default:l(()=>[a(t(ee),null,{default:l(()=>[a(t(te),null,{default:l(()=>[a(t(ne),null,{default:l(()=>e[49]||(e[49]=[i("Confirm Deletion")])),_:1}),a(t(ae),null,{default:l(()=>e[50]||(e[50]=[i(" Are you sure you want to delete this performance record? This action cannot be undone. ")])),_:1})]),_:1}),a(t(le),{class:"mt-4"},{default:l(()=>[a(t(_),{type:"button",onClick:e[16]||(e[16]=n=>M.value=!1),variant:"outline"},{default:l(()=>e[51]||(e[51]=[i(" Cancel ")])),_:1}),a(t(_),{type:"button",onClick:ve,variant:"destructive"},{default:l(()=>e[52]||(e[52]=[i(" Delete ")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),r("form",{ref_key:"exportForm",ref:z,method:"GET",class:"hidden"},null,512)])]),_:1},8,["tenantSlug"]))}};export{$t as default};
