import{d as vt,w as ge,L as u,e as n,X as t,k as g,l,f as s,S as i,D as L,Y as H,u as a,M as w,N as E,U as f,P as Oe,c as A,b2 as Z,a1 as yt,r as D,A as je,bW as gt,b as k,K as xt,bF as bt}from"./vendor-C-CW143M.js";import{x as ve,a as _t,g as wt,W as q}from"./vendor-vue-o4TX1eGc.js";import{_ as xe}from"./Input.vue_vue_type_script_setup_true_lang-taOxs2kk.js";import{_ as b}from"./Button.vue_vue_type_script_setup_true_lang-B-CPTRto.js";import{_ as kt}from"./Checkbox.vue_vue_type_script_setup_true_lang-ChpjAJsN.js";import{_ as z}from"./Label.vue_vue_type_script_setup_true_lang-CZjK18aI.js";import{_ as $}from"./Icon.vue_vue_type_script_setup_true_lang-B7IfTNIf.js";import{_ as ht}from"./Badge.vue_vue_type_script_setup_true_lang-Cb4j4dNt.js";import{_ as he,a as Ce,b as te,c as X,d as De,e as G}from"./TableRow.vue_vue_type_script_setup_true_lang-D19AmMrD.js";import{_ as de}from"./Card.vue_vue_type_script_setup_true_lang-Cp4wUgFE.js";import{_ as Ct}from"./CardHeader.vue_vue_type_script_setup_true_lang-CNgbOXgy.js";import{_ as Dt}from"./CardTitle.vue_vue_type_script_setup_true_lang-BcA2pWrU.js";import{_ as ie}from"./CardContent.vue_vue_type_script_setup_true_lang-DxPj8Tg7.js";import{b as ue,_ as me,a as ce}from"./DialogDescription.vue_vue_type_script_setup_true_lang-DjSCH9m8.js";import{_ as fe,a as pe}from"./DialogTitle.vue_vue_type_script_setup_true_lang-BSj40beh.js";import{_ as ke}from"./DialogFooter.vue_vue_type_script_setup_true_lang-RSN6g_4k.js";import{b as Se,_ as $e,a as Ne}from"./AlertDescription.vue_vue_type_script_setup_true_lang-Bni7FoRm.js";import{_ as St}from"./AppLayout.vue_vue_type_script_setup_true_lang-D9jrdhXX.js";import"./vendor-axios-xsH4HHeE.js";import"./utils-CmSxFldp.js";import"./vendor-ui-DUlj4Wsf.js";import"./vendor-icons-Dyo-jBRF.js";import"./useInitials-DzeGKvtI.js";import"./app-ChvJRkE5.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-C-8K70bD.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const $t={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Nt={key:0,class:"col-span-full"},Tt={class:"relative"},At=["value"],Ft={class:"col-span-full"},Vt={class:"relative"},Mt={class:"relative"},Ot={class:"relative"},jt=["value"],Ut={class:"relative"},zt={class:"flex items-center space-x-2"},Et={class:"flex-col space-y-2 sm:space-y-0 sm:flex-row sm:justify-end sm:space-x-2 pt-4 border-t flex"},Rt=vt({__name:"DelayForm",props:{delay:{type:Object,default:null},delayCodes:{type:Array,default:()=>[]},tenants:{type:Array,default:()=>[]},isSuperAdmin:{type:Boolean,default:!1},tenantSlug:{type:String,default:null}},emits:["close"],setup(p,{emit:r}){var N,S,O,T,K,j,B;const _=p,R=r,v=ve({id:(N=_.delay)==null?void 0:N.id,tenant_id:_.isSuperAdmin?(S=_.delay)==null?void 0:S.tenant_id:null,date:((O=_.delay)==null?void 0:O.date)||"",driver_name:((T=_.delay)==null?void 0:T.driver_name)||"",delay_type:((K=_.delay)==null?void 0:K.delay_type)||"origin",delay_category:((j=_.delay)==null?void 0:j.delay_category)||"1_60",delay_code_id:((B=_.delay)==null?void 0:B.delay_code_id)||null,disputed:_.delay&&_.delay.disputed!==null?parseInt(_.delay.disputed)===1:!1,driver_controllable:_.delay&&_.delay.driver_controllable!==null?parseInt(_.delay.driver_controllable)===1:null});ge(()=>_.delay,h=>{h?(v.id=h.id,v.tenant_id=h.tenant_id,v.date=h.date,v.driver_name=h.driver_name,v.delay_type=h.delay_type,v.delay_category=h.delay_category,v.delay_code_id=h.delay_code_id,v.disputed=h.disputed!==null?parseInt(h.disputed)===1:!1,v.driver_controllable=h.driver_controllable!==null?parseInt(h.driver_controllable)===1:null):v.reset()},{immediate:!0});const U=()=>{const h=!!v.id,c=_.isSuperAdmin?h?"ontime.update.admin":"ontime.store.admin":h?"ontime.update":"ontime.store",m=_.isSuperAdmin?h?{delay:v.id}:{}:h?{tenantSlug:_.tenantSlug,delay:v.id}:{tenantSlug:_.tenantSlug};v[h?"put":"post"](route(c,m),{onSuccess:()=>R("close")})};return(h,c)=>(n(),u("form",{onSubmit:Oe(U,["prevent"]),class:"space-y-6"},[t("div",$t,[p.isSuperAdmin?(n(),u("div",Nt,[l(z,null,{default:s(()=>c[9]||(c[9]=[i("Company Name")])),_:1}),t("div",Tt,[L(t("select",{"onUpdate:modelValue":c[0]||(c[0]=m=>a(v).tenant_id=m),class:"flex h-10 w-full items-center rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 appearance-none"},[c[10]||(c[10]=t("option",{value:null,disabled:""},"Select Company",-1)),(n(!0),u(w,null,E(p.tenants,m=>(n(),u("option",{key:m.id,value:m.id},f(m.name),9,At))),128))],512),[[H,a(v).tenant_id]]),c[11]||(c[11]=t("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[t("svg",{class:"h-4 w-4 opacity-50",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])],-1))])])):g("",!0),t("div",Ft,[l(z,null,{default:s(()=>c[12]||(c[12]=[i("Date")])),_:1}),l(xe,{type:"date",modelValue:a(v).date,"onUpdate:modelValue":c[1]||(c[1]=m=>a(v).date=m),class:"w-full"},null,8,["modelValue"])]),t("div",null,[l(z,null,{default:s(()=>c[13]||(c[13]=[i("Driver Name")])),_:1}),l(xe,{modelValue:a(v).driver_name,"onUpdate:modelValue":c[2]||(c[2]=m=>a(v).driver_name=m),class:"w-full"},null,8,["modelValue"])]),t("div",null,[l(z,null,{default:s(()=>c[14]||(c[14]=[i("Delay Type")])),_:1}),t("div",Vt,[L(t("select",{"onUpdate:modelValue":c[3]||(c[3]=m=>a(v).delay_type=m),class:"flex h-10 w-full items-center rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 appearance-none"},c[15]||(c[15]=[t("option",{value:"origin"},"Origin",-1),t("option",{value:"destination"},"Destination",-1)]),512),[[H,a(v).delay_type]]),c[16]||(c[16]=t("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[t("svg",{class:"h-4 w-4 opacity-50",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])],-1))])]),t("div",null,[l(z,null,{default:s(()=>c[17]||(c[17]=[i("Delay Category")])),_:1}),t("div",Mt,[L(t("select",{"onUpdate:modelValue":c[4]||(c[4]=m=>a(v).delay_category=m),class:"flex h-10 w-full items-center rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 appearance-none"},c[18]||(c[18]=[t("option",{value:"1_60"},"1–60 min",-1),t("option",{value:"61_240"},"61–240 min",-1),t("option",{value:"241_600"},"241–600 min",-1),t("option",{value:"601_plus"},"601+ min",-1)]),512),[[H,a(v).delay_category]]),c[19]||(c[19]=t("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[t("svg",{class:"h-4 w-4 opacity-50",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])],-1))])]),t("div",null,[l(z,null,{default:s(()=>c[20]||(c[20]=[i("Delay Code")])),_:1}),t("div",Ot,[L(t("select",{"onUpdate:modelValue":c[5]||(c[5]=m=>a(v).delay_code_id=m),class:"flex h-10 w-full items-center rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 appearance-none"},[(n(!0),u(w,null,E(p.delayCodes,m=>(n(),u("option",{key:m.id,value:m.id},f(m.code),9,jt))),128))],512),[[H,a(v).delay_code_id]]),c[21]||(c[21]=t("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[t("svg",{class:"h-4 w-4 opacity-50",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])],-1))])]),t("div",null,[l(z,null,{default:s(()=>c[22]||(c[22]=[i("Driver Controllable")])),_:1}),t("div",Ut,[L(t("select",{"onUpdate:modelValue":c[6]||(c[6]=m=>a(v).driver_controllable=m),class:"flex h-10 w-full items-center rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 appearance-none"},c[23]||(c[23]=[t("option",{value:null},"N/A",-1),t("option",{value:!0},"Yes",-1),t("option",{value:!1},"No",-1)]),512),[[H,a(v).driver_controllable]]),c[24]||(c[24]=t("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[t("svg",{class:"h-4 w-4 opacity-50",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])],-1))])]),t("div",zt,[l(kt,{checked:a(v).disputed,"onUpdate:checked":c[7]||(c[7]=m=>a(v).disputed=m),id:"disputed"},null,8,["checked"]),l(z,{for:"disputed"},{default:s(()=>c[25]||(c[25]=[i("Disputed")])),_:1})])]),t("div",Et,[l(b,{type:"button",onClick:c[8]||(c[8]=m=>R("close")),variant:"outline",class:"w-full sm:w-auto"},{default:s(()=>c[26]||(c[26]=[i(" Cancel ")])),_:1}),l(b,{type:"submit",disabled:a(v).processing,class:"w-full sm:w-auto"},{default:s(()=>[i(f(a(v).id?"Update":"Create"),1)]),_:1},8,["disabled"])])],32))}}),Pt={class:"bg-background rounded-lg border shadow-sm p-2 md:p-4 lg:p-6 flex flex-col items-center justify-center"},Bt={class:"text-base font-semibold mb-2 text-foreground"},It={__name:"TotalLateStops",props:{title:{type:String,required:!0},value:{type:[Number,String],required:!0}},setup(p){const r=p,_=A(()=>r.value===null||r.value===void 0||r.value===""?"No Data":r.value),R=A(()=>{const v=Number(r.value);return r.title.toLowerCase().includes("total")&&v>0});return(v,U)=>(n(),u("div",Pt,[t("h3",Bt,f(p.title),1),t("p",{class:Z(["text-2xl font-bold",R.value?"text-red-600":"text-primary"])},f(_.value),3)]))}},Lt={class:"bg-background rounded-lg border shadow-sm p-2 md:p-4"},Wt={class:"text-base text-center font-semibold mb-2 md:mb-4"},Yt={key:0,class:"text-center text-sm py-4 text-primary font-medium"},qt={class:"space-y-3"},Ht={class:"text-sm"},Gt={__name:"BottomDrivers",props:{title:{type:String,default:"Bottom 5 Drivers"},drivers:{type:Array,default:()=>[]},delayType:{type:String,default:""},totalDelays:{type:Number,default:-1}},setup(p){const r=p,_=R=>{const v=["#ef4444","#f97316","#f59e0b","#84cc16","#10b981"],N=[...r.drivers].sort((S,O)=>O.total_penalty-S.total_penalty).map(S=>S.total_penalty).indexOf(R);return v[N]||"#6b7280"};return(R,v)=>(n(),u("div",Lt,[t("h3",Wt,f(p.title),1),p.drivers.length===0?(n(),u("div",Yt,[p.totalDelays===0?(n(),u(w,{key:0},[p.delayType==="origin"?(n(),u(w,{key:0},[i(" No origin delays recorded. You're on track for Fantastic+ ! ")],64)):p.delayType==="destination"?(n(),u(w,{key:1},[i(" No destination delays recorded. You're on track for Fantastic+ ! ")],64)):(n(),u(w,{key:2},[i(" No delays recorded. You're on track for Fantastic+ ! ")],64))],64)):(n(),u(w,{key:1},[i(" No delays recorded. You're on track for Fantastic+ ! ")],64))])):(n(),u(w,{key:1},[v[0]||(v[0]=t("div",{class:"flex justify-between items-center mb-2"},[t("span",{class:"text-base mb-2 font-medium"},"Driver Name"),t("span",{class:"text-base mb-2 font-medium"},"Total Penalty")],-1)),t("div",qt,[(n(!0),u(w,null,E(p.drivers,(U,N)=>(n(),u("div",{key:N,class:"flex justify-between items-center"},[t("span",Ht,f(U.driver_name),1),t("span",{class:"text-sm font-medium",style:yt({color:_(U.total_penalty)})},f(U.total_penalty),5)]))),128))])],64))]))}},Kt={class:"bg-background rounded-lg border shadow-sm p-2 md:p-4"},Qt={class:"text-base text-center font-semibold mb-2 md:mb-4"},Xt={class:"h-64"},Zt={__name:"LineChart",props:{title:{type:String,default:"On-Time Score"},chartData:{type:Object,default:()=>({labels:[],datasets:[]})},averageOntime:{type:Number,default:null}},setup(p){const r=p,_=D(null);let R=null;const v=()=>{if(R&&R.destroy(),!_.value)return;const U=_.value.getContext("2d"),N=[];r.chartData.datasets.forEach(T=>{T.data&&T.data.length&&N.push(...T.data)});const S=N.length>0?Math.min(...N):0,O=N.length>0?Math.max(...N):100;R=new gt(U,{type:"line",data:r.chartData,options:{responsive:!0,maintainAspectRatio:!1,layout:{padding:{left:15,right:15,top:10,bottom:10}},plugins:{legend:{position:!1},tooltip:{callbacks:{label:function(T){const K=T.raw||0,j=r.averageOntime||0,B=r.chartData.dateRangeLabel||"selected period",h=Number(j).toFixed(2);return[`On-Time Score: ${K}`,`Average Score Over ${B}: ${h}`]}}}},scales:{y:{beginAtZero:!(S>10),min:Math.max(Math.floor(S-5),0),max:Math.min(102,Math.ceil(O+5)),ticks:{stepSize:2.5,padding:10,font:{size:11},callback:function(T){return T<=100?T:""}},grid:{drawBorder:!0,color:"rgba(200, 200, 200, 0.2)"}},x:{ticks:{padding:10,font:{size:11}},grid:{drawBorder:!0,color:"rgba(200, 200, 200, 0.2)"}}}}})};return je(()=>{v()}),ge(()=>r.chartData,()=>{v()},{deep:!0}),(U,N)=>(n(),u("div",Kt,[t("h3",Qt,f(p.title),1),t("div",Xt,[t("canvas",{ref_key:"chartCanvas",ref:_},null,512)])]))}},Jt={class:"space-y-2 md:space-y-4 lg:space-y-6 mb-2 md:mb-4 lg:mb-6"},el={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-2 md:gap-4"},tl={class:"grid grid-cols-1 lg:grid-cols-4 gap-2 md:gap-4 lg:gap-6"},ll={key:1,class:"bg-background rounded-lg border shadow-sm p-4 md:p-6 lg:col-span-3 md:col-span-2 transition-all duration-300 hover:shadow-md flex flex-col justify-center"},sl={class:"flex flex-col sm:flex-row items-center justify-center sm:justify-around gap-3 mb-4"},al={class:"text-xs text-muted-foreground text-center mt-2"},ol={key:2,class:"bg-background rounded-lg border shadow-sm p-4 md:p-6 lg:col-span-3 md:col-span-2 transition-all duration-300 hover:shadow-md flex flex-col justify-center items-center"},nl={class:"flex flex-col items-center justify-center gap-3 mb-4"},rl={__name:"OnTimeDashboard",props:{metricsData:{type:Object,default:()=>({})},driversData:{type:Array,default:()=>[]},chartData:{type:Object,default:()=>({})},averageOntime:{type:Number,default:null},currentDateFilter:{type:String,default:null},delayType:{type:String,default:"all"}},setup(p){const r=p,_=A(()=>r.metricsData&&r.metricsData.by_category?[{title:"Total Delayed Stops",value:r.metricsData.totalDelays},{title:"Delayed for 1-60 Minutes",value:r.metricsData.between1_60Count},{title:"Delayed for 61-240 Minutes",value:r.metricsData.between61_240Count},{title:"Delayed for 241-600 Minutes",value:r.metricsData.between241_600Count},{title:"Delayed for +601 Minutes",value:r.metricsData.moreThan601Count}]:[]),R=A(()=>r.driversData&&r.driversData.length?r.driversData:[]),v=A(()=>r.chartData&&Object.keys(r.chartData).length?r.chartData:{}),U=A(()=>{var m;return((m=r.metricsData)==null?void 0:m.totalDelays)||0}),N=A(()=>!r.chartData||!r.chartData.labels?!1:r.chartData.labels.length>1),S=A(()=>{var m,F,W,J;return((J=(W=(F=(m=r.chartData)==null?void 0:m.datasets)==null?void 0:F[0])==null?void 0:W.data)==null?void 0:J.length)>0}),O=A(()=>S.value?r.chartData.datasets[0].data[0]:0),T=A(()=>{const m=O.value;return m>=98?"fantastic_plus":m>=95?"fantastic":m>=90?"good":m>=85?"fair":"poor"}),K=m=>m==null?"0%":`${Math.round(parseFloat(m))}%`,j=m=>{if(!m)return"Not Available";switch(m){case"fantastic_plus":return"Fantastic +";case"fantastic":return"Fantastic";case"good":return"Good";case"fair":return"Fair";case"poor":return"Poor";default:return m}},B=m=>{if(!m)return"outline";switch(m){case"fantastic_plus":return"fantastic-plus";case"fantastic":return"fantastic";case"good":return"good";case"fair":return"fair";case"poor":return"poor";default:return"outline"}},h=m=>{if(!m)return"text-gray-600";switch(m){case"fantastic_plus":return"text-green-600";case"fantastic":return"text-emerald-600";case"good":return"text-blue-600";case"fair":return"text-amber-600";case"poor":return"text-red-600";default:return"text-indigo-600"}},c=m=>{if(!m)return"";switch(m){case"fantastic_plus":return"Outstanding performance with exceptional on-time rate";case"fantastic":return"Excellent performance with very high on-time rate";case"good":return"Solid performance with good on-time rate";case"fair":return"Acceptable performance with room for improvement";case"poor":return"Performance needs significant improvement";default:return""}};return(m,F)=>(n(),u("div",Jt,[t("div",el,[(n(!0),u(w,null,E(_.value,(W,J)=>(n(),k(It,{key:J,title:W.title,value:W.value,class:"transition-all duration-300 hover:shadow-md"},null,8,["title","value"]))),128))]),t("div",tl,[l(Gt,{title:"Bottom 5 Drivers",drivers:R.value,delayType:p.delayType,totalDelays:U.value,class:Z({"lg:col-span-1":N.value,"lg:col-span-1 md:col-span-1":!N.value,"transition-all duration-300 hover:shadow-md":!0})},null,8,["drivers","delayType","totalDelays","class"]),r.currentDateFilter!="Yesterday"&&N.value?(n(),k(Zt,{key:0,title:"On-Time Score",chartData:v.value,averageOntime:p.averageOntime,class:"lg:col-span-3 md:col-span-2 transition-all duration-300 hover:shadow-md"},null,8,["chartData","averageOntime"])):g("",!0),!N.value&&S.value?(n(),u("div",ll,[F[0]||(F[0]=t("h3",{class:"text-base md:text-lg text-center font-semibold mb-4"},"On-Time Score",-1)),t("div",sl,[t("div",{class:Z(["text-4xl md:text-5xl font-bold text-center",h(T.value)])},f(K(O.value)),3),l(a(ht),{variant:B(T.value),class:"text-xs md:text-sm px-3 py-1"},{default:s(()=>[i(f(j(T.value)),1)]),_:1},8,["variant"])]),t("p",al,f(c(T.value)),1)])):g("",!0),S.value?g("",!0):(n(),u("div",ol,[F[3]||(F[3]=t("h3",{class:"text-base md:text-lg text-center font-semibold mb-4"},"On-Time Score",-1)),t("div",nl,[l($,{name:"chart_bar",class:"h-16 w-16 text-muted-foreground/50"}),F[1]||(F[1]=t("div",{class:"text-lg font-medium text-center text-primary"}," No data available ",-1)),F[2]||(F[2]=t("p",{class:"text-sm text-primary/70 text-center max-w-md"}," There is no on-time data available for the selected time period. Try selecting a different date range or check back later. ",-1))])]))])]))}},dl={class:"w-full md:max-w-2xl lg:max-w-3xl xl:max-w-6xl lg:mx-auto m-0 p-2 md:p-4 lg:p-6 space-y-2 md:space-y-4 lg:space-y-6"},il={class:"mb-2 flex flex-col items-center justify-between px-2 sm:flex-row md:mb-4 lg:mb-6"},ul={class:"flex flex-wrap gap-3 ml-3"},ml=["action"],cl={class:"flex flex-col items-center gap-2 md:items-start"},fl={class:"flex flex-wrap gap-1 md:gap-2"},pl={key:0,class:"text-sm text-muted-foreground"},vl={key:0},yl={key:1},gl={key:2},xl={key:3,class:"ml-1"},bl={class:"flex items-center justify-between"},_l={class:"flex items-center gap-2"},wl={key:0,class:"ml-4 flex flex-wrap gap-2"},kl={key:0,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},hl={key:1,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},Cl={key:2,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},Dl={key:3,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},Sl={key:4,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},$l={key:5,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},Nl={class:"flex flex-col justify-between gap-1 md:gap-4"},Tl={class:"grid w-full grid-cols-1 gap-1 sm:grid-cols-3 md:gap-4"},Al=["value"],Fl={class:"flex justify-end space-x-2"},Vl={class:"overflow-x-auto"},Ml={class:"flex items-center justify-center"},Ol=["checked"],jl={class:"flex items-center"},Ul={key:2,class:"ml-2"},zl={key:0,class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},El={key:1,class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Rl={key:3,class:"ml-2 opacity-50"},Pl=["value"],Bl={key:0,class:"ml-1 text-xs text-red-500"},Il={class:"flex space-x-2"},Ll={key:0,class:"border-t bg-muted/20 px-4 py-3"},Wl={class:"flex flex-col items-center justify-between gap-2 sm:flex-row"},Yl={class:"text-sm text-muted-foreground"},ql={class:"flex w-full flex-col items-center gap-2 sm:w-auto sm:flex-row sm:gap-4"},Hl={class:"flex items-center gap-2"},Gl={class:"flex flex-wrap"},Kl=["innerHTML"],Ql={class:"max-h-[75vh] space-y-4 overflow-y-auto p-4 sm:p-6"},Xl={class:"flex items-center justify-between"},Zl={class:"max-h-[400px] overflow-y-auto rounded-md border"},Jl={key:0,class:"rounded-md border py-8 text-center text-xs text-muted-foreground sm:text-sm"},es={key:1,class:"divide-y"},ts=["onClick"],ls={class:"text-xs font-medium sm:text-sm"},ss={key:0,class:"ml-2 text-[0.65rem] text-red-500 sm:text-xs"},as={key:0,class:"mt-1 text-xs text-muted-foreground sm:text-sm"},os={class:"flex space-x-1 opacity-0 transition-opacity group-hover:opacity-100"},ns={key:0,class:"space-y-4 rounded-md border p-4"},rs={class:"text-sm font-medium sm:text-base"},ds={class:"space-y-3"},is={class:"flex justify-end space-x-2"},us={class:"flex items-center gap-2"},ms={class:"flex-1 overflow-y-auto px-4 sm:px-6 py-4"},cs={key:0},fs={class:"space-y-4"},ps={class:"flex flex-col items-center justify-center border-2 border-dashed rounded-lg p-8 bg-muted/20"},vs={class:"cursor-pointer"},ys=["disabled"],gs={class:"flex items-center gap-2 text-sm text-muted-foreground"},xs=["href"],bs={key:0,class:"flex items-center justify-center gap-2 p-4"},_s={key:1,class:"space-y-4"},ws={key:0,class:"rounded-lg border p-3"},ks={class:"flex items-center justify-between"},hs={class:"text-xs text-muted-foreground"},Cs={class:"mt-2 flex flex-wrap gap-2"},Ds={class:"grid grid-cols-3 gap-4"},Ss={class:"text-2xl font-bold"},$s={class:"text-2xl font-bold text-green-600"},Ns={class:"text-2xl font-bold text-red-600"},Ts={key:2},As={class:"flex items-center justify-between mb-3"},Fs={class:"text-lg font-semibold text-red-600 flex items-center gap-2"},Vs={class:"border rounded-lg overflow-hidden"},Ms={class:"max-h-96 overflow-y-auto"},Os={class:"flex flex-wrap gap-x-3 gap-y-1"},js={class:"font-medium text-foreground"},Us={key:0,class:"italic text-muted-foreground"},zs={class:"space-y-1"},Es={key:0,class:"text-xs text-muted-foreground"},Rs={key:3},Ps={class:"text-lg font-semibold text-green-600 flex items-center gap-2 mb-3"},Bs={class:"border rounded-lg overflow-hidden"},Is={class:"flex flex-wrap gap-x-3 gap-y-1"},Ls={class:"font-medium"},Ws={key:0,class:"italic text-muted-foreground"},Ys={class:"border-t p-4 flex justify-end gap-3"},qs={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},ba={__name:"Index",props:{delays:{type:Object,default:()=>({data:[],links:[]})},tenantSlug:{type:String,default:null},delay_codes:Array,tenants:{type:Array,default:()=>[]},isSuperAdmin:{type:Boolean,default:!1},dateRange:{type:Object,default:null},dateFilter:{type:String,default:"yesterday"},weekNumber:{type:Number,default:null},startWeekNumber:{type:Number,default:null},endWeekNumber:{type:Number,default:null},year:{type:Number,default:null},delay_breakdown:{type:Object,default:null},line_chart_data:{type:Object,default:null},average_ontime:{type:Number},filters:{type:Object,default:()=>({search:"",delayCode:"",delayCategory:"",delayType:"",disputed:"",driverControllable:""})},permissions:Array},setup(p){const r=p,_=A(()=>(P.value==="yesterday"||P.value==="current-week")&&r.weekNumber&&r.year?`Week ${r.weekNumber}, ${r.year}`:(P.value==="6w"||P.value==="quarterly")&&r.startWeekNumber&&r.endWeekNumber&&r.year?`Weeks ${r.startWeekNumber}-${r.endWeekNumber}, ${r.year}`:""),R=[{title:r.tenantSlug?"Dashboard":"Admin Dashboard",href:r.tenantSlug?route("dashboard",{tenantSlug:r.tenantSlug}):route("admin.dashboard")},{title:"On-Time",href:r.tenantSlug?route("ontime.index",{tenantSlug:r.tenantSlug}):route("ontime.index.admin")}],v=D(!1),U=D(!1),N=D(null),S=D(""),O=D(""),T=D(!1),K=D(null),j=D([]),B=D(!1),h=D(null),c=D(!1),m=D(null),F=D({code:"",description:""}),W=D(!1),J=D(null),le=D("date"),se=D("desc"),Ue=_t(),ye=D(!1),C=D(null),ae=D(!1),ee=D(!1),x=D({...r.filters}),be=["date","delay_type","driver_name","delay_category","delay_code","disputed","driver_controllable"],oe=A(()=>{let d=[...r.delays.data];return d.sort((e,o)=>{var M,Y;let y,V;return le.value==="delay_code"?(y=((M=e.delay_code)==null?void 0:M.code)||"",V=((Y=o.delay_code)==null?void 0:Y.code)||""):(y=e[le.value],V=o[le.value]),y===null?1:V===null?-1:(typeof y=="string"&&(y=y.toLowerCase(),V=V.toLowerCase()),y<V?se.value==="asc"?-1:1:y>V?se.value==="asc"?1:-1:0)}),d}),ze=A(()=>r.delay_codes.filter(d=>!d.deleted_at));function Ee(d){le.value===d?se.value=se.value==="asc"?"desc":"asc":(le.value=d,se.value="asc")}function Te(){const d=r.tenantSlug?route("ontime.index",{tenantSlug:r.tenantSlug}):route("ontime.index.admin");q.get(d,{...x.value,perPage:ne.value,dateFilter:P.value})}function Re(){x.value={search:"",dateFrom:"",dateTo:"",delayCode:"",delayCategory:"",delayType:"",disputed:"",controllable:""},Te()}const ne=D(r.delays.per_page||10),P=D(r.dateFilter||"full");function Pe(){const d=r.tenantSlug?route("ontime.index",{tenantSlug:r.tenantSlug}):route("ontime.index.admin");q.get(d,{...x.value,perPage:ne.value,dateFilter:P.value})}function _e(d){P.value=d;const e=r.tenantSlug?route("ontime.index",{tenantSlug:r.tenantSlug}):route("ontime.index.admin");q.get(e,{...x.value,perPage:ne.value,dateFilter:d})}function Be(d){if(d){const e=new URL(d),o=e.origin+e.pathname;q.get(o,{...x.value,perPage:ne.value,dateFilter:P.value,page:e.searchParams.get("page")||1})}}function we(d){if(!d)return"";const e=d.split("-");if(e.length!==3)return d;const[o,y,V]=e;return`${Number(y)}/${Number(V)}/${o}`}const Ae=(d=null)=>{N.value=d,v.value=!0},Ie=d=>{K.value=d,T.value=!0},Le=()=>{U.value=!0,c.value=!1,m.value=null},We=()=>{F.value={code:"",description:""},m.value=null,c.value=!0},Ye=d=>{F.value={code:d.code,description:d.description||""},m.value=d.id,c.value=!0},qe=()=>{c.value=!1,m.value=null},He=d=>{J.value=d,W.value=!0},re=D(!1),Ge=A(()=>x.value.search||x.value.dateFrom||x.value.dateTo||x.value.delayCode||x.value.delayCategory||x.value.disputed||x.value.delayType||x.value.controllable),Ke=d=>{if(!d)return"";const e=r.delay_codes.find(o=>o.id===parseInt(d));return e?e.code:""},Qe=async d=>{try{await q.delete(route("delay_codes.destroy.admin",d),{onSuccess:()=>{W.value=!1,S.value="Delay code deleted successfully"}})}catch(e){console.error("Error deleting delay code:",e)}};function Fe(d){if(!d)return"—";switch(d){case"1_120":return"1-120 mins";case"121_600":return"121-600 mins";case"601_plus":return"601+ mins";case"1_60":return"1-60 mins";case"61_240":return"61-240 mins";case"241_600":return"241-600 mins";default:return d}}const Xe=()=>{const d=ve({code:F.value.code,description:F.value.description}),e=m.value?r.isSuperAdmin?"delay_codes.update.admin":"delay_codes.update":r.isSuperAdmin?"delay_codes.store.admin":"delay_codes.store",o=m.value?r.isSuperAdmin?{id:m.value}:{tenantSlug:r.tenantSlug,id:m.value}:r.isSuperAdmin?{}:{tenantSlug:r.tenantSlug};(m.value?d.put:d.post).call(d,route(e,o),{onSuccess:()=>{S.value=m.value?"Delay code updated successfully.":"Delay code created successfully.",c.value=!1,m.value=null,q.reload({only:["delay_codes"]})},onError:V=>{console.error(V)}})},Ze=d=>{ve({}).post(route(r.isSuperAdmin?"delay_codes.restore.admin":"delay_codes.restore",{id:d}),{onSuccess:()=>{S.value="Delay code restored successfully.",q.reload({only:["delay_codes"]})},onError:o=>{console.error(o)}})},Je=d=>{ve({}).delete(route(r.isSuperAdmin?"delay_codes.forceDelete.admin":"delay_codes.forceDelete",{id:d}),{onSuccess:()=>{S.value="Delay code permanently deleted successfully.",q.reload({only:["delay_codes"]})},onError:o=>{console.error(o)}})},et=d=>{const e=ve({}),o=r.isSuperAdmin?"ontime.destroy.admin":"ontime.destroy",y=r.isSuperAdmin?{delay:d}:{tenantSlug:r.tenantSlug,delay:d};e.delete(route(o,y),{preserveScroll:!0,onSuccess:()=>{S.value="Delay record deleted successfully.",T.value=!1}})};ge(S,d=>{d&&setTimeout(()=>{S.value=""},5e3)}),r.flash&&r.flash.error&&(O.value=r.flash.error),ge(O,d=>{d&&setTimeout(()=>{O.value=""},5e3)});const tt=A(()=>{var o;if(!((o=r.delay_breakdown)!=null&&o.by_category))return null;const d=r.delay_breakdown.by_category,e=r.filters.delayType;return e?{moreThan601Count:d[`category_601_plus_${e}_count`]||"0",between1_60Count:d[`category_1_60_${e}_count`]||"0",between61_240Count:d[`category_61_240_${e}_count`]||"0",between241_600Count:d[`category_241_600_${e}_count`]||"0",totalDelays:d[`total_${e}_delays`]||"0",by_category:!0}:{between1_120Count:d.category_1_120_count||"0",between121_600Count:d.category_121_600_count||"0",moreThan601Count:d.category_601_plus_count||"0",between1_60Count:d.category_1_60_count||"0",between61_240Count:d.category_61_240_count||"0",between241_600Count:d.category_241_600_count||"0",totalDelays:d.total_delays||"0",by_category:!0}}),lt=A(()=>{var d,e,o;return r.filters.delayType=="origin"?((d=r.delay_breakdown)==null?void 0:d.bottom_five_drivers.origin)||[]:r.filters.delayType=="destination"?((e=r.delay_breakdown)==null?void 0:e.bottom_five_drivers.destination)||[]:((o=r.delay_breakdown)==null?void 0:o.bottom_five_drivers.total)||[]}),st=A(()=>!r.line_chart_data||r.line_chart_data.length===0?{labels:[],datasets:[{label:"On-Time Performance",data:[],borderColor:"#3b82f6",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.3,fill:!1}]}:{labels:r.line_chart_data.map(d=>d.date),datasets:[{label:"On-Time Performance",data:r.line_chart_data.map(d=>d.onTimePerformance),borderColor:"#3b82f6",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.3,fill:!1}]}),at=A(()=>oe.value.length>0&&j.value.length===oe.value.length);A(()=>r.delays.data&&r.delays.data.length>0);function ot(d){d.target.checked?j.value=oe.value.map(e=>e.id):j.value=[]}function nt(){j.value.length>0&&(B.value=!0)}function rt(){const d=ve({ids:j.value}),e=r.isSuperAdmin?"ontime.destroyBulk.admin":"ontime.destroyBulk",o=r.isSuperAdmin?{}:{tenantSlug:r.tenantSlug};d.delete(route(e,o),{preserveScroll:!0,onSuccess:()=>{S.value=`${j.value.length} delay records deleted successfully.`,j.value=[],B.value=!1,q.reload()},onError:y=>{console.error(y)}})}function dt(){if(r.delays.data.length===0){O.value="No delay data found to export.";return}h.value&&h.value.submit()}const it=A(()=>r.tenantSlug?route("ontime.export",{tenantSlug:r.tenantSlug}):route("ontime.export.admin")),Ve=D(!1),ut=A(()=>"/storage/upload-data-temps/Delays Template.csv");je(()=>{const d=e=>{Ve.value&&!e.target.closest(".relative")&&(Ve.value=!1)};document.addEventListener("click",d),xt(()=>{document.removeEventListener("click",d)})});const I=A(()=>r.permissions.map(d=>d.name));function mt(d){var V;const e=(V=d.target.files)==null?void 0:V[0];if(!e)return;ae.value=!0;const o=new FormData;o.append("file",e);const y=r.isSuperAdmin?route("ontime.validateImport.admin"):route("ontime.validateImport",{tenantSlug:r.tenantSlug});q.post(y,o,{forceFormData:!0,preserveScroll:!0,only:["flash"],onFinish:()=>{ae.value=!1,d.target.value=""},onError:()=>{ae.value=!1,O.value="Failed to validate CSV file",d.target.value=""}})}function ct(){var e;if(!C.value||C.value.header_error||(((e=C.value.summary)==null?void 0:e.invalid)??0)>0)return;ee.value=!0;const d=r.isSuperAdmin?route("ontime.confirmImport.admin"):route("ontime.confirmImport",{tenantSlug:r.tenantSlug});q.post(d,{},{preserveScroll:!0,onSuccess:()=>{var o;S.value=`Successfully imported ${((o=C.value.summary)==null?void 0:o.valid)??0} delays`,Me()},onError:()=>{O.value="Failed to import delays"},onFinish:()=>{ee.value=!1}})}function ft(){const d=r.isSuperAdmin?route("ontime.downloadErrorReport.admin"):route("ontime.downloadErrorReport",{tenantSlug:r.tenantSlug});window.location.href=d}function Me(){ye.value=!1,C.value=null,ae.value=!1,ee.value=!1}return ge(()=>{var d;return(d=Ue.props.flash)==null?void 0:d.importValidation},d=>{if(d){if(d.results){C.value=d.results,d.header_error&&(C.value.header_error=d.header_error),ye.value=!0;return}d.message&&(O.value=d.message)}},{immediate:!0}),(d,e)=>(n(),k(St,{breadcrumbs:R,tenantSlug:p.tenantSlug,permissions:r.permissions},{default:s(()=>[l(a(wt),{title:"On-Time"}),t("div",dl,[S.value?(n(),k(a(Se),{key:0,variant:"success"},{default:s(()=>[l(a($e),null,{default:s(()=>e[33]||(e[33]=[i("Success")])),_:1}),l(a(Ne),null,{default:s(()=>[i(f(S.value),1)]),_:1})]),_:1})):g("",!0),O.value?(n(),k(a(Se),{key:1,variant:"destructive"},{default:s(()=>[l(a($e),null,{default:s(()=>e[34]||(e[34]=[i("Error")])),_:1}),l(a(Ne),null,{default:s(()=>[i(f(O.value),1)]),_:1})]),_:1})):g("",!0),t("div",il,[e[39]||(e[39]=t("h1",{class:"text-lg font-bold text-gray-800 dark:text-gray-200 md:text-xl lg:text-2xl"}," On-Time Management ",-1)),t("div",ul,[I.value.includes("delays.create")?(n(),k(b,{key:0,class:"px-2 py-0 md:px-4 md:py-2",onClick:e[0]||(e[0]=o=>Ae()),variant:"default"},{default:s(()=>[l($,{name:"plus",class:"mr-1 h-4 w-4 md:mr-2"}),e[35]||(e[35]=i(" Add Delay "))]),_:1})):g("",!0),j.value.length>0&&I.value.includes("delays.delete")?(n(),k(b,{key:1,class:"px-2 py-0 md:px-4 md:py-2",onClick:e[1]||(e[1]=o=>nt()),variant:"destructive"},{default:s(()=>[l($,{name:"trash",class:"mr-1 h-4 w-4 md:mr-2"}),i(" Delete Selected ("+f(j.value.length)+") ",1)]),_:1})):g("",!0),I.value.includes("delays.import")?(n(),k(b,{key:2,onClick:e[2]||(e[2]=o=>ye.value=!0),variant:"secondary",class:"px-2 py-0 md:px-4 md:py-2 shadow-sm hover:shadow transition-all"},{default:s(()=>[l($,{name:"upload",class:"mr-1 h-4 w-4 md:mr-2"}),e[36]||(e[36]=i(" Import CSV "))]),_:1})):g("",!0),I.value.includes("delays.export")?(n(),k(b,{key:3,class:"px-2 py-0 md:px-4 md:py-2",onClick:Oe(dt,["prevent"]),variant:"outline"},{default:s(()=>[l($,{name:"download",class:"mr-1 h-4 w-4 md:mr-2"}),e[37]||(e[37]=i(" Download CSV "))]),_:1})):g("",!0),p.isSuperAdmin?(n(),k(b,{key:4,class:"px-2 py-0 md:px-4 md:py-2",onClick:e[3]||(e[3]=o=>Le()),variant:"outline"},{default:s(()=>[l($,{name:"settings",class:"mr-1 h-4 w-4 md:mr-2"}),e[38]||(e[38]=i(" Manage Delay Codes "))]),_:1})):g("",!0)])]),t("form",{ref_key:"exportForm",ref:h,action:it.value,method:"GET",class:"hidden"},null,8,ml),l(a(de),null,{default:s(()=>[l(a(ie),{class:"p-2 md:p-4 lg:p-6"},{default:s(()=>[t("div",cl,[t("div",fl,[l(b,{onClick:e[4]||(e[4]=o=>_e("yesterday")),variant:"outline",size:"sm",class:Z({"border-primary bg-primary/10 text-primary":P.value==="yesterday"})},{default:s(()=>e[40]||(e[40]=[i(" Yesterday ")])),_:1},8,["class"]),l(b,{onClick:e[5]||(e[5]=o=>_e("current-week")),variant:"outline",size:"sm",class:Z({"border-primary bg-primary/10 text-primary":P.value==="current-week"})},{default:s(()=>e[41]||(e[41]=[i(" WTD ")])),_:1},8,["class"]),l(b,{onClick:e[6]||(e[6]=o=>_e("6w")),variant:"outline",size:"sm",class:Z({"border-primary bg-primary/10 text-primary":P.value==="6w"})},{default:s(()=>e[42]||(e[42]=[i(" T6W ")])),_:1},8,["class"]),l(b,{onClick:e[7]||(e[7]=o=>_e("quarterly")),variant:"outline",size:"sm",class:Z({"border-primary bg-primary/10 text-primary":P.value==="quarterly"})},{default:s(()=>e[43]||(e[43]=[i(" Quarterly ")])),_:1},8,["class"])]),p.dateRange?(n(),u("div",pl,[P.value==="yesterday"&&p.dateRange.start?(n(),u("span",vl," Showing data from "+f(we(p.dateRange.start)),1)):p.dateRange.start&&p.dateRange.end?(n(),u("span",yl," Showing data from "+f(we(p.dateRange.start))+" to "+f(we(p.dateRange.end)),1)):(n(),u("span",gl,f(p.dateRange.label),1)),_.value?(n(),u("span",xl,"("+f(_.value)+")",1)):g("",!0)])):g("",!0)])]),_:1})]),_:1}),l(a(de),null,{default:s(()=>[l(a(Ct),{class:"p-2 md:p-4 lg:p-6"},{default:s(()=>[t("div",bl,[t("div",_l,[l(a(Dt),{class:"text-lg md:text-xl lg:text-2xl"},{default:s(()=>e[44]||(e[44]=[i("Filters")])),_:1}),!re.value&&Ge.value?(n(),u("div",wl,[x.value.search?(n(),u("div",kl," Search: "+f(x.value.search),1)):g("",!0),x.value.delayCode?(n(),u("div",hl," Code: "+f(Ke(x.value.delayCode)),1)):g("",!0),x.value.delayCategory?(n(),u("div",Cl," Category: "+f(Fe(x.value.delayCategory)),1)):g("",!0),x.value.delayType?(n(),u("div",Dl," Type: "+f(x.value.delayType==="origin"?"Origin":"Destination"),1)):g("",!0),x.value.disputed?(n(),u("div",Sl," Disputed: "+f(x.value.disputed==="true"?"Yes":"No"),1)):g("",!0),x.value.controllable?(n(),u("div",$l," Driver Controllable: "+f(x.value.controllable==="true"?"Yes":x.value.controllable==="false"?"No":"N/A"),1)):g("",!0)])):g("",!0)]),l(b,{variant:"ghost",size:"sm",onClick:e[8]||(e[8]=o=>re.value=!re.value)},{default:s(()=>[i(f(re.value?"Hide Filters":"Show Filters")+" ",1),l($,{name:re.value?"chevron-up":"chevron-down",class:"ml-2 h-4 w-4"},null,8,["name"])]),_:1})])]),_:1}),re.value?(n(),k(a(ie),{key:0,class:"p-2 md:p-4 lg:p-6"},{default:s(()=>[t("div",Nl,[t("div",Tl,[t("div",null,[l(a(z),{for:"search"},{default:s(()=>e[45]||(e[45]=[i("Search")])),_:1}),l(a(xe),{class:"h-9 px-1 py-1 md:px-2 md:py-1 lg:h-10 lg:px-3 lg:py-2",id:"search",modelValue:x.value.search,"onUpdate:modelValue":e[9]||(e[9]=o=>x.value.search=o),type:"text",placeholder:"Search by driver..."},null,8,["modelValue"])]),t("div",null,[l(a(z),{for:"delayCode"},{default:s(()=>e[46]||(e[46]=[i("Delay Code")])),_:1}),L(t("select",{id:"delayCode","onUpdate:modelValue":e[10]||(e[10]=o=>x.value.delayCode=o),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},[e[47]||(e[47]=t("option",{value:""},"All Codes",-1)),(n(!0),u(w,null,E(p.delay_codes,o=>(n(),u("option",{key:o.id,value:o.id},f(o.code),9,Al))),128))],512),[[H,x.value.delayCode]])]),t("div",null,[l(a(z),{for:"delayCategory"},{default:s(()=>e[48]||(e[48]=[i("Delay Category")])),_:1}),L(t("select",{id:"delayCategory","onUpdate:modelValue":e[11]||(e[11]=o=>x.value.delayCategory=o),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},e[49]||(e[49]=[t("option",{value:""},"All Categories",-1),t("option",{value:"1_60"},"1-60 mins",-1),t("option",{value:"61_240"},"61-240 mins",-1),t("option",{value:"241_600"},"241-600 mins",-1),t("option",{value:"601_plus"},"601+ mins",-1)]),512),[[H,x.value.delayCategory]])]),t("div",null,[l(a(z),{for:"delayType"},{default:s(()=>e[50]||(e[50]=[i("Delay Type")])),_:1}),L(t("select",{id:"delayType","onUpdate:modelValue":e[12]||(e[12]=o=>x.value.delayType=o),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},e[51]||(e[51]=[t("option",{value:""},"All Types",-1),t("option",{value:"origin"},"Origin",-1),t("option",{value:"destination"},"Destination",-1)]),512),[[H,x.value.delayType]])]),t("div",null,[l(a(z),{for:"disputed"},{default:s(()=>e[52]||(e[52]=[i("Disputed Status")])),_:1}),L(t("select",{id:"disputed","onUpdate:modelValue":e[13]||(e[13]=o=>x.value.disputed=o),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},e[53]||(e[53]=[t("option",{value:""},"All",-1),t("option",{value:"true"},"Disputed",-1),t("option",{value:"false"},"Not Disputed",-1)]),512),[[H,x.value.disputed]])]),t("div",null,[l(a(z),{for:"controllable"},{default:s(()=>e[54]||(e[54]=[i("Driver Controllable")])),_:1}),L(t("select",{id:"controllable","onUpdate:modelValue":e[14]||(e[14]=o=>x.value.controllable=o),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},e[55]||(e[55]=[t("option",{value:""},"All",-1),t("option",{value:"true"},"Yes",-1),t("option",{value:"false"},"No",-1),t("option",{value:"NA"},"N/A",-1)]),512),[[H,x.value.controllable]])])]),t("div",Fl,[l(b,{onClick:Re,variant:"ghost",size:"sm"},{default:s(()=>[l($,{name:"rotate_ccw",class:"mr-2 h-4 w-4"}),e[56]||(e[56]=i(" Reset Filters "))]),_:1}),l(b,{onClick:Te,variant:"default",size:"sm"},{default:s(()=>[l($,{name:"filter",class:"mr-2 h-4 w-4"}),e[57]||(e[57]=i(" Apply Filters "))]),_:1})])])]),_:1})):g("",!0)]),_:1}),p.isSuperAdmin?g("",!0):(n(),k(rl,{key:2,metricsData:tt.value,driversData:lt.value,chartData:st.value,averageOntime:p.average_ontime,currentDateFilter:r.dateRange.label,delayType:x.value.delayType},null,8,["metricsData","driversData","chartData","averageOntime","currentDateFilter","delayType"])),l(a(de),{class:"mx-auto max-w-[95vw] overflow-x-auto md:max-w-[64vw] lg:max-w-full"},{default:s(()=>[l(a(ie),{class:"p-0"},{default:s(()=>[t("div",Vl,[l(a(he),{class:"relative h-[500px] overflow-auto"},{default:s(()=>[l(a(Ce),null,{default:s(()=>[l(a(te),{class:"sticky top-0 z-10 border-b bg-background hover:bg-background"},{default:s(()=>[I.value.includes("delays.delete")?(n(),k(a(X),{key:0,class:"w-[50px]"},{default:s(()=>[t("div",Ml,[t("input",{type:"checkbox",onChange:ot,checked:at.value,class:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"},null,40,Ol)])]),_:1})):g("",!0),p.isSuperAdmin?(n(),k(a(X),{key:1},{default:s(()=>e[58]||(e[58]=[i("Company Name")])),_:1})):g("",!0),(n(),u(w,null,E(be,o=>l(a(X),{key:o,class:"cursor-pointer",onClick:y=>Ee(o)},{default:s(()=>[t("div",jl,[o==="delay_category"?(n(),u(w,{key:0},[i(" Delay ")],64)):(n(),u(w,{key:1},[i(f(o.replace(/_/g," ").split(" ").map(y=>y.charAt(0).toUpperCase()+y.slice(1)).join(" ")),1)],64)),le.value===o?(n(),u("div",Ul,[se.value==="asc"?(n(),u("svg",zl,e[59]||(e[59]=[t("path",{d:"M8 15l4-4 4 4"},null,-1)]))):(n(),u("svg",El,e[60]||(e[60]=[t("path",{d:"M16 9l-4 4-4-4"},null,-1)])))])):(n(),u("div",Rl,e[61]||(e[61]=[t("svg",{class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M8 10l4-4 4 4"}),t("path",{d:"M16 14l-4 4-4-4"})],-1)])))])]),_:2},1032,["onClick"])),64)),I.value.includes("delays.delete")||I.value.includes("delays.update")?(n(),k(a(X),{key:2,class:"text-right"},{default:s(()=>e[62]||(e[62]=[i("Actions")])),_:1})):g("",!0)]),_:1})]),_:1}),l(a(De),null,{default:s(()=>[oe.value.length===0?(n(),k(a(te),{key:0},{default:s(()=>[l(a(G),{colspan:p.isSuperAdmin?be.length+2:be.length+1,class:"py-8 text-center text-primary font-medium"},{default:s(()=>e[63]||(e[63]=[i(" No delays found matching your criteria ")])),_:1},8,["colspan"])]),_:1})):g("",!0),(n(!0),u(w,null,E(oe.value,o=>(n(),k(a(te),{key:o.id,class:"hover:bg-muted/50"},{default:s(()=>[I.value.includes("delays.delete")?(n(),k(a(G),{key:0,class:"text-center"},{default:s(()=>[L(t("input",{type:"checkbox",value:o.id,"onUpdate:modelValue":e[15]||(e[15]=y=>j.value=y),class:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"},null,8,Pl),[[bt,j.value]])]),_:2},1024)):g("",!0),p.isSuperAdmin?(n(),k(a(G),{key:1},{default:s(()=>{var y;return[i(f(((y=o.tenant)==null?void 0:y.name)||"—"),1)]}),_:2},1024)):g("",!0),(n(),u(w,null,E(be,y=>l(a(G),{key:y,class:"whitespace-nowrap"},{default:s(()=>{var V,M;return[y==="date"?(n(),u(w,{key:0},[i(f(we(o[y])),1)],64)):y==="disputed"?(n(),u(w,{key:1},[i(f(o[y]?"Yes":"No"),1)],64)):y==="driver_controllable"?(n(),u(w,{key:2},[i(f(o[y]===null?"N/A":o[y]?"Yes":"No"),1)],64)):y==="delay_code"?(n(),u(w,{key:3},[i(f(((V=o.delay_code)==null?void 0:V.code)||"—")+" ",1),(M=o.delay_code)!=null&&M.deleted_at?(n(),u("span",Bl,"(Deleted Code)")):g("",!0)],64)):y==="delay_category"?(n(),u(w,{key:4},[i(f(Fe(o.delay_category)),1)],64)):(n(),u(w,{key:5},[i(f(o[y]),1)],64))]}),_:2},1024)),64)),I.value.includes("delays.udpate")||I.value.includes("delays.delete")?(n(),k(a(G),{key:2},{default:s(()=>[t("div",Il,[I.value.includes("delays.update")?(n(),k(b,{key:0,onClick:y=>Ae(o),variant:"warning",size:"sm"},{default:s(()=>[l($,{name:"pencil",class:"mr-1 h-4 w-4"}),e[64]||(e[64]=i(" Edit "))]),_:2},1032,["onClick"])):g("",!0),I.value.includes("delays.delete")?(n(),k(b,{key:1,onClick:y=>Ie(o.id),variant:"destructive",size:"sm"},{default:s(()=>[l($,{name:"trash",class:"mr-1 h-4 w-4"}),e[65]||(e[65]=i(" Delete "))]),_:2},1032,["onClick"])):g("",!0)])]),_:2},1024)):g("",!0)]),_:2},1024))),128))]),_:1})]),_:1})]),p.delays.links?(n(),u("div",Ll,[t("div",Wl,[t("div",Yl," Showing "+f(oe.value.length)+" of "+f(p.delays.data.length)+" entries ",1),t("div",ql,[t("div",Hl,[l(a(z),{for:"perPage",class:"text-sm"},{default:s(()=>e[66]||(e[66]=[i("Per page:")])),_:1}),L(t("select",{id:"perPage","onUpdate:modelValue":e[16]||(e[16]=o=>ne.value=o),onChange:Pe,class:"h-8 rounded-md border border-input bg-background px-2 py-1 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"},e[67]||(e[67]=[t("option",{value:"10"},"10",-1),t("option",{value:"25"},"25",-1),t("option",{value:"50"},"50",-1),t("option",{value:"100"},"100",-1)]),544),[[H,ne.value]])]),t("div",Gl,[(n(!0),u(w,null,E(p.delays.links,o=>(n(),k(b,{key:o.label,onClick:y=>Be(o.url),disabled:!o.url,variant:"ghost",size:"sm",class:Z(["mx-1",{"border-primary bg-primary/10 text-primary":o.active}])},{default:s(()=>[t("span",{innerHTML:o.label},null,8,Kl)]),_:2},1032,["onClick","disabled","class"]))),128))])])])])):g("",!0)]),_:1})]),_:1}),l(a(ue),{open:v.value,"onUpdate:open":e[18]||(e[18]=o=>v.value=o)},{default:s(()=>[l(a(me),{class:"max-w-[95vw] sm:max-w-[90vw] md:max-w-4xl"},{default:s(()=>[l(a(fe),{class:"px-4 sm:px-6"},{default:s(()=>[l(a(pe),{class:"text-lg sm:text-xl"},{default:s(()=>[i(f(N.value?"Edit":"Add")+" Delay",1)]),_:1}),l(a(ce),{class:"text-xs sm:text-sm"},{default:s(()=>[i(" Fill in the details to "+f(N.value?"update":"create")+" a delay record. ",1)]),_:1})]),_:1}),l(Rt,{delay:N.value,"delay-codes":ze.value,tenants:p.tenants,"is-super-admin":p.isSuperAdmin,"tenant-slug":p.tenantSlug,onClose:e[17]||(e[17]=o=>v.value=!1),class:"max-h-[75vh] overflow-y-auto p-4 sm:p-6"},null,8,["delay","delay-codes","tenants","is-super-admin","tenant-slug"])]),_:1})]),_:1},8,["open"]),l(a(ue),{open:U.value,"onUpdate:open":e[22]||(e[22]=o=>U.value=o)},{default:s(()=>[l(a(me),{class:"max-w-[95vw] sm:max-w-[90vw] md:max-w-2xl"},{default:s(()=>[l(a(fe),{class:"px-4 sm:px-6"},{default:s(()=>[l(a(pe),{class:"text-lg sm:text-xl"},{default:s(()=>e[68]||(e[68]=[i("Manage Delay Codes")])),_:1}),l(a(ce),{class:"text-xs sm:text-sm"},{default:s(()=>e[69]||(e[69]=[i(" Create and manage delay codes for your organization. ")])),_:1})]),_:1}),t("div",Ql,[t("div",Xl,[e[71]||(e[71]=t("h3",{class:"text-sm font-medium sm:text-base"},"Current Delay Codes",-1)),l(b,{onClick:We,size:"sm",variant:"outline",class:"h-8 px-3 text-xs sm:h-9 sm:px-4 sm:text-sm"},{default:s(()=>[l($,{name:"plus",class:"mr-1 h-3 w-3 sm:h-3.5 sm:w-3.5"}),e[70]||(e[70]=i(" Add New Code "))]),_:1})]),t("div",Zl,[!p.delay_codes||p.delay_codes.length===0?(n(),u("div",Jl," No delay codes found ")):(n(),u("div",es,[(n(!0),u(w,null,E(p.delay_codes,o=>(n(),u("div",{key:o.id,class:"group flex items-center justify-between p-3 hover:bg-muted/50"},[t("div",{class:"flex-1 cursor-pointer",onClick:y=>Ye(o)},[t("div",ls,[i(f(o.code)+" ",1),o.deleted_at?(n(),u("span",ss,"(Deleted)")):g("",!0)]),o.description?(n(),u("div",as,f(o.description),1)):g("",!0)],8,ts),t("div",os,[p.isSuperAdmin?(n(),u(w,{key:0},[o.deleted_at?(n(),u(w,{key:0},[l(b,{onClick:y=>Ze(o.id),size:"sm",variant:"outline",class:"h-8 px-2 text-xs sm:h-9 sm:px-3 sm:text-sm"},{default:s(()=>[l($,{name:"refresh",class:"mr-1 h-3 w-3 sm:h-3 sm:w-3"}),e[72]||(e[72]=i(" Restore "))]),_:2},1032,["onClick"]),l(b,{onClick:y=>Je(o.id),size:"sm",variant:"destructive",class:"h-8 px-2 text-xs sm:h-9 sm:px-3 sm:text-sm"},{default:s(()=>[l($,{name:"trash",class:"mr-1 h-3 w-3 sm:h-3 sm:w-3"}),e[73]||(e[73]=i(" Delete "))]),_:2},1032,["onClick"])],64)):(n(),k(b,{key:1,onClick:y=>He(o.id),size:"sm",variant:"destructive",class:"h-8 px-2 text-xs sm:h-9 sm:px-3 sm:text-sm"},{default:s(()=>[l($,{name:"trash",class:"mr-1 h-3 w-3 sm:h-3 sm:w-3"}),e[74]||(e[74]=i(" Delete "))]),_:2},1032,["onClick"]))],64)):g("",!0)])]))),128))]))]),c.value?(n(),u("div",ns,[t("h3",rs,f(m.value?"Edit":"Add")+" Delay Code ",1),t("div",ds,[t("div",null,[l(a(z),{for:"code",class:"text-xs sm:text-sm"},{default:s(()=>e[75]||(e[75]=[i("Code")])),_:1}),l(a(xe),{id:"code",modelValue:F.value.code,"onUpdate:modelValue":e[19]||(e[19]=o=>F.value.code=o),placeholder:"Enter code",class:"h-9 text-xs sm:h-10 sm:text-sm"},null,8,["modelValue"])]),t("div",null,[l(a(z),{for:"description",class:"text-xs sm:text-sm"},{default:s(()=>e[76]||(e[76]=[i("Description")])),_:1}),l(a(xe),{id:"description",modelValue:F.value.description,"onUpdate:modelValue":e[20]||(e[20]=o=>F.value.description=o),placeholder:"Enter description",class:"h-9 text-xs sm:h-10 sm:text-sm"},null,8,["modelValue"])]),t("div",is,[l(b,{onClick:qe,variant:"ghost",size:"sm",class:"h-8 px-3 text-xs sm:h-9 sm:px-4 sm:text-sm"},{default:s(()=>e[77]||(e[77]=[i("Cancel")])),_:1}),l(b,{onClick:Xe,variant:"default",size:"sm",class:"h-8 px-3 text-xs sm:h-9 sm:px-4 sm:text-sm"},{default:s(()=>e[78]||(e[78]=[i("Save")])),_:1})])])])):g("",!0)]),l(a(ke),{class:"px-4 sm:px-6"},{default:s(()=>[l(b,{onClick:e[21]||(e[21]=o=>U.value=!1),variant:"outline",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:s(()=>e[79]||(e[79]=[i("Close")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),l(a(ue),{open:W.value,"onUpdate:open":e[25]||(e[25]=o=>W.value=o)},{default:s(()=>[l(a(me),{class:"max-w-[95vw] sm:max-w-md"},{default:s(()=>[l(a(fe),{class:"px-4 sm:px-6"},{default:s(()=>[l(a(pe),{class:"text-lg sm:text-xl"},{default:s(()=>e[80]||(e[80]=[i("Confirm Deletion")])),_:1}),l(a(ce),{class:"text-xs sm:text-sm"},{default:s(()=>e[81]||(e[81]=[i(" Are you sure you want to delete this delay code? This action cannot be undone. ")])),_:1})]),_:1}),l(a(ke),{class:"px-4 sm:px-6"},{default:s(()=>[l(b,{type:"button",onClick:e[23]||(e[23]=o=>W.value=!1),variant:"outline",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:s(()=>e[82]||(e[82]=[i(" Cancel ")])),_:1}),l(b,{type:"button",onClick:e[24]||(e[24]=o=>Qe(J.value)),variant:"destructive",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:s(()=>e[83]||(e[83]=[i(" Delete ")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),l(a(ue),{open:T.value,"onUpdate:open":e[28]||(e[28]=o=>T.value=o)},{default:s(()=>[l(a(me),{class:"max-w-[95vw] sm:max-w-md"},{default:s(()=>[l(a(fe),{class:"px-4 sm:px-6"},{default:s(()=>[l(a(pe),{class:"text-lg sm:text-xl"},{default:s(()=>e[84]||(e[84]=[i("Confirm Deletion")])),_:1}),l(a(ce),{class:"text-xs sm:text-sm"},{default:s(()=>e[85]||(e[85]=[i(" Are you sure you want to delete this delay record? This action cannot be undone. ")])),_:1})]),_:1}),l(a(ke),{class:"px-4 sm:px-6"},{default:s(()=>[l(b,{type:"button",onClick:e[26]||(e[26]=o=>T.value=!1),variant:"outline",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:s(()=>e[86]||(e[86]=[i(" Cancel ")])),_:1}),l(b,{type:"button",onClick:e[27]||(e[27]=o=>et(K.value)),variant:"destructive",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:s(()=>e[87]||(e[87]=[i(" Delete ")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),l(a(ue),{open:B.value,"onUpdate:open":e[31]||(e[31]=o=>B.value=o)},{default:s(()=>[l(a(me),{class:"max-w-[95vw] sm:max-w-md"},{default:s(()=>[l(a(fe),{class:"px-4 sm:px-6"},{default:s(()=>[l(a(pe),{class:"text-lg sm:text-xl"},{default:s(()=>e[88]||(e[88]=[i("Confirm Bulk Deletion")])),_:1}),l(a(ce),{class:"text-xs sm:text-sm"},{default:s(()=>[i(" Are you sure you want to delete "+f(j.value.length)+" delay records? This action cannot be undone. ",1)]),_:1})]),_:1}),l(a(ke),{class:"px-4 sm:px-6"},{default:s(()=>[l(b,{type:"button",onClick:e[29]||(e[29]=o=>B.value=!1),variant:"outline",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:s(()=>e[89]||(e[89]=[i(" Cancel ")])),_:1}),l(b,{type:"button",onClick:e[30]||(e[30]=o=>rt()),variant:"destructive",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:s(()=>e[90]||(e[90]=[i(" Delete Selected ")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"])]),l(a(ue),{open:ye.value,"onUpdate:open":e[32]||(e[32]=o=>ye.value=o)},{default:s(()=>[l(a(me),{class:"max-w-[95vw] sm:max-w-[90vw] md:max-w-5xl max-h-[90vh] overflow-hidden flex flex-col"},{default:s(()=>{var o,y,V;return[l(a(fe),{class:"px-4 sm:px-6 border-b pb-3"},{default:s(()=>[t("div",us,[l($,{name:"upload",class:"h-5 w-5 text-primary"}),l(a(pe),{class:"text-lg sm:text-xl font-semibold"},{default:s(()=>e[91]||(e[91]=[i(" Import Delays ")])),_:1})]),l(a(ce),{class:"text-xs sm:text-sm mt-1 text-muted-foreground"},{default:s(()=>e[92]||(e[92]=[i(" Upload a CSV file to import delays. The file will be validated before import. ")])),_:1})]),_:1}),t("div",ms,[C.value?(n(),u("div",_s,[(o=C.value.headers)!=null&&o.length?(n(),u("div",ws,[t("div",ks,[e[96]||(e[96]=t("div",{class:"text-sm font-semibold"},"CSV Headers",-1)),t("div",hs,f(C.value.headers.length)+" columns ",1)]),t("div",Cs,[(n(!0),u(w,null,E(C.value.headers,M=>(n(),u("span",{key:M,class:"rounded-full bg-muted px-2 py-0.5 text-xs"},f(M),1))),128))])])):g("",!0),t("div",Ds,[l(a(de),{class:"border-2"},{default:s(()=>[l(a(ie),{class:"p-4 text-center"},{default:s(()=>[t("div",Ss,f(C.value.summary.total),1),e[97]||(e[97]=t("div",{class:"text-sm text-muted-foreground"},"Total Rows",-1))]),_:1})]),_:1}),l(a(de),{class:"border-2 border-green-500/50 bg-green-50 dark:bg-green-900/10"},{default:s(()=>[l(a(ie),{class:"p-4 text-center"},{default:s(()=>[t("div",$s,f(C.value.summary.valid),1),e[98]||(e[98]=t("div",{class:"text-sm text-muted-foreground"},"Valid",-1))]),_:1})]),_:1}),l(a(de),{class:"border-2 border-red-500/50 bg-red-50 dark:bg-red-900/10"},{default:s(()=>[l(a(ie),{class:"p-4 text-center"},{default:s(()=>[t("div",Ns,f(C.value.summary.invalid),1),e[99]||(e[99]=t("div",{class:"text-sm text-muted-foreground"},"Invalid",-1))]),_:1})]),_:1})]),C.value.header_error?(n(),k(a(Se),{key:1,variant:"destructive"},{default:s(()=>[l(a($e),{class:"flex items-center gap-2"},{default:s(()=>[l($,{name:"alert_circle",class:"h-5 w-5"}),e[100]||(e[100]=i(" Header Error "))]),_:1}),l(a(Ne),null,{default:s(()=>[i(f(C.value.header_error),1)]),_:1})]),_:1})):g("",!0),(y=C.value.invalid)!=null&&y.length?(n(),u("div",Ts,[t("div",As,[t("h3",Fs,[l($,{name:"alert-triangle",class:"h-5 w-5"}),i(" Validation Errors ("+f(C.value.invalid.length)+") ",1)]),l(b,{onClick:ft,variant:"outline",size:"sm",class:"flex items-center gap-2"},{default:s(()=>[l($,{name:"download",class:"h-4 w-4"}),e[101]||(e[101]=i(" Download Error Report "))]),_:1})]),t("div",Vs,[t("div",Ms,[l(a(he),null,{default:s(()=>[l(a(Ce),{class:"sticky top-0 bg-background"},{default:s(()=>[l(a(te),null,{default:s(()=>[l(a(X),{class:"w-20"},{default:s(()=>e[102]||(e[102]=[i("Row #")])),_:1}),l(a(X),null,{default:s(()=>e[103]||(e[103]=[i("Preview")])),_:1}),l(a(X),null,{default:s(()=>e[104]||(e[104]=[i("Errors")])),_:1})]),_:1})]),_:1}),l(a(De),null,{default:s(()=>[(n(!0),u(w,null,E(C.value.invalid,M=>(n(),k(a(te),{key:M.rowNumber,class:"hover:bg-muted/50"},{default:s(()=>[l(a(G),{class:"font-medium"},{default:s(()=>[i(f(M.rowNumber),1)]),_:2},1024),l(a(G),{class:"text-sm text-muted-foreground"},{default:s(()=>{var Y;return[t("div",Os,[(n(!0),u(w,null,E(M.preview||[],Q=>(n(),u("span",{key:Q.key,class:"whitespace-nowrap"},[t("span",js,f(Q.label)+":",1),i(" "+f(Q.value),1)]))),128)),(Y=M.preview)!=null&&Y.length?g("",!0):(n(),u("span",Us,"—"))])]}),_:2},1024),l(a(G),null,{default:s(()=>{var Y;return[t("div",zs,[(n(!0),u(w,null,E(M.errors||[],(Q,pt)=>(n(),u("div",{key:pt,class:"text-xs text-red-600 flex items-start gap-1"},[l($,{name:"x-circle",class:"h-3 w-3 mt-0.5 flex-shrink-0"}),t("span",null,f(Q),1)]))),128)),(Y=M.errors)!=null&&Y.length?g("",!0):(n(),u("div",Es," — "))])]}),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])])])):g("",!0),(V=C.value.valid)!=null&&V.length?(n(),u("div",Rs,[t("h3",Ps,[l($,{name:"check-circle",class:"h-5 w-5"}),i(" Valid Rows ("+f(C.value.valid.length)+") ",1)]),e[107]||(e[107]=t("div",{class:"text-sm text-muted-foreground mb-2"}," Showing first 5 valid rows ",-1)),t("div",Bs,[l(a(he),null,{default:s(()=>[l(a(Ce),null,{default:s(()=>[l(a(te),null,{default:s(()=>[l(a(X),null,{default:s(()=>e[105]||(e[105]=[i("Row #")])),_:1}),l(a(X),null,{default:s(()=>e[106]||(e[106]=[i("Preview")])),_:1})]),_:1})]),_:1}),l(a(De),null,{default:s(()=>[(n(!0),u(w,null,E(C.value.valid.slice(0,5),M=>(n(),k(a(te),{key:M.rowNumber},{default:s(()=>[l(a(G),{class:"font-medium"},{default:s(()=>[i(f(M.rowNumber),1)]),_:2},1024),l(a(G),{class:"text-sm"},{default:s(()=>{var Y;return[t("div",Is,[(n(!0),u(w,null,E(M.preview||[],Q=>(n(),u("span",{key:Q.key,class:"whitespace-nowrap"},[t("span",Ls,f(Q.label)+":",1),i(" "+f(Q.value),1)]))),128)),(Y=M.preview)!=null&&Y.length?g("",!0):(n(),u("span",Ws,"—"))])]}),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])])):g("",!0)])):(n(),u("div",cs,[t("div",fs,[t("div",ps,[l($,{name:"file-spreadsheet",class:"h-12 w-12 text-muted-foreground mb-3"}),t("label",vs,[e[93]||(e[93]=t("span",{class:"text-sm font-medium text-primary hover:underline"}," Choose CSV file ",-1)),t("input",{type:"file",class:"hidden",onChange:mt,accept:".csv",disabled:ae.value},null,40,ys)]),e[94]||(e[94]=t("p",{class:"text-xs text-muted-foreground mt-2"},"or drag and drop",-1))]),t("div",gs,[l($,{name:"info",class:"h-4 w-4"}),t("a",{href:ut.value,download:"",class:"text-primary hover:underline"}," Download CSV Template ",8,xs)]),ae.value?(n(),u("div",bs,e[95]||(e[95]=[t("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"},null,-1),t("span",{class:"text-sm text-muted-foreground"},"Validating CSV file...",-1)]))):g("",!0)])]))]),t("div",Ys,[l(b,{onClick:Me,variant:"outline",disabled:ee.value},{default:s(()=>e[108]||(e[108]=[i(" Close ")])),_:1},8,["disabled"]),C.value&&C.value.summary.valid>0?(n(),k(b,{key:0,onClick:ct,variant:"default",disabled:ee.value||C.value.summary.invalid>0||!!C.value.header_error,class:"flex items-center gap-2"},{default:s(()=>[ee.value?(n(),u("div",qs)):(n(),k($,{key:1,name:"check",class:"h-4 w-4"})),i(" "+f(ee.value?"Importing...":`Import ${C.value.summary.valid} Rows`),1)]),_:1},8,["disabled"])):g("",!0)])]}),_:1})]),_:1},8,["open"])]),_:1},8,["tenantSlug","permissions"]))}};export{ba as default};
