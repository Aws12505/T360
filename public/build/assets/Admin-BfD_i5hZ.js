import{r as E,c as z,b,e as i,f as t,z as l,X as u,u as e,F as f,E as A,S as n,H as _,O as p,U as d,C as X,Y}from"./vendor--q1ey8Ib.js";import{_ as J}from"./AppLayout.vue_vue_type_script_setup_true_lang-CTYBMBH9.js";import{_ as K}from"./Form.vue_vue_type_script_setup_true_lang-D6CoSa7-.js";import{g as Q}from"./vendor-vue-BsCVk3W_.js";import{_ as N,a as O,b as M,c as v,d as F,e as g}from"./TableRow.vue_vue_type_script_setup_true_lang-CyEhCbZI.js";import{_ as W}from"./Button.vue_vue_type_script_setup_true_lang-CURKxeic.js";import{_ as k}from"./Card.vue_vue_type_script_setup_true_lang-D6lnctxv.js";import{_ as w}from"./CardHeader.vue_vue_type_script_setup_true_lang-D36Fjuw_.js";import{_ as S}from"./CardTitle.vue_vue_type_script_setup_true_lang-C7T0BrR7.js";import{_ as T}from"./CardContent.vue_vue_type_script_setup_true_lang-Bg8Ud8NP.js";import{_ as Z}from"./Badge.vue_vue_type_script_setup_true_lang-MdQcxSLl.js";import"./utils-tTsIgFyK.js";import"./vendor-ui-VCcvGdtT.js";import"./Icon.vue_vue_type_script_setup_true_lang-Cf3euL4G.js";import"./vendor-icons-Cd5utPp1.js";import"./useInitials-DzeGKvtI.js";import"./app-DSK4nD5u.js";import"./vendor-axios-xsH4HHeE.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-Dc8NxSZT.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Input.vue_vue_type_script_setup_true_lang-D2siHqHg.js";import"./Label.vue_vue_type_script_setup_true_lang-DXVzP2wd.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-CC0Uw8BM.js";const ee={class:"w-full md:max-w-2xl lg:max-w-3xl xl:max-w-6xl lg:mx-auto m-0 p-2 md:p-4 lg:p-6 space-y-2 md:space-y-4 lg:space-y-6"},te={class:"flex flex-col sm:flex-row justify-between items-center mb-6"},le={key:0},ae={key:1,class:"grid grid-cols-1 md:grid-cols-3 gap-6"},se={class:"overflow-x-auto"},re={class:"overflow-x-auto"},ne=["value"],oe={class:"flex flex-col space-y-2"},ie={class:"flex items-center justify-between"},ue={class:"text-muted-foreground"},de={class:"flex flex-wrap gap-2"},Re={__name:"Admin",props:{metrics:Object,permissions:{type:Array,default:()=>[]},TenantMetricsRules:{type:Array,default:()=>[]},tenants:{type:Array,default:()=>[]}},setup(m){var D,j;const o=m,{tenantSlug:y}=o,U=[{title:y?"Dashboard":"Admin Dashboard",href:y?route("dashboard",{tenantSlug:y}):route("admin.dashboard")},{title:"Metrics",href:route("performance-metrics.edit")}],V=E(!1),h=E({}),L=["acceptance","on_time","maintenance_variance","open_boc","vcr_preventable","vmcr_p"],G=["fantastic_plus","fantastic","good","fair","poor"],q=["driver_distraction","speeding_violation","sign_violation","traffic_light_violation","following_distance"],H=["gold","silver","not_eligible"],R={less:"Less than",less_or_equal:"Less than or equal to",equal:"Equal to",more_or_equal:"More than or equal to",more:"More than"},x=z(()=>{if(!o.metrics)return{};const c={};return L.forEach(a=>{c[a]=G.map(s=>{const r=o.metrics[`${a}_${s}_operator`]??"-";return{level:s.replace(/_/g," "),value:o.metrics[`${a}_${s}`]??"-",operator:R[r]||r}})}),q.forEach(a=>{c[a]=H.map(s=>{const r=o.metrics[`${a}_${s}_operator`]??"-";return{level:s.replace(/_/g," "),value:o.metrics[`${a}_${s}`]??"-",operator:R[r]||r}})}),c.safety_bonus_eligible_levels=o.metrics.safety_bonus_eligible_levels||[],c});function I(){h.value=o.metrics??{},V.value=!0}function B(){V.value=!1,h.value={}}const $=E(((j=(D=o.tenants)==null?void 0:D[0])==null?void 0:j.id)||null),P=z(()=>!Array.isArray(o.TenantMetricsRules)||!$.value?o.metrics||{}:o.TenantMetricsRules.find(c=>c.tenant_id===$.value)||o.metrics||{});return(c,a)=>(i(),b(J,{breadcrumbs:U,tenantSlug:e(y),permissions:o.permissions},{default:t(()=>[l(e(Q),{title:"Metrics Management"}),u("div",ee,[u("div",te,[a[2]||(a[2]=u("h1",{class:"text-2xl font-bold text-foreground"}," Performance Metrics ",-1)),l(e(W),{onClick:I,variant:"default",class:"mt-4 sm:mt-0"},{default:t(()=>a[1]||(a[1]=[n(" Edit Global Metrics ")])),_:1})]),V.value?(i(),f("div",le,[l(K,{entry:h.value,tenants:m.tenants,metrics:m.metrics,TenantMetricsRules:m.TenantMetricsRules,onSaved:B,onCancel:B},null,8,["entry","tenants","metrics","TenantMetricsRules"])])):o.metrics?(i(),f("div",ae,[(i(),f(_,null,p(L,s=>l(e(k),{key:s},{default:t(()=>[l(e(w),null,{default:t(()=>[l(e(S),{class:"capitalize"},{default:t(()=>[n(d(s.replace(/_/g," ")),1)]),_:2},1024)]),_:2},1024),l(e(T),null,{default:t(()=>[u("div",se,[l(e(N),null,{default:t(()=>[l(e(O),null,{default:t(()=>[l(e(M),null,{default:t(()=>[l(e(v),null,{default:t(()=>a[3]||(a[3]=[n("Level")])),_:1}),l(e(v),null,{default:t(()=>a[4]||(a[4]=[n("Value")])),_:1}),l(e(v),null,{default:t(()=>a[5]||(a[5]=[n("Operator")])),_:1})]),_:1})]),_:1}),l(e(F),null,{default:t(()=>[(i(!0),f(_,null,p(x.value[s],(r,C)=>(i(),b(e(M),{key:C},{default:t(()=>[l(e(g),null,{default:t(()=>[n(d(r.level),1)]),_:2},1024),l(e(g),null,{default:t(()=>[n(d(r.value),1)]),_:2},1024),l(e(g),null,{default:t(()=>[n(d(r.operator),1)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)])]),_:2},1024)]),_:2},1024)),64)),(i(),f(_,null,p(q,s=>l(e(k),{key:s},{default:t(()=>[l(e(w),null,{default:t(()=>[l(e(S),{class:"capitalize"},{default:t(()=>[n(d(s.replace(/_/g," ")),1)]),_:2},1024)]),_:2},1024),l(e(T),null,{default:t(()=>[u("div",re,[l(e(N),null,{default:t(()=>[l(e(O),null,{default:t(()=>[l(e(M),null,{default:t(()=>[l(e(v),null,{default:t(()=>a[6]||(a[6]=[n("Tier")])),_:1}),l(e(v),null,{default:t(()=>a[7]||(a[7]=[n("Value")])),_:1}),l(e(v),null,{default:t(()=>a[8]||(a[8]=[n("Operator")])),_:1})]),_:1})]),_:1}),l(e(F),null,{default:t(()=>[(i(!0),f(_,null,p(x.value[s],(r,C)=>(i(),b(e(M),{key:C},{default:t(()=>[l(e(g),null,{default:t(()=>[n(d(r.level),1)]),_:2},1024),l(e(g),null,{default:t(()=>[n(d(r.value),1)]),_:2},1024),l(e(g),null,{default:t(()=>[n(d(r.operator),1)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)])]),_:2},1024)]),_:2},1024)),64)),l(e(k),{class:"col-span-1 md:col-span-2"},{default:t(()=>[l(e(w),{class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},{default:t(()=>{var s;return[l(e(S),null,{default:t(()=>a[9]||(a[9]=[n("MVtS Configuration")])),_:1}),(s=m.tenants)!=null&&s.length?X((i(),f("select",{key:0,"onUpdate:modelValue":a[0]||(a[0]=r=>$.value=r),class:"p-2 rounded-md border border-input bg-background text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-700 dark:bg-gray-800 dark:text-white max-w-[200px]"},[(i(!0),f(_,null,p(m.tenants,r=>(i(),f("option",{key:r.id,value:r.id},d(r.name),9,ne))),128))],512)),[[Y,$.value]]):A("",!0)]}),_:1}),l(e(T),null,{default:t(()=>{var s;return[u("div",oe,[u("div",ie,[a[10]||(a[10]=u("span",{class:"font-medium text-foreground"},"MVtS Divisor:",-1)),u("span",ue,d(((s=P.value)==null?void 0:s.mvts_divisor)||"0.135"),1)]),a[11]||(a[11]=u("p",{class:"text-sm text-muted-foreground"}," This value is used to calculate the Maintenance Variance to Standard (MVtS) metric. ",-1))])]}),_:1})]),_:1}),x.value.safety_bonus_eligible_levels.length?(i(),b(e(k),{key:0,class:"col-span-1 md:col-span-2"},{default:t(()=>[l(e(w),null,{default:t(()=>[l(e(S),null,{default:t(()=>a[12]||(a[12]=[n(" Safety Bonus Eligibility ")])),_:1})]),_:1}),l(e(T),null,{default:t(()=>[u("div",de,[(i(!0),f(_,null,p(x.value.safety_bonus_eligible_levels,(s,r)=>(i(),b(e(Z),{key:r,variant:"success",class:"capitalize"},{default:t(()=>[n(d(s.replace(/_/g," ")),1)]),_:2},1024))),128))])]),_:1})]),_:1})):A("",!0)])):A("",!0)])]),_:1},8,["tenantSlug","permissions"]))}};export{Re as default};
