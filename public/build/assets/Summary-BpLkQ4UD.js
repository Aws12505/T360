import{z as te,b as ae,E as se,W as E,m as ne}from"./vendor-vue-BRPOKWly.js";import{_ as re}from"./AppLayout.vue_vue_type_script_setup_true_lang-D6HeKE5A.js";import{_ as oe}from"./Icon.vue_vue_type_script_setup_true_lang-ChfPiT8z.js";import{_ as F}from"./Badge.vue_vue_type_script_setup_true_lang-xe4tQroL.js";import{J as C,B as q,a7 as v,N as m,a9 as j,aa as T,an as e,af as o,aM as A,L as R,I as d,aP as le,aJ as I,O as g,a6 as M,a1 as u,ae as x,A as k,aQ as ie,av as z,P as de,aG as J,a0 as ce}from"./vendor-xy97mY0-.js";import{a as Z,b as L,c as O,d as X,_ as ee,e as V}from"./TableRow.vue_vue_type_script_setup_true_lang-B3yArJuB.js";import{_ as G}from"./Button.vue_vue_type_script_setup_true_lang-BW5qRT-D.js";import{c as ue}from"./utils-OMMm8ro2.js";import{_ as me}from"./Card.vue_vue_type_script_setup_true_lang-DYwS7A8-.js";import{_ as fe}from"./CardContent.vue_vue_type_script_setup_true_lang-DuDvULMo.js";import{_ as ge,a as ve}from"./CardTitle.vue_vue_type_script_setup_true_lang-Wjlz8bZz.js";import"./vendor-axios-t--hEgTQ.js";import"./vendor-lodash-DCUXXPMP.js";import"./vendor-ui-CqtnUFeu.js";import"./app-COgRaFVd.js";import"./vendor-d3-DpcuoaSC.js";import"./vendor-icons-CrF1H9yF.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-evYd1tA8.js";const _e={class:"flex border-b mb-6"},ye=["onClick"],pe=C({__name:"TabsHeader",emits:["tab-change"],setup(t,{expose:n,emit:p}){const _=[{id:"on-time",label:"On-Time"},{id:"acceptance",label:"Acceptance"},{id:"safety",label:"Safety"},{id:"maintenance",label:"Maintenance"}],f=q("on-time"),i=p,c=s=>{f.value=s,i("tab-change",s)};return n({activeTab:f}),(s,a)=>(m(),v("div",_e,[(m(),v(j,null,T(_,y=>e("button",{key:y.id,onClick:()=>c(y.id),class:A(["px-4 py-2 font-medium text-sm transition-colors",[f.value===y.id?"text-primary border-b-2 border-primary":"text-muted-foreground hover:text-foreground"]])},o(y.label),11,ye)),64))]))}}),be=C({__name:"ChartSingleTooltip",props:{selector:{},index:{},items:{},valueFormatter:{type:Function},customTooltip:{}},setup(t){const n=t,p=new WeakMap;function _(f,i,c){const s=n.valueFormatter??(a=>`${a}`);if(n.index in f){if(p.has(f))return p.get(f);{const a=document.createElement("div"),y=Object.entries(le(f,[n.index])).map(([$,r])=>{var S;return{...(S=n.items)==null?void 0:S.find(D=>D.name===$),value:s(r)}}),b=n.customTooltip??Y;return I(b,{title:f[n.index],data:y}).mount(a),p.set(f,a.innerHTML),a.innerHTML}}else{const a=f.data;if(p.has(a))return p.get(a);{const y=getComputedStyle(c[i]),b=[{name:a.name,value:s(a[n.index]),color:y.fill}],$=document.createElement("div"),r=n.customTooltip??Y;return I(r,{title:f[n.index],data:b}).mount($),p.set(f,$.innerHTML),$.innerHTML}}}return(f,i)=>(m(),R(d(te),{"horizontal-shift":20,"vertical-shift":20,triggers:{[f.selector]:_}},null,8,["triggers"]))}}),xe={class:"flex items-center"},he={class:"w-2.5 h-2.5 mr-2"},we={width:"100%",height:"100%",viewBox:"0 0 30 30"},De=["stroke","fill"],$e={class:"font-semibold ml-4"},Y=C({__name:"ChartTooltip",props:{title:{},data:{}},setup(t){return(n,p)=>(m(),R(d(me),{class:"text-sm"},{default:g(()=>[n.title?(m(),R(d(ge),{key:0,class:"p-3 border-b"},{default:g(()=>[u(d(ve),null,{default:g(()=>[x(o(n.title),1)]),_:1})]),_:1})):M("",!0),u(d(fe),{class:"p-3 min-w-[180px] flex flex-col gap-1"},{default:g(()=>[(m(!0),v(j,null,T(n.data,(_,f)=>(m(),v("div",{key:f,class:"flex justify-between"},[e("div",xe,[e("span",he,[(m(),v("svg",we,[e("path",{d:" M 15 15 m -14, 0 a 14,14 0 1,1 28,0 a 14,14 0 1,1 -28,0",stroke:_.color,fill:_.color,"stroke-width":"1"},null,8,De)]))]),e("span",null,o(_.name),1)]),e("span",$e,o(_.value),1)]))),128))]),_:1})]),_:1}))}});function ke(t=3){const n=Math.floor(t/2),p=t%2,_=n+p,f=n;return[...Array.from(new Array(_).keys()).map(i=>`hsl(var(--vis-primary-color) / ${1-1/_*i})`),...Array.from(new Array(f).keys()).map(i=>`hsl(var(--vis-secondary-color) / ${1-1/f*i})`)]}const H=C({__name:"DonutChart",props:{data:{},colors:{},index:{},margin:{default:()=>({top:0,bottom:0,left:0,right:0})},showLegend:{type:Boolean,default:!0},showTooltip:{type:Boolean,default:!0},filterOpacity:{default:.2},category:{},type:{default:"donut"},sortFunction:{type:Function,default:()=>{}},valueFormatter:{},customTooltip:{}},setup(t){const n=t,p=n.valueFormatter??(b=>`${b}`),_=k(()=>n.category),f=k(()=>n.index),i=ie(),c=q(),s=k(()=>{var b;return(b=n.colors)!=null&&b.length?n.colors:ke(n.data.filter($=>$[n.category]).filter(Boolean).length)}),a=k(()=>n.data.map((b,$)=>({name:b[n.index],color:s.value[$],inactive:!1}))),y=k(()=>n.data.reduce((b,$)=>b+$[n.category],0));return(b,$)=>(m(),v("div",{class:A(d(ue)("w-full h-48 flex flex-col items-end",b.$attrs.class??""))},[u(d(ae),{style:z({height:d(i)?"100%":"auto"}),margin:{left:20,right:20},data:b.data},{default:g(()=>[u(d(be),{selector:d(J).selectors.segment,index:_.value,items:a.value,"value-formatter":d(p),"custom-tooltip":b.customTooltip},null,8,["selector","index","items","value-formatter","custom-tooltip"]),u(d(se),{value:r=>r[_.value],"sort-function":b.sortFunction,color:s.value,"arc-width":b.type==="donut"?20:0,"show-background":!1,"central-label":b.type==="donut"?d(p)(y.value):"",events:{[d(J).selectors.segment]:{click:(r,l,S,D)=>{var h,w;((h=r==null?void 0:r.data)==null?void 0:h[f.value])===c.value?(c.value=void 0,D.forEach(B=>B.style.opacity="1")):(c.value=(w=r==null?void 0:r.data)==null?void 0:w[f.value],D.forEach(B=>B.style.opacity=`${b.filterOpacity}`),D[S].style.opacity="1")}}}},null,8,["value","sort-function","color","arc-width","central-label","events"]),de(b.$slots,"default")]),_:3},8,["style","data"])],2))}}),Se={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},je={class:"bg-card rounded-lg border shadow-sm"},Te={class:"p-4"},Be={class:"mt-4 text-right"},Ce={class:"bg-card rounded-lg border shadow-sm"},Re={class:"p-4 flex flex-col items-center"},Me={class:"mt-6 w-full grid grid-cols-2 gap-4"},Fe={class:"text-sm"},Ae=C({__name:"OnTimeContent",props:{delayBreakdownsByDriver:{type:Array,default:()=>[]},delayBreakdownsByCode:{type:Array,default:()=>[]},tenantSlug:{type:String,required:!0}},setup(t){const n=t,p=k(()=>[...n.delayBreakdownsByDriver].sort((c,s)=>s.total_delays-c.total_delays).slice(0,5)),_=()=>{E.visit(route("ontime.index",{tenantSlug:n.tenantSlug}))},f=k(()=>{const c=[...n.delayBreakdownsByCode].sort((a,y)=>y.total_delays-a.total_delays).slice(0,4),s=c.reduce((a,y)=>a+y.total_delays,0);return c.map(a=>({label:a.code||"Unknown",value:s>0?Math.round(a.total_delays/s*100):0}))}),i=["#1e40af","#3b82f6","#60a5fa","#93c5fd"];return(c,s)=>(m(),v("div",Se,[e("div",je,[s[5]||(s[5]=e("div",{class:"p-4 border-b"},[e("h3",{class:"text-lg font-semibold"},"Total delays by driver")],-1)),e("div",Te,[u(d(ee),null,{default:g(()=>[u(d(Z),null,{default:g(()=>[u(d(L),null,{default:g(()=>[u(d(O),null,{default:g(()=>s[0]||(s[0]=[x("Driver Name")])),_:1}),u(d(O),null,{default:g(()=>s[1]||(s[1]=[x("Origin Delays")])),_:1}),u(d(O),null,{default:g(()=>s[2]||(s[2]=[x("Destination Delays")])),_:1}),u(d(O),null,{default:g(()=>s[3]||(s[3]=[x("Total")])),_:1})]),_:1})]),_:1}),u(d(X),null,{default:g(()=>[(m(!0),v(j,null,T(p.value,(a,y)=>(m(),R(d(L),{key:y},{default:g(()=>[u(d(V),null,{default:g(()=>[x(o(a.driver_name||"Unknown"),1)]),_:2},1024),u(d(V),null,{default:g(()=>[x(o(a.total_origin_delays),1)]),_:2},1024),u(d(V),null,{default:g(()=>[x(o(a.total_destination_delays),1)]),_:2},1024),u(d(V),null,{default:g(()=>[x(o(a.total_delays),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),e("div",Be,[u(d(G),{variant:"link",size:"sm",class:"text-primary",onClick:_},{default:g(()=>s[4]||(s[4]=[x(" See details... ")])),_:1})])])]),e("div",Ce,[s[6]||(s[6]=e("div",{class:"p-4 border-b"},[e("h3",{class:"text-lg font-semibold"},"Delays By Reason")],-1)),e("div",Re,[u(d(H),{category:"value",data:f.value,colors:i,index:"label",showTooltip:!0,tooltipTemplate:a=>`${a.label}: ${a.value}%`,class:"max-w-[500px]"},null,8,["data","tooltipTemplate"]),e("div",Me,[(m(!0),v(j,null,T(f.value,(a,y)=>(m(),v("div",{key:y,class:"flex items-center"},[e("div",{class:"w-3 h-3 rounded-full mr-2",style:z({backgroundColor:i[y]})},null,4),e("span",Fe,o(a.label)+": "+o(a.value)+"%",1)]))),128))])])])]))}}),Ne={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},Oe={class:"bg-card rounded-lg border shadow-sm"},Ve={class:"p-4"},Pe={class:"mt-4 text-right"},qe={class:"bg-card rounded-lg border shadow-sm"},Ee={class:"p-4 flex flex-col items-center"},Le={class:"mt-6 w-full grid grid-cols-2 gap-4"},ze={class:"text-sm"},Ge=C({__name:"AcceptanceContent",props:{rejectionBreakdownsByDriver:{type:Array,default:()=>[]},rejectionBreakdownsByReason:{type:Array,default:()=>[]},tenantSlug:{type:String,required:!0}},setup(t){const n=t,p=k(()=>[...n.rejectionBreakdownsByDriver].sort((c,s)=>s.total_rejections-c.total_rejections).slice(0,5)),_=()=>{E.visit(route("acceptance.index",{tenantSlug:n.tenantSlug}))},f=k(()=>{const c=[...n.rejectionBreakdownsByReason].sort((a,y)=>y.total_rejections-a.total_rejections).slice(0,4),s=c.reduce((a,y)=>a+y.total_rejections,0);return c.map(a=>({label:a.reason_code||"Unknown",value:s>0?Math.round(a.total_rejections/s*100):0}))}),i=["#1e40af","#3b82f6","#60a5fa","#93c5fd"];return(c,s)=>(m(),v("div",Ne,[e("div",Oe,[s[5]||(s[5]=e("div",{class:"p-4 border-b"},[e("h3",{class:"text-lg font-semibold"},"Total rejections by driver")],-1)),e("div",Ve,[u(d(ee),null,{default:g(()=>[u(d(Z),null,{default:g(()=>[u(d(L),null,{default:g(()=>[u(d(O),null,{default:g(()=>s[0]||(s[0]=[x("Driver Name")])),_:1}),u(d(O),null,{default:g(()=>s[1]||(s[1]=[x("Load rejections")])),_:1}),u(d(O),null,{default:g(()=>s[2]||(s[2]=[x("Block rejections")])),_:1}),u(d(O),null,{default:g(()=>s[3]||(s[3]=[x("Penalty")])),_:1})]),_:1})]),_:1}),u(d(X),null,{default:g(()=>[(m(!0),v(j,null,T(p.value,(a,y)=>(m(),R(d(L),{key:y},{default:g(()=>[u(d(V),null,{default:g(()=>[x(o(a.driver_name||"Unknown"),1)]),_:2},1024),u(d(V),null,{default:g(()=>[x(o(a.total_load_rejections),1)]),_:2},1024),u(d(V),null,{default:g(()=>[x(o(a.total_block_rejections),1)]),_:2},1024),u(d(V),null,{default:g(()=>[x(o(a.total_penalty),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),e("div",Pe,[u(d(G),{variant:"link",size:"sm",class:"text-primary",onClick:_},{default:g(()=>s[4]||(s[4]=[x(" See details... ")])),_:1})])])]),e("div",qe,[s[6]||(s[6]=e("div",{class:"p-4 border-b"},[e("h3",{class:"text-lg font-semibold"},"Rejections By Reason")],-1)),e("div",Ee,[u(d(H),{data:f.value,colors:i,index:"label",category:"value",showTooltip:!0,tooltipTemplate:a=>`${a.label}: ${a.value}%`},null,8,["data","tooltipTemplate"]),e("div",Le,[(m(!0),v(j,null,T(f.value,(a,y)=>(m(),v("div",{key:y,class:"flex items-center"},[e("div",{class:"w-3 h-3 rounded-full mr-2",style:z({backgroundColor:i[y]})},null,4),e("span",ze,o(a.label)+": "+o(a.value)+"%",1)]))),128))])])])]))}}),He={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},Ue={class:"bg-card rounded-lg border shadow-sm"},Qe={class:"p-4"},We={class:"space-y-3"},Ke={key:0,class:"text-center text-muted-foreground"},Ie={class:"mt-4 text-right"},Je={class:"bg-card rounded-lg border shadow-sm"},Ye={class:"p-4"},Ze={class:"space-y-3"},Xe={key:0,class:"text-center text-muted-foreground"},et={class:"bg-card rounded-lg border shadow-sm"},tt={class:"p-4 flex flex-col items-center"},at={class:"mt-6 w-full space-y-2"},st={class:"flex items-center"},nt={class:"text-sm"},rt={class:"text-sm font-medium"},ot=C({__name:"SafetyContent",props:{safetyData:{type:Object,default:()=>({})},tenantSlug:{type:String,required:!0}},setup(t){const n=t,p=()=>{E.visit(route("safety.index",{tenantSlug:n.tenantSlug}))},_=k(()=>{const i=(n.safetyData.traffic_light_violation||0)+(n.safetyData.speeding_violations||0)+(n.safetyData.following_distance_hard_brake||0)+(n.safetyData.driver_distraction||0)+(n.safetyData.sign_violations||0);return i===0?[{label:"No Data",value:100}]:[{label:"Speeding Violations",value:i>0?Math.round((n.safetyData.speeding_violations||0)/i*100*10)/10:0},{label:"Traffic Light Violation",value:i>0?Math.round((n.safetyData.traffic_light_violation||0)/i*100*10)/10:0},{label:"Following Distance",value:i>0?Math.round((n.safetyData.following_distance_hard_brake||0)/i*100*10)/10:0},{label:"Driver Distraction",value:i>0?Math.round((n.safetyData.driver_distraction||0)/i*100*10)/10:0},{label:"Sign Violations",value:i>0?Math.round((n.safetyData.sign_violations||0)/i*100*10)/10:0}].filter(c=>c.value>0)}),f=["#1e40af","#3b82f6","#60a5fa","#93c5fd","#bfdbfe"];return(i,c)=>(m(),v("div",He,[e("div",Ue,[c[1]||(c[1]=e("div",{class:"p-4 border-b"},[e("h3",{class:"text-lg font-semibold"},"Top 5 Drivers")],-1)),e("div",Qe,[e("ul",We,[(m(!0),v(j,null,T(t.safetyData.top_drivers||[],(s,a)=>(m(),v("li",{key:a,class:"flex justify-between items-center"},[e("span",null,o(s.name),1),u(d(F),{variant:"outline"},{default:g(()=>[x(o(s.score),1)]),_:2},1024)]))),128)),(t.safetyData.top_drivers||[]).length===0?(m(),v("li",Ke," No data available ")):M("",!0)]),e("div",Ie,[u(d(G),{variant:"link",size:"sm",class:"text-primary",onClick:p},{default:g(()=>c[0]||(c[0]=[x(" See details... ")])),_:1})])])]),e("div",Je,[c[2]||(c[2]=e("div",{class:"p-4 border-b"},[e("h3",{class:"text-lg font-semibold"},"Bottom 5 Drivers")],-1)),e("div",Ye,[e("ul",Ze,[(m(!0),v(j,null,T(t.safetyData.bottom_drivers||[],(s,a)=>(m(),v("li",{key:a,class:"flex justify-between items-center"},[e("span",null,o(s.name),1),u(d(F),{variant:"outline"},{default:g(()=>[x(o(s.score),1)]),_:2},1024)]))),128)),(t.safetyData.bottom_drivers||[]).length===0?(m(),v("li",Xe," No data available ")):M("",!0)])])]),e("div",et,[c[3]||(c[3]=e("div",{class:"p-4 border-b"},[e("h3",{class:"text-lg font-semibold"},"Safety Summary")],-1)),e("div",tt,[u(d(H),{category:"value",data:_.value,colors:f,index:"label",showTooltip:!0,tooltipTemplate:s=>`${s.label}: ${s.value}%`,class:"max-w-[200px]"},null,8,["data","tooltipTemplate"]),e("div",at,[(m(!0),v(j,null,T(_.value,(s,a)=>(m(),v("div",{key:a,class:"flex items-center justify-between"},[e("div",st,[e("div",{class:"w-3 h-3 rounded-full mr-2",style:z({backgroundColor:f[a]})},null,4),e("span",nt,o(s.label),1)]),e("span",rt,o(s.value)+"%",1)]))),128))])])])]))}}),lt={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},it={class:"bg-card rounded-lg border shadow-sm"},dt={class:"p-4"},ct={class:"space-y-4"},ut={class:"flex justify-between items-center"},mt={class:"font-medium"},ft={class:"flex justify-between items-center"},gt={class:"font-medium"},vt={class:"flex justify-between items-center"},_t={class:"font-medium"},yt={class:"flex justify-between items-center"},pt={class:"font-medium"},bt={class:"flex justify-between items-center"},xt={class:"font-medium"},ht={class:"flex justify-between items-center"},wt={class:"font-medium"},Dt={class:"flex justify-between items-center"},$t={class:"font-medium"},kt={class:"mt-4 text-right"},St={class:"bg-card rounded-lg border shadow-sm"},jt={class:"p-4"},Tt={class:"space-y-3"},Bt={class:"text-sm"},Ct={key:0,class:"text-center text-muted-foreground"},Rt={class:"bg-card rounded-lg border shadow-sm"},Mt={class:"p-4"},Ft={class:"space-y-3"},At={class:"text-sm"},Nt={key:0,class:"text-center text-muted-foreground"},Ot=C({__name:"MaintenanceContent",props:{maintenanceData:{type:Object,default:()=>({})},tenantSlug:{type:String,required:!0}},setup(t){const n=t,p=()=>{E.visit(route("repair_orders.index",{tenantSlug:n.tenantSlug}))},_=k(()=>(n.maintenanceData.areas_of_concern||[]).slice(0,5)),f=k(()=>(n.maintenanceData.work_orders_by_truck||[]).slice(0,5)),i=(s,a=2)=>s==null?"0.00":Number(s).toFixed(a),c=(s,a=0)=>s==null?"0":Number(s).toLocaleString("en-US",{minimumFractionDigits:a,maximumFractionDigits:a});return(s,a)=>(m(),v("div",lt,[e("div",it,[a[8]||(a[8]=e("div",{class:"p-4 border-b"},[e("h3",{class:"text-lg font-semibold"},"Maintenance Overview")],-1)),e("div",dt,[e("div",ct,[e("div",ut,[a[0]||(a[0]=e("span",{class:"text-sm text-muted-foreground"},"Total Repair Orders:",-1)),e("span",mt,o(t.maintenanceData.total_repair_orders||0),1)]),e("div",ft,[a[1]||(a[1]=e("span",{class:"text-sm text-muted-foreground"},"Total Invoice Amount:",-1)),e("span",gt,"$"+o(i(t.maintenanceData.total_invoice_amount)),1)]),e("div",vt,[a[2]||(a[2]=e("span",{class:"text-sm text-muted-foreground"},"QS Invoice Amount:",-1)),e("span",_t,"$"+o(i(t.maintenanceData.qs_invoice_amount)),1)]),e("div",yt,[a[3]||(a[3]=e("span",{class:"text-sm text-muted-foreground"},"Total Miles:",-1)),e("span",pt,o(c(t.maintenanceData.total_miles)),1)]),e("div",bt,[a[4]||(a[4]=e("span",{class:"text-sm text-muted-foreground"},"Cost Per Mile (CPM):",-1)),e("span",xt,"$"+o(i(t.maintenanceData.cpm,3)),1)]),e("div",ht,[a[5]||(a[5]=e("span",{class:"text-sm text-muted-foreground"},"QS CPM:",-1)),e("span",wt,"$"+o(i(t.maintenanceData.qs_cpm,3)),1)]),e("div",Dt,[a[6]||(a[6]=e("span",{class:"text-sm text-muted-foreground"},"QS MVtS:",-1)),e("span",$t,o(c(t.maintenanceData.qs_MVtS,2)),1)])]),e("div",kt,[u(d(G),{variant:"link",size:"sm",class:"text-primary",onClick:p},{default:g(()=>a[7]||(a[7]=[x(" See details... ")])),_:1})])])]),e("div",St,[a[9]||(a[9]=e("div",{class:"p-4 border-b"},[e("h3",{class:"text-lg font-semibold"},"Areas of Concern")],-1)),e("div",jt,[e("ul",Tt,[(m(!0),v(j,null,T(_.value,(y,b)=>(m(),v("li",{key:b,class:"flex justify-between items-center"},[e("span",Bt,o(y.concern),1),u(d(F),{variant:"outline"},{default:g(()=>[x(o(y.count),1)]),_:2},1024)]))),128)),_.value.length===0?(m(),v("li",Ct," No data available ")):M("",!0)])])]),e("div",Rt,[a[10]||(a[10]=e("div",{class:"p-4 border-b"},[e("h3",{class:"text-lg font-semibold"},"Top Trucks by Work Orders")],-1)),e("div",Mt,[e("ul",Ft,[(m(!0),v(j,null,T(f.value,(y,b)=>(m(),v("li",{key:b,class:"flex justify-between items-center"},[e("span",At,"Truck #"+o(y.truckid),1),u(d(F),{variant:"outline"},{default:g(()=>[x(o(y.work_order_count),1)]),_:2},1024)]))),128)),f.value.length===0?(m(),v("li",Nt," No data available ")):M("",!0)])])])]))}}),Vt={class:"mb-6"},Pt=C({__name:"DashboardHeader",props:{operationalExcellenceScore:{type:String,default:"Not Available"}},setup(t){const n=t,p=k(()=>{switch(n.operationalExcellenceScore){case"Fantastic +":return"text-green-600";case"Fantastic":return"text-emerald-600";case"Good":return"text-blue-600";case"Fair":return"text-amber-600";case"Poor":return"text-red-600";default:return"text-gray-600"}});return(_,f)=>(m(),v("div",Vt,[e("h2",{class:A(["text-4xl font-bold tracking-tight",[p.value,"transition-colors duration-300"]])},o(t.operationalExcellenceScore),3)]))}}),qt={class:"mb-6"},Et={class:"border-b"},Lt={class:"flex -mb-px space-x-8"},zt=["onClick"],Gt={key:0,class:"mt-2 text-sm text-muted-foreground"},Ht=C({__name:"TimePeriodTabs",props:{dateRangeText:{type:String,default:""}},emits:["tab-change"],setup(t,{emit:n}){const p=[{id:"yesterday",label:"Yesterday"},{id:"current-week",label:"Current Week"},{id:"t6w",label:"T6W Scores"},{id:"quarterly",label:"Quarterly Scores"}],_=q("yesterday"),f=n,i=c=>{_.value=c,f("tab-change",c)};return ce(()=>{f("tab-change",_.value)}),(c,s)=>(m(),v("div",qt,[e("div",Et,[e("div",Lt,[(m(),v(j,null,T(p,a=>e("button",{key:a.id,onClick:y=>i(a.id),class:A(["py-2 px-1 border-b-2 text-sm font-medium transition-colors",_.value===a.id?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground hover:border-muted-foreground"])},o(a.label),11,zt)),64))])]),t.dateRangeText?(m(),v("div",Gt,[e("span",null,o(t.dateRangeText),1)])):M("",!0)]))}}),Ut={class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6 mb-6"},Qt={class:"bg-card rounded-lg border shadow-sm p-4"},Wt={class:"flex items-center justify-between gap-3 mb-4"},Kt={class:"space-y-2 text-sm max-h-40 overflow-y-auto"},It={class:"bg-card rounded-lg border shadow-sm p-4"},Jt={class:"flex items-center justify-between gap-3 mb-4"},Yt={class:"space-y-2 text-sm max-h-40 overflow-y-auto"},Zt={class:"bg-card rounded-lg border shadow-sm p-4"},Xt={class:"flex items-center justify-between gap-3 mb-4"},ea={class:"text-sm mb-2 space-y-2"},ta={class:"flex justify-between"},aa={class:"flex justify-between"},sa={class:"flex justify-between"},na={class:"bg-card rounded-lg border shadow-sm p-4"},ra={class:"flex items-center justify-between gap-3 mb-4"},oa={class:"text-4xl font-bold text-indigo-600"},la={class:"space-y-2 text-sm"},ia={class:"flex justify-between items-center"},da={class:"flex items-center gap-2"},ca={class:"w-12 text-right"},ua={class:"w-16 text-right text-xs text-muted-foreground"},ma={class:"flex justify-between items-center"},fa={class:"flex items-center gap-2"},ga={class:"w-12 text-right"},va={class:"w-16 text-right text-xs text-muted-foreground"},_a={class:"flex justify-between items-center"},ya={class:"flex items-center gap-2"},pa={class:"w-12 text-right"},ba={class:"w-16 text-right text-xs text-muted-foreground"},xa={class:"flex justify-between items-center"},ha={class:"flex items-center gap-2"},wa={class:"w-12 text-right"},Da={class:"w-16 text-right text-xs text-muted-foreground"},$a={class:"flex justify-between items-center"},ka={class:"flex items-center gap-2"},Sa={class:"w-12 text-right"},ja={class:"w-16 text-right text-xs text-muted-foreground"},Ta={class:"text-sm text-muted-foreground mt-3"},Ba=C({__name:"PerformanceCards",props:{performanceData:{type:Object,default:()=>({})},performanceRatings:{type:Object,default:()=>({})},safetyData:{type:Object,default:()=>({})},delayBreakdowns:{type:Array,default:()=>[]},rejectionBreakdowns:{type:Array,default:()=>[]},maintenanceBreakdowns:{type:Object,default:()=>({})}},setup(t){const n=t,p=k(()=>[...n.delayBreakdowns].sort((r,l)=>l.total_delays-r.total_delays).slice(0,3)),_=k(()=>[...n.rejectionBreakdowns].sort((r,l)=>l.total_rejections-r.total_rejections).slice(0,3)),f=r=>r==null?"0%":`${Math.round(parseFloat(r))}%`,i=r=>(typeof r=="string"&&(r=parseFloat(r)),r==null||isNaN(r)?"0":Math.round(r).toString()),c=r=>r==null||typeof r!="number"?"0":Math.round(r).toString(),s=r=>{if(!r)return"Not Available";switch(r){case"gold":return"Gold Tier";case"silver":return"Silver Tier";case"not_eligible":return"Not Eligible";case"fantastic_plus":return"Fantastic+";case"fantastic":return"Fantastic";case"good":return"Good";case"fair":return"Fair";case"poor":return"Poor";default:return r}},a=r=>{if(!r)return"outline";switch(r){case"gold":return"gold";case"silver":return"silver";case"not_eligible":return"not-eligible";case"fantastic_plus":return"fantastic-plus";case"fantastic":return"fantastic";case"good":return"good";case"fair":return"fair";case"poor":return"poor";default:return"outline"}},y=r=>r?r==="Gold Tier"?"gold":r==="Silver Tier"?"silver":r==="Not Eligible"?"not-eligible":"outline":"outline",b=k(()=>{var h;if(!((h=n.safetyData)!=null&&h.ratings))return null;const r=n.safetyData.ratings,l={gold:3,silver:2,not_eligible:1},S=["traffic_light_violation","speeding_violations","following_distance","driver_distraction","sign_violations"];let D="gold";for(const w of S)r[w]&&l[r[w]]<l[D]&&(D=r[w]);switch(D){case"gold":return"Gold Tier";case"silver":return"Silver Tier";case"not_eligible":return"Not Eligible";default:return"Not Available"}}),$=r=>{if(!r)return"text-gray-600";switch(r){case"gold":return"text-amber-600";case"silver":return"text-slate-600";case"not_eligible":return"text-red-600";case"fantastic_plus":return"text-green-600";case"fantastic":return"text-emerald-600";case"good":return"text-blue-600";case"fair":return"text-amber-600";case"poor":return"text-red-600";default:return"text-indigo-600"}};return(r,l)=>{var S,D,h,w,B;return m(),v("div",Ut,[e("div",Qt,[l[0]||(l[0]=e("h3",{class:"text-lg font-semibold mb-2"},"On-Time",-1)),l[1]||(l[1]=e("div",{class:"text-sm text-muted-foreground mb-1"},"Total Score",-1)),e("div",Wt,[e("div",{class:A(["text-4xl font-bold",$(t.performanceRatings.average_on_time)])},o(f(t.performanceData.average_on_time)),3),u(d(F),{variant:a(t.performanceRatings.average_on_time),class:"text-xs"},{default:g(()=>[x(o(s(t.performanceRatings.average_on_time)),1)]),_:1},8,["variant"])]),l[2]||(l[2]=e("div",{class:"text-sm mb-2 flex justify-between"},[e("span",{class:"font-semibold"},"Delays By Reason"),e("span",{class:"font-semibold"},"Total")],-1)),e("div",Kt,[(m(!0),v(j,null,T(p.value,(N,P)=>(m(),v("div",{key:P,class:"flex justify-between"},[e("span",null,o(N.code),1),e("span",null,o(N.total_delays),1)]))),128))])]),e("div",It,[l[3]||(l[3]=e("h3",{class:"text-lg font-semibold mb-2"},"Acceptance",-1)),l[4]||(l[4]=e("div",{class:"text-sm text-muted-foreground mb-1"},"Total Score",-1)),e("div",Jt,[e("div",{class:A(["text-4xl font-bold",$(t.performanceRatings.average_acceptance)])},o(f(t.performanceData.average_acceptance)),3),u(d(F),{variant:a(t.performanceRatings.average_acceptance),class:"text-xs"},{default:g(()=>[x(o(s(t.performanceRatings.average_acceptance)),1)]),_:1},8,["variant"])]),l[5]||(l[5]=e("div",{class:"text-sm mb-2 flex justify-between"},[e("span",{class:"font-semibold"},"Rejections By Reason"),e("span",{class:"font-semibold"},"Total")],-1)),e("div",Yt,[(m(!0),v(j,null,T(_.value,(N,P)=>(m(),v("div",{key:P,class:"flex justify-between"},[e("span",null,o(N.reason_code),1),e("span",null,o(N.total_rejections),1)]))),128))])]),e("div",Zt,[l[9]||(l[9]=e("h3",{class:"text-lg font-semibold mb-2"},"Maintenance",-1)),l[10]||(l[10]=e("div",{class:"text-sm text-muted-foreground mb-1"},"MVtS Score",-1)),e("div",Xt,[e("div",{class:A(["text-4xl font-bold",$(t.performanceRatings.average_maintenance_variance_to_spend)])},o(f(t.performanceData.average_maintenance_variance_to_spend)),3),u(d(F),{variant:a(t.performanceRatings.average_maintenance_variance_to_spend),class:"text-xs"},{default:g(()=>[x(o(s(t.performanceRatings.average_maintenance_variance_to_spend)),1)]),_:1},8,["variant"])]),e("div",ea,[e("div",ta,[l[6]||(l[6]=e("span",null,"Cost per mile",-1)),e("span",null,"$"+o(c(t.maintenanceBreakdowns.cpm)),1)]),e("div",aa,[l[7]||(l[7]=e("span",null,"QS Cost per mile",-1)),e("span",null,"$"+o(c(t.maintenanceBreakdowns.qs_cpm)),1)]),e("div",sa,[l[8]||(l[8]=e("span",null,"QS MVtS",-1)),e("span",null,o(i(t.maintenanceBreakdowns.qs_MVtS)),1)])])]),e("div",na,[l[16]||(l[16]=e("h3",{class:"text-lg font-semibold mb-2"},"Netradyne Alerts Bonus Criteria",-1)),l[17]||(l[17]=e("div",{class:"text-sm text-muted-foreground mb-1"},"Green Zone Score",-1)),e("div",ra,[e("div",oa,o(i(t.safetyData.average_driver_score||"N/A")),1),u(d(F),{variant:y(b.value),class:"text-xs"},{default:g(()=>[x(o(s(b.value)),1)]),_:1},8,["variant"])]),l[18]||(l[18]=e("div",{class:"flex justify-between items-center text-sm font-semibold mb-2"},[e("span",null,"Alert Type"),e("div",{class:"flex items-center gap-2"},[e("span",{class:"w-12 text-right"},"Total"),e("span",{class:"w-16 text-right"},"P1KH")])],-1)),e("div",la,[e("div",ia,[l[11]||(l[11]=e("span",null,"Distracted Driving",-1)),e("div",da,[e("span",ca,o(t.safetyData.driver_distraction),1),e("span",ua,o(i((S=t.safetyData.rates)==null?void 0:S.driver_distraction)),1)])]),e("div",ma,[l[12]||(l[12]=e("span",null,"Speeding",-1)),e("div",fa,[e("span",ga,o(t.safetyData.speeding_violations),1),e("span",va,o(i((D=t.safetyData.rates)==null?void 0:D.speeding_violations)),1)])]),e("div",_a,[l[13]||(l[13]=e("span",null,"Sign Violation",-1)),e("div",ya,[e("span",pa,o(t.safetyData.sign_violations),1),e("span",ba,o(i((h=t.safetyData.rates)==null?void 0:h.sign_violations)),1)])]),e("div",xa,[l[14]||(l[14]=e("span",null,"Traffic Light Violation",-1)),e("div",ha,[e("span",wa,o(t.safetyData.traffic_light_violation),1),e("span",Da,o(i((w=t.safetyData.rates)==null?void 0:w.traffic_light_violation)),1)])]),e("div",$a,[l[15]||(l[15]=e("span",null,"Following Distance",-1)),e("div",ka,[e("span",Sa,o(t.safetyData.following_distance_hard_brake),1),e("span",ja,o(i((B=t.safetyData.rates)==null?void 0:B.following_distance_hard_brake)),1)])])]),e("div",Ta,[e("div",null,"Total Hours Analyzed: "+o(i(t.safetyData.total_hours||0)),1)])])])}}}),Ca={class:"bg-card rounded-lg border shadow-sm p-6 mb-6"},Ra={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},Ma={class:"p-4 border rounded-lg"},Fa={class:"flex items-center justify-between gap-3 mb-3"},Aa={class:"p-4 border rounded-lg"},Na={class:"flex items-center justify-between gap-3 mb-3"},Oa={class:"p-4 border rounded-lg"},Va={class:"flex items-center justify-between gap-3 mb-3"},Pa=C({__name:"AdditionalMetricsCard",props:{performanceData:{type:Object,default:()=>({})},performanceRatings:{type:Object,default:()=>({})}},setup(t){const n=i=>i==null?"0":Math.round(parseFloat(i)).toString(),p=i=>{if(!i)return"Not Available";switch(i){case"fantastic_plus":return"Fantastic+";case"fantastic":return"Fantastic";case"good":return"Good";case"fair":return"Fair";case"poor":return"Poor";default:return i.charAt(0).toUpperCase()+i.slice(1).replace(/_/g," ")}},_=i=>{if(!i)return"outline";switch(i){case"fantastic_plus":return"fantastic-plus";case"fantastic":return"fantastic";case"good":return"good";case"fair":return"fair";case"poor":return"poor";default:return"outline"}},f=i=>{if(!i)return"text-gray-600";switch(i){case"fantastic_plus":return"text-green-600";case"fantastic":return"text-emerald-600";case"good":return"text-blue-600";case"fair":return"text-amber-600";case"poor":return"text-red-600";default:return"text-indigo-600"}};return(i,c)=>(m(),v("div",Ca,[c[6]||(c[6]=e("h3",{class:"text-xl font-semibold mb-4"},"Additional Performance Metrics",-1)),e("div",Ra,[e("div",Ma,[c[0]||(c[0]=e("h4",{class:"text-lg font-medium mb-2"},"VCR-P Preventable",-1)),c[1]||(c[1]=e("div",{class:"text-sm text-muted-foreground mb-1"},"Score",-1)),e("div",Fa,[e("div",{class:A(["text-3xl font-bold",f(t.performanceRatings.vcr_preventable)])},o(n(t.performanceData.vcr_preventable)),3),u(d(F),{variant:_(t.performanceRatings.vcr_preventable),class:"text-xs"},{default:g(()=>[x(o(p(t.performanceRatings.vcr_preventable)),1)]),_:1},8,["variant"])])]),e("div",Aa,[c[2]||(c[2]=e("h4",{class:"text-lg font-medium mb-2"},"Open BOC",-1)),c[3]||(c[3]=e("div",{class:"text-sm text-muted-foreground mb-1"},"Score",-1)),e("div",Na,[e("div",{class:A(["text-3xl font-bold",f(t.performanceRatings.open_boc)])},o(n(t.performanceData.open_boc)),3),u(d(F),{variant:_(t.performanceRatings.open_boc),class:"text-xs"},{default:g(()=>[x(o(p(t.performanceRatings.open_boc)),1)]),_:1},8,["variant"])])]),e("div",Oa,[c[4]||(c[4]=e("h4",{class:"text-lg font-medium mb-2"},"VMCR-P",-1)),c[5]||(c[5]=e("div",{class:"text-sm text-muted-foreground mb-1"},"Score",-1)),e("div",Va,[e("div",{class:A(["text-3xl font-bold",f(t.performanceRatings.vmcr_p)])},o(n(t.performanceData.vmcr_p)),3),u(d(F),{variant:_(t.performanceRatings.vmcr_p),class:"text-xs"},{default:g(()=>[x(o(p(t.performanceRatings.vmcr_p)),1)]),_:1},8,["variant"])])])])]))}}),qa={class:"container mx-auto p-6"},Ea={class:"flex items-center justify-between mb-6"},rs=C({__name:"Summary",props:{tenantSlug:String,summaries:Object,delayBreakdowns:Object,rejectionBreakdowns:Object,maintenanceBreakdowns:Object,dateFilter:String,dateRange:Object},setup(t){const n=t,p=q("on-time"),_=q(n.dateFilter||"yesterday"),f=k(()=>{const l={yesterday:"yesterday","current-week":"current_week",t6w:"rolling_6_weeks",quarterly:"quarterly"}[_.value]||_.value;return y(l)}),i=r=>{p.value=r},c=r=>{_.value=r,E.visit(route("dashboard",{tenantSlug:n.tenantSlug,dateFilter:r}),{preserveState:!0,preserveScroll:!0,only:["summaries","delayBreakdowns","rejectionBreakdowns","maintenanceBreakdowns","dateFilter","dateRange"]})},s=[{title:n.tenantSlug?"Dashboard":"Admin Dashboard",href:n.tenantSlug?route("dashboard",{tenantSlug:n.tenantSlug}):route("admin.dashboard")},{title:"Performance Summary",href:route("dashboard",{tenantSlug:n.tenantSlug})}],a=r=>new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(r),y=r=>{var S,D;if((D=(S=n.summaries)==null?void 0:S[r])!=null&&D.date_range){const h=new Date(n.summaries[r].date_range.start+"T12:00:00"),w=new Date(n.summaries[r].date_range.end+"T12:00:00");return`${b(h)} - ${b(w)}`}const l=new Date;switch(r){case"yesterday":{const h=new Date(l);return h.setDate(h.getDate()-1),b(h)}case"current_week":{const h=new Date(l);h.setDate(l.getDate()-l.getDay());const w=new Date(h);return w.setDate(h.getDate()+6),`${b(h)} - ${b(w)}`}case"rolling_6_weeks":{const h=new Date(l);h.setDate(l.getDate()-l.getDay()+6);const w=new Date(h);return w.setDate(h.getDate()-6*7+1),`${b(w)} - ${b(h)}`}case"quarterly":{const h=new Date(l),w=new Date(l);return w.setMonth(w.getMonth()-3),`${b(w)} - ${b(h)}`}default:return""}},b=r=>new Intl.DateTimeFormat("en-US",{month:"numeric",day:"numeric",year:"numeric"}).format(r),$=k(()=>{var h,w;if(!((w=(h=n.summaries)==null?void 0:h.performance)!=null&&w.ratings))return"Not Available";const r=n.summaries.performance.ratings,l={fantastic_plus:5,fantastic:4,good:3,fair:2,poor:1},S=["average_acceptance","average_on_time","average_maintenance_variance_to_spend","open_boc","vcr_preventable","vmcr_p"];let D="fantastic_plus";for(const B of S)r[B]&&l[r[B]]<l[D]&&(D=r[B]);switch(D){case"fantastic_plus":return"Fantastic +";case"fantastic":return"Fantastic";case"good":return"Good";case"fair":return"Fair";case"poor":return"Poor";default:return"Not Available"}});return(r,l)=>(m(),R(re,{breadcrumbs:s,tenantSlug:t.tenantSlug},{default:g(()=>{var S,D,h,w,B,N,P,U,Q,W,K;return[u(d(ne),{title:"Performance Summary Dashboard"}),e("div",qa,[e("div",Ea,[l[0]||(l[0]=e("h1",{class:"text-2xl font-bold"},null,-1)),u(d(F),{variant:"outline",class:"text-sm"},{default:g(()=>[u(oe,{name:"calendar",class:"mr-1 h-4 w-4"}),x(" Last updated: "+o(a(new Date)),1)]),_:1})]),u(Pt,{operationalExcellenceScore:$.value},null,8,["operationalExcellenceScore"]),u(Ht,{onTabChange:c,dateRangeText:f.value},null,8,["dateRangeText"]),t.summaries?(m(),R(Ba,{key:0,performanceData:((S=t.summaries.performance)==null?void 0:S.data)||{},performanceRatings:((D=t.summaries.performance)==null?void 0:D.ratings)||{},safetyData:t.summaries.safety||{},delayBreakdowns:((h=t.delayBreakdowns)==null?void 0:h.by_code)||[],rejectionBreakdowns:((w=t.rejectionBreakdowns)==null?void 0:w.by_reason)||[],maintenanceBreakdowns:t.maintenanceBreakdowns||{}},null,8,["performanceData","performanceRatings","safetyData","delayBreakdowns","rejectionBreakdowns","maintenanceBreakdowns"])):M("",!0),t.summaries?(m(),R(Pa,{key:1,performanceData:((B=t.summaries.performance)==null?void 0:B.data)||{},performanceRatings:((N=t.summaries.performance)==null?void 0:N.ratings)||{}},null,8,["performanceData","performanceRatings"])):M("",!0),u(pe,{onTabChange:i}),e("div",null,[p.value==="on-time"?(m(),R(Ae,{key:0,delayBreakdownsByDriver:((P=t.delayBreakdowns)==null?void 0:P.by_driver)||[],delayBreakdownsByCode:((U=t.delayBreakdowns)==null?void 0:U.by_code)||[],tenantSlug:t.tenantSlug},null,8,["delayBreakdownsByDriver","delayBreakdownsByCode","tenantSlug"])):M("",!0),p.value==="acceptance"?(m(),R(Ge,{key:1,rejectionBreakdownsByDriver:((Q=t.rejectionBreakdowns)==null?void 0:Q.by_driver)||[],rejectionBreakdownsByReason:((W=t.rejectionBreakdowns)==null?void 0:W.by_reason)||[],tenantSlug:t.tenantSlug},null,8,["rejectionBreakdownsByDriver","rejectionBreakdownsByReason","tenantSlug"])):M("",!0),p.value==="safety"?(m(),R(ot,{key:2,safetyData:((K=t.summaries)==null?void 0:K.safety)||{},tenantSlug:t.tenantSlug},null,8,["safetyData","tenantSlug"])):M("",!0),p.value==="maintenance"?(m(),R(Ot,{key:3,maintenanceData:t.maintenanceBreakdowns||{},tenantSlug:t.tenantSlug},null,8,["maintenanceData","tenantSlug"])):M("",!0)])])]}),_:1},8,["tenantSlug"]))}});export{rs as default};
