import{g as Q,W as Z}from"./vendor-vue-U3hygByY.js";import{_ as Y}from"./AppLayout.vue_vue_type_script_setup_true_lang-CXgYXOP5.js";import{_ as k}from"./Icon.vue_vue_type_script_setup_true_lang-B-9SXevG.js";import{_ as B}from"./Badge.vue_vue_type_script_setup_true_lang-Bn0FBe5D.js";import{d as V,c as R,v as $,e as m,V as e,y as o,aj as O,r as A,z as M,F as z,C as I,l,f as d,x as b,u as c,i as J,w as H,b as D,M as X,W as ee,k as te}from"./vendor-Bo5HMgp9.js";import{_ as ae,a as se,b as K,c as L,d as ne,e as E}from"./TableRow.vue_vue_type_script_setup_true_lang-DlDTWHeS.js";import{_ as q}from"./Button.vue_vue_type_script_setup_true_lang-aefVT2rO.js";import{_ as re}from"./Card.vue_vue_type_script_setup_true_lang-BiSo-lfq.js";import{_ as oe}from"./CardHeader.vue_vue_type_script_setup_true_lang-DnXa1Q0v.js";import{_ as le}from"./CardTitle.vue_vue_type_script_setup_true_lang-Db1edUY4.js";import{_ as ie}from"./CardContent.vue_vue_type_script_setup_true_lang-OH4fMdUO.js";import{_ as ce}from"./Input.vue_vue_type_script_setup_true_lang-CYJ9MQnK.js";import{c as de}from"./utils-olDi9ANG.js";import"./vendor-axios-xsH4HHeE.js";import"./vendor-ui-CdWqhd_O.js";import"./app-DmtAxi3n.js";import"./vendor-icons-CLnRj7LD.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DNzftHcG.js";const ue={class:"mb-6"},me=V({__name:"DashboardHeader",props:{operationalExcellenceScore:{type:String,default:"Not Available"}},setup(s){const f=s,u=R(()=>{switch(f.operationalExcellenceScore){case"Fantastic +":return"text-green-600";case"Fantastic":return"text-emerald-600";case"Good":return"text-blue-600";case"Fair":return"text-amber-600";case"Poor":return"text-red-600";default:return"text-gray-600"}});return(y,p)=>(m(),$("div",ue,[e("h2",{class:O(["text-4xl font-bold tracking-tight",[u.value,"transition-colors duration-300"]])},o(s.operationalExcellenceScore),3)]))}}),fe={class:"mb-6"},ve={class:"border-b"},ge={class:"flex -mb-px space-x-8"},pe=["onClick"],xe={key:0,class:"mt-2 text-sm text-muted-foreground"},be={key:0,class:"ml-1"},ye=V({__name:"TimePeriodTabs",props:{dateRangeText:{type:String,default:""},weekNumber:{type:Number,default:null},startWeekNumber:{type:Number,default:null},endWeekNumber:{type:Number,default:null},year:{type:Number,default:null},activeTabId:{type:String,default:"yesterday"}},emits:["tab-change"],setup(s,{emit:f}){const u=s,y=[{id:"yesterday",label:"Yesterday"},{id:"current-week",label:"WTD"},{id:"t6w",label:"T6W Scores"},{id:"quarterly",label:"Quarterly Scores"}],p=A(u.activeTabId),g=f,x=R(()=>(p.value==="yesterday"||p.value==="current-week")&&u.weekNumber&&u.year?`Week ${u.weekNumber}, ${u.year}`:(p.value==="t6w"||p.value==="quarterly")&&u.startWeekNumber&&u.endWeekNumber&&u.year?`Weeks ${u.startWeekNumber}-${u.endWeekNumber}, ${u.year}`:""),P=C=>{p.value=C,g("tab-change",C)};return(C,w)=>(m(),$("div",fe,[e("div",ve,[e("div",ge,[(m(),$(z,null,I(y,j=>e("button",{key:j.id,onClick:h=>P(j.id),class:O(["py-2 px-1 border-b-2 text-sm font-medium transition-colors",p.value===j.id?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground hover:border-muted-foreground"])},o(j.label),11,pe)),64))])]),s.dateRangeText?(m(),$("div",xe,[e("span",null,o(s.dateRangeText),1),x.value?(m(),$("span",be,"("+o(x.value)+")",1)):M("",!0)])):M("",!0)]))}}),we={class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6 mb-6"},_e={class:"bg-card rounded-lg border shadow-sm p-4"},he={class:"flex items-center justify-between gap-3 mb-4"},ke={class:"space-y-2 text-sm max-h-40 overflow-y-auto"},De={class:"bg-card rounded-lg border shadow-sm p-4"},$e={class:"flex items-center justify-between gap-3 mb-4"},je={class:"space-y-2 text-sm max-h-40 overflow-y-auto"},Se={class:"bg-card rounded-lg border shadow-sm p-4"},Re={class:"flex items-center justify-between gap-3 mb-4"},Ne={class:"text-sm mb-2 space-y-2"},Ce={class:"flex justify-between"},Te={class:"flex justify-between"},Be={class:"flex justify-between"},Fe={class:"flex justify-between"},Pe={class:"bg-card rounded-lg border shadow-sm p-4"},Ae={class:"flex items-center justify-between gap-3 mb-4"},Oe={class:"text-4xl font-bold text-indigo-600"},Me={class:"space-y-2 text-sm"},Ve={class:"flex justify-between items-center"},We={class:"flex items-center gap-2"},Ee={class:"w-12 text-right"},ze={class:"w-16 text-right"},Ie={class:"flex justify-between items-center"},Ge={class:"flex items-center gap-2"},Le={class:"w-12 text-right"},qe={class:"w-16 text-right"},Ue={class:"flex justify-between items-center"},He={class:"flex items-center gap-2"},Ke={class:"w-12 text-right"},Qe={class:"w-16 text-right"},Ze={class:"flex justify-between items-center"},Ye={class:"flex items-center gap-2"},Je={class:"w-12 text-right"},Xe={class:"w-16 text-right"},et={class:"flex justify-between items-center"},tt={class:"flex items-center gap-2"},at={class:"w-12 text-right"},st={class:"w-16 text-right"},nt={class:"text-sm text-muted-foreground mt-3"},rt=V({__name:"PerformanceCards",props:{performanceData:{type:Object,default:()=>({})},performanceRatings:{type:Object,default:()=>({})},safetyData:{type:Object,default:()=>({})},delayBreakdowns:{type:Array,default:()=>[]},rejectionBreakdowns:{type:Array,default:()=>[]},maintenanceBreakdowns:{type:Object,default:()=>({})}},setup(s){const f=s,u=R(()=>[...f.delayBreakdowns].sort((t,a)=>a.total_delays-t.total_delays).slice(0,3)),y=R(()=>[...f.rejectionBreakdowns].sort((t,a)=>a.total_rejections-t.total_rejections).slice(0,3)),p=t=>t==null?"0%":`${Math.round(parseFloat(t))}%`,g=t=>(typeof t=="string"&&(t=parseFloat(t)),t==null||isNaN(t)?"0":Math.round(t).toString()),x=t=>(typeof t=="string"&&(t=parseFloat(t)),t==null||isNaN(t)?"0.00":t.toFixed(2)),P=t=>(typeof t=="string"&&(t=parseFloat(t)),t==null||isNaN(t)?"0.00":t.toFixed(2)),C=t=>{if(!t)return"Not Available";switch(t){case"gold":return"Gold Tier";case"silver":return"Silver Tier";case"not_eligible":return"Not Eligible";case"fantastic_plus":return"Fantastic +";case"fantastic":return"Fantastic";case"good":return"Good";case"fair":return"Fair";case"poor":return"Poor";default:return t}},w=t=>{if(!t)return"outline";switch(t){case"gold":return"gold";case"silver":return"silver";case"not_eligible":return"not-eligible";case"fantastic_plus":return"fantastic-plus";case"fantastic":return"fantastic";case"good":return"good";case"fair":return"fair";case"poor":return"poor";default:return"outline"}},j=t=>t?t==="Gold Tier"?"gold":t==="Silver Tier"?"silver":t==="Not Eligible"?"not-eligible":"outline":"outline",h=R(()=>{var v;if(!((v=f.safetyData)!=null&&v.ratings))return null;const t=f.safetyData.ratings,a={gold:3,silver:2,not_eligible:1},N=["traffic_light_violation","speeding_violations","following_distance","driver_distraction","sign_violations"];let _="gold";for(const i of N)t[i]&&a[t[i]]<a[_]&&(_=t[i]);switch(_){case"gold":return"Gold Tier";case"silver":return"Silver Tier";case"not_eligible":return"Not Eligible";default:return"Not Available"}}),F=t=>{if(!t)return"text-gray-600";switch(t){case"gold":return"text-amber-600";case"silver":return"text-slate-600";case"not_eligible":return"text-red-600";case"fantastic_plus":return"text-green-600";case"fantastic":return"text-emerald-600";case"good":return"text-blue-600";case"fair":return"text-amber-600";case"poor":return"text-red-600";default:return"text-indigo-600"}};return(t,a)=>{var N,_,v,i,n;return m(),$("div",we,[e("div",_e,[a[0]||(a[0]=e("h3",{class:"text-base font-semibold mb-1"},"Acceptance",-1)),a[1]||(a[1]=e("div",{class:"text-xs text-muted-foreground mb-1"},"Total Score",-1)),e("div",he,[e("div",{class:O(["text-4xl font-bold",F(s.performanceRatings.average_acceptance)])},o(p(s.performanceData.average_acceptance)),3),l(c(B),{variant:w(s.performanceRatings.average_acceptance),class:"text-xs"},{default:d(()=>[b(o(C(s.performanceRatings.average_acceptance)),1)]),_:1},8,["variant"])]),a[2]||(a[2]=e("div",{class:"text-sm mb-2 flex justify-between"},[e("span",{class:"font-semibold"},"Rejections by Reason"),e("span",{class:"font-semibold"},"Total")],-1)),e("div",ke,[(m(!0),$(z,null,I(y.value,(r,S)=>(m(),$("div",{key:S,class:"flex justify-between"},[e("span",null,o(r.reason_code),1),e("span",null,o(r.total_rejections),1)]))),128))])]),e("div",De,[a[3]||(a[3]=e("h3",{class:"text-base font-semibold mb-1"},"On-Time",-1)),a[4]||(a[4]=e("div",{class:"text-xs text-muted-foreground mb-1"},"Total Score",-1)),e("div",$e,[e("div",{class:O(["text-4xl font-bold",F(s.performanceRatings.average_on_time)])},o(p(s.performanceData.average_on_time)),3),l(c(B),{variant:w(s.performanceRatings.average_on_time),class:"text-xs"},{default:d(()=>[b(o(C(s.performanceRatings.average_on_time)),1)]),_:1},8,["variant"])]),a[5]||(a[5]=e("div",{class:"text-sm mb-2 flex justify-between"},[e("span",{class:"font-semibold"},"Delays by Reason"),e("span",{class:"font-semibold"},"Total")],-1)),e("div",je,[(m(!0),$(z,null,I(u.value,(r,S)=>(m(),$("div",{key:S,class:"flex justify-between"},[e("span",null,o(r.code),1),e("span",null,o(r.total_delays),1)]))),128))])]),e("div",Se,[a[10]||(a[10]=e("h3",{class:"text-base font-semibold mb-1"},"Maintenance",-1)),a[11]||(a[11]=e("div",{class:"text-xs text-muted-foreground mb-1"},"MVtS Score",-1)),e("div",Re,[e("div",{class:O(["text-4xl font-bold",F(s.performanceRatings.average_maintenance_variance_to_spend)])},o(p(s.performanceData.average_maintenance_variance_to_spend)),3),l(c(B),{variant:w(s.performanceRatings.average_maintenance_variance_to_spend),class:"text-xs"},{default:d(()=>[b(o(C(s.performanceRatings.average_maintenance_variance_to_spend)),1)]),_:1},8,["variant"])]),e("div",Ne,[e("div",Ce,[a[6]||(a[6]=e("span",null,"Cost per mile",-1)),e("span",null,"$"+o(P(s.maintenanceBreakdowns.cpm)),1)]),e("div",Te,[a[7]||(a[7]=e("span",null,"Num of WOs",-1)),e("span",null,o(s.maintenanceBreakdowns.total_repair_orders),1)]),e("div",Be,[a[8]||(a[8]=e("span",null,"Current Costs",-1)),e("span",null,"$"+o(P(s.maintenanceBreakdowns.total_invoice_amount)),1)]),e("div",Fe,[a[9]||(a[9]=e("span",null,"Missing Invoices",-1)),e("span",null,o(s.maintenanceBreakdowns.missing_invoices_count||0),1)])])]),e("div",Pe,[a[17]||(a[17]=e("h3",{class:"text-base font-semibold mb-1"},"Netradyne Alerts Bonus Criteria",-1)),a[18]||(a[18]=e("div",{class:"text-xs text-muted-foreground mb-1"},"Green Zone Score",-1)),e("div",Ae,[e("div",Oe,o(g(s.safetyData.average_driver_score||"N/A")),1),l(c(B),{variant:j(h.value),class:"text-xs"},{default:d(()=>[b(o(C(h.value)),1)]),_:1},8,["variant"])]),a[19]||(a[19]=e("div",{class:"flex justify-between items-center text-sm font-semibold mb-2"},[e("span",null,"Alert Type"),e("div",{class:"flex items-center gap-2"},[e("span",{class:"w-12 text-right"},"Total"),e("span",{class:"w-16 text-right"},"P1KH")])],-1)),e("div",Me,[e("div",Ve,[a[12]||(a[12]=e("span",null,"Distracted Driving",-1)),e("div",We,[e("span",Ee,o(g(s.safetyData.driver_distraction)),1),e("span",ze,o(x((N=s.safetyData.rates)==null?void 0:N.driver_distraction)),1)])]),e("div",Ie,[a[13]||(a[13]=e("span",null,"Speeding",-1)),e("div",Ge,[e("span",Le,o(g(s.safetyData.speeding_violations)),1),e("span",qe,o(x((_=s.safetyData.rates)==null?void 0:_.speeding_violations)),1)])]),e("div",Ue,[a[14]||(a[14]=e("span",null,"Sign Violation",-1)),e("div",He,[e("span",Ke,o(g(s.safetyData.sign_violations)),1),e("span",Qe,o(x((v=s.safetyData.rates)==null?void 0:v.sign_violations)),1)])]),e("div",Ze,[a[15]||(a[15]=e("span",null,"Traffic Light Violation",-1)),e("div",Ye,[e("span",Je,o(g(s.safetyData.traffic_light_violation)),1),e("span",Xe,o(x((i=s.safetyData.rates)==null?void 0:i.traffic_light_violation)),1)])]),e("div",et,[a[16]||(a[16]=e("span",null,"Following Distance",-1)),e("div",tt,[e("span",at,o(g(s.safetyData.following_distance)),1),e("span",st,o(x((n=s.safetyData.rates)==null?void 0:n.following_distance)),1)])])]),e("div",nt,[e("div",null,"Total Hours Analyzed: "+o(g(s.safetyData.total_hours||0)),1)])])])}}}),ot={class:"bg-card rounded-lg border shadow-sm p-6 mb-6"},lt={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},it={class:"p-4 border rounded-lg"},ct={class:"flex items-center justify-between gap-3 mb-3"},dt={class:"p-4 border rounded-lg"},ut={class:"flex items-center justify-between gap-3 mb-3"},mt={class:"p-4 border rounded-lg"},ft={class:"flex items-center justify-between gap-3 mb-3"},vt=V({__name:"AdditionalMetricsCard",props:{performanceData:{type:Object,default:()=>({})},performanceRatings:{type:Object,default:()=>({})}},setup(s){const f=g=>g==null?"0":Math.round(parseFloat(g)).toString(),u=g=>{if(!g)return"Not Available";switch(g){case"fantastic_plus":return"Fantastic +";case"fantastic":return"Fantastic";case"good":return"Good";case"fair":return"Fair";case"poor":return"Poor";default:return g.charAt(0).toUpperCase()+g.slice(1).replace(/_/g," ")}},y=g=>{if(!g)return"outline";switch(g){case"fantastic_plus":return"fantastic-plus";case"fantastic":return"fantastic";case"good":return"good";case"fair":return"fair";case"poor":return"poor";default:return"outline"}},p=g=>{if(!g)return"text-gray-600";switch(g){case"fantastic_plus":return"text-green-600";case"fantastic":return"text-emerald-600";case"good":return"text-blue-600";case"fair":return"text-amber-600";case"poor":return"text-red-600";default:return"text-indigo-600"}};return(g,x)=>(m(),$("div",ot,[x[6]||(x[6]=e("h3",{class:"text-xl font-semibold mb-4"},"Additional Performance Metrics",-1)),e("div",lt,[e("div",it,[x[0]||(x[0]=e("h4",{class:"text-lg font-medium mb-2"},"VCR-P",-1)),x[1]||(x[1]=e("div",{class:"text-sm text-muted-foreground mb-1"},"Count",-1)),e("div",ct,[e("div",{class:O(["text-3xl font-bold",p(s.performanceRatings.vcr_preventable)])},o(f(s.performanceData.vcr_preventable)),3),l(c(B),{variant:y(s.performanceRatings.vcr_preventable),class:"text-xs"},{default:d(()=>[b(o(u(s.performanceRatings.vcr_preventable)),1)]),_:1},8,["variant"])])]),e("div",dt,[x[2]||(x[2]=e("h4",{class:"text-lg font-medium mb-2"},"VMCR-P",-1)),x[3]||(x[3]=e("div",{class:"text-sm text-muted-foreground mb-1"},"Count",-1)),e("div",ut,[e("div",{class:O(["text-3xl font-bold",p(s.performanceRatings.vmcr_p)])},o(f(s.performanceData.vmcr_p)),3),l(c(B),{variant:y(s.performanceRatings.vmcr_p),class:"text-xs"},{default:d(()=>[b(o(u(s.performanceRatings.vmcr_p)),1)]),_:1},8,["variant"])])]),e("div",mt,[x[4]||(x[4]=e("h4",{class:"text-lg font-medium mb-2"},"Open BOC",-1)),x[5]||(x[5]=e("div",{class:"text-sm text-muted-foreground mb-1"},"Count",-1)),e("div",ft,[e("div",{class:O(["text-3xl font-bold",p(s.performanceRatings.open_boc)])},o(f(s.performanceData.open_boc)),3),l(c(B),{variant:y(s.performanceRatings.open_boc),class:"text-xs"},{default:d(()=>[b(o(u(s.performanceRatings.open_boc)),1)]),_:1},8,["variant"])])])])]))}}),gt=V({__name:"CardDescription",props:{class:{}},setup(s){const f=s;return(u,y)=>(m(),$("p",{class:O(c(de)("text-sm text-muted-foreground",f.class))},[J(u.$slots,"default")],2))}}),pt={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-2"},xt={class:"flex items-center gap-2"},bt={class:"relative w-full md:w-auto"},yt={class:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"},wt={class:"overflow-x-auto"},_t={class:"flex items-center gap-1"},ht={class:"flex items-center justify-end gap-1"},kt={class:"flex items-center justify-end gap-1"},Dt={class:"flex items-center justify-end gap-1"},$t={class:"flex flex-col items-center justify-center gap-2"},jt={key:0},St={key:1},Rt={class:"border-t bg-muted/20 px-4 py-3 flex flex-col sm:flex-row justify-between items-center gap-2"},Nt={class:"flex items-center gap-4 text-sm text-muted-foreground"},Ct={class:"flex items-center gap-1"},Tt={class:"flex items-center gap-1"},Bt={class:"relative"},Ft=["value"],Pt={class:"flex space-x-1"},At=V({__name:"DriverPerformanceTable",props:{driversData:{type:Array,default:()=>[]}},setup(s){const f=s,u=A(""),y=A("overall_score"),p=A("desc"),g=i=>{y.value===i?p.value=p.value==="asc"?"desc":"asc":(y.value=i,p.value=i==="driver_name"?"asc":"desc")},x=()=>{u.value="",y.value="overall_score",p.value="desc",w.value=1,j.value=10},P=R(()=>{if(!f.driversData||f.driversData.length===0)return[];if(!u.value)return f.driversData;const i=u.value.toLowerCase();return f.driversData.filter(n=>n.driver_name.toLowerCase().includes(i))}),C=R(()=>P.value.length===0?[]:[...P.value].sort((i,n)=>{const r=i[y.value],S=n[y.value];return typeof r=="string"?p.value==="asc"?r.localeCompare(S):S.localeCompare(r):p.value==="asc"?r-S:S-r})),w=A(1),j=A(10);H([y,p,u],()=>{w.value=1}),H(j,()=>{w.value=1});const h=R(()=>C.value.length),F=R(()=>Math.max(1,Math.ceil(h.value/j.value)));H([F,w],()=>{w.value>F.value&&(w.value=F.value)});const t=R(()=>{const i=F.value,n=w.value;if(i<=5)return Array.from({length:i},(T,U)=>U+1);let r=[1,i];const S=[n-1,n,n+1].filter(T=>T>1&&T<i);r.push(...S),r=[...new Set(r)].sort((T,U)=>T-U);const W=[];let G=0;for(const T of r)T-G>1&&W.push(-1),W.push(T),G=T;return W}),a=R(()=>(w.value-1)*j.value),N=R(()=>Math.min(a.value+j.value,h.value)),_=R(()=>C.value.slice(a.value,N.value)),v=i=>i>=90?"success":i>=75?"default":i>=60?"warning":"destructive";return(i,n)=>(m(),D(c(re),{class:"shadow-sm border bg-card"},{default:d(()=>[l(c(oe),{class:"p-4 border-b"},{default:d(()=>[e("div",pt,[e("div",null,[l(c(le),{class:"text-lg font-semibold flex items-center gap-2"},{default:d(()=>[l(k,{name:"users",class:"h-5 w-5 text-primary"}),n[9]||(n[9]=b(" Driver Performance "))]),_:1}),l(gt,null,{default:d(()=>n[10]||(n[10]=[b("Overall driver performance metrics")])),_:1})]),e("div",xt,[e("div",bt,[e("div",yt,[l(k,{name:"search",class:"h-4 w-4 text-muted-foreground"})]),l(c(ce),{modelValue:u.value,"onUpdate:modelValue":n[0]||(n[0]=r=>u.value=r),placeholder:"Search drivers...",class:"pl-10 w-full md:w-[200px]"},null,8,["modelValue"])]),l(c(q),{variant:"outline",size:"sm",onClick:x,class:"hidden md:flex items-center gap-1"},{default:d(()=>[l(k,{name:"rotate-ccw",class:"h-4 w-4"}),n[11]||(n[11]=b(" Reset "))]),_:1})])])]),_:1}),l(c(ie),{class:"p-0"},{default:d(()=>[e("div",wt,[l(c(ae),{class:"relative h-[500px] overflow-auto"},{default:d(()=>[l(c(se),null,{default:d(()=>[l(c(K),{class:"sticky top-0 z-10 border-b bg-background hover:bg-background"},{default:d(()=>[l(c(L),{class:"w-12 text-center"},{default:d(()=>n[12]||(n[12]=[e("div",{class:"flex items-center justify-center"}," # ",-1)])),_:1}),l(c(L),{onClick:n[1]||(n[1]=r=>g("driver_name")),class:"cursor-pointer whitespace-nowrap"},{default:d(()=>[e("div",_t,[n[13]||(n[13]=b(" Driver Name ")),y.value==="driver_name"?(m(),D(k,{key:0,name:p.value==="asc"?"arrow-up":"arrow-down",class:"h-4 w-4"},null,8,["name"])):(m(),D(k,{key:1,name:"arrow-up-down",class:"h-4 w-4 opacity-50"}))])]),_:1}),l(c(L),{onClick:n[2]||(n[2]=r=>g("acceptance_score")),class:"cursor-pointer text-right whitespace-nowrap"},{default:d(()=>[e("div",ht,[n[14]||(n[14]=b(" Acceptance ")),y.value==="acceptance_score"?(m(),D(k,{key:0,name:p.value==="asc"?"arrow-up":"arrow-down",class:"h-4 w-4"},null,8,["name"])):(m(),D(k,{key:1,name:"arrow-up-down",class:"h-4 w-4 opacity-50"}))])]),_:1}),l(c(L),{onClick:n[3]||(n[3]=r=>g("on_time_score")),class:"cursor-pointer text-right whitespace-nowrap"},{default:d(()=>[e("div",kt,[n[15]||(n[15]=b(" On-Time ")),y.value==="on_time_score"?(m(),D(k,{key:0,name:p.value==="asc"?"arrow-up":"arrow-down",class:"h-4 w-4"},null,8,["name"])):(m(),D(k,{key:1,name:"arrow-up-down",class:"h-4 w-4 opacity-50"}))])]),_:1}),l(c(L),{onClick:n[4]||(n[4]=r=>g("safety_score")),class:"cursor-pointer text-right whitespace-nowrap"},{default:d(()=>[e("div",Dt,[n[16]||(n[16]=b(" Green Zone Score ")),y.value==="safety_score"?(m(),D(k,{key:0,name:p.value==="asc"?"arrow-up":"arrow-down",class:"h-4 w-4"},null,8,["name"])):(m(),D(k,{key:1,name:"arrow-up-down",class:"h-4 w-4 opacity-50"}))])]),_:1})]),_:1})]),_:1}),l(c(ne),null,{default:d(()=>[(m(!0),$(z,null,I(_.value,(r,S)=>(m(),D(c(K),{key:r.driver_name,class:"hover:bg-muted/20 transition-colors"},{default:d(()=>[l(c(E),{class:"text-center"},{default:d(()=>[l(c(B),{variant:"outline",class:"min-w-[28px] justify-center"},{default:d(()=>[b(o(a.value+S+1),1)]),_:2},1024)]),_:2},1024),l(c(E),{class:"font-medium"},{default:d(()=>[b(o(r.driver_name),1)]),_:2},1024),l(c(E),{class:"text-right"},{default:d(()=>[l(c(B),{variant:v(r.acceptance_score)},{default:d(()=>[b(o(r.acceptance_score)+"% ",1)]),_:2},1032,["variant"])]),_:2},1024),l(c(E),{class:"text-right"},{default:d(()=>[l(c(B),{variant:v(r.on_time_score)},{default:d(()=>[b(o(r.on_time_score)+"% ",1)]),_:2},1032,["variant"])]),_:2},1024),l(c(E),{class:"text-right"},{default:d(()=>[l(c(B),{variant:v(r.safety_score)},{default:d(()=>n[17]||(n[17]=[b(" 1050 ")])),_:2},1032,["variant"])]),_:2},1024)]),_:2},1024))),128)),P.value.length===0?(m(),D(c(K),{key:0},{default:d(()=>[l(c(E),{colspan:"6",class:"text-center py-8 text-muted-foreground"},{default:d(()=>[e("div",$t,[l(k,{name:"users-x",class:"h-10 w-10 opacity-50"}),u.value?(m(),$("p",jt,'No drivers found matching "'+o(u.value)+'"',1)):(m(),$("p",St,"No driver performance data available for the selected period.")),u.value?(m(),D(c(q),{key:2,variant:"outline",size:"sm",onClick:n[5]||(n[5]=r=>u.value="")},{default:d(()=>n[18]||(n[18]=[b(" Clear search ")])),_:1})):M("",!0)])]),_:1})]),_:1})):M("",!0)]),_:1})]),_:1})]),e("div",Rt,[e("div",Nt,[e("span",Ct,[l(k,{name:"list",class:"h-4 w-4"}),b(" Showing "+o(a.value+1)+"-"+o(N.value)+" of "+o(h.value)+" drivers ",1)]),e("span",Tt,[l(k,{name:"layout-grid",class:"h-4 w-4"}),n[19]||(n[19]=b(" Per page: "))]),e("div",Bt,[X(e("select",{"onUpdate:modelValue":n[6]||(n[6]=r=>j.value=r),class:"h-8 appearance-none rounded-md border bg-background px-2 py-1 text-sm focus:ring-2 focus:ring-ring"},[(m(),$(z,null,I([5,10,20,50],r=>e("option",{key:r,value:r},o(r),9,Ft)),64))],512),[[ee,j.value,void 0,{number:!0}]]),n[20]||(n[20]=e("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[e("svg",{class:"h-4 w-4 opacity-50",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])],-1))])]),e("div",Pt,[l(c(q),{size:"sm",variant:"ghost",onClick:n[7]||(n[7]=r=>w.value--),disabled:w.value===1,class:"flex items-center gap-1"},{default:d(()=>[l(k,{name:"chevron-left",class:"h-4 w-4"}),n[21]||(n[21]=b(" Prev "))]),_:1},8,["disabled"]),(m(!0),$(z,null,I(t.value,r=>(m(),D(c(q),{key:r,size:"sm",variant:"ghost",onClick:S=>r!==-1?w.value=r:null,class:O({"border-primary bg-primary/10 text-primary font-medium":r===w.value,"opacity-50 pointer-events-none":r===-1})},{default:d(()=>[b(o(r===-1?"...":r),1)]),_:2},1032,["onClick","class"]))),128)),l(c(q),{size:"sm",variant:"ghost",onClick:n[8]||(n[8]=r=>w.value++),disabled:w.value===F.value,class:"flex items-center gap-1"},{default:d(()=>[n[22]||(n[22]=b(" Next ")),l(k,{name:"chevron-right",class:"h-4 w-4"})]),_:1},8,["disabled"])])])]),_:1})]),_:1}))}}),Ot={class:"container w-full md:max-w-2xl lg:max-w-3xl xl:max-w-6xl lg:mx-auto m-0 p-2 md:p-4 lg:p-6 space-y-2 md:space-y-4 lg:space-y-6"},Mt={class:"flex items-center justify-between mb-6"},Vt={class:"h-auto"},sa=V({__name:"Summary",props:{tenantSlug:String,summaries:Object,delayBreakdowns:Object,rejectionBreakdowns:Object,maintenanceBreakdowns:Object,dateFilter:String,dateRange:Object,milesEntries:Object,driversOverallPerformance:Object},setup(s){const f=s;A("on-time");const u=A(f.dateFilter||"t6w"),y=A(null),p=A(null);te(()=>{});const g=R(()=>{const a={yesterday:"yesterday","current-week":"current_week",t6w:"rolling_6_weeks",quarterly:"quarterly"}[u.value]||u.value;return j(a)}),x=t=>{u.value=t,Z.visit(route("dashboard",{tenantSlug:f.tenantSlug,dateFilter:t,minInvoiceAmount:y.value||null,outstandingDate:p.value||null}),{only:["summaries","delayBreakdowns","rejectionBreakdowns","maintenanceBreakdowns","dateFilter","dateRange","milesEntries"]})},P=[{title:f.tenantSlug?"Dashboard":"Admin Dashboard",href:f.tenantSlug?route("dashboard",{tenantSlug:f.tenantSlug}):route("admin.dashboard")},{title:"Performance Summary",href:route("dashboard",{tenantSlug:f.tenantSlug})}],C=R(()=>{var t,a;return(a=(t=f.summaries)==null?void 0:t.performance)!=null&&a.last_updated?w(new Date(f.summaries.performance.last_updated)):w(new Date)}),w=t=>new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(t),j=t=>{var N,_;if((_=(N=f.summaries)==null?void 0:N[t])!=null&&_.date_range){const v=new Date(f.summaries[t].date_range.start+"T12:00:00"),i=new Date(f.summaries[t].date_range.end+"T12:00:00");return`${h(v)} - ${h(i)}`}const a=new Date;switch(t){case"yesterday":{const v=new Date(a);return v.setDate(v.getDate()-1),h(v)}case"current_week":{const v=new Date(a);v.setDate(a.getDate()-a.getDay());const i=new Date(v);return i.setDate(v.getDate()+6),`${h(v)} - ${h(i)}`}case"rolling_6_weeks":{const v=new Date(a);v.setDate(a.getDate()-a.getDay()+6);const i=new Date(v);return i.setDate(v.getDate()-6*7+1),`${h(i)} - ${h(v)}`}case"quarterly":{const v=new Date(a),i=new Date(a);return i.setMonth(i.getMonth()-3),`${h(i)} - ${h(v)}`}default:return""}},h=t=>new Intl.DateTimeFormat("en-US",{month:"numeric",day:"numeric",year:"numeric"}).format(t),F=R(()=>{var v,i;if(!((i=(v=f.summaries)==null?void 0:v.performance)!=null&&i.ratings))return"Not Available";const t=f.summaries.performance.ratings,a={fantastic_plus:5,fantastic:4,good:3,fair:2,poor:1},N=["average_acceptance","average_on_time","average_maintenance_variance_to_spend","open_boc","vcr_preventable","vmcr_p"];let _="fantastic_plus";for(const n of N)t[n]&&a[t[n]]<a[_]&&(_=t[n]);switch(_){case"fantastic_plus":return"Fantastic +";case"fantastic":return"Fantastic";case"good":return"Good";case"fair":return"Fair";case"poor":return"Poor";default:return"Not Available"}});return(t,a)=>(m(),D(Y,{breadcrumbs:P,tenantSlug:s.tenantSlug},{default:d(()=>{var N,_,v,i,n,r,S,W,G,T;return[l(c(Q),{title:"Performance Summary Dashboard"}),e("div",Ot,[e("div",Mt,[a[0]||(a[0]=e("h1",{class:"text-2xl font-bold"},null,-1)),l(c(B),{variant:"outline",class:"text-sm"},{default:d(()=>[l(k,{name:"calendar",class:"mr-1 h-4 w-4"}),b(" Last updated: "+o(C.value),1)]),_:1})]),l(me,{operationalExcellenceScore:F.value},null,8,["operationalExcellenceScore"]),l(ye,{onTabChange:x,dateRangeText:g.value,weekNumber:(N=s.dateRange)==null?void 0:N.weekNumber,startWeekNumber:(_=s.dateRange)==null?void 0:_.startWeekNumber,endWeekNumber:(v=s.dateRange)==null?void 0:v.endWeekNumber,year:(i=s.dateRange)==null?void 0:i.year,activeTabId:u.value},null,8,["dateRangeText","weekNumber","startWeekNumber","endWeekNumber","year","activeTabId"]),s.summaries?(m(),D(rt,{key:0,performanceData:((n=s.summaries.performance)==null?void 0:n.data)||{},performanceRatings:((r=s.summaries.performance)==null?void 0:r.ratings)||{},safetyData:s.summaries.safety||{},delayBreakdowns:((S=s.delayBreakdowns)==null?void 0:S.by_code)||[],rejectionBreakdowns:((W=s.rejectionBreakdowns)==null?void 0:W.by_reason)||[],maintenanceBreakdowns:s.maintenanceBreakdowns||{}},null,8,["performanceData","performanceRatings","safetyData","delayBreakdowns","rejectionBreakdowns","maintenanceBreakdowns"])):M("",!0),e("div",Vt,[s.driversOverallPerformance?(m(),D(At,{key:0,driversData:s.driversOverallPerformance.drivers||[]},null,8,["driversData"])):M("",!0)]),s.summaries?(m(),D(vt,{key:1,performanceData:((G=s.summaries.performance)==null?void 0:G.data)||{},performanceRatings:((T=s.summaries.performance)==null?void 0:T.ratings)||{}},null,8,["performanceData","performanceRatings"])):M("",!0)])]}),_:1},8,["tenantSlug"]))}});export{sa as default};
