import{J as Je,E as ye,a7 as m,N as i,an as o,a6 as k,a1 as t,O as s,ae as d,a4 as T,ao as z,I as n,a9 as A,aa as L,af as y,a8 as we,B as C,A as Q,a0 as Qe,am as Ke,L as N,aR as K,aS as Xe}from"./vendor-DW_gyfXE.js";import{x as X,g as Ze,W as V}from"./vendor-vue-BIhQdEdd.js";import{_ as et}from"./AppLayout.vue_vue_type_script_setup_true_lang-DnDcxt42.js";import{_ as g}from"./Button.vue_vue_type_script_setup_true_lang-CZMgI4AI.js";import{_ as se,a as ne,b as ae,c as de,d as re}from"./DialogTitle.vue_vue_type_script_setup_true_lang-BAHS8JjQ.js";import{_ as fe}from"./DialogFooter.vue_vue_type_script_setup_true_lang-CMVRlm2Q.js";import{_ as S,a as P}from"./Label.vue_vue_type_script_setup_true_lang-gg10UQW6.js";import{_ as tt}from"./Checkbox.vue_vue_type_script_setup_true_lang-DAbelC7L.js";import{_ as $}from"./Icon.vue_vue_type_script_setup_true_lang-C-mirX2J.js";import{_ as lt,a as ot,b as ve,c as me,d as st,e as ie}from"./TableRow.vue_vue_type_script_setup_true_lang-CgXPUvWo.js";import{_ as pe}from"./Card.vue_vue_type_script_setup_true_lang-Cv_RhfZi.js";import{_ as nt,a as at}from"./CardTitle.vue_vue_type_script_setup_true_lang-DvbDsVuE.js";import{_ as ce}from"./CardContent.vue_vue_type_script_setup_true_lang-CJoJj2cM.js";import{_ as ke,a as Ce,b as _e}from"./AlertDescription.vue_vue_type_script_setup_true_lang-faxB04Ew.js";import"./vendor-d3-CjigyTW8.js";import"./vendor-axios-xsH4HHeE.js";import"./utils-BCw79v42.js";import"./vendor-ui-m5Us76-N.js";import"./app-B0NuZhfC.js";import"./vendor-icons-DY85x-Wz.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BHAHC43q.js";const dt={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},rt={key:0,class:"col-span-full"},it={class:"relative"},ut=["value"],ft={class:"col-span-full"},mt={class:"relative"},vt={class:"relative"},pt={class:"relative"},ct=["value"],yt={class:"relative"},gt={class:"flex items-center space-x-2"},bt={class:"flex-col space-y-2 sm:space-y-0 sm:flex-row sm:justify-end sm:space-x-2 pt-4 border-t flex"},xt=Je({__name:"DelayForm",props:{delay:{type:Object,default:null},delayCodes:{type:Array,default:()=>[]},tenants:{type:Array,default:()=>[]},isSuperAdmin:{type:Boolean,default:!1},tenantSlug:{type:String,default:null}},emits:["close"],setup(b,{emit:v}){var F,U,M,Z,D,h,O;const _=b,j=v,p=X({id:(F=_.delay)==null?void 0:F.id,tenant_id:_.isSuperAdmin?(U=_.delay)==null?void 0:U.tenant_id:null,date:((M=_.delay)==null?void 0:M.date)||"",driver_name:((Z=_.delay)==null?void 0:Z.driver_name)||"",delay_type:((D=_.delay)==null?void 0:D.delay_type)||"origin",delay_category:((h=_.delay)==null?void 0:h.delay_category)||"1_120",delay_code_id:((O=_.delay)==null?void 0:O.delay_code_id)||null,disputed:_.delay&&_.delay.disputed!==null?parseInt(_.delay.disputed)===1:!1,driver_controllable:_.delay&&_.delay.driver_controllable!==null?parseInt(_.delay.driver_controllable)===1:null});ye(()=>_.delay,x=>{x?(p.id=x.id,p.tenant_id=x.tenant_id,p.date=x.date,p.driver_name=x.driver_name,p.delay_type=x.delay_type,p.delay_category=x.delay_category,p.delay_code_id=x.delay_code_id,p.disputed=x.disputed!==null?parseInt(x.disputed)===1:!1,p.driver_controllable=x.driver_controllable!==null?parseInt(x.driver_controllable)===1:null):p.reset()},{immediate:!0});const R=()=>{const x=!!p.id,r=_.isSuperAdmin?x?"ontime.update.admin":"ontime.store.admin":x?"ontime.update":"ontime.store",c=_.isSuperAdmin?x?{delay:p.id}:{}:x?{tenantSlug:_.tenantSlug,delay:p.id}:{tenantSlug:_.tenantSlug};p[x?"put":"post"](route(r,c),{onSuccess:()=>j("close")})};return(x,r)=>(i(),m("form",{onSubmit:we(R,["prevent"]),class:"space-y-6"},[o("div",dt,[b.isSuperAdmin?(i(),m("div",rt,[t(S,null,{default:s(()=>r[9]||(r[9]=[d("Company Name")])),_:1}),o("div",it,[T(o("select",{"onUpdate:modelValue":r[0]||(r[0]=c=>n(p).tenant_id=c),class:"flex h-10 w-full items-center rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 appearance-none"},[r[10]||(r[10]=o("option",{value:null,disabled:""},"Select Company",-1)),(i(!0),m(A,null,L(b.tenants,c=>(i(),m("option",{key:c.id,value:c.id},y(c.name),9,ut))),128))],512),[[z,n(p).tenant_id]]),r[11]||(r[11]=o("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[o("svg",{class:"h-4 w-4 opacity-50",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[o("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])],-1))])])):k("",!0),o("div",ft,[t(S,null,{default:s(()=>r[12]||(r[12]=[d("Date")])),_:1}),t(P,{type:"date",modelValue:n(p).date,"onUpdate:modelValue":r[1]||(r[1]=c=>n(p).date=c),class:"w-full"},null,8,["modelValue"])]),o("div",null,[t(S,null,{default:s(()=>r[13]||(r[13]=[d("Driver Name")])),_:1}),t(P,{modelValue:n(p).driver_name,"onUpdate:modelValue":r[2]||(r[2]=c=>n(p).driver_name=c),class:"w-full"},null,8,["modelValue"])]),o("div",null,[t(S,null,{default:s(()=>r[14]||(r[14]=[d("Delay Type")])),_:1}),o("div",mt,[T(o("select",{"onUpdate:modelValue":r[3]||(r[3]=c=>n(p).delay_type=c),class:"flex h-10 w-full items-center rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 appearance-none"},r[15]||(r[15]=[o("option",{value:"origin"},"Origin",-1),o("option",{value:"destination"},"Destination",-1)]),512),[[z,n(p).delay_type]]),r[16]||(r[16]=o("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[o("svg",{class:"h-4 w-4 opacity-50",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[o("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])],-1))])]),o("div",null,[t(S,null,{default:s(()=>r[17]||(r[17]=[d("Delay Category")])),_:1}),o("div",vt,[T(o("select",{"onUpdate:modelValue":r[4]||(r[4]=c=>n(p).delay_category=c),class:"flex h-10 w-full items-center rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 appearance-none"},r[18]||(r[18]=[o("option",{value:"1_120"},"1–120 min",-1),o("option",{value:"121_600"},"121–600 min",-1),o("option",{value:"601_plus"},"601+ min",-1)]),512),[[z,n(p).delay_category]]),r[19]||(r[19]=o("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[o("svg",{class:"h-4 w-4 opacity-50",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[o("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])],-1))])]),o("div",null,[t(S,null,{default:s(()=>r[20]||(r[20]=[d("Delay Code")])),_:1}),o("div",pt,[T(o("select",{"onUpdate:modelValue":r[5]||(r[5]=c=>n(p).delay_code_id=c),class:"flex h-10 w-full items-center rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 appearance-none"},[(i(!0),m(A,null,L(b.delayCodes,c=>(i(),m("option",{key:c.id,value:c.id},y(c.code),9,ct))),128))],512),[[z,n(p).delay_code_id]]),r[21]||(r[21]=o("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[o("svg",{class:"h-4 w-4 opacity-50",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[o("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])],-1))])]),o("div",null,[t(S,null,{default:s(()=>r[22]||(r[22]=[d("Driver Controllable")])),_:1}),o("div",yt,[T(o("select",{"onUpdate:modelValue":r[6]||(r[6]=c=>n(p).driver_controllable=c),class:"flex h-10 w-full items-center rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 appearance-none"},r[23]||(r[23]=[o("option",{value:null},"N/A",-1),o("option",{value:!0},"Yes",-1),o("option",{value:!1},"No",-1)]),512),[[z,n(p).driver_controllable]]),r[24]||(r[24]=o("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[o("svg",{class:"h-4 w-4 opacity-50",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[o("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])],-1))])]),o("div",gt,[t(tt,{checked:n(p).disputed,"onUpdate:checked":r[7]||(r[7]=c=>n(p).disputed=c),id:"disputed"},null,8,["checked"]),t(S,{for:"disputed"},{default:s(()=>r[25]||(r[25]=[d("Disputed")])),_:1})])]),o("div",bt,[t(g,{type:"button",onClick:r[8]||(r[8]=c=>j("close")),variant:"outline",class:"w-full sm:w-auto"},{default:s(()=>r[26]||(r[26]=[d(" Cancel ")])),_:1}),t(g,{type:"submit",disabled:n(p).processing,class:"w-full sm:w-auto"},{default:s(()=>[d(y(n(p).id?"Update":"Create"),1)]),_:1},8,["disabled"])])],32))}}),kt={class:"max-w-7xl mx-auto p-6 space-y-8"},Ct={class:"flex flex-col sm:flex-row justify-between items-center mb-6 gap-4"},_t={class:"flex flex-wrap gap-3"},wt={class:"relative"},St={key:0,class:"absolute right-0 mt-1 w-48 bg-background rounded-md shadow-lg border z-10"},Dt={class:"py-1"},$t={class:"cursor-pointer block px-4 py-2 text-sm hover:bg-muted"},At=["href"],Ft=["action"],Nt={class:"flex flex-col gap-2"},Tt={class:"flex flex-wrap gap-2"},Ut={key:0,class:"text-sm text-muted-foreground"},Vt={key:0},zt={key:1},Mt={key:2},ht={class:"flex justify-between items-center"},Bt={class:"flex items-center gap-2"},Et={key:0,class:"flex flex-wrap gap-2 ml-4"},Lt={key:0,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},jt={key:1,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},Pt={key:2,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},Rt={key:3,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},Ot={key:4,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},It={key:5,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},Yt={class:"flex flex-col justify-between gap-4"},Wt={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 w-full"},qt=["value"],Ht={class:"flex justify-end"},Gt={class:"overflow-x-auto"},Jt={class:"flex items-center justify-center"},Qt=["checked"],Kt={class:"flex items-center"},Xt={key:0,class:"ml-2"},Zt={key:0,class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},el={key:1,class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},tl={key:1,class:"ml-2 opacity-50"},ll=["value"],ol={key:0,class:"ml-1 text-xs text-red-500"},sl={class:"flex space-x-2"},nl={key:0,class:"bg-muted/20 px-4 py-3 border-t"},al={class:"flex justify-between items-center"},dl={class:"text-sm text-muted-foreground"},rl={class:"flex items-center gap-4"},il={class:"flex items-center gap-2"},ul={class:"flex"},fl=["innerHTML"],ml={class:"mt-4 space-y-4"},vl={class:"flex items-center justify-between"},pl={class:"max-h-[400px] overflow-y-auto"},cl={key:0,class:"text-center py-8 text-muted-foreground border rounded-md"},yl={key:1,class:"space-y-2"},gl=["onClick"],bl={class:"font-medium"},xl={key:0,class:"ml-2 text-xs text-red-500"},kl={key:0,class:"text-sm text-muted-foreground mt-1"},Cl={class:"opacity-0 group-hover:opacity-100 transition-opacity"},_l={key:0,class:"border rounded-md p-4 space-y-4"},wl={class:"text-sm font-medium"},Sl={class:"space-y-3"},Dl={class:"flex justify-end space-x-2"},Hl={__name:"Index",props:{delays:{type:Object,default:()=>({data:[],links:[]})},tenantSlug:{type:String,default:null},delay_codes:Array,tenants:{type:Array,default:()=>[]},isSuperAdmin:{type:Boolean,default:!1},dateRange:{type:Object,default:null},dateFilter:{type:String,default:"yesterday"}},setup(b){const v=b,_=[{title:v.tenantSlug?"Dashboard":"Admin Dashboard",href:v.tenantSlug?route("dashboard",{tenantSlug:v.tenantSlug}):route("admin.dashboard")},{title:"On-Time",href:v.tenantSlug?route("ontime.index",{tenantSlug:v.tenantSlug}):route("ontime.index.admin")}],j=C(!1),p=C(!1),R=C(null),F=C(""),U=C(""),M=C(!1),Z=C(null),D=C([]),h=C(!1),O=C(null),x=C(!1),r=C(null),c=C({code:"",description:""}),I=C(!1),ge=C(null),Y=C("date"),W=C("desc"),f=C({search:"",dateFrom:"",dateTo:"",delayCode:"",disputed:"",controllable:""}),ue=["date","delay_type","driver_name","penalty","delay_code","disputed","driver_controllable"],q=Q(()=>{let a=[...v.delays.data];if(f.value.search){const e=f.value.search.toLowerCase();a=a.filter(l=>{var u,w,E,oe;return((u=l.driver_name)==null?void 0:u.toLowerCase().includes(e))||((w=l.delay_type)==null?void 0:w.toLowerCase().includes(e))||((oe=(E=l.delay_code)==null?void 0:E.code)==null?void 0:oe.toLowerCase().includes(e))})}if(f.value.dateFrom&&(a=a.filter(e=>e.date&&e.date>=f.value.dateFrom)),f.value.dateTo&&(a=a.filter(e=>e.date&&e.date<=f.value.dateTo)),f.value.delayCode&&(a=a.filter(e=>{var l;return((l=e.delay_code)==null?void 0:l.id)===parseInt(f.value.delayCode)})),f.value.disputed!==""){const e=f.value.disputed==="true";a=a.filter(l=>l.disputed===e)}if(f.value.controllable!=="")if(f.value.controllable==="null")a=a.filter(e=>e.driver_controllable===null);else{const e=f.value.controllable==="true";a=a.filter(l=>l.driver_controllable===e)}return a.sort((e,l)=>{var E,oe;let u,w;return Y.value==="delay_code"?(u=((E=e.delay_code)==null?void 0:E.code)||"",w=((oe=l.delay_code)==null?void 0:oe.code)||""):(u=e[Y.value],w=l[Y.value]),u===null?1:w===null?-1:(typeof u=="string"&&(u=u.toLowerCase(),w=w.toLowerCase()),u<w?W.value==="asc"?-1:1:u>w?W.value==="asc"?1:-1:0)}),a}),Se=Q(()=>v.delay_codes.filter(a=>!a.deleted_at));function De(a){Y.value===a?W.value=W.value==="asc"?"desc":"asc":(Y.value=a,W.value="asc")}function H(){}function $e(){f.value={search:"",dateFrom:"",dateTo:"",delayCode:"",disputed:"",controllable:""}}const ee=C(v.delays.per_page||10),B=C(v.dateFilter||"full");function Ae(){const a=v.tenantSlug?route("ontime.index",{tenantSlug:v.tenantSlug}):route("ontime.index.admin");V.get(a,{dateFilter:B.value,perPage:ee.value},{preserveState:!0})}function te(a){B.value=a;const e=v.tenantSlug?route("ontime.index",{tenantSlug:v.tenantSlug}):route("ontime.index.admin");V.get(e,{dateFilter:a,perPage:ee.value},{preserveState:!0})}function Fe(a){if(a){const e=new URL(a);e.searchParams.set("perPage",ee.value),V.get(e.href,{},{preserveScroll:!0,preserveState:!0,only:["delays"]})}}function G(a){if(!a)return"";const e=a.split("-");if(e.length!==3)return a;const[l,u,w]=e;return`${Number(u)}/${Number(w)}/${l}`}const be=(a=null)=>{R.value=a,j.value=!0},Ne=a=>{Z.value=a,M.value=!0},Te=()=>{p.value=!0,x.value=!1,r.value=null},Ue=()=>{c.value={code:"",description:""},r.value=null,x.value=!0},Ve=a=>{c.value={code:a.code,description:a.description||""},r.value=a.id,x.value=!0},ze=()=>{x.value=!1,r.value=null},xe=a=>{ge.value=a,I.value=!0},J=C(!1),Me=Q(()=>f.value.search||f.value.dateFrom||f.value.dateTo||f.value.delayCode||f.value.disputed||f.value.controllable),he=a=>{if(!a)return"";const e=v.delay_codes.find(l=>l.id===parseInt(a));return e?e.code:""},Be=async a=>{try{await V.delete(route("delay-codes.destroy",a),{onSuccess:()=>{I.value=!1,F.value="Delay code deleted successfully"}})}catch(e){console.error("Error deleting delay code:",e)}},Ee=()=>{const a=X({code:c.value.code,description:c.value.description}),e=r.value?v.isSuperAdmin?"delay_codes.update.admin":"delay_codes.update":v.isSuperAdmin?"delay_codes.store.admin":"delay_codes.store",l=r.value?v.isSuperAdmin?{id:r.value}:{tenantSlug:v.tenantSlug,id:r.value}:v.isSuperAdmin?{}:{tenantSlug:v.tenantSlug};(r.value?a.put:a.post).call(a,route(e,l),{onSuccess:()=>{F.value=r.value?"Delay code updated successfully.":"Delay code created successfully.",x.value=!1,r.value=null,V.reload({only:["delay_codes"]})},onError:w=>{console.error(w)}})},Le=a=>{X({}).post(route(v.isSuperAdmin?"delay_codes.restore.admin":"delay_codes.restore",{id:a}),{onSuccess:()=>{F.value="Delay code restored successfully.",V.reload({only:["delay_codes"]})},onError:l=>{console.error(l)}})},je=a=>{X({}).delete(route(v.isSuperAdmin?"delay_codes.forceDelete.admin":"delay_codes.forceDelete",{id:a}),{onSuccess:()=>{F.value="Delay code permanently deleted successfully.",V.reload({only:["delay_codes"]})},onError:l=>{console.error(l)}})},Pe=a=>{const e=X({}),l=v.isSuperAdmin?"ontime.destroy.admin":"ontime.destroy",u=v.isSuperAdmin?{delay:a}:{tenantSlug:v.tenantSlug,delay:a};e.delete(route(l,u),{preserveScroll:!0,onSuccess:()=>{F.value="Delay record deleted successfully.",M.value=!1}})};ye(F,a=>{a&&setTimeout(()=>{F.value=""},5e3)}),v.flash&&v.flash.error&&(U.value=v.flash.error),ye(U,a=>{a&&setTimeout(()=>{U.value=""},5e3)});const Re=Q(()=>q.value.length>0&&D.value.length===q.value.length);function Oe(a){a.target.checked?D.value=q.value.map(e=>e.id):D.value=[]}function Ie(){D.value.length>0&&(h.value=!0)}function Ye(){const a=X({ids:D.value}),e=v.isSuperAdmin?"ontime.destroyBulk.admin":"ontime.destroyBulk",l=v.isSuperAdmin?{}:{tenantSlug:v.tenantSlug};a.delete(route(e,l),{preserveScroll:!0,onSuccess:()=>{F.value=`${D.value.length} delay records deleted successfully.`,D.value=[],h.value=!1,V.reload()},onError:u=>{console.error(u)}})}function We(a){const e=a.target.files[0];if(!e)return;const l=new FormData;l.append("csv_file",e);const u=v.isSuperAdmin?route("ontime.import.admin"):route("ontime.import",{tenantSlug:v.tenantSlug});V.post(u,l,{onSuccess:()=>{F.value="Delays imported successfully",a.target.value=""},onError:w=>{console.error(w),a.target.value=""}})}function qe(){if(v.delays.data.length===0){U.value="No delay data found to export.";return}O.value&&O.value.submit()}const He=Q(()=>v.tenantSlug?route("ontime.export",{tenantSlug:v.tenantSlug}):route("ontime.export.admin")),le=C(!1),Ge=Q(()=>"/storage/upload-data-temps/Delays Template.csv");return Qe(()=>{const a=e=>{le.value&&!e.target.closest(".relative")&&(le.value=!1)};document.addEventListener("click",a),Ke(()=>{document.removeEventListener("click",a)})}),(a,e)=>(i(),N(et,{breadcrumbs:_,tenantSlug:b.tenantSlug},{default:s(()=>[t(n(Ze),{title:"On-Time"}),o("div",kt,[F.value?(i(),N(n(ke),{key:0,variant:"success"},{default:s(()=>[t(n(Ce),null,{default:s(()=>e[33]||(e[33]=[d("Success")])),_:1}),t(n(_e),null,{default:s(()=>[d(y(F.value),1)]),_:1})]),_:1})):k("",!0),U.value?(i(),N(n(ke),{key:1,variant:"destructive"},{default:s(()=>[t(n(Ce),null,{default:s(()=>e[34]||(e[34]=[d("Error")])),_:1}),t(n(_e),null,{default:s(()=>[d(y(U.value),1)]),_:1})]),_:1})):k("",!0),o("div",Ct,[e[40]||(e[40]=o("h1",{class:"text-2xl font-bold text-gray-800 dark:text-gray-200"},"On-Time Management",-1)),o("div",_t,[t(g,{onClick:e[0]||(e[0]=l=>be()),variant:"default"},{default:s(()=>[t($,{name:"plus",class:"mr-2 h-4 w-4"}),e[35]||(e[35]=d(" Add Delay "))]),_:1}),D.value.length>0?(i(),N(g,{key:0,onClick:e[1]||(e[1]=l=>Ie()),variant:"destructive"},{default:s(()=>[t($,{name:"trash",class:"mr-2 h-4 w-4"}),d(" Delete Selected ("+y(D.value.length)+") ",1)]),_:1})):k("",!0),o("div",wt,[t(g,{onClick:e[2]||(e[2]=l=>le.value=!le.value),variant:"secondary"},{default:s(()=>[t($,{name:"upload",class:"mr-2 h-4 w-4"}),e[36]||(e[36]=d(" Upload CSV ")),t($,{name:"chevron-down",class:"ml-2 h-4 w-4"})]),_:1}),le.value?(i(),m("div",St,[o("div",Dt,[o("label",$t,[e[37]||(e[37]=o("span",null,"Upload CSV File",-1)),o("input",{type:"file",class:"hidden",onChange:We,accept:".csv"},null,32)]),o("a",{href:Ge.value,download:"Delays Template.csv",class:"block px-4 py-2 text-sm hover:bg-muted"}," Download Template ",8,At)])])):k("",!0)]),t(g,{onClick:we(qe,["prevent"]),variant:"outline"},{default:s(()=>[t($,{name:"download",class:"mr-2 h-4 w-4"}),e[38]||(e[38]=d(" Download CSV "))]),_:1}),b.isSuperAdmin?(i(),N(g,{key:1,onClick:e[3]||(e[3]=l=>Te()),variant:"outline"},{default:s(()=>[t($,{name:"settings",class:"mr-2 h-4 w-4"}),e[39]||(e[39]=d(" Manage Delay Codes "))]),_:1})):k("",!0)])]),o("form",{ref_key:"exportForm",ref:O,action:He.value,method:"GET",class:"hidden"},null,8,Ft),t(n(pe),null,{default:s(()=>[t(n(ce),{class:"p-4"},{default:s(()=>[o("div",Nt,[o("div",Tt,[t(g,{onClick:e[4]||(e[4]=l=>te("yesterday")),variant:"outline",size:"sm",class:K({"bg-primary/10 text-primary border-primary":B.value==="yesterday"})},{default:s(()=>e[41]||(e[41]=[d(" Yesterday ")])),_:1},8,["class"]),t(g,{onClick:e[5]||(e[5]=l=>te("current-week")),variant:"outline",size:"sm",class:K({"bg-primary/10 text-primary border-primary":B.value==="current-week"})},{default:s(()=>e[42]||(e[42]=[d(" Current Week ")])),_:1},8,["class"]),t(g,{onClick:e[6]||(e[6]=l=>te("6w")),variant:"outline",size:"sm",class:K({"bg-primary/10 text-primary border-primary":B.value==="6w"})},{default:s(()=>e[43]||(e[43]=[d(" 6 Weeks ")])),_:1},8,["class"]),t(g,{onClick:e[7]||(e[7]=l=>te("quarterly")),variant:"outline",size:"sm",class:K({"bg-primary/10 text-primary border-primary":B.value==="quarterly"})},{default:s(()=>e[44]||(e[44]=[d(" Quarterly ")])),_:1},8,["class"]),t(g,{onClick:e[8]||(e[8]=l=>te("full")),variant:"outline",size:"sm",class:K({"bg-primary/10 text-primary border-primary":B.value==="full"})},{default:s(()=>e[45]||(e[45]=[d(" Full ")])),_:1},8,["class"])]),b.dateRange?(i(),m("div",Ut,[B.value==="yesterday"&&b.dateRange.start?(i(),m("span",Vt," Showing data from "+y(G(b.dateRange.start)),1)):b.dateRange.start&&b.dateRange.end?(i(),m("span",zt," Showing data from "+y(G(b.dateRange.start))+" to "+y(G(b.dateRange.end)),1)):(i(),m("span",Mt,y(b.dateRange.label),1))])):k("",!0)])]),_:1})]),_:1}),t(n(pe),null,{default:s(()=>[t(n(nt),{class:"pb-2"},{default:s(()=>[o("div",ht,[o("div",Bt,[t(n(at),null,{default:s(()=>e[46]||(e[46]=[d("Filters")])),_:1}),!J.value&&Me.value?(i(),m("div",Et,[f.value.search?(i(),m("div",Lt," Search: "+y(f.value.search),1)):k("",!0),f.value.dateFrom?(i(),m("div",jt," From: "+y(G(f.value.dateFrom)),1)):k("",!0),f.value.dateTo?(i(),m("div",Pt," To: "+y(G(f.value.dateTo)),1)):k("",!0),f.value.delayCode?(i(),m("div",Rt," Code: "+y(he(f.value.delayCode)),1)):k("",!0),f.value.disputed?(i(),m("div",Ot," Disputed: "+y(f.value.disputed==="true"?"Yes":"No"),1)):k("",!0),f.value.controllable?(i(),m("div",It," Driver Controllable: "+y(f.value.controllable==="true"?"Yes":f.value.controllable==="false"?"No":"N/A"),1)):k("",!0)])):k("",!0)]),t(g,{variant:"ghost",size:"sm",onClick:e[9]||(e[9]=l=>J.value=!J.value)},{default:s(()=>[d(y(J.value?"Hide Filters":"Show Filters")+" ",1),t($,{name:J.value?"chevron-up":"chevron-down",class:"ml-2 h-4 w-4"},null,8,["name"])]),_:1})])]),_:1}),J.value?(i(),N(n(ce),{key:0,class:"pt-2"},{default:s(()=>[o("div",Yt,[o("div",Wt,[o("div",null,[t(n(S),{for:"search"},{default:s(()=>e[47]||(e[47]=[d("Search")])),_:1}),t(n(P),{id:"search",modelValue:f.value.search,"onUpdate:modelValue":e[10]||(e[10]=l=>f.value.search=l),type:"text",placeholder:"Search by driver or type...",onInput:H},null,8,["modelValue"])]),o("div",null,[t(n(S),{for:"dateFrom"},{default:s(()=>e[48]||(e[48]=[d("Date From")])),_:1}),t(n(P),{id:"dateFrom",modelValue:f.value.dateFrom,"onUpdate:modelValue":e[11]||(e[11]=l=>f.value.dateFrom=l),type:"date",onChange:H},null,8,["modelValue"])]),o("div",null,[t(n(S),{for:"dateTo"},{default:s(()=>e[49]||(e[49]=[d("Date To")])),_:1}),t(n(P),{id:"dateTo",modelValue:f.value.dateTo,"onUpdate:modelValue":e[12]||(e[12]=l=>f.value.dateTo=l),type:"date",onChange:H},null,8,["modelValue"])]),o("div",null,[t(n(S),{for:"delayCode"},{default:s(()=>e[50]||(e[50]=[d("Delay Code")])),_:1}),T(o("select",{id:"delayCode","onUpdate:modelValue":e[13]||(e[13]=l=>f.value.delayCode=l),onChange:H,class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},[e[51]||(e[51]=o("option",{value:""},"All Codes",-1)),(i(!0),m(A,null,L(b.delay_codes,l=>(i(),m("option",{key:l.id,value:l.id},y(l.code),9,qt))),128))],544),[[z,f.value.delayCode]])]),o("div",null,[t(n(S),{for:"disputed"},{default:s(()=>e[52]||(e[52]=[d("Disputed Status")])),_:1}),T(o("select",{id:"disputed","onUpdate:modelValue":e[14]||(e[14]=l=>f.value.disputed=l),onChange:H,class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},e[53]||(e[53]=[o("option",{value:""},"All",-1),o("option",{value:"true"},"Disputed",-1),o("option",{value:"false"},"Not Disputed",-1)]),544),[[z,f.value.disputed]])]),o("div",null,[t(n(S),{for:"controllable"},{default:s(()=>e[54]||(e[54]=[d("Driver Controllable")])),_:1}),T(o("select",{id:"controllable","onUpdate:modelValue":e[15]||(e[15]=l=>f.value.controllable=l),onChange:H,class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},e[55]||(e[55]=[o("option",{value:""},"All",-1),o("option",{value:"true"},"Yes",-1),o("option",{value:"false"},"No",-1),o("option",{value:"null"},"N/A",-1)]),544),[[z,f.value.controllable]])])]),o("div",Ht,[t(g,{onClick:$e,variant:"ghost",size:"sm"},{default:s(()=>[t($,{name:"rotate_ccw",class:"mr-2 h-4 w-4"}),e[56]||(e[56]=d(" Reset Filters "))]),_:1})])])]),_:1})):k("",!0)]),_:1}),t(n(pe),null,{default:s(()=>[t(n(ce),{class:"p-0"},{default:s(()=>[o("div",Gt,[t(n(lt),{class:"relative h-[500px] overflow-auto"},{default:s(()=>[t(n(ot),null,{default:s(()=>[t(n(ve),{class:"sticky top-0 bg-background border-b z-10 hover:bg-background"},{default:s(()=>[t(n(me),{class:"w-[50px]"},{default:s(()=>[o("div",Jt,[o("input",{type:"checkbox",onChange:Oe,checked:Re.value,class:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"},null,40,Qt)])]),_:1}),b.isSuperAdmin?(i(),N(n(me),{key:0},{default:s(()=>e[57]||(e[57]=[d("Company Name")])),_:1})):k("",!0),(i(),m(A,null,L(ue,l=>t(n(me),{key:l,class:"cursor-pointer",onClick:u=>De(l)},{default:s(()=>[o("div",Kt,[d(y(l.replace(/_/g," ").split(" ").map(u=>u.charAt(0).toUpperCase()+u.slice(1)).join(" "))+" ",1),Y.value===l?(i(),m("div",Xt,[W.value==="asc"?(i(),m("svg",Zt,e[58]||(e[58]=[o("path",{d:"M8 15l4-4 4 4"},null,-1)]))):(i(),m("svg",el,e[59]||(e[59]=[o("path",{d:"M16 9l-4 4-4-4"},null,-1)])))])):(i(),m("div",tl,e[60]||(e[60]=[o("svg",{class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[o("path",{d:"M8 10l4-4 4 4"}),o("path",{d:"M16 14l-4 4-4-4"})],-1)])))])]),_:2},1032,["onClick"])),64)),t(n(me),null,{default:s(()=>e[61]||(e[61]=[d("Actions")])),_:1})]),_:1})]),_:1}),t(n(st),null,{default:s(()=>[q.value.length===0?(i(),N(n(ve),{key:0},{default:s(()=>[t(n(ie),{colspan:b.isSuperAdmin?ue.length+2:ue.length+1,class:"text-center py-8"},{default:s(()=>e[62]||(e[62]=[d(" No delays found matching your criteria ")])),_:1},8,["colspan"])]),_:1})):k("",!0),(i(!0),m(A,null,L(q.value,l=>(i(),N(n(ve),{key:l.id,class:"hover:bg-muted/50"},{default:s(()=>[t(n(ie),{class:"text-center"},{default:s(()=>[T(o("input",{type:"checkbox",value:l.id,"onUpdate:modelValue":e[16]||(e[16]=u=>D.value=u),class:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"},null,8,ll),[[Xe,D.value]])]),_:2},1024),b.isSuperAdmin?(i(),N(n(ie),{key:0},{default:s(()=>{var u;return[d(y(((u=l.tenant)==null?void 0:u.name)||"—"),1)]}),_:2},1024)):k("",!0),(i(),m(A,null,L(ue,u=>t(n(ie),{key:u,class:"whitespace-nowrap"},{default:s(()=>{var w,E;return[u==="date"?(i(),m(A,{key:0},[d(y(G(l[u])),1)],64)):u==="disputed"?(i(),m(A,{key:1},[d(y(l[u]?"Yes":"No"),1)],64)):u==="driver_controllable"?(i(),m(A,{key:2},[d(y(l[u]===null?"N/A":l[u]?"Yes":"No"),1)],64)):u==="delay_code"?(i(),m(A,{key:3},[d(y(((w=l.delay_code)==null?void 0:w.code)||"—")+" ",1),(E=l.delay_code)!=null&&E.deleted_at?(i(),m("span",ol,"(Deleted Code)")):k("",!0)],64)):(i(),m(A,{key:4},[d(y(l[u]),1)],64))]}),_:2},1024)),64)),t(n(ie),null,{default:s(()=>[o("div",sl,[t(g,{onClick:u=>be(l),variant:"warning",size:"sm"},{default:s(()=>[t($,{name:"pencil",class:"mr-1 h-4 w-4"}),e[63]||(e[63]=d(" Edit "))]),_:2},1032,["onClick"]),t(g,{onClick:u=>Ne(l.id),variant:"destructive",size:"sm"},{default:s(()=>[t($,{name:"trash",class:"mr-1 h-4 w-4"}),e[64]||(e[64]=d(" Delete "))]),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),b.delays.links?(i(),m("div",nl,[o("div",al,[o("div",dl," Showing "+y(q.value.length)+" of "+y(b.delays.data.length)+" entries ",1),o("div",rl,[o("div",il,[t(n(S),{for:"perPage",class:"text-sm"},{default:s(()=>e[65]||(e[65]=[d("Per page:")])),_:1}),T(o("select",{id:"perPage","onUpdate:modelValue":e[17]||(e[17]=l=>ee.value=l),onChange:Ae,class:"h-8 rounded-md border border-input bg-background px-2 py-1 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"},e[66]||(e[66]=[o("option",{value:"10"},"10",-1),o("option",{value:"25"},"25",-1),o("option",{value:"50"},"50",-1),o("option",{value:"100"},"100",-1)]),544),[[z,ee.value]])]),o("div",ul,[(i(!0),m(A,null,L(b.delays.links,l=>(i(),N(g,{key:l.label,onClick:u=>Fe(l.url),disabled:!l.url,variant:"ghost",size:"sm",class:K(["mx-1",{"bg-primary/10 text-primary border-primary":l.active}])},{default:s(()=>[o("span",{innerHTML:l.label},null,8,fl)]),_:2},1032,["onClick","disabled","class"]))),128))])])])])):k("",!0)]),_:1})]),_:1}),t(n(se),{open:j.value,"onUpdate:open":e[19]||(e[19]=l=>j.value=l)},{default:s(()=>[t(n(ne),{class:"sm:max-w-2xl"},{default:s(()=>[t(n(ae),null,{default:s(()=>[t(n(de),null,{default:s(()=>[d(y(R.value?"Edit":"Add")+" Delay",1)]),_:1}),t(n(re),null,{default:s(()=>[d(" Fill in the details to "+y(R.value?"update":"create")+" a delay record. ",1)]),_:1})]),_:1}),t(xt,{delay:R.value,"delay-codes":Se.value,tenants:b.tenants,"is-super-admin":b.isSuperAdmin,"tenant-slug":b.tenantSlug,onClose:e[18]||(e[18]=l=>j.value=!1)},null,8,["delay","delay-codes","tenants","is-super-admin","tenant-slug"])]),_:1})]),_:1},8,["open"]),t(n(se),{open:p.value,"onUpdate:open":e[23]||(e[23]=l=>p.value=l)},{default:s(()=>[t(n(ne),{class:"sm:max-w-lg"},{default:s(()=>[t(n(ae),null,{default:s(()=>[t(n(de),null,{default:s(()=>e[67]||(e[67]=[d("Manage Delay Codes")])),_:1}),t(n(re),null,{default:s(()=>e[68]||(e[68]=[d(" Create and manage delay codes for your organization. ")])),_:1})]),_:1}),o("div",ml,[o("div",vl,[e[70]||(e[70]=o("h3",{class:"text-sm font-medium"},"Current Delay Codes",-1)),t(g,{onClick:Ue,size:"sm",variant:"outline"},{default:s(()=>[t($,{name:"plus",class:"mr-2 h-4 w-4"}),e[69]||(e[69]=d(" Add New Code "))]),_:1})]),o("div",pl,[!b.delay_codes||b.delay_codes.length===0?(i(),m("div",cl," No delay codes found ")):(i(),m("div",yl,[(i(!0),m(A,null,L(b.delay_codes,l=>(i(),m("div",{key:l.id,class:"flex items-center justify-between p-3 border rounded-md hover:bg-muted/50 group"},[o("div",{class:"flex-1 cursor-pointer",onClick:u=>Ve(l)},[o("div",bl,[d(y(l.code)+" ",1),l.deleted_at?(i(),m("span",xl,"(Deleted)")):k("",!0)]),l.description?(i(),m("div",kl,y(l.description),1)):k("",!0)],8,gl),o("div",Cl,[b.isSuperAdmin?(i(),m(A,{key:0},[l.deleted_at?(i(),m(A,{key:0},[t(g,{onClick:u=>Le(l.id),size:"sm",variant:"outline"},{default:s(()=>[t($,{name:"refresh",class:"mr-2 h-4 w-4"}),e[71]||(e[71]=d(" Restore "))]),_:2},1032,["onClick"]),t(g,{onClick:u=>je(l.id),size:"sm",variant:"destructive"},{default:s(()=>[t($,{name:"trash",class:"mr-2 h-4 w-4"}),e[72]||(e[72]=d(" Permanently Delete "))]),_:2},1032,["onClick"])],64)):(i(),N(g,{key:1,onClick:u=>xe(l.id),size:"sm",variant:"destructive"},{default:s(()=>[t($,{name:"trash",class:"mr-2 h-4 w-4"}),e[73]||(e[73]=d(" Delete "))]),_:2},1032,["onClick"]))],64)):(i(),N(g,{key:1,onClick:u=>xe(l.id),size:"sm",variant:"destructive"},{default:s(()=>[t($,{name:"trash",class:"mr-2 h-4 w-4"}),e[74]||(e[74]=d(" Delete "))]),_:2},1032,["onClick"]))])]))),128))]))]),x.value?(i(),m("div",_l,[o("h3",wl,y(r.value?"Edit":"Add")+" Delay Code",1),o("div",Sl,[o("div",null,[t(n(S),{for:"code"},{default:s(()=>e[75]||(e[75]=[d("Code")])),_:1}),t(n(P),{id:"code",modelValue:c.value.code,"onUpdate:modelValue":e[20]||(e[20]=l=>c.value.code=l),placeholder:"Enter code"},null,8,["modelValue"])]),o("div",null,[t(n(S),{for:"description"},{default:s(()=>e[76]||(e[76]=[d("Description")])),_:1}),t(n(P),{id:"description",modelValue:c.value.description,"onUpdate:modelValue":e[21]||(e[21]=l=>c.value.description=l),placeholder:"Enter description"},null,8,["modelValue"])]),o("div",Dl,[t(g,{onClick:ze,variant:"ghost",size:"sm"},{default:s(()=>e[77]||(e[77]=[d("Cancel")])),_:1}),t(g,{onClick:Ee,variant:"default",size:"sm"},{default:s(()=>e[78]||(e[78]=[d("Save")])),_:1})])])])):k("",!0)]),t(n(fe),{class:"mt-6"},{default:s(()=>[t(g,{onClick:e[22]||(e[22]=l=>p.value=!1),variant:"outline"},{default:s(()=>e[79]||(e[79]=[d("Close")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),t(n(se),{open:I.value,"onUpdate:open":e[26]||(e[26]=l=>I.value=l)},{default:s(()=>[t(n(ne),null,{default:s(()=>[t(n(ae),null,{default:s(()=>[t(n(de),null,{default:s(()=>e[80]||(e[80]=[d("Confirm Deletion")])),_:1}),t(n(re),null,{default:s(()=>e[81]||(e[81]=[d(" Are you sure you want to delete this delay code? This action cannot be undone. ")])),_:1})]),_:1}),t(n(fe),{class:"mt-4"},{default:s(()=>[t(g,{type:"button",onClick:e[24]||(e[24]=l=>I.value=!1),variant:"outline"},{default:s(()=>e[82]||(e[82]=[d(" Cancel ")])),_:1}),t(g,{type:"button",onClick:e[25]||(e[25]=l=>Be(ge.value)),variant:"destructive"},{default:s(()=>e[83]||(e[83]=[d(" Delete ")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),t(n(se),{open:M.value,"onUpdate:open":e[29]||(e[29]=l=>M.value=l)},{default:s(()=>[t(n(ne),null,{default:s(()=>[t(n(ae),null,{default:s(()=>[t(n(de),null,{default:s(()=>e[84]||(e[84]=[d("Confirm Deletion")])),_:1}),t(n(re),null,{default:s(()=>e[85]||(e[85]=[d(" Are you sure you want to delete this delay record? This action cannot be undone. ")])),_:1})]),_:1}),t(n(fe),{class:"mt-4"},{default:s(()=>[t(g,{type:"button",onClick:e[27]||(e[27]=l=>M.value=!1),variant:"outline"},{default:s(()=>e[86]||(e[86]=[d(" Cancel ")])),_:1}),t(g,{type:"button",onClick:e[28]||(e[28]=l=>Pe(Z.value)),variant:"destructive"},{default:s(()=>e[87]||(e[87]=[d(" Delete ")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),t(n(se),{open:h.value,"onUpdate:open":e[32]||(e[32]=l=>h.value=l)},{default:s(()=>[t(n(ne),null,{default:s(()=>[t(n(ae),null,{default:s(()=>[t(n(de),null,{default:s(()=>e[88]||(e[88]=[d("Confirm Bulk Deletion")])),_:1}),t(n(re),null,{default:s(()=>[d(" Are you sure you want to delete "+y(D.value.length)+" delay records? This action cannot be undone. ",1)]),_:1})]),_:1}),t(n(fe),{class:"mt-4"},{default:s(()=>[t(g,{type:"button",onClick:e[30]||(e[30]=l=>h.value=!1),variant:"outline"},{default:s(()=>e[89]||(e[89]=[d(" Cancel ")])),_:1}),t(g,{type:"button",onClick:e[31]||(e[31]=l=>Ye()),variant:"destructive"},{default:s(()=>e[90]||(e[90]=[d(" Delete Selected ")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]),_:1},8,["tenantSlug"]))}};export{Hl as default};
