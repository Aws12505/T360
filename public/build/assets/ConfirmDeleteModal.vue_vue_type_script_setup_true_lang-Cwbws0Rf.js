import{_ as b}from"./Button.vue_vue_type_script_setup_true_lang-B9WZ-5fZ.js";import{S as oe,W as Z,x as F}from"./vendor-vue-BInP8APy.js";import{F as p,e as a,X as s,E as C,H as j,O as z,U as y,z as l,b as P,f as d,S as f,u as e,r as N,d as W,c as O,w as I,G as ee,aj as B,C as ie,Y as re,ak as ne}from"./vendor-DrR5RGOb.js";import{_ as R}from"./Badge.vue_vue_type_script_setup_true_lang-gLGZkSRc.js";import{c as se,a1 as te,J as ae,N as de,aa as ue,X as G,E as ce,d as me,S as Y,p as K,y as pe,L as le}from"./vendor-icons-CwVCzoc4.js";import{_ as V}from"./Input.vue_vue_type_script_setup_true_lang-CfJsKr1D.js";import{_ as A}from"./Label.vue_vue_type_script_setup_true_lang-G5SND9_d.js";import{_ as Q}from"./Checkbox.vue_vue_type_script_setup_true_lang-B7Y_3pUj.js";import{_ as L}from"./InputError.vue_vue_type_script_setup_true_lang-DJFUZLlW.js";const fe={class:"w-full overflow-x-auto"},ve={class:"rounded-md border"},ge={class:"w-full caption-bottom text-sm"},xe={class:"[&_tr:last-child]:border-0"},be={class:"p-4 align-middle font-medium"},he={class:"p-4 align-middle"},_e={class:"p-4 align-middle text-right"},ye={class:"flex justify-end space-x-2"},ke={key:0,class:"mt-6 flex justify-center"},we={class:"flex flex-wrap items-center gap-1 justify-center"},xt={__name:"UserList",props:{users:Object,isSuperAdmin:{type:Boolean,default:!1}},setup(k){const $=i=>{i&&Z.get(i,{},{only:["users"]})};return(i,m)=>(a(),p("div",fe,[s("div",ve,[s("table",ge,[m[3]||(m[3]=s("thead",{class:"[&_tr]:border-b"},[s("tr",{class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},[s("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Name"),s("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Email"),s("th",{class:"h-12 px-4 text-right align-middle font-medium text-muted-foreground"},"Actions")])],-1)),s("tbody",xe,[(a(!0),p(j,null,z(k.users.data,t=>(a(),p("tr",{key:t.id,class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},[s("td",be,y(t.name),1),s("td",he,y(t.email),1),s("td",_e,[s("div",ye,[l(e(b),{onClick:u=>i.$emit("edit",t),variant:"outline",size:"sm"},{default:d(()=>m[0]||(m[0]=[f(" Edit ")])),_:2},1032,["onClick"]),l(e(b),{onClick:u=>i.$emit("delete",t),variant:"destructive",size:"sm"},{default:d(()=>m[1]||(m[1]=[f(" Delete ")])),_:2},1032,["onClick"]),k.isSuperAdmin?(a(),P(e(oe),{key:0,href:i.route("impersonate.start",t.id),as:"button"},{default:d(()=>[l(e(b),{variant:"secondary",size:"sm"},{default:d(()=>m[2]||(m[2]=[f(" Impersonate ")])),_:1})]),_:2},1032,["href"])):C("",!0)])])]))),128))])])]),k.users.links?(a(),p("div",ke,[s("nav",we,[(a(!0),p(j,null,z(k.users.links,t=>(a(),P(e(b),{key:t.label,onClick:u=>$(t.url),disabled:!t.url,variant:t.active?"default":"outline",size:"sm",class:"min-w-[40px]",innerHTML:t.label},null,8,["onClick","disabled","variant","innerHTML"]))),128))])])):C("",!0)]))}},$e={class:"w-full overflow-x-auto"},Ce={class:"rounded-md border"},Se={class:"w-full caption-bottom text-sm"},je={class:"[&_tr:last-child]:border-0"},ze={class:"p-4 align-middle font-medium"},Ae={class:"flex items-center"},Pe={class:"p-4 align-middle"},Ue={class:"flex flex-wrap gap-1"},Ee={class:"mb-2 w-full"},Le={key:0,class:"w-full"},Ve={class:"text-xs font-semibold text-muted-foreground mb-1 flex items-center"},Te={class:"flex flex-wrap gap-1 ml-4"},Oe={class:"p-4 align-middle text-right"},Re={class:"flex justify-end space-x-2"},De={key:0,class:"mt-6 flex justify-center"},Me={class:"flex flex-wrap items-center gap-1 justify-center"},bt={__name:"RoleList",props:{roles:Object},setup(k){const $=N([]),i=v=>{const w=$.value.indexOf(v);w===-1?$.value.push(v):$.value.splice(w,1)},m=v=>v.length,t=v=>{v&&Z.get(v,{},{only:["roles"]})},u=v=>{const w={};return v.forEach(h=>{const E=h.name.split(".")[0];w[E]||(w[E]=[]),w[E].push(h)}),w},g=v=>v==="tenant-settings"?"Tenant Settings":v==="repair-orders"?"Repair Orders":v==="safety-data"?"Safety Data":v==="miles-driven"?"Miles Driven":v==="support-tickets"?"Support Tickets":v==="sms-coaching"?"SMS Coaching":v==="support-responses"?"Support Responses":v.charAt(0).toUpperCase()+v.slice(1),_=v=>{const w=v.split(".");return w.length>1?w[1].charAt(0).toUpperCase()+w[1].slice(1).replace(/-/g," "):v};return(v,w)=>(a(),p("div",$e,[s("div",Ce,[s("table",Se,[w[2]||(w[2]=s("thead",{class:"[&_tr]:border-b bg-muted/50"},[s("tr",{class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},[s("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Role Name"),s("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Permissions"),s("th",{class:"h-12 px-4 text-right align-middle font-medium text-muted-foreground"},"Actions")])],-1)),s("tbody",je,[(a(!0),p(j,null,z(k.roles.data,h=>(a(),p("tr",{key:h.id,class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},[s("td",ze,[s("div",Ae,[l(e(se),{class:"h-4 w-4 mr-2 text-primary"}),f(" "+y(h.name),1)])]),s("td",Pe,[s("div",Ue,[s("div",Ee,[l(e(R),{variant:"outline",class:"mr-2"},{default:d(()=>[f(y(m(h.permissions))+" permissions ",1)]),_:2},1024),l(e(b),{variant:"ghost",size:"sm",onClick:U=>i(h.id),class:"text-xs"},{default:d(()=>[f(y($.value.includes(h.id)?"Hide details":"Show details"),1)]),_:2},1032,["onClick"])]),$.value.includes(h.id)?(a(),p("div",Le,[(a(!0),p(j,null,z(u(h.permissions),(U,E)=>(a(),p("span",{key:E,class:"inline-flex flex-col mb-2 w-full"},[s("span",Ve,[l(e(te),{class:"h-3 w-3 mr-1"}),f(" "+y(g(E))+" ",1),l(e(R),{variant:"secondary",class:"ml-2"},{default:d(()=>[f(y(U.length),1)]),_:2},1024)]),s("div",Te,[(a(!0),p(j,null,z(U,D=>(a(),p("span",{key:D.id,class:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-muted text-muted-foreground"},y(_(D.name)),1))),128))])]))),128))])):C("",!0)])]),s("td",Oe,[s("div",Re,[l(e(b),{onClick:U=>v.$emit("edit",h),variant:"outline",size:"sm",class:"flex items-center"},{default:d(()=>[l(e(ae),{class:"h-3.5 w-3.5 mr-1"}),w[0]||(w[0]=f(" Edit "))]),_:2},1032,["onClick"]),l(e(b),{onClick:U=>v.$emit("delete",h),variant:"destructive",size:"sm",class:"flex items-center"},{default:d(()=>[l(e(de),{class:"h-3.5 w-3.5 mr-1"}),w[1]||(w[1]=f(" Delete "))]),_:2},1032,["onClick"])])])]))),128))])])]),k.roles.links?(a(),p("div",De,[s("nav",Me,[(a(!0),p(j,null,z(k.roles.links,h=>(a(),P(e(b),{key:h.label,onClick:U=>t(h.url),disabled:!h.url,variant:h.active?"default":"outline",size:"sm",class:"min-w-[40px]",innerHTML:h.label},null,8,["onClick","disabled","variant","innerHTML"]))),128))])])):C("",!0)]))}},Ne={class:"fixed inset-0 z-[100]"},Ge={class:"absolute inset-0 flex items-center justify-center p-2 sm:p-4"},He={class:"bg-background p-4 sm:p-6 rounded-lg shadow-xl w-full sm:max-w-lg md:max-w-2xl lg:max-w-4xl overflow-y-auto max-h-[95vh] animate-in fade-in zoom-in-95 duration-200 border border-border"},Be={class:"flex justify-between items-center mb-4"},Fe={class:"text-xl sm:text-2xl font-bold text-foreground flex items-center"},We={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Xe={class:"space-y-2"},qe={class:"space-y-2"},Je={class:"space-y-2 md:col-span-2"},Ye={key:0,class:"text-destructive ml-1"},Ke={class:"relative"},Qe={key:0,class:"space-y-2 md:col-span-2"},Ze=["value"],Ie={class:"grid grid-cols-1 md:grid-cols-2 gap-4 pt-2"},es={class:"space-y-2"},ss={class:"flex justify-between items-center"},ts={class:"relative"},ls={class:"flex items-center space-x-2"},ns={class:"relative w-full"},os={class:"h-60 border rounded-md p-2 overflow-y-auto"},is={key:0,class:"flex flex-col items-center justify-center h-full text-muted-foreground"},rs={class:"space-y-2"},as={class:"flex justify-between items-center"},ds={class:"flex space-x-2"},us={class:"relative"},cs={class:"flex items-center space-x-2"},ms={class:"relative w-full"},ps={class:"h-60 border rounded-md p-2 overflow-y-auto"},fs={class:"flex items-center justify-between mb-1"},vs={class:"font-medium text-sm text-foreground flex items-center"},gs={class:"flex space-x-1"},xs={key:0,class:"ml-2 text-xs px-2 py-0.5 rounded-full border border-gray-200 bg-gray-100 dark:border-gray-700 dark:bg-gray-800 text-gray-600 dark:text-gray-300"},bs={key:0,class:"flex flex-col items-center justify-center h-full text-muted-foreground"},hs={class:"flex justify-end space-x-3 pt-4"},ht=W({__name:"UserForm",props:{user:{type:Object,default:null},tenants:{type:Array,default:()=>[]},roles:{type:Array,default:()=>[]},permissions:{type:Array,default:()=>[]},isSuperAdmin:{type:Boolean,default:!1},tenantSlug:{type:String,default:null}},emits:["close","saved"],setup(k,{emit:$}){const i=k,m=$,t=F({name:i.user?i.user.name:"",email:i.user?i.user.email:"",password:i.user?i.user.password:"",tenant_id:i.user?i.user.tenant_id:i.tenants.length?i.tenants[0].id:null,roles:i.user&&i.user.roles?i.user.roles.map(o=>o.id):[],user_permissions:i.user&&i.user.permissions?i.user.permissions.map(o=>o.name):[]}),u=N(""),g=N(""),_=N(!1),v=O(()=>{if(!u.value.trim())return i.roles;const o=u.value.toLowerCase();return i.roles.filter(n=>n.name.toLowerCase().includes(o))}),w=O(()=>t.user_permissions.length);O(()=>{if(!g.value.trim())return i.permissions;const o=g.value.toLowerCase();return i.permissions.filter(n=>n.name.toLowerCase().includes(o))});const h=O(()=>{const o=new Set;return i.roles.forEach(n=>{t.roles.includes(n.id)&&n.permissions&&n.permissions.forEach(r=>{o.add(r.name)})}),Array.from(o)});I(()=>i.user,o=>{o?(t.name=o.name,t.email=o.email,t.password=o.password,t.tenant_id=o.tenant_id,t.roles=o.roles?o.roles.map(n=>n.id):[],t.user_permissions=o.permissions?o.permissions.map(n=>n.name):[]):(t.name="",t.email="",t.password="",t.tenant_id=i.tenants.length?i.tenants[0].id:null,t.roles=[],t.user_permissions=[])},{immediate:!0});const U=()=>{i.user?i.isSuperAdmin?t.put(route("admin.users.update",i.user),{onSuccess:()=>{m("saved")}}):t.put(route("users.update",[i.tenantSlug,i.user]),{onSuccess:()=>{m("saved")}}):i.isSuperAdmin?t.post(route("admin.users.store"),{onSuccess:()=>{m("saved")}}):t.post(route("users.store",i.tenantSlug),{onSuccess:()=>{m("saved")}})},E=o=>{const n=t.roles.indexOf(o);n===-1?t.roles.push(o):t.roles.splice(n,1)},D=o=>{if(h.value.includes(o))return;const n=t.user_permissions.indexOf(o);n===-1?t.user_permissions.push(o):t.user_permissions.splice(n,1)},X=()=>{i.permissions.forEach(o=>{!h.value.includes(o.name)&&!t.user_permissions.includes(o.name)&&t.user_permissions.push(o.name)})},q=()=>{t.user_permissions=[]},J=o=>{i.permissions.filter(r=>r.name.startsWith(o+".")).map(r=>r.name).forEach(r=>{!t.user_permissions.includes(r)&&!h.value.includes(r)&&t.user_permissions.push(r)})},H=o=>{t.user_permissions=t.user_permissions.filter(n=>!n.startsWith(o+"."))},M=O(()=>{const o=g.value.trim()?i.permissions.filter(r=>r.name.toLowerCase().includes(g.value.toLowerCase())):i.permissions,n={};return o.forEach(r=>{const S=r.name.split(".")[0];n[S]||(n[S]=[]),n[S].push(r)}),n}),x=o=>o==="tenant-settings"?"Tenant Settings":o==="repair-orders"?"Repair Orders":o==="safety-data"?"Safety Data":o==="miles-driven"?"Miles Driven":o==="support-tickets"?"Support Tickets":o==="sms-coaching"?"SMS Coaching":o==="support-responses"?"Support Responses":o==="receive_updates"?"General":o.charAt(0).toUpperCase()+o.slice(1),c=o=>{const n=o.split(".");return n.length>1?n[1].charAt(0).toUpperCase()+n[1].slice(1).replace(/-/g," "):o};return(o,n)=>(a(),p("div",Ne,[s("div",{class:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:n[0]||(n[0]=()=>m("close"))}),s("div",Ge,[s("div",He,[s("div",Be,[s("h2",Fe,[l(e(ue),{class:"h-5 w-5 mr-2 text-primary"}),f(" "+y(k.user?"Edit User":"Create User"),1)]),l(e(b),{variant:"ghost",size:"icon",onClick:n[1]||(n[1]=()=>m("close"))},{default:d(()=>[l(e(G),{class:"h-5 w-5"})]),_:1})]),s("form",{onSubmit:ee(U,["prevent"]),class:"space-y-4"},[s("div",We,[s("div",Xe,[l(e(A),{for:"name",class:"flex items-center"},{default:d(()=>n[12]||(n[12]=[s("span",null,"Name",-1),s("span",{class:"text-destructive ml-1"},"*",-1)])),_:1}),l(e(V),{id:"name",modelValue:e(t).name,"onUpdate:modelValue":n[2]||(n[2]=r=>e(t).name=r),placeholder:"Enter name",class:B(["w-full",{"border-destructive":e(t).errors.name}])},null,8,["modelValue","class"]),l(L,{message:e(t).errors.name},null,8,["message"])]),s("div",qe,[l(e(A),{for:"email",class:"flex items-center"},{default:d(()=>n[13]||(n[13]=[s("span",null,"Email",-1),s("span",{class:"text-destructive ml-1"},"*",-1)])),_:1}),l(e(V),{id:"email",modelValue:e(t).email,"onUpdate:modelValue":n[3]||(n[3]=r=>e(t).email=r),type:"email",placeholder:"Enter email",class:B(["w-full",{"border-destructive":e(t).errors.email}])},null,8,["modelValue","class"]),l(L,{message:e(t).errors.email},null,8,["message"])]),s("div",Je,[l(e(A),{for:"password",class:"flex items-center"},{default:d(()=>[n[14]||(n[14]=s("span",null,"Password",-1)),k.user?C("",!0):(a(),p("span",Ye,"*"))]),_:1}),s("div",Ke,[l(e(V),{id:"password",modelValue:e(t).password,"onUpdate:modelValue":n[4]||(n[4]=r=>e(t).password=r),type:_.value?"text":"password",placeholder:"Enter password",class:B(["w-full pr-10",{"border-destructive":e(t).errors.password}])},null,8,["modelValue","type","class"]),s("button",{type:"button",onClick:n[5]||(n[5]=r=>_.value=!_.value),class:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"},[_.value?(a(),P(e(me),{key:1,class:"h-5 w-5"})):(a(),P(e(ce),{key:0,class:"h-5 w-5"}))])]),l(L,{message:e(t).errors.password},null,8,["message"])]),k.isSuperAdmin?(a(),p("div",Qe,[l(e(A),{for:"tenant"},{default:d(()=>n[15]||(n[15]=[f("Company Name")])),_:1}),ie(s("select",{id:"tenant","onUpdate:modelValue":n[6]||(n[6]=r=>e(t).tenant_id=r),class:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"},[n[16]||(n[16]=s("option",{value:null},"None",-1)),(a(!0),p(j,null,z(k.tenants,r=>(a(),p("option",{value:r.id,key:r.id},y(r.name),9,Ze))),128))],512),[[re,e(t).tenant_id]]),l(L,{message:e(t).errors.tenant_id},null,8,["message"])])):C("",!0)]),s("div",Ie,[s("div",es,[s("div",ss,[l(e(A),{class:"flex items-center"},{default:d(()=>[l(e(se),{class:"h-4 w-4 mr-1 text-primary"}),n[17]||(n[17]=s("span",null,"Roles",-1)),l(e(R),{variant:"outline",class:"ml-2"},{default:d(()=>[f(y(e(t).roles.length)+" selected",1)]),_:1})]),_:1})]),s("div",ts,[s("div",ls,[s("div",ns,[l(e(Y),{class:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),l(e(V),{modelValue:u.value,"onUpdate:modelValue":n[7]||(n[7]=r=>u.value=r),placeholder:"Search roles...",class:"w-full pl-9"},null,8,["modelValue"])]),u.value?(a(),P(e(b),{key:0,type:"button",variant:"ghost",size:"icon",onClick:n[8]||(n[8]=r=>u.value=""),class:"absolute right-2 top-2"},{default:d(()=>[l(e(G),{class:"h-4 w-4"})]),_:1})):C("",!0)])]),s("div",os,[(a(!0),p(j,null,z(v.value,r=>(a(),p("div",{key:r.id,class:"flex items-center py-1 px-2 hover:bg-muted/50 rounded transition-colors"},[l(e(Q),{id:`role-${r.id}`,checked:e(t).roles.includes(r.id),"onUpdate:checked":T=>E(r.id),class:"mr-2"},null,8,["id","checked","onUpdate:checked"]),l(e(A),{for:`role-${r.id}`,class:"cursor-pointer"},{default:d(()=>[f(y(r.name),1)]),_:2},1032,["for"])]))),128)),v.value.length===0?(a(),p("div",is,[l(e(K),{class:"h-8 w-8 mb-2"}),n[18]||(n[18]=s("p",null,"No roles match your search",-1))])):C("",!0)]),l(L,{message:e(t).errors.roles},null,8,["message"])]),s("div",rs,[s("div",as,[l(e(A),{class:"flex items-center"},{default:d(()=>[l(e(pe),{class:"h-4 w-4 mr-1 text-primary"}),n[19]||(n[19]=s("span",null,"Permissions",-1)),l(e(R),{variant:"outline",class:"ml-2"},{default:d(()=>[f(y(w.value)+" selected",1)]),_:1})]),_:1}),s("div",ds,[l(e(b),{type:"button",variant:"outline",size:"sm",onClick:X,class:"text-xs"},{default:d(()=>n[20]||(n[20]=[f(" Select All ")])),_:1}),l(e(b),{type:"button",variant:"outline",size:"sm",onClick:q,class:"text-xs"},{default:d(()=>n[21]||(n[21]=[f(" Clear All ")])),_:1})])]),s("div",us,[s("div",cs,[s("div",ms,[l(e(Y),{class:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),l(e(V),{modelValue:g.value,"onUpdate:modelValue":n[9]||(n[9]=r=>g.value=r),placeholder:"Search permissions...",class:"w-full pl-9"},null,8,["modelValue"])]),g.value?(a(),P(e(b),{key:0,type:"button",variant:"ghost",size:"icon",onClick:n[10]||(n[10]=r=>g.value=""),class:"absolute right-2 top-2"},{default:d(()=>[l(e(G),{class:"h-4 w-4"})]),_:1})):C("",!0)])]),s("div",ps,[(a(!0),p(j,null,z(M.value,(r,T)=>(a(),p("div",{key:T,class:"mb-4"},[s("div",fs,[s("div",vs,[l(e(te),{class:"h-4 w-4 mr-1 text-muted-foreground"}),f(" "+y(x(T))+" ",1),l(e(R),{variant:"secondary",class:"ml-2"},{default:d(()=>[f(y(r.length),1)]),_:2},1024)]),s("div",gs,[l(e(b),{type:"button",variant:"ghost",size:"sm",onClick:S=>J(T),class:"text-xs h-6 px-2"},{default:d(()=>n[22]||(n[22]=[f(" Select All ")])),_:2},1032,["onClick"]),l(e(b),{type:"button",variant:"ghost",size:"sm",onClick:S=>H(T),class:"text-xs h-6 px-2"},{default:d(()=>n[23]||(n[23]=[f(" Clear ")])),_:2},1032,["onClick"])])]),(a(!0),p(j,null,z(r,S=>(a(),p("div",{key:S.id,class:"flex items-center py-1 px-2 hover:bg-muted/50 rounded transition-colors"},[l(e(Q),{id:`permission-${S.name}`,checked:e(t).user_permissions.includes(S.name),"onUpdate:checked":rt=>D(S.name),disabled:h.value.includes(S.name),class:"mr-2"},null,8,["id","checked","onUpdate:checked","disabled"]),l(e(A),{for:`permission-${S.name}`,class:"cursor-pointer text-sm"},{default:d(()=>[f(y(c(S.name))+" ",1),h.value.includes(S.name)?(a(),p("span",xs," inherited ")):C("",!0)]),_:2},1032,["for"])]))),128))]))),128)),Object.keys(M.value).length===0?(a(),p("div",bs,[l(e(K),{class:"h-8 w-8 mb-2"}),n[24]||(n[24]=s("p",null,"No permissions match your search",-1))])):C("",!0)]),l(L,{message:e(t).errors.user_permissions},null,8,["message"])])]),s("div",hs,[l(e(b),{type:"button",onClick:n[11]||(n[11]=()=>m("close")),variant:"outline"},{default:d(()=>n[25]||(n[25]=[f(" Cancel ")])),_:1}),l(e(b),{type:"submit",disabled:e(t).processing},{default:d(()=>[e(t).processing?(a(),P(e(le),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):C("",!0),f(" "+y(e(t).processing?"Saving...":"Save"),1)]),_:1},8,["disabled"])])],32)])])]))}}),_s={class:"w-full overflow-x-auto"},ys={class:"rounded-md border"},ks={class:"w-full caption-bottom text-sm"},ws={class:"[&_tr:last-child]:border-0"},$s={class:"p-4 align-middle font-medium"},Cs={class:"p-4 align-middle"},Ss={class:"p-4 align-middle text-right"},js={class:"flex justify-end space-x-2"},zs={key:0,class:"mt-6 flex justify-center"},As={class:"flex flex-wrap items-center gap-1 justify-center"},_t={__name:"TenantList",props:{tenants:{type:Object,default:()=>({data:[],links:[]})}},setup(k){const $=k,i=Array.isArray($.tenants)?$.tenants:$.tenants.data||[],m=t=>{t&&Z.get(t,{},{only:["tenants"]})};return(t,u)=>(a(),p("div",_s,[s("div",ys,[s("table",ks,[u[2]||(u[2]=s("thead",{class:"[&_tr]:border-b"},[s("tr",{class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},[s("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Company Name"),s("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Slug"),s("th",{class:"h-12 px-4 text-right pr-16 align-middle font-medium text-muted-foreground"},"Actions")])],-1)),s("tbody",ws,[(a(!0),p(j,null,z(e(i),g=>(a(),p("tr",{key:g.id,class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},[s("td",$s,y(g.name),1),s("td",Cs,y(g.slug),1),s("td",Ss,[s("div",js,[l(e(b),{onClick:_=>t.$emit("edit",g),variant:"outline",size:"sm"},{default:d(()=>u[0]||(u[0]=[f(" Edit ")])),_:2},1032,["onClick"]),l(e(b),{onClick:_=>t.$emit("delete",g),variant:"destructive",size:"sm"},{default:d(()=>u[1]||(u[1]=[f(" Delete ")])),_:2},1032,["onClick"])])])]))),128))])])]),k.tenants.links?(a(),p("div",zs,[s("nav",As,[(a(!0),p(j,null,z(k.tenants.links,g=>(a(),P(e(b),{key:g.label,onClick:_=>m(g.url),disabled:!g.url,variant:g.active?"default":"outline",size:"sm",class:"min-w-[40px]",innerHTML:g.label},null,8,["onClick","disabled","variant","innerHTML"]))),128))])])):C("",!0)]))}},Ps={class:"fixed inset-0 z-50"},Us={class:"absolute inset-0 flex items-center justify-center p-2 sm:p-4"},Es={class:"bg-background p-6 rounded-lg shadow-xl w-full max-w-md overflow-y-auto max-h-[90vh] animate-in fade-in zoom-in-95 duration-200 border border-border"},Ls={class:"flex justify-between items-center mb-4"},Vs={class:"text-2xl font-bold text-foreground"},Ts={class:"space-y-2"},Os={key:0,class:"space-y-2"},Rs={class:"flex justify-end space-x-3 pt-4"},yt=W({__name:"TenantForm",props:{tenant:{type:Object,default:null}},emits:["close","saved"],setup(k,{emit:$}){const i=k,m=$,t=F({name:i.tenant?i.tenant.name:"",slug:i.tenant?i.tenant.slug:""});I(()=>i.tenant,g=>{g?(t.name=g.name,t.slug=g.slug):(t.name="",t.slug="")},{immediate:!0});const u=()=>{i.tenant?t.put(route("admin.tenants.update",i.tenant),{onSuccess:()=>{m("saved")}}):t.post(route("admin.tenants.store"),{onSuccess:()=>{m("saved")}})};return(g,_)=>{const v=ne("X"),w=ne("Loader2");return a(),p("div",Ps,[_[7]||(_[7]=s("div",{class:"absolute inset-0 bg-black/50 backdrop-blur-sm"},null,-1)),s("div",Us,[s("div",Es,[s("div",Ls,[s("h2",Vs,y(k.tenant?"Edit Company":"Create Company"),1),l(e(b),{variant:"ghost",size:"icon",onClick:_[0]||(_[0]=()=>m("close"))},{default:d(()=>[l(v,{class:"h-5 w-5"})]),_:1})]),s("form",{onSubmit:ee(u,["prevent"]),class:"space-y-4"},[s("div",Ts,[l(e(A),{for:"name"},{default:d(()=>_[4]||(_[4]=[f("Company Name")])),_:1}),l(e(V),{id:"name",modelValue:e(t).name,"onUpdate:modelValue":_[1]||(_[1]=h=>e(t).name=h),placeholder:"Enter company name",class:"w-full"},null,8,["modelValue"]),l(L,{message:e(t).errors.name},null,8,["message"])]),k.tenant?(a(),p("div",Os,[l(e(A),{for:"slug"},{default:d(()=>_[5]||(_[5]=[f("Slug")])),_:1}),l(e(V),{id:"slug",modelValue:e(t).slug,"onUpdate:modelValue":_[2]||(_[2]=h=>e(t).slug=h),placeholder:"Enter company slug",class:"w-full"},null,8,["modelValue"]),l(L,{message:e(t).errors.slug},null,8,["message"])])):C("",!0),s("div",Rs,[l(e(b),{type:"button",onClick:_[3]||(_[3]=()=>m("close")),variant:"outline"},{default:d(()=>_[6]||(_[6]=[f(" Cancel ")])),_:1}),l(e(b),{type:"submit",disabled:e(t).processing},{default:d(()=>[e(t).processing?(a(),P(w,{key:0,class:"mr-2 h-4 w-4 animate-spin"})):C("",!0),f(" "+y(e(t).processing?"Saving...":"Save"),1)]),_:1},8,["disabled"])])],32)])])])}}}),Ds={class:"fixed inset-0 z-50"},Ms={class:"absolute inset-0 flex items-center justify-center p-2 sm:p-4"},Ns={class:"bg-background p-4 sm:p-6 rounded-lg shadow-xl w-full max-w-sm sm:max-w-md md:max-w-lg overflow-y-auto max-h-[95vh] animate-in fade-in zoom-in-95 duration-200 border border-border"},Gs={class:"flex justify-between items-center mb-4"},Hs={class:"text-xl sm:text-2xl font-bold text-foreground flex items-center"},Bs={class:"space-y-2"},Fs={class:"space-y-2"},Ws={class:"flex justify-between items-center"},Xs={class:"flex space-x-2"},qs={class:"relative"},Js={class:"flex items-center space-x-2"},Ys={class:"relative w-full"},Ks={class:"h-48 sm:h-56 md:h-64 border rounded-md p-2 overflow-y-auto"},Qs={class:"flex items-center justify-between mb-1"},Zs={class:"font-medium text-sm text-foreground flex items-center"},Is={class:"flex space-x-1"},et={key:0,class:"flex flex-col items-center justify-center h-full text-muted-foreground"},st={class:"flex justify-end space-x-3 pt-4"},kt=W({__name:"RoleForm",props:{role:{type:Object,default:null},permissions:{type:Array,default:()=>[]},isSuperAdmin:{type:Boolean,default:!1},tenantSlug:{type:String,default:null}},emits:["saved","close"],setup(k,{emit:$}){var H,M;const i=$,m=k,{tenantSlug:t}=m,u=F({name:m.role?m.role.name:"",permissions:((M=(H=m.role)==null?void 0:H.permissions)==null?void 0:M.map(x=>x.name))||[]}),g=N(""),_=O(()=>u.permissions.length),v=O(()=>{const x=g.value.trim()?m.permissions.filter(o=>o.name.toLowerCase().includes(g.value.toLowerCase())):m.permissions,c={};return x.forEach(o=>{const r=o.name.split(".")[0];c[r]||(c[r]=[]),c[r].push(o)}),c}),w=x=>x==="tenant-settings"?"Tenant Settings":x==="repair-orders"?"Repair Orders":x==="safety-data"?"Safety Data":x==="miles-driven"?"Miles Driven":x==="support-tickets"?"Support Tickets":x==="sms-coaching"?"SMS Coaching":x==="support-responses"?"Support Responses":x==="receive_updates"?"General":x.charAt(0).toUpperCase()+x.slice(1),h=x=>{const c=x.split(".");return c.length>1?c[1].charAt(0).toUpperCase()+c[1].slice(1).replace(/-/g," "):x};I(()=>m.role,x=>{var c;x?(u.name=x.name,u.permissions=((c=x.permissions)==null?void 0:c.map(o=>o.name))||[]):(u.name="",u.permissions=[])},{immediate:!0});const U=x=>{const c=u.permissions.indexOf(x);c===-1?u.permissions.push(x):u.permissions.splice(c,1)},E=()=>{u.permissions=m.permissions.map(x=>x.name)},D=()=>{u.permissions=[]},X=x=>{m.permissions.filter(o=>o.name.startsWith(x+".")).map(o=>o.name).forEach(o=>{u.permissions.includes(o)||u.permissions.push(o)})},q=x=>{u.permissions=u.permissions.filter(c=>!c.startsWith(x+"."))},J=()=>{m.role?m.isSuperAdmin?u.put(route("admin.roles.update",m.role.id),{onSuccess:()=>{i("saved")}}):u.put(route("roles.update",[t,m.role.id]),{onSuccess:()=>{i("saved")}}):m.isSuperAdmin?u.post(route("admin.roles.store"),{onSuccess:()=>{i("saved")}}):u.post(route("roles.store",t),{onSuccess:()=>{i("saved")}})};return(x,c)=>(a(),p("div",Ds,[c[13]||(c[13]=s("div",{class:"absolute inset-0 bg-black/50 backdrop-blur-sm"},null,-1)),s("div",Ms,[s("div",Ns,[s("div",Gs,[s("h2",Hs,[l(e(se),{class:"h-5 w-5 mr-2 text-primary"}),f(" "+y(k.role?"Edit Role":"Create Role"),1)]),l(e(b),{variant:"ghost",size:"icon",onClick:c[0]||(c[0]=()=>i("close"))},{default:d(()=>[l(e(G),{class:"h-5 w-5"})]),_:1})]),s("form",{onSubmit:ee(J,["prevent"]),class:"space-y-4"},[s("div",Bs,[l(e(A),{for:"name",class:"flex items-center"},{default:d(()=>c[5]||(c[5]=[s("span",null,"Role Name",-1),s("span",{class:"text-destructive ml-1"},"*",-1)])),_:1}),l(e(V),{id:"name",modelValue:e(u).name,"onUpdate:modelValue":c[1]||(c[1]=o=>e(u).name=o),placeholder:"Enter role name",class:B(["w-full",{"border-destructive":e(u).errors.name}]),autofocus:""},null,8,["modelValue","class"]),l(L,{message:e(u).errors.name},null,8,["message"])]),s("div",Fs,[s("div",Ws,[l(e(A),{class:"flex items-center"},{default:d(()=>[c[6]||(c[6]=s("span",null,"Permissions",-1)),l(e(R),{variant:"outline",class:"ml-2"},{default:d(()=>[f(y(_.value)+" selected",1)]),_:1})]),_:1}),s("div",Xs,[l(e(b),{type:"button",variant:"outline",size:"sm",onClick:E,class:"text-xs"},{default:d(()=>c[7]||(c[7]=[f(" Select All ")])),_:1}),l(e(b),{type:"button",variant:"outline",size:"sm",onClick:D,class:"text-xs"},{default:d(()=>c[8]||(c[8]=[f(" Clear All ")])),_:1})])]),s("div",qs,[s("div",Js,[s("div",Ys,[l(e(Y),{class:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),l(e(V),{modelValue:g.value,"onUpdate:modelValue":c[2]||(c[2]=o=>g.value=o),placeholder:"Search permissions...",class:"w-full pl-9"},null,8,["modelValue"])]),g.value?(a(),P(e(b),{key:0,type:"button",variant:"ghost",size:"icon",onClick:c[3]||(c[3]=o=>g.value=""),class:"absolute right-2 top-2"},{default:d(()=>[l(e(G),{class:"h-4 w-4"})]),_:1})):C("",!0)])]),s("div",Ks,[(a(!0),p(j,null,z(v.value,(o,n)=>(a(),p("div",{key:n,class:"mb-4"},[s("div",Qs,[s("div",Zs,[l(e(te),{class:"h-4 w-4 mr-1 text-muted-foreground"}),f(" "+y(w(n))+" ",1),l(e(R),{variant:"secondary",class:"ml-2"},{default:d(()=>[f(y(o.length),1)]),_:2},1024)]),s("div",Is,[l(e(b),{type:"button",variant:"ghost",size:"sm",onClick:r=>X(n),class:"text-xs h-6 px-2"},{default:d(()=>c[9]||(c[9]=[f(" Select All ")])),_:2},1032,["onClick"]),l(e(b),{type:"button",variant:"ghost",size:"sm",onClick:r=>q(n),class:"text-xs h-6 px-2"},{default:d(()=>c[10]||(c[10]=[f(" Clear ")])),_:2},1032,["onClick"])])]),(a(!0),p(j,null,z(o,r=>(a(),p("div",{key:r.id,class:"flex items-center py-1 px-2 hover:bg-muted/50 rounded transition-colors"},[l(e(Q),{id:`permission-${r.name}`,checked:e(u).permissions.includes(r.name),"onUpdate:checked":T=>U(r.name),class:"mr-2"},null,8,["id","checked","onUpdate:checked"]),l(e(A),{for:`permission-${r.name}`,class:"cursor-pointer text-sm"},{default:d(()=>[f(y(h(r.name)),1)]),_:2},1032,["for"])]))),128))]))),128)),Object.keys(v.value).length===0?(a(),p("div",et,[l(e(K),{class:"h-8 w-8 mb-2"}),c[11]||(c[11]=s("p",null,"No permissions match your search",-1))])):C("",!0)]),l(L,{message:e(u).errors.permissions},null,8,["message"])]),s("div",st,[l(e(b),{type:"button",onClick:c[4]||(c[4]=()=>i("close")),variant:"outline"},{default:d(()=>c[12]||(c[12]=[f(" Cancel ")])),_:1}),l(e(b),{type:"submit",disabled:e(u).processing},{default:d(()=>[e(u).processing?(a(),P(e(le),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):C("",!0),f(" "+y(e(u).processing?"Saving...":"Save"),1)]),_:1},8,["disabled"])])],32)])])]))}}),tt={class:"fixed inset-0 flex items-center justify-center bg-black/50 backdrop-blur-sm z-50 p-4"},lt={class:"bg-background p-6 rounded-lg shadow-xl w-full max-w-md animate-in fade-in zoom-in-95 duration-200 border border-border"},nt={class:"flex flex-col space-y-4"},ot={class:"text-muted-foreground"},it={class:"flex justify-end space-x-3 pt-2"},wt=W({__name:"ConfirmDeleteModal",props:{message:{type:String,default:"Are you sure you want to delete this item?"},deleteUrl:{type:String,required:!0},tenantSlug:{type:String,default:null}},emits:["cancel","confirmed"],setup(k,{emit:$}){const i=k,m=$,t=F({}),u=()=>{t.delete(i.deleteUrl,{onSuccess:()=>{m("confirmed")}})},g=()=>{m("cancel")};return(_,v)=>(a(),p("div",tt,[s("div",lt,[s("div",nt,[v[1]||(v[1]=s("h2",{class:"text-xl font-bold text-foreground"},"Confirm Deletion",-1)),s("p",ot,y(k.message),1),s("div",it,[l(e(b),{type:"button",onClick:g,variant:"outline"},{default:d(()=>v[0]||(v[0]=[f(" Cancel ")])),_:1}),l(e(b),{type:"button",variant:"destructive",onClick:u,disabled:e(t).processing},{default:d(()=>[e(t).processing?(a(),P(e(le),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):C("",!0),f(" "+y(e(t).processing?"Deleting...":"Delete"),1)]),_:1},8,["disabled"])])])])]))}});export{xt as _,bt as a,_t as b,ht as c,yt as d,kt as e,wt as f};
