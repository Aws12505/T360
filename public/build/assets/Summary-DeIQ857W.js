import{z as we,b as he,E as ke,W as H,g as $e}from"./vendor-vue-BIhQdEdd.js";import{_ as De}from"./AppLayout.vue_vue_type_script_setup_true_lang-DnDcxt42.js";import{_ as J}from"./Icon.vue_vue_type_script_setup_true_lang-C-mirX2J.js";import{_ as M}from"./Badge.vue_vue_type_script_setup_true_lang-CnxAYvm1.js";import{_ as Q}from"./Button.vue_vue_type_script_setup_true_lang-CZMgI4AI.js";import{_ as Se,a as je,b as Te,c as Be,d as Ce}from"./DialogTitle.vue_vue_type_script_setup_true_lang-BAHS8JjQ.js";import{_ as Re}from"./DialogFooter.vue_vue_type_script_setup_true_lang-CMVRlm2Q.js";import{a as Y,b as U,c as R,d as Z,_ as X,e as N}from"./TableRow.vue_vue_type_script_setup_true_lang-CgXPUvWo.js";import{J as I,B as q,a7 as y,N as m,a9 as B,aa as A,an as e,af as r,aR as E,L as F,I as n,aU as Ne,aO as ve,O as o,a6 as O,a1 as s,ae as v,A as S,aV as Ae,av as ee,P as Fe,aL as be,a0 as xe}from"./vendor-DW_gyfXE.js";import{c as Oe}from"./utils-BCw79v42.js";import{_ as Me}from"./Card.vue_vue_type_script_setup_true_lang-Cv_RhfZi.js";import{_ as Ie}from"./CardContent.vue_vue_type_script_setup_true_lang-CJoJj2cM.js";import{_ as Ve,a as We}from"./CardTitle.vue_vue_type_script_setup_true_lang-DvbDsVuE.js";import{_ as _e,a as ye}from"./Label.vue_vue_type_script_setup_true_lang-gg10UQW6.js";import"./vendor-axios-xsH4HHeE.js";import"./vendor-ui-m5Us76-N.js";import"./app-B0NuZhfC.js";import"./vendor-d3-CjigyTW8.js";import"./vendor-icons-DY85x-Wz.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BHAHC43q.js";const Pe={class:"flex border-b mb-6"},qe=["onClick"],Ee=I({__name:"TabsHeader",emits:["tab-change"],setup(t,{expose:l,emit:b}){const p=[{id:"on-time",label:"On-Time"},{id:"acceptance",label:"Acceptance"},{id:"safety",label:"Safety"},{id:"maintenance",label:"Maintenance"}],g=q("on-time"),c=b,f=i=>{g.value=i,c("tab-change",i)};return l({activeTab:g}),(i,u)=>(m(),y("div",Pe,[(m(),y(B,null,A(p,x=>e("button",{key:x.id,onClick:()=>f(x.id),class:E(["px-4 py-2 font-medium text-sm transition-colors",[g.value===x.id?"text-primary border-b-2 border-primary":"text-muted-foreground hover:text-foreground"]])},r(x.label),11,qe)),64))]))}}),Le=I({__name:"ChartSingleTooltip",props:{selector:{},index:{},items:{},valueFormatter:{type:Function},customTooltip:{}},setup(t){const l=t,b=new WeakMap;function p(g,c,f){const i=l.valueFormatter??(u=>`${u}`);if(l.index in g){if(b.has(g))return b.get(g);{const u=document.createElement("div"),x=Object.entries(Ne(g,[l.index])).map(([D,k])=>{var d;return{...(d=l.items)==null?void 0:d.find(C=>C.name===D),value:i(k)}}),w=l.customTooltip??pe;return ve(w,{title:g[l.index],data:x}).mount(u),b.set(g,u.innerHTML),u.innerHTML}}else{const u=g.data;if(b.has(u))return b.get(u);{const x=getComputedStyle(f[c]),w=[{name:u.name,value:i(u[l.index]),color:x.fill}],D=document.createElement("div"),k=l.customTooltip??pe;return ve(k,{title:g[l.index],data:w}).mount(D),b.set(g,D.innerHTML),D.innerHTML}}}return(g,c)=>(m(),F(n(we),{"horizontal-shift":20,"vertical-shift":20,triggers:{[g.selector]:p}},null,8,["triggers"]))}}),Ue={class:"flex items-center"},ze={class:"w-2.5 h-2.5 mr-2"},Qe={width:"100%",height:"100%",viewBox:"0 0 30 30"},Ge=["stroke","fill"],He={class:"font-semibold ml-4"},pe=I({__name:"ChartTooltip",props:{title:{},data:{}},setup(t){return(l,b)=>(m(),F(n(Me),{class:"text-sm"},{default:o(()=>[l.title?(m(),F(n(Ve),{key:0,class:"p-3 border-b"},{default:o(()=>[s(n(We),null,{default:o(()=>[v(r(l.title),1)]),_:1})]),_:1})):O("",!0),s(n(Ie),{class:"p-3 min-w-[180px] flex flex-col gap-1"},{default:o(()=>[(m(!0),y(B,null,A(l.data,(p,g)=>(m(),y("div",{key:g,class:"flex justify-between"},[e("div",Ue,[e("span",ze,[(m(),y("svg",Qe,[e("path",{d:" M 15 15 m -14, 0 a 14,14 0 1,1 28,0 a 14,14 0 1,1 -28,0",stroke:p.color,fill:p.color,"stroke-width":"1"},null,8,Ge)]))]),e("span",null,r(p.name),1)]),e("span",He,r(p.value),1)]))),128))]),_:1})]),_:1}))}});function Ke(t=3){const l=Math.floor(t/2),b=t%2,p=l+b,g=l;return[...Array.from(new Array(p).keys()).map(c=>`hsl(var(--vis-primary-color) / ${1-1/p*c})`),...Array.from(new Array(g).keys()).map(c=>`hsl(var(--vis-secondary-color) / ${1-1/g*c})`)]}const te=I({__name:"DonutChart",props:{data:{},colors:{},index:{},margin:{default:()=>({top:0,bottom:0,left:0,right:0})},showLegend:{type:Boolean,default:!0},showTooltip:{type:Boolean,default:!0},filterOpacity:{default:.2},category:{},type:{default:"donut"},sortFunction:{type:Function,default:()=>{}},valueFormatter:{},customTooltip:{}},setup(t){const l=t,b=l.valueFormatter??(w=>`${w}`),p=S(()=>l.category),g=S(()=>l.index),c=Ae(),f=q(),i=S(()=>{var w;return(w=l.colors)!=null&&w.length?l.colors:Ke(l.data.filter(D=>D[l.category]).filter(Boolean).length)}),u=S(()=>l.data.map((w,D)=>({name:w[l.index],color:i.value[D],inactive:!1}))),x=S(()=>l.data.reduce((w,D)=>w+D[l.category],0));return(w,D)=>(m(),y("div",{class:E(n(Oe)("w-full h-48 flex flex-col items-end",w.$attrs.class??""))},[s(n(he),{style:ee({height:n(c)?"100%":"auto"}),margin:{left:20,right:20},data:w.data},{default:o(()=>[s(n(Le),{selector:n(be).selectors.segment,index:p.value,items:u.value,"value-formatter":n(b),"custom-tooltip":w.customTooltip},null,8,["selector","index","items","value-formatter","custom-tooltip"]),s(n(ke),{value:k=>k[p.value],"sort-function":w.sortFunction,color:i.value,"arc-width":w.type==="donut"?20:0,"show-background":!1,"central-label":w.type==="donut"?n(b)(x.value):"",events:{[n(be).selectors.segment]:{click:(k,a,d,C)=>{var W,j;((W=k==null?void 0:k.data)==null?void 0:W[g.value])===f.value?(f.value=void 0,C.forEach(V=>V.style.opacity="1")):(f.value=(j=k==null?void 0:k.data)==null?void 0:j[g.value],C.forEach(V=>V.style.opacity=`${w.filterOpacity}`),C[d].style.opacity="1")}}}},null,8,["value","sort-function","color","arc-width","central-label","events"]),Fe(w.$slots,"default")]),_:3},8,["style","data"])],2))}}),Je={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},Ye={class:"bg-card rounded-lg border shadow-sm"},Ze={class:"p-4"},Xe={class:"mt-4 text-right"},et={class:"bg-card rounded-lg border shadow-sm"},tt={class:"p-4 flex flex-col items-center"},at={class:"mt-6 w-full grid grid-cols-2 gap-4"},nt={class:"text-sm"},st=I({__name:"OnTimeContent",props:{delayBreakdownsByDriver:{type:Array,default:()=>[]},delayBreakdownsByCode:{type:Array,default:()=>[]},tenantSlug:{type:String,required:!0}},setup(t){const l=t,b=S(()=>[...l.delayBreakdownsByDriver].sort((f,i)=>i.total_delays-f.total_delays).slice(0,5)),p=()=>{H.visit(route("ontime.index",{tenantSlug:l.tenantSlug}))},g=S(()=>{const f=[...l.delayBreakdownsByCode].sort((u,x)=>x.total_delays-u.total_delays).slice(0,4),i=f.reduce((u,x)=>u+x.total_delays,0);return f.map(u=>({label:u.code||"Unknown",value:i>0?Math.round(u.total_delays/i*100):0}))}),c=["#1e40af","#3b82f6","#60a5fa","#93c5fd"];return(f,i)=>(m(),y("div",Je,[e("div",Ye,[i[5]||(i[5]=e("div",{class:"p-4 border-b"},[e("h3",{class:"text-lg font-semibold"},"Total delays by driver")],-1)),e("div",Ze,[s(n(X),null,{default:o(()=>[s(n(Y),null,{default:o(()=>[s(n(U),null,{default:o(()=>[s(n(R),null,{default:o(()=>i[0]||(i[0]=[v("Driver Name")])),_:1}),s(n(R),null,{default:o(()=>i[1]||(i[1]=[v("Origin Delays")])),_:1}),s(n(R),null,{default:o(()=>i[2]||(i[2]=[v("Destination Delays")])),_:1}),s(n(R),null,{default:o(()=>i[3]||(i[3]=[v("Total")])),_:1})]),_:1})]),_:1}),s(n(Z),null,{default:o(()=>[(m(!0),y(B,null,A(b.value,(u,x)=>(m(),F(n(U),{key:x},{default:o(()=>[s(n(N),null,{default:o(()=>[v(r(u.driver_name||"Unknown"),1)]),_:2},1024),s(n(N),null,{default:o(()=>[v(r(u.total_origin_delays),1)]),_:2},1024),s(n(N),null,{default:o(()=>[v(r(u.total_destination_delays),1)]),_:2},1024),s(n(N),null,{default:o(()=>[v(r(u.total_delays),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),e("div",Xe,[s(n(Q),{variant:"link",size:"sm",class:"text-primary",onClick:p},{default:o(()=>i[4]||(i[4]=[v(" See details... ")])),_:1})])])]),e("div",et,[i[6]||(i[6]=e("div",{class:"p-4 border-b"},[e("h3",{class:"text-lg font-semibold"},"Delays By Reason")],-1)),e("div",tt,[s(n(te),{category:"value",data:g.value,colors:c,index:"label",showTooltip:!0,tooltipTemplate:u=>`${u.label}: ${u.value}%`,class:"max-w-[500px]"},null,8,["data","tooltipTemplate"]),e("div",at,[(m(!0),y(B,null,A(g.value,(u,x)=>(m(),y("div",{key:x,class:"flex items-center"},[e("div",{class:"w-3 h-3 rounded-full mr-2",style:ee({backgroundColor:c[x]})},null,4),e("span",nt,r(u.label)+": "+r(u.value)+"%",1)]))),128))])])])]))}}),ot={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},rt={class:"bg-card rounded-lg border shadow-sm"},lt={class:"p-4"},it={class:"mt-4 text-right"},dt={class:"bg-card rounded-lg border shadow-sm"},ut={class:"p-4 flex flex-col items-center"},ct={class:"mt-6 w-full grid grid-cols-2 gap-4"},mt={class:"text-sm"},ft=I({__name:"AcceptanceContent",props:{rejectionBreakdownsByDriver:{type:Array,default:()=>[]},rejectionBreakdownsByReason:{type:Array,default:()=>[]},tenantSlug:{type:String,required:!0}},setup(t){const l=t,b=S(()=>[...l.rejectionBreakdownsByDriver].sort((f,i)=>i.total_rejections-f.total_rejections).slice(0,5)),p=()=>{H.visit(route("acceptance.index",{tenantSlug:l.tenantSlug}))},g=S(()=>{const f=[...l.rejectionBreakdownsByReason].sort((u,x)=>x.total_rejections-u.total_rejections).slice(0,4),i=f.reduce((u,x)=>u+x.total_rejections,0);return f.map(u=>({label:u.reason_code||"Unknown",value:i>0?Math.round(u.total_rejections/i*100):0}))}),c=["#1e40af","#3b82f6","#60a5fa","#93c5fd"];return(f,i)=>(m(),y("div",ot,[e("div",rt,[i[5]||(i[5]=e("div",{class:"p-4 border-b"},[e("h3",{class:"text-lg font-semibold"},"Total rejections by driver")],-1)),e("div",lt,[s(n(X),null,{default:o(()=>[s(n(Y),null,{default:o(()=>[s(n(U),null,{default:o(()=>[s(n(R),null,{default:o(()=>i[0]||(i[0]=[v("Driver Name")])),_:1}),s(n(R),null,{default:o(()=>i[1]||(i[1]=[v("Load rejections")])),_:1}),s(n(R),null,{default:o(()=>i[2]||(i[2]=[v("Block rejections")])),_:1}),s(n(R),null,{default:o(()=>i[3]||(i[3]=[v("Penalty")])),_:1})]),_:1})]),_:1}),s(n(Z),null,{default:o(()=>[(m(!0),y(B,null,A(b.value,(u,x)=>(m(),F(n(U),{key:x},{default:o(()=>[s(n(N),null,{default:o(()=>[v(r(u.driver_name||"Unknown"),1)]),_:2},1024),s(n(N),null,{default:o(()=>[v(r(u.total_load_rejections),1)]),_:2},1024),s(n(N),null,{default:o(()=>[v(r(u.total_block_rejections),1)]),_:2},1024),s(n(N),null,{default:o(()=>[v(r(u.total_penalty),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),e("div",it,[s(n(Q),{variant:"link",size:"sm",class:"text-primary",onClick:p},{default:o(()=>i[4]||(i[4]=[v(" See details... ")])),_:1})])])]),e("div",dt,[i[6]||(i[6]=e("div",{class:"p-4 border-b"},[e("h3",{class:"text-lg font-semibold"},"Rejections by Reason")],-1)),e("div",ut,[s(n(te),{data:g.value,colors:c,index:"label",category:"value",showTooltip:!0,tooltipTemplate:u=>`${u.label}: ${u.value}%`},null,8,["data","tooltipTemplate"]),e("div",ct,[(m(!0),y(B,null,A(g.value,(u,x)=>(m(),y("div",{key:x,class:"flex items-center"},[e("div",{class:"w-3 h-3 rounded-full mr-2",style:ee({backgroundColor:c[x]})},null,4),e("span",mt,r(u.label)+": "+r(u.value)+"%",1)]))),128))])])])]))}}),gt={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},vt={class:"bg-card rounded-lg border shadow-sm"},bt={class:"p-4"},_t={class:"space-y-3"},yt={key:0,class:"text-center text-muted-foreground"},pt={class:"mt-4 text-right"},xt={class:"bg-card rounded-lg border shadow-sm"},wt={class:"p-4"},ht={class:"space-y-3"},kt={key:0,class:"text-center text-muted-foreground"},$t={class:"bg-card rounded-lg border shadow-sm"},Dt={class:"p-4 flex flex-col items-center"},St={class:"mt-6 w-full space-y-2"},jt={class:"flex items-center"},Tt={class:"text-sm"},Bt={class:"text-sm font-medium"},Ct=I({__name:"SafetyContent",props:{safetyData:{type:Object,default:()=>({})},tenantSlug:{type:String,required:!0}},setup(t){const l=t,b=()=>{H.visit(route("safety.index",{tenantSlug:l.tenantSlug}))},p=S(()=>{const c=(l.safetyData.traffic_light_violation||0)+(l.safetyData.speeding_violations||0)+(l.safetyData.following_distance||0)+(l.safetyData.driver_distraction||0)+(l.safetyData.sign_violations||0);return c===0?[{label:"No Data",value:100}]:[{label:"Speeding Violations",value:c>0?Math.round((l.safetyData.speeding_violations||0)/c*100*10)/10:0},{label:"Traffic Light Violation",value:c>0?Math.round((l.safetyData.traffic_light_violation||0)/c*100*10)/10:0},{label:"Following Distance",value:c>0?Math.round((l.safetyData.following_distance||0)/c*100*10)/10:0},{label:"Driver Distraction",value:c>0?Math.round((l.safetyData.driver_distraction||0)/c*100*10)/10:0},{label:"Sign Violations",value:c>0?Math.round((l.safetyData.sign_violations||0)/c*100*10)/10:0}].filter(f=>f.value>0)}),g=["#1e40af","#3b82f6","#60a5fa","#93c5fd","#bfdbfe"];return(c,f)=>(m(),y("div",gt,[e("div",vt,[f[1]||(f[1]=e("div",{class:"p-4 border-b"},[e("h3",{class:"text-lg font-semibold"},"Top 5 Drivers")],-1)),e("div",bt,[e("ul",_t,[(m(!0),y(B,null,A(t.safetyData.top_drivers||[],(i,u)=>(m(),y("li",{key:u,class:"flex justify-between items-center"},[e("span",null,r(i.name),1),s(n(M),{variant:"outline"},{default:o(()=>[v(r(i.score),1)]),_:2},1024)]))),128)),(t.safetyData.top_drivers||[]).length===0?(m(),y("li",yt," No data available ")):O("",!0)]),e("div",pt,[s(n(Q),{variant:"link",size:"sm",class:"text-primary",onClick:b},{default:o(()=>f[0]||(f[0]=[v(" See details... ")])),_:1})])])]),e("div",xt,[f[2]||(f[2]=e("div",{class:"p-4 border-b"},[e("h3",{class:"text-lg font-semibold"},"Bottom 5 Drivers")],-1)),e("div",wt,[e("ul",ht,[(m(!0),y(B,null,A(t.safetyData.bottom_drivers||[],(i,u)=>(m(),y("li",{key:u,class:"flex justify-between items-center"},[e("span",null,r(i.name),1),s(n(M),{variant:"outline"},{default:o(()=>[v(r(i.score),1)]),_:2},1024)]))),128)),(t.safetyData.bottom_drivers||[]).length===0?(m(),y("li",kt," No data available ")):O("",!0)])])]),e("div",$t,[f[3]||(f[3]=e("div",{class:"p-4 border-b"},[e("h3",{class:"text-lg font-semibold"},"Safety Summary")],-1)),e("div",Dt,[s(n(te),{category:"value",data:p.value,colors:g,index:"label",showTooltip:!0,tooltipTemplate:i=>`${i.label}: ${i.value}%`,class:"max-w-[200px]"},null,8,["data","tooltipTemplate"]),e("div",St,[(m(!0),y(B,null,A(p.value,(i,u)=>(m(),y("div",{key:u,class:"flex items-center justify-between"},[e("div",jt,[e("div",{class:"w-3 h-3 rounded-full mr-2",style:ee({backgroundColor:g[u]})},null,4),e("span",Tt,r(i.label),1)]),e("span",Bt,r(i.value)+"%",1)]))),128))])])])]))}}),Rt={class:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6"},Nt={class:"bg-card rounded-lg border shadow-sm"},At={class:"p-4"},Ft={class:"space-y-4"},Ot={class:"flex justify-between items-center"},Mt={class:"font-medium"},It={class:"flex justify-between items-center"},Vt={class:"font-medium"},Wt={class:"flex justify-between items-center"},Pt={class:"font-medium"},qt={class:"flex justify-between items-center"},Et={class:"font-medium"},Lt={class:"flex justify-between items-center"},Ut={class:"font-medium"},zt={class:"flex justify-between items-center"},Qt={class:"font-medium"},Gt={class:"flex justify-between items-center"},Ht={class:"font-medium"},Kt={class:"mt-4 text-right"},Jt={class:"bg-card rounded-lg border shadow-sm"},Yt={class:"p-4"},Zt={class:"space-y-3"},Xt={class:"text-sm"},ea={key:0,class:"text-center text-muted-foreground"},ta={class:"bg-card rounded-lg border shadow-sm"},aa={class:"p-4"},na={class:"space-y-3"},sa={class:"text-sm"},oa={key:0,class:"text-center text-muted-foreground"},ra={class:"bg-card rounded-lg border shadow-sm p-4 mb-6"},la={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ia={class:"mt-4 flex justify-end"},da={key:0,class:"bg-card rounded-lg border shadow-sm mb-6"},ua={class:"p-4 border-b flex justify-between items-center"},ca={class:"p-4"},ma={key:1,class:"bg-card rounded-lg border shadow-sm mb-6"},fa=I({__name:"MaintenanceContent",props:{maintenanceData:{type:Object,default:()=>({})},tenantSlug:{type:String,required:!0},showOutstandingInvoicesSection:{type:Boolean,default:!1},initialMinInvoiceAmount:{type:[Number,String,null],default:null},initialOutstandingDate:{type:[String,null],default:null}},emits:["filter-applied"],setup(t,{emit:l}){const b=t,p=l,g=q(b.initialMinInvoiceAmount),c=q(b.initialOutstandingDate),f=()=>{p("filter-applied",{minInvoiceAmount:g.value,outstandingDate:c.value})},i=()=>{H.visit(route("repair_orders.index",{tenantSlug:b.tenantSlug}))},u=S(()=>(b.maintenanceData.areas_of_concern||[]).slice(0,5)),x=S(()=>(b.maintenanceData.work_orders_by_truck||[]).slice(0,5)),w=(k,a=2)=>k==null?"0.00":Number(k).toFixed(a),D=(k,a=0)=>k==null?"0":Number(k).toLocaleString("en-US",{minimumFractionDigits:a,maximumFractionDigits:a});return(k,a)=>(m(),y(B,null,[e("div",Rt,[e("div",Nt,[a[10]||(a[10]=e("div",{class:"p-4 border-b"},[e("h3",{class:"text-lg font-semibold"},"Maintenance Overview")],-1)),e("div",At,[e("div",Ft,[e("div",Ot,[a[2]||(a[2]=e("span",{class:"text-sm text-muted-foreground"},"Total Repair Orders:",-1)),e("span",Mt,r(t.maintenanceData.total_repair_orders||0),1)]),e("div",It,[a[3]||(a[3]=e("span",{class:"text-sm text-muted-foreground"},"Total Invoice Amount:",-1)),e("span",Vt,"$"+r(w(t.maintenanceData.total_invoice_amount)),1)]),e("div",Wt,[a[4]||(a[4]=e("span",{class:"text-sm text-muted-foreground"},"QS Invoice Amount:",-1)),e("span",Pt,"$"+r(w(t.maintenanceData.qs_invoice_amount)),1)]),e("div",qt,[a[5]||(a[5]=e("span",{class:"text-sm text-muted-foreground"},"Total Miles:",-1)),e("span",Et,r(D(t.maintenanceData.total_miles)),1)]),e("div",Lt,[a[6]||(a[6]=e("span",{class:"text-sm text-muted-foreground"},"Cost Per Mile (CPM):",-1)),e("span",Ut,"$"+r(w(t.maintenanceData.cpm,3)),1)]),e("div",zt,[a[7]||(a[7]=e("span",{class:"text-sm text-muted-foreground"},"QS CPM:",-1)),e("span",Qt,"$"+r(w(t.maintenanceData.qs_cpm,3)),1)]),e("div",Gt,[a[8]||(a[8]=e("span",{class:"text-sm text-muted-foreground"},"QS MVtS:",-1)),e("span",Ht,r(D(t.maintenanceData.qs_MVtS,2)),1)])]),e("div",Kt,[s(n(Q),{variant:"link",size:"sm",class:"text-primary",onClick:i},{default:o(()=>a[9]||(a[9]=[v(" See details... ")])),_:1})])])]),e("div",Jt,[a[11]||(a[11]=e("div",{class:"p-4 border-b"},[e("h3",{class:"text-lg font-semibold"},"Areas of Concern")],-1)),e("div",Yt,[e("ul",Zt,[(m(!0),y(B,null,A(u.value,(d,C)=>(m(),y("li",{key:C,class:"flex justify-between items-center"},[e("span",Xt,r(d.concern),1),s(n(M),{variant:"outline"},{default:o(()=>[v(r(d.count),1)]),_:2},1024)]))),128)),u.value.length===0?(m(),y("li",ea," No data available ")):O("",!0)])])]),e("div",ta,[a[12]||(a[12]=e("div",{class:"p-4 border-b"},[e("h3",{class:"text-lg font-semibold"},"Top Trucks by Work Orders")],-1)),e("div",aa,[e("ul",na,[(m(!0),y(B,null,A(x.value,(d,C)=>(m(),y("li",{key:C,class:"flex justify-between items-center"},[e("span",sa,"Truck #"+r(d.truckid),1),s(n(M),{variant:"outline"},{default:o(()=>[v(r(d.work_order_count),1)]),_:2},1024)]))),128)),x.value.length===0?(m(),y("li",oa," No data available ")):O("",!0)])])])]),e("div",ra,[a[16]||(a[16]=e("h3",{class:"text-lg font-semibold mb-4"},"Outstanding Invoices Filter",-1)),e("div",la,[e("div",null,[s(n(_e),{for:"min-invoice-amount"},{default:o(()=>a[13]||(a[13]=[v("Minimum Invoice Amount ($)")])),_:1}),s(n(ye),{id:"min-invoice-amount",modelValue:g.value,"onUpdate:modelValue":a[0]||(a[0]=d=>g.value=d),type:"number",min:"0",step:"100",placeholder:"Enter minimum amount",class:"mt-1"},null,8,["modelValue"])]),e("div",null,[s(n(_e),{for:"outstanding-since"},{default:o(()=>a[14]||(a[14]=[v("Outstanding Since")])),_:1}),s(n(ye),{id:"outstanding-since",modelValue:c.value,"onUpdate:modelValue":a[1]||(a[1]=d=>c.value=d),type:"date",class:"mt-1"},null,8,["modelValue"])])]),e("div",ia,[s(n(Q),{onClick:f},{default:o(()=>a[15]||(a[15]=[v("Apply Filter")])),_:1})])]),t.maintenanceData.outstanding_invoices&&t.maintenanceData.outstanding_invoices.length>0?(m(),y("div",da,[e("div",ua,[a[17]||(a[17]=e("h3",{class:"text-lg font-semibold"},"Outstanding Invoices",-1)),s(n(M),{variant:"outline",class:"text-sm"},{default:o(()=>[v(r(t.maintenanceData.outstanding_invoices.length)+" invoices",1)]),_:1})]),e("div",ca,[s(n(X),null,{default:o(()=>[s(n(Y),null,{default:o(()=>[s(n(U),null,{default:o(()=>[s(n(R),null,{default:o(()=>a[18]||(a[18]=[v("RO Number")])),_:1}),s(n(R),null,{default:o(()=>a[19]||(a[19]=[v("Vendor")])),_:1}),s(n(R),null,{default:o(()=>a[20]||(a[20]=[v("Week")])),_:1}),s(n(R),{class:"text-right"},{default:o(()=>a[21]||(a[21]=[v("Amount")])),_:1})]),_:1})]),_:1}),s(n(Z),null,{default:o(()=>[(m(!0),y(B,null,A(t.maintenanceData.outstanding_invoices,d=>(m(),F(n(U),{key:d.ro_number},{default:o(()=>[s(n(N),null,{default:o(()=>[v(r(d.ro_number),1)]),_:2},1024),s(n(N),null,{default:o(()=>[v(r(d.vendor_name),1)]),_:2},1024),s(n(N),null,{default:o(()=>[v("W"+r(d.week_number)+"/"+r(d.year),1)]),_:2},1024),s(n(N),{class:"text-right"},{default:o(()=>[v("$"+r(w(d.invoice_amount)),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])])):t.showOutstandingInvoicesSection?(m(),y("div",ma,a[22]||(a[22]=[e("div",{class:"p-4 border-b"},[e("h3",{class:"text-lg font-semibold"},"Outstanding Invoices")],-1),e("div",{class:"p-4 text-center text-muted-foreground"}," No outstanding invoices match the current criteria ",-1)]))):O("",!0)],64))}}),ga={class:"mb-6"},va=I({__name:"DashboardHeader",props:{operationalExcellenceScore:{type:String,default:"Not Available"}},setup(t){const l=t,b=S(()=>{switch(l.operationalExcellenceScore){case"Fantastic +":return"text-green-600";case"Fantastic":return"text-emerald-600";case"Good":return"text-blue-600";case"Fair":return"text-amber-600";case"Poor":return"text-red-600";default:return"text-gray-600"}});return(p,g)=>(m(),y("div",ga,[e("h2",{class:E(["text-4xl font-bold tracking-tight",[b.value,"transition-colors duration-300"]])},r(t.operationalExcellenceScore),3)]))}}),ba={class:"mb-6"},_a={class:"border-b"},ya={class:"flex -mb-px space-x-8"},pa=["onClick"],xa={key:0,class:"mt-2 text-sm text-muted-foreground"},wa={key:0,class:"ml-1"},ha=I({__name:"TimePeriodTabs",props:{dateRangeText:{type:String,default:""},weekNumber:{type:Number,default:null},startWeekNumber:{type:Number,default:null},endWeekNumber:{type:Number,default:null},year:{type:Number,default:null},activeTabId:{type:String,default:"yesterday"}},emits:["tab-change"],setup(t,{emit:l}){const b=t,p=[{id:"yesterday",label:"Yesterday"},{id:"current-week",label:"Current Week"},{id:"t6w",label:"T6W Scores"},{id:"quarterly",label:"Quarterly Scores"}],g=q(b.activeTabId),c=l,f=S(()=>(g.value==="yesterday"||g.value==="current-week")&&b.weekNumber&&b.year?`Week ${b.weekNumber}, ${b.year}`:(g.value==="t6w"||g.value==="quarterly")&&b.startWeekNumber&&b.endWeekNumber&&b.year?`Weeks ${b.startWeekNumber}-${b.endWeekNumber}, ${b.year}`:""),i=u=>{g.value=u,c("tab-change",u)};return xe(()=>{c("tab-change",g.value)}),(u,x)=>(m(),y("div",ba,[e("div",_a,[e("div",ya,[(m(),y(B,null,A(p,w=>e("button",{key:w.id,onClick:D=>i(w.id),class:E(["py-2 px-1 border-b-2 text-sm font-medium transition-colors",g.value===w.id?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground hover:border-muted-foreground"])},r(w.label),11,pa)),64))])]),t.dateRangeText?(m(),y("div",xa,[e("span",null,r(t.dateRangeText),1),f.value?(m(),y("span",wa,"("+r(f.value)+")",1)):O("",!0)])):O("",!0)]))}}),ka={class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6 mb-6"},$a={class:"bg-card rounded-lg border shadow-sm p-4"},Da={class:"flex items-center justify-between gap-3 mb-4"},Sa={class:"space-y-2 text-sm max-h-40 overflow-y-auto"},ja={class:"bg-card rounded-lg border shadow-sm p-4"},Ta={class:"flex items-center justify-between gap-3 mb-4"},Ba={class:"space-y-2 text-sm max-h-40 overflow-y-auto"},Ca={class:"bg-card rounded-lg border shadow-sm p-4"},Ra={class:"flex items-center justify-between gap-3 mb-4"},Na={class:"text-sm mb-2 space-y-2"},Aa={class:"flex justify-between"},Fa={class:"flex justify-between"},Oa={class:"flex justify-between"},Ma={class:"flex justify-between"},Ia={class:"bg-card rounded-lg border shadow-sm p-4"},Va={class:"flex items-center justify-between gap-3 mb-4"},Wa={class:"text-4xl font-bold text-indigo-600"},Pa={class:"space-y-2 text-sm"},qa={class:"flex justify-between items-center"},Ea={class:"flex items-center gap-2"},La={class:"w-12 text-right"},Ua={class:"w-16 text-right"},za={class:"flex justify-between items-center"},Qa={class:"flex items-center gap-2"},Ga={class:"w-12 text-right"},Ha={class:"w-16 text-right"},Ka={class:"flex justify-between items-center"},Ja={class:"flex items-center gap-2"},Ya={class:"w-12 text-right"},Za={class:"w-16 text-right"},Xa={class:"flex justify-between items-center"},en={class:"flex items-center gap-2"},tn={class:"w-12 text-right"},an={class:"w-16 text-right"},nn={class:"flex justify-between items-center"},sn={class:"flex items-center gap-2"},on={class:"w-12 text-right"},rn={class:"w-16 text-right"},ln={class:"text-sm text-muted-foreground mt-3"},dn=I({__name:"PerformanceCards",props:{performanceData:{type:Object,default:()=>({})},performanceRatings:{type:Object,default:()=>({})},safetyData:{type:Object,default:()=>({})},delayBreakdowns:{type:Array,default:()=>[]},rejectionBreakdowns:{type:Array,default:()=>[]},maintenanceBreakdowns:{type:Object,default:()=>({})}},setup(t){const l=t,b=S(()=>[...l.delayBreakdowns].sort((a,d)=>d.total_delays-a.total_delays).slice(0,3)),p=S(()=>[...l.rejectionBreakdowns].sort((a,d)=>d.total_rejections-a.total_rejections).slice(0,3)),g=a=>a==null?"0%":`${Math.round(parseFloat(a))}%`,c=a=>(typeof a=="string"&&(a=parseFloat(a)),a==null||isNaN(a)?"0":Math.round(a).toString()),f=a=>(typeof a=="string"&&(a=parseFloat(a)),a==null||isNaN(a)?"0.00":a.toFixed(2)),i=a=>(typeof a=="string"&&(a=parseFloat(a)),a==null||isNaN(a)?"0.00":a.toFixed(2)),u=a=>{if(!a)return"Not Available";switch(a){case"gold":return"Gold Tier";case"silver":return"Silver Tier";case"not_eligible":return"Not Eligible";case"fantastic_plus":return"Fantastic +";case"fantastic":return"Fantastic";case"good":return"Good";case"fair":return"Fair";case"poor":return"Poor";default:return a}},x=a=>{if(!a)return"outline";switch(a){case"gold":return"gold";case"silver":return"silver";case"not_eligible":return"not-eligible";case"fantastic_plus":return"fantastic-plus";case"fantastic":return"fantastic";case"good":return"good";case"fair":return"fair";case"poor":return"poor";default:return"outline"}},w=a=>a?a==="Gold Tier"?"gold":a==="Silver Tier"?"silver":a==="Not Eligible"?"not-eligible":"outline":"outline",D=S(()=>{var j;if(!((j=l.safetyData)!=null&&j.ratings))return null;const a=l.safetyData.ratings,d={gold:3,silver:2,not_eligible:1},C=["traffic_light_violation","speeding_violations","following_distance","driver_distraction","sign_violations"];let W="gold";for(const V of C)a[V]&&d[a[V]]<d[W]&&(W=a[V]);switch(W){case"gold":return"Gold Tier";case"silver":return"Silver Tier";case"not_eligible":return"Not Eligible";default:return"Not Available"}}),k=a=>{if(!a)return"text-gray-600";switch(a){case"gold":return"text-amber-600";case"silver":return"text-slate-600";case"not_eligible":return"text-red-600";case"fantastic_plus":return"text-green-600";case"fantastic":return"text-emerald-600";case"good":return"text-blue-600";case"fair":return"text-amber-600";case"poor":return"text-red-600";default:return"text-indigo-600"}};return(a,d)=>{var C,W,j,V,h;return m(),y("div",ka,[e("div",$a,[d[0]||(d[0]=e("h3",{class:"text-base font-semibold mb-1"},"On-Time",-1)),d[1]||(d[1]=e("div",{class:"text-xs text-muted-foreground mb-1"},"Total Score",-1)),e("div",Da,[e("div",{class:E(["text-4xl font-bold",k(t.performanceRatings.average_on_time)])},r(g(t.performanceData.average_on_time)),3),s(n(M),{variant:x(t.performanceRatings.average_on_time),class:"text-xs"},{default:o(()=>[v(r(u(t.performanceRatings.average_on_time)),1)]),_:1},8,["variant"])]),d[2]||(d[2]=e("div",{class:"text-sm mb-2 flex justify-between"},[e("span",{class:"font-semibold"},"Delays by Reason"),e("span",{class:"font-semibold"},"Total")],-1)),e("div",Sa,[(m(!0),y(B,null,A(b.value,(_,P)=>(m(),y("div",{key:P,class:"flex justify-between"},[e("span",null,r(_.code),1),e("span",null,r(_.total_delays),1)]))),128))])]),e("div",ja,[d[3]||(d[3]=e("h3",{class:"text-base font-semibold mb-1"},"Acceptance",-1)),d[4]||(d[4]=e("div",{class:"text-xs text-muted-foreground mb-1"},"Total Score",-1)),e("div",Ta,[e("div",{class:E(["text-4xl font-bold",k(t.performanceRatings.average_acceptance)])},r(g(t.performanceData.average_acceptance)),3),s(n(M),{variant:x(t.performanceRatings.average_acceptance),class:"text-xs"},{default:o(()=>[v(r(u(t.performanceRatings.average_acceptance)),1)]),_:1},8,["variant"])]),d[5]||(d[5]=e("div",{class:"text-sm mb-2 flex justify-between"},[e("span",{class:"font-semibold"},"Rejections by Reason"),e("span",{class:"font-semibold"},"Total")],-1)),e("div",Ba,[(m(!0),y(B,null,A(p.value,(_,P)=>(m(),y("div",{key:P,class:"flex justify-between"},[e("span",null,r(_.reason_code),1),e("span",null,r(_.total_rejections),1)]))),128))])]),e("div",Ca,[d[10]||(d[10]=e("h3",{class:"text-base font-semibold mb-1"},"Maintenance",-1)),d[11]||(d[11]=e("div",{class:"text-xs text-muted-foreground mb-1"},"MVtS Score",-1)),e("div",Ra,[e("div",{class:E(["text-4xl font-bold",k(t.performanceRatings.average_maintenance_variance_to_spend)])},r(g(t.performanceData.average_maintenance_variance_to_spend)),3),s(n(M),{variant:x(t.performanceRatings.average_maintenance_variance_to_spend),class:"text-xs"},{default:o(()=>[v(r(u(t.performanceRatings.average_maintenance_variance_to_spend)),1)]),_:1},8,["variant"])]),e("div",Na,[e("div",Aa,[d[6]||(d[6]=e("span",null,"Cost per mile",-1)),e("span",null,"$"+r(i(t.maintenanceBreakdowns.cpm)),1)]),e("div",Fa,[d[7]||(d[7]=e("span",null,"Num of WOs",-1)),e("span",null,r(t.maintenanceBreakdowns.total_repair_orders),1)]),e("div",Oa,[d[8]||(d[8]=e("span",null,"Current Costs",-1)),e("span",null,"$"+r(i(t.maintenanceBreakdowns.total_invoice_amount)),1)]),e("div",Ma,[d[9]||(d[9]=e("span",null,"Missing Invoices",-1)),e("span",null,r(t.maintenanceBreakdowns.missing_invoices_count||0),1)])])]),e("div",Ia,[d[17]||(d[17]=e("h3",{class:"text-base font-semibold mb-1"},"Netradyne Alerts Bonus Criteria",-1)),d[18]||(d[18]=e("div",{class:"text-xs text-muted-foreground mb-1"},"Green Zone Score",-1)),e("div",Va,[e("div",Wa,r(c(t.safetyData.average_driver_score||"N/A")),1),s(n(M),{variant:w(D.value),class:"text-xs"},{default:o(()=>[v(r(u(D.value)),1)]),_:1},8,["variant"])]),d[19]||(d[19]=e("div",{class:"flex justify-between items-center text-sm font-semibold mb-2"},[e("span",null,"Alert Type"),e("div",{class:"flex items-center gap-2"},[e("span",{class:"w-12 text-right"},"Total"),e("span",{class:"w-16 text-right"},"P1KH")])],-1)),e("div",Pa,[e("div",qa,[d[12]||(d[12]=e("span",null,"Distracted Driving",-1)),e("div",Ea,[e("span",La,r(c(t.safetyData.driver_distraction)),1),e("span",Ua,r(f((C=t.safetyData.rates)==null?void 0:C.driver_distraction)),1)])]),e("div",za,[d[13]||(d[13]=e("span",null,"Speeding",-1)),e("div",Qa,[e("span",Ga,r(c(t.safetyData.speeding_violations)),1),e("span",Ha,r(f((W=t.safetyData.rates)==null?void 0:W.speeding_violations)),1)])]),e("div",Ka,[d[14]||(d[14]=e("span",null,"Sign Violation",-1)),e("div",Ja,[e("span",Ya,r(c(t.safetyData.sign_violations)),1),e("span",Za,r(f((j=t.safetyData.rates)==null?void 0:j.sign_violations)),1)])]),e("div",Xa,[d[15]||(d[15]=e("span",null,"Traffic Light Violation",-1)),e("div",en,[e("span",tn,r(c(t.safetyData.traffic_light_violation)),1),e("span",an,r(f((V=t.safetyData.rates)==null?void 0:V.traffic_light_violation)),1)])]),e("div",nn,[d[16]||(d[16]=e("span",null,"Following Distance",-1)),e("div",sn,[e("span",on,r(c(t.safetyData.following_distance)),1),e("span",rn,r(f((h=t.safetyData.rates)==null?void 0:h.following_distance)),1)])])]),e("div",ln,[e("div",null,"Total Hours Analyzed: "+r(c(t.safetyData.total_hours||0)),1)])])])}}}),un={class:"bg-card rounded-lg border shadow-sm p-6 mb-6"},cn={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},mn={class:"p-4 border rounded-lg"},fn={class:"flex items-center justify-between gap-3 mb-3"},gn={class:"p-4 border rounded-lg"},vn={class:"flex items-center justify-between gap-3 mb-3"},bn={class:"p-4 border rounded-lg"},_n={class:"flex items-center justify-between gap-3 mb-3"},yn=I({__name:"AdditionalMetricsCard",props:{performanceData:{type:Object,default:()=>({})},performanceRatings:{type:Object,default:()=>({})}},setup(t){const l=c=>c==null?"0":Math.round(parseFloat(c)).toString(),b=c=>{if(!c)return"Not Available";switch(c){case"fantastic_plus":return"Fantastic +";case"fantastic":return"Fantastic";case"good":return"Good";case"fair":return"Fair";case"poor":return"Poor";default:return c.charAt(0).toUpperCase()+c.slice(1).replace(/_/g," ")}},p=c=>{if(!c)return"outline";switch(c){case"fantastic_plus":return"fantastic-plus";case"fantastic":return"fantastic";case"good":return"good";case"fair":return"fair";case"poor":return"poor";default:return"outline"}},g=c=>{if(!c)return"text-gray-600";switch(c){case"fantastic_plus":return"text-green-600";case"fantastic":return"text-emerald-600";case"good":return"text-blue-600";case"fair":return"text-amber-600";case"poor":return"text-red-600";default:return"text-indigo-600"}};return(c,f)=>(m(),y("div",un,[f[6]||(f[6]=e("h3",{class:"text-xl font-semibold mb-4"},"Additional Performance Metrics",-1)),e("div",cn,[e("div",mn,[f[0]||(f[0]=e("h4",{class:"text-lg font-medium mb-2"},"VCR-P",-1)),f[1]||(f[1]=e("div",{class:"text-sm text-muted-foreground mb-1"},"Count",-1)),e("div",fn,[e("div",{class:E(["text-3xl font-bold",g(t.performanceRatings.vcr_preventable)])},r(l(t.performanceData.vcr_preventable)),3),s(n(M),{variant:p(t.performanceRatings.vcr_preventable),class:"text-xs"},{default:o(()=>[v(r(b(t.performanceRatings.vcr_preventable)),1)]),_:1},8,["variant"])])]),e("div",gn,[f[2]||(f[2]=e("h4",{class:"text-lg font-medium mb-2"},"Open BOC",-1)),f[3]||(f[3]=e("div",{class:"text-sm text-muted-foreground mb-1"},"Count",-1)),e("div",vn,[e("div",{class:E(["text-3xl font-bold",g(t.performanceRatings.open_boc)])},r(l(t.performanceData.open_boc)),3),s(n(M),{variant:p(t.performanceRatings.open_boc),class:"text-xs"},{default:o(()=>[v(r(b(t.performanceRatings.open_boc)),1)]),_:1},8,["variant"])])]),e("div",bn,[f[4]||(f[4]=e("h4",{class:"text-lg font-medium mb-2"},"VMCR-P",-1)),f[5]||(f[5]=e("div",{class:"text-sm text-muted-foreground mb-1"},"Count",-1)),e("div",_n,[e("div",{class:E(["text-3xl font-bold",g(t.performanceRatings.vmcr_p)])},r(l(t.performanceData.vmcr_p)),3),s(n(M),{variant:p(t.performanceRatings.vmcr_p),class:"text-xs"},{default:o(()=>[v(r(b(t.performanceRatings.vmcr_p)),1)]),_:1},8,["variant"])])])])]))}}),pn={class:"container mx-auto p-6"},xn={class:"flex items-center justify-between mb-6"},wn={key:0,class:"mb-6"},hn={class:"bg-red-50 dark:bg-red-900/30 border-l-4 border-red-500 dark:border-red-400 p-4 rounded-md shadow-sm"},kn={class:"flex items-center"},$n={class:"flex-shrink-0"},Dn={class:"h-10 w-10 rounded-full bg-red-100 dark:bg-red-800 flex items-center justify-center"},Sn={class:"ml-3"},jn={class:"mt-1 text-sm text-red-700 dark:text-red-200"},Tn={class:"mt-2"},Bn={class:"max-h-[60vh] overflow-y-auto"},Cn={class:"flex items-center gap-2"},Rn={key:1,class:"text-center py-8 text-muted-foreground"},Zn=I({__name:"Summary",props:{tenantSlug:String,summaries:Object,delayBreakdowns:Object,rejectionBreakdowns:Object,maintenanceBreakdowns:Object,dateFilter:String,dateRange:Object},setup(t){const l=t,b=q("on-time"),p=q(l.dateFilter||"t6w"),g=q(null),c=q(null),f=q(!0),i=q(!1),u=S(()=>{var h,_;return((_=(h=l.maintenanceBreakdowns)==null?void 0:h.canceled_qs_invoices)==null?void 0:_.length)>0});xe(()=>{});const x=h=>h==null?"0.00":Number(h).toFixed(2),w=h=>{g.value=h.minInvoiceAmount,c.value=h.outstandingDate,H.visit(route("dashboard",{tenantSlug:l.tenantSlug,dateFilter:p.value,minInvoiceAmount:h.minInvoiceAmount||null,outstandingDate:h.outstandingDate||null}),{preserveState:!0,preserveScroll:!0,only:["maintenanceBreakdowns"]})},D=S(()=>{const _={yesterday:"yesterday","current-week":"current_week",t6w:"rolling_6_weeks",quarterly:"quarterly"}[p.value]||p.value;return W(_)}),k=h=>{b.value=h},a=h=>{p.value=h,H.visit(route("dashboard",{tenantSlug:l.tenantSlug,dateFilter:h,minInvoiceAmount:g.value||null,outstandingDate:c.value||null}),{preserveState:!0,preserveScroll:!0,only:["summaries","delayBreakdowns","rejectionBreakdowns","maintenanceBreakdowns","dateFilter","dateRange"]})},d=[{title:l.tenantSlug?"Dashboard":"Admin Dashboard",href:l.tenantSlug?route("dashboard",{tenantSlug:l.tenantSlug}):route("admin.dashboard")},{title:"Performance Summary",href:route("dashboard",{tenantSlug:l.tenantSlug})}],C=h=>new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(h),W=h=>{var P,L;if((L=(P=l.summaries)==null?void 0:P[h])!=null&&L.date_range){const $=new Date(l.summaries[h].date_range.start+"T12:00:00"),T=new Date(l.summaries[h].date_range.end+"T12:00:00");return`${j($)} - ${j(T)}`}const _=new Date;switch(h){case"yesterday":{const $=new Date(_);return $.setDate($.getDate()-1),j($)}case"current_week":{const $=new Date(_);$.setDate(_.getDate()-_.getDay());const T=new Date($);return T.setDate($.getDate()+6),`${j($)} - ${j(T)}`}case"rolling_6_weeks":{const $=new Date(_);$.setDate(_.getDate()-_.getDay()+6);const T=new Date($);return T.setDate($.getDate()-6*7+1),`${j(T)} - ${j($)}`}case"quarterly":{const $=new Date(_),T=new Date(_);return T.setMonth(T.getMonth()-3),`${j(T)} - ${j($)}`}default:return""}},j=h=>new Intl.DateTimeFormat("en-US",{month:"numeric",day:"numeric",year:"numeric"}).format(h),V=S(()=>{var $,T;if(!((T=($=l.summaries)==null?void 0:$.performance)!=null&&T.ratings))return"Not Available";const h=l.summaries.performance.ratings,_={fantastic_plus:5,fantastic:4,good:3,fair:2,poor:1},P=["average_acceptance","average_on_time","average_maintenance_variance_to_spend","open_boc","vcr_preventable","vmcr_p"];let L="fantastic_plus";for(const G of P)h[G]&&_[h[G]]<_[L]&&(L=h[G]);switch(L){case"fantastic_plus":return"Fantastic +";case"fantastic":return"Fantastic";case"good":return"Good";case"fair":return"Fair";case"poor":return"Poor";default:return"Not Available"}});return(h,_)=>(m(),F(De,{breadcrumbs:d,tenantSlug:t.tenantSlug},{default:o(()=>{var P,L,$,T,G,ae,ne,se,oe,re,le,ie,de,ue,ce,me,fe;return[s(n($e),{title:"Performance Summary Dashboard"}),e("div",pn,[e("div",xn,[_[3]||(_[3]=e("h1",{class:"text-2xl font-bold"},null,-1)),s(n(M),{variant:"outline",class:"text-sm"},{default:o(()=>[s(J,{name:"calendar",class:"mr-1 h-4 w-4"}),v(" Last updated: "+r(C(new Date)),1)]),_:1})]),s(va,{operationalExcellenceScore:V.value},null,8,["operationalExcellenceScore"]),u.value?(m(),y("div",wn,[e("div",hn,[e("div",kn,[e("div",$n,[e("div",Dn,[s(J,{name:"triangleAlert",class:"h-6 w-6 text-red-600 dark:text-red-300"})])]),e("div",Sn,[_[5]||(_[5]=e("h3",{class:"text-lg font-medium text-red-800 dark:text-red-300"},"Attention Required",-1)),e("div",jn,r(((L=(P=t.maintenanceBreakdowns)==null?void 0:P.canceled_qs_invoices)==null?void 0:L.length)||0)+" invoices found with canceled WO status but still on QS. These need immediate attention. ",1),e("div",Tn,[s(n(Q),{onClick:_[0]||(_[0]=K=>i.value=!0),variant:"destructive",size:"sm"},{default:o(()=>_[4]||(_[4]=[v(" View Details ")])),_:1})])])])])])):O("",!0),s(ha,{onTabChange:a,dateRangeText:D.value,weekNumber:($=t.dateRange)==null?void 0:$.weekNumber,startWeekNumber:(T=t.dateRange)==null?void 0:T.startWeekNumber,endWeekNumber:(G=t.dateRange)==null?void 0:G.endWeekNumber,year:(ae=t.dateRange)==null?void 0:ae.year,activeTabId:p.value},null,8,["dateRangeText","weekNumber","startWeekNumber","endWeekNumber","year","activeTabId"]),t.summaries?(m(),F(dn,{key:1,performanceData:((ne=t.summaries.performance)==null?void 0:ne.data)||{},performanceRatings:((se=t.summaries.performance)==null?void 0:se.ratings)||{},safetyData:t.summaries.safety||{},delayBreakdowns:((oe=t.delayBreakdowns)==null?void 0:oe.by_code)||[],rejectionBreakdowns:((re=t.rejectionBreakdowns)==null?void 0:re.by_reason)||[],maintenanceBreakdowns:t.maintenanceBreakdowns||{}},null,8,["performanceData","performanceRatings","safetyData","delayBreakdowns","rejectionBreakdowns","maintenanceBreakdowns"])):O("",!0),t.summaries?(m(),F(yn,{key:2,performanceData:((le=t.summaries.performance)==null?void 0:le.data)||{},performanceRatings:((ie=t.summaries.performance)==null?void 0:ie.ratings)||{}},null,8,["performanceData","performanceRatings"])):O("",!0),s(Ee,{onTabChange:k}),e("div",null,[b.value==="on-time"?(m(),F(st,{key:0,delayBreakdownsByDriver:((de=t.delayBreakdowns)==null?void 0:de.by_driver)||[],delayBreakdownsByCode:((ue=t.delayBreakdowns)==null?void 0:ue.by_code)||[],tenantSlug:t.tenantSlug},null,8,["delayBreakdownsByDriver","delayBreakdownsByCode","tenantSlug"])):O("",!0),b.value==="acceptance"?(m(),F(ft,{key:1,rejectionBreakdownsByDriver:((ce=t.rejectionBreakdowns)==null?void 0:ce.by_driver)||[],rejectionBreakdownsByReason:((me=t.rejectionBreakdowns)==null?void 0:me.by_reason)||[],tenantSlug:t.tenantSlug},null,8,["rejectionBreakdownsByDriver","rejectionBreakdownsByReason","tenantSlug"])):O("",!0),b.value==="safety"?(m(),F(Ct,{key:2,safetyData:((fe=t.summaries)==null?void 0:fe.safety)||{},tenantSlug:t.tenantSlug},null,8,["safetyData","tenantSlug"])):O("",!0),b.value==="maintenance"?(m(),F(fa,{key:3,maintenanceData:t.maintenanceBreakdowns||{},tenantSlug:t.tenantSlug,showOutstandingInvoicesSection:f.value,initialMinInvoiceAmount:g.value,initialOutstandingDate:c.value,onFilterApplied:w},null,8,["maintenanceData","tenantSlug","showOutstandingInvoicesSection","initialMinInvoiceAmount","initialOutstandingDate"])):O("",!0)])]),s(n(Se),{open:i.value,"onUpdate:open":_[2]||(_[2]=K=>i.value=K)},{default:o(()=>[s(n(je),{class:"sm:max-w-lg"},{default:o(()=>{var K,ge;return[s(n(Te),null,{default:o(()=>[s(n(Be),{class:"flex items-center gap-2"},{default:o(()=>[s(J,{name:"alert-triangle",class:"h-5 w-5 text-red-600"}),_[6]||(_[6]=v(" Canceled Invoices on QS "))]),_:1}),s(n(Ce),null,{default:o(()=>_[7]||(_[7]=[v(" These invoices have a canceled WO status but are still marked as on QS. Please review and take appropriate action. ")])),_:1})]),_:1}),e("div",Bn,[(ge=(K=t.maintenanceBreakdowns)==null?void 0:K.canceled_qs_invoices)!=null&&ge.length?(m(),F(n(X),{key:0},{default:o(()=>[s(n(Y),null,{default:o(()=>[s(n(U),null,{default:o(()=>[s(n(R),null,{default:o(()=>_[8]||(_[8]=[v("RO Number")])),_:1}),s(n(R),null,{default:o(()=>_[9]||(_[9]=[v("Vendor")])),_:1}),s(n(R),{class:"text-right"},{default:o(()=>_[10]||(_[10]=[v("Amount")])),_:1}),s(n(R),null,{default:o(()=>_[11]||(_[11]=[v("Week")])),_:1})]),_:1})]),_:1}),s(n(Z),null,{default:o(()=>[(m(!0),y(B,null,A(t.maintenanceBreakdowns.canceled_qs_invoices,z=>(m(),F(n(U),{key:z.ro_number,class:"hover:bg-red-50 dark:hover:bg-red-900/30"},{default:o(()=>[s(n(N),{class:"font-medium"},{default:o(()=>[e("div",Cn,[s(J,{name:"alert-triangle",class:"h-4 w-4 text-red-600 dark:text-red-400"}),v(" "+r(z.ro_number),1)])]),_:2},1024),s(n(N),null,{default:o(()=>[v(r(z.vendor_name),1)]),_:2},1024),s(n(N),{class:"text-right"},{default:o(()=>[v("$"+r(x(z.invoice_amount)),1)]),_:2},1024),s(n(N),null,{default:o(()=>[v("W"+r(z.week_number)+"/"+r(z.year),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):(m(),y("div",Rn," No canceled QS invoices found. "))]),s(n(Re),null,{default:o(()=>[s(n(Q),{onClick:_[1]||(_[1]=z=>i.value=!1),variant:"outline"},{default:o(()=>_[12]||(_[12]=[v("Close")])),_:1})]),_:1})]}),_:1})]),_:1},8,["open"])]}),_:1},8,["tenantSlug"]))}});export{Zn as default};
