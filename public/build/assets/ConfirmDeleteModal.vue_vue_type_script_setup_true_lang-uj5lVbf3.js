import{_ as h}from"./Button.vue_vue_type_script_setup_true_lang-BTsGooBq.js";import{S as re,W as Q,x as W}from"./vendor-vue-DhopVsWr.js";import{c as V,F as c,e as a,X as s,E as $,H as z,O as T,U as y,b as S,f as u,S as f,u as e,z as t,r as G,d as X,w as Z,G as ee,aj as F,C as ie,Y as oe,ak as le}from"./vendor-_LBoWcPD.js";import{_ as R}from"./Badge.vue_vue_type_script_setup_true_lang-DwyBWJwY.js";import{d as se,a1 as te,J as ae,N as de,aa as ue,X as I,E as me,a as ce,S as K,p as q,y as pe,L as ne}from"./vendor-icons-DEdOLZ3C.js";import{_ as M}from"./Input.vue_vue_type_script_setup_true_lang-ct5fQ9S7.js";import{_ as j}from"./Label.vue_vue_type_script_setup_true_lang-CM72ee2b.js";import{_ as J}from"./Checkbox.vue_vue_type_script_setup_true_lang-Di6jfqi8.js";import{_ as U}from"./InputError.vue_vue_type_script_setup_true_lang-78CVv6-X.js";const fe={class:"w-full overflow-x-auto"},ve={class:"rounded-md border"},ge={class:"w-full caption-bottom text-sm"},xe={class:"[&_tr]:border-b"},be={class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},he={key:0,class:"h-12 px-4 text-right align-middle font-medium text-muted-foreground"},_e={class:"[&_tr:last-child]:border-0"},ye={class:"p-4 align-middle font-medium"},ke={class:"p-4 align-middle"},$e={key:0,class:"p-4 align-middle text-right"},we={class:"flex justify-end space-x-2"},Ce={key:0,class:"mt-6 flex justify-center"},Se={class:"flex flex-wrap items-center gap-1 justify-center"},St={__name:"UserList",props:{users:Object,isSuperAdmin:{type:Boolean,default:!1},permissions:Array},setup(k){const A=k,r=V(()=>A.permissions.map(l=>l.name)),g=l=>{l&&Q.get(l,{},{only:["users"]})};return(l,o)=>(a(),c("div",fe,[s("div",ve,[s("table",ge,[s("thead",xe,[s("tr",be,[o[0]||(o[0]=s("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Name",-1)),o[1]||(o[1]=s("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Email",-1)),r.value.includes("users.update")||r.value.includes("users.delete")?(a(),c("th",he,"Actions")):$("",!0)])]),s("tbody",_e,[(a(!0),c(z,null,T(k.users.data,v=>(a(),c("tr",{key:v.id,class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},[s("td",ye,y(v.name),1),s("td",ke,y(v.email),1),r.value.includes("users.update")||r.value.includes("users.delete")?(a(),c("td",$e,[s("div",we,[r.value.includes("users.update")?(a(),S(e(h),{key:0,onClick:w=>l.$emit("edit",v),variant:"outline",size:"sm"},{default:u(()=>o[2]||(o[2]=[f(" Edit ")])),_:2},1032,["onClick"])):$("",!0),r.value.includes("users.delete")?(a(),S(e(h),{key:1,onClick:w=>l.$emit("delete",v),variant:"destructive",size:"sm"},{default:u(()=>o[3]||(o[3]=[f(" Delete ")])),_:2},1032,["onClick"])):$("",!0),k.isSuperAdmin?(a(),S(e(re),{key:2,href:l.route("impersonate.start",v.id),as:"button"},{default:u(()=>[t(e(h),{variant:"secondary",size:"sm"},{default:u(()=>o[4]||(o[4]=[f(" Impersonate ")])),_:1})]),_:2},1032,["href"])):$("",!0)])])):$("",!0)]))),128))])])]),k.users.links?(a(),c("div",Ce,[s("nav",Se,[(a(!0),c(z,null,T(k.users.links,v=>(a(),S(e(h),{key:v.label,onClick:w=>g(v.url),disabled:!v.url,variant:v.active?"default":"outline",size:"sm",class:"min-w-[40px]",innerHTML:v.label},null,8,["onClick","disabled","variant","innerHTML"]))),128))])])):$("",!0)]))}},Ae={class:"w-full overflow-x-auto"},ze={class:"rounded-md border"},Te={class:"w-full caption-bottom text-sm"},Pe={class:"[&_tr]:border-b bg-muted/50"},je={class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},Ee={key:0,class:"h-12 px-4 text-right align-middle font-medium text-muted-foreground"},Ue={class:"[&_tr:last-child]:border-0"},Le={class:"p-4 align-middle font-medium"},De={class:"flex items-center"},Ve={class:"p-4 align-middle"},Me={class:"flex flex-wrap gap-1"},Oe={class:"mb-2 w-full"},Re={key:0,class:"w-full"},Ne={class:"text-xs font-semibold text-muted-foreground mb-1 flex items-center"},He={class:"flex flex-wrap gap-1 ml-4"},Ge={key:0,class:"p-4 align-middle text-right"},Ie={class:"flex justify-end space-x-2"},Be={key:0,class:"mt-6 flex justify-center"},Fe={class:"flex flex-wrap items-center gap-1 justify-center"},At={__name:"RoleList",props:{roles:Object,permissions:Array},setup(k){const A=k,r=V(()=>A.permissions.map(x=>x.name)),g=G([]),l=x=>{const _=g.value.indexOf(x);_===-1?g.value.push(x):g.value.splice(_,1)},o=x=>x.length,v=x=>{x&&Q.get(x,{},{only:["roles"]})},w=x=>{const _={};return x.forEach(C=>{const D=C.name.split(".")[0];_[D]||(_[D]=[]),_[D].push(C)}),_},p=x=>x==="tenant-settings"?"Tenant Settings":x==="repair-orders"?"Repair Orders":x==="safety-data"?"Safety Data":x==="miles-driven"?"Miles Driven":x==="support-tickets"?"Support Tickets":x==="sms-coaching"?"SMS Coaching":x==="support-responses"?"Support Responses":x.charAt(0).toUpperCase()+x.slice(1),L=x=>{const _=x.split(".");return _.length>1?_[1].charAt(0).toUpperCase()+_[1].slice(1).replace(/-/g," "):x};return(x,_)=>(a(),c("div",Ae,[s("div",ze,[s("table",Te,[s("thead",Pe,[s("tr",je,[_[0]||(_[0]=s("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Role Name",-1)),_[1]||(_[1]=s("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Permissions",-1)),r.value.includes("roles.update")||r.value.includes("roles.delete")?(a(),c("th",Ee,"Actions")):$("",!0)])]),s("tbody",Ue,[(a(!0),c(z,null,T(k.roles.data,C=>(a(),c("tr",{key:C.id,class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},[s("td",Le,[s("div",De,[t(e(se),{class:"h-4 w-4 mr-2 text-primary"}),f(" "+y(C.name),1)])]),s("td",Ve,[s("div",Me,[s("div",Oe,[t(e(R),{variant:"outline",class:"mr-2"},{default:u(()=>[f(y(o(C.permissions))+" permissions ",1)]),_:2},1024),t(e(h),{variant:"ghost",size:"sm",onClick:E=>l(C.id),class:"text-xs"},{default:u(()=>[f(y(g.value.includes(C.id)?"Hide details":"Show details"),1)]),_:2},1032,["onClick"])]),g.value.includes(C.id)?(a(),c("div",Re,[(a(!0),c(z,null,T(w(C.permissions),(E,D)=>(a(),c("span",{key:D,class:"inline-flex flex-col mb-2 w-full"},[s("span",Ne,[t(e(te),{class:"h-3 w-3 mr-1"}),f(" "+y(p(D))+" ",1),t(e(R),{variant:"secondary",class:"ml-2"},{default:u(()=>[f(y(E.length),1)]),_:2},1024)]),s("div",He,[(a(!0),c(z,null,T(E,N=>(a(),c("span",{key:N.id,class:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-muted text-muted-foreground"},y(L(N.name)),1))),128))])]))),128))])):$("",!0)])]),r.value.includes("roles.update")||r.value.includes("roles.delete")?(a(),c("td",Ge,[s("div",Ie,[r.value.includes("roles.update")?(a(),S(e(h),{key:0,onClick:E=>x.$emit("edit",C),variant:"outline",size:"sm",class:"flex items-center"},{default:u(()=>[t(e(ae),{class:"h-3.5 w-3.5 mr-1"}),_[2]||(_[2]=f(" Edit "))]),_:2},1032,["onClick"])):$("",!0),r.value.includes("roles.delete")?(a(),S(e(h),{key:1,onClick:E=>x.$emit("delete",C),variant:"destructive",size:"sm",class:"flex items-center"},{default:u(()=>[t(e(de),{class:"h-3.5 w-3.5 mr-1"}),_[3]||(_[3]=f(" Delete "))]),_:2},1032,["onClick"])):$("",!0)])])):$("",!0)]))),128))])])]),k.roles.links?(a(),c("div",Be,[s("nav",Fe,[(a(!0),c(z,null,T(k.roles.links,C=>(a(),S(e(h),{key:C.label,onClick:E=>v(C.url),disabled:!C.url,variant:C.active?"default":"outline",size:"sm",class:"min-w-[40px]",innerHTML:C.label},null,8,["onClick","disabled","variant","innerHTML"]))),128))])])):$("",!0)]))}},We={class:"fixed inset-0 z-[100]"},Xe={class:"absolute inset-0 flex items-center justify-center p-2 sm:p-4"},Ye={class:"bg-background p-4 sm:p-6 rounded-lg shadow-xl w-full sm:max-w-lg md:max-w-2xl lg:max-w-4xl overflow-y-auto max-h-[95vh] animate-in fade-in zoom-in-95 duration-200 border border-border"},Ke={class:"flex justify-between items-center mb-4"},qe={class:"text-xl sm:text-2xl font-bold text-foreground flex items-center"},Je={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Qe={class:"space-y-2"},Ze={class:"space-y-2"},es={class:"space-y-2 md:col-span-2"},ss={key:0,class:"text-destructive ml-1"},ts={class:"relative"},ns={key:0,class:"space-y-2 md:col-span-2"},ls=["value"],is={class:"grid grid-cols-1 md:grid-cols-2 gap-4 pt-2"},os={class:"space-y-2"},rs={class:"flex justify-between items-center"},as={class:"relative"},ds={class:"flex items-center space-x-2"},us={class:"relative w-full"},ms={class:"h-60 border rounded-md p-2 overflow-y-auto"},cs={key:0,class:"flex flex-col items-center justify-center h-full text-muted-foreground"},ps={class:"space-y-2"},fs={class:"flex justify-between items-center"},vs={class:"flex space-x-2"},gs={class:"relative"},xs={class:"flex items-center space-x-2"},bs={class:"relative w-full"},hs={class:"h-60 border rounded-md p-2 overflow-y-auto"},_s={class:"flex items-center justify-between mb-1"},ys={class:"font-medium text-sm text-foreground flex items-center"},ks={class:"flex space-x-1"},$s={key:0,class:"ml-2 text-xs px-2 py-0.5 rounded-full border border-gray-200 bg-gray-100 dark:border-gray-700 dark:bg-gray-800 text-gray-600 dark:text-gray-300"},ws={key:0,class:"flex flex-col items-center justify-center h-full text-muted-foreground"},Cs={class:"flex justify-end space-x-3 pt-4"},zt=X({__name:"UserForm",props:{user:{type:Object,default:null},tenants:{type:Array,default:()=>[]},roles:{type:Array,default:()=>[]},permissions:{type:Array,default:()=>[]},isSuperAdmin:{type:Boolean,default:!1},tenantSlug:{type:String,default:null}},emits:["close","saved"],setup(k,{emit:A}){const r=k,g=A,l=W({name:r.user?r.user.name:"",email:r.user?r.user.email:"",password:r.user?r.user.password:"",tenant_id:r.user?r.user.tenant_id:r.tenants.length?r.tenants[0].id:null,roles:r.user&&r.user.roles?r.user.roles.map(i=>i.id):[],user_permissions:r.user&&r.user.permissions?r.user.permissions.map(i=>i.name):[]}),o=G(""),v=G(""),w=G(!1),p=V(()=>{if(!o.value.trim())return r.roles;const i=o.value.toLowerCase();return r.roles.filter(n=>n.name.toLowerCase().includes(i))}),L=V(()=>l.user_permissions.length);V(()=>{if(!v.value.trim())return r.permissions;const i=v.value.toLowerCase();return r.permissions.filter(n=>n.name.toLowerCase().includes(i))});const x=V(()=>{const i=new Set;return r.roles.forEach(n=>{l.roles.includes(n.id)&&n.permissions&&n.permissions.forEach(d=>{i.add(d.name)})}),Array.from(i)});Z(()=>r.user,i=>{i?(l.name=i.name,l.email=i.email,l.password=i.password,l.tenant_id=i.tenant_id,l.roles=i.roles?i.roles.map(n=>n.id):[],l.user_permissions=i.permissions?i.permissions.map(n=>n.name):[]):(l.name="",l.email="",l.password="",l.tenant_id=r.tenants.length?r.tenants[0].id:null,l.roles=[],l.user_permissions=[])},{immediate:!0});const _=()=>{r.user?r.isSuperAdmin?l.put(route("admin.users.update",r.user),{onSuccess:()=>{g("saved")}}):l.put(route("users.update",[r.tenantSlug,r.user]),{onSuccess:()=>{g("saved")}}):r.isSuperAdmin?l.post(route("admin.users.store"),{onSuccess:()=>{g("saved")}}):l.post(route("users.store",r.tenantSlug),{onSuccess:()=>{g("saved")}})},C=i=>{const n=l.roles.indexOf(i);n===-1?l.roles.push(i):l.roles.splice(n,1)},E=i=>{if(x.value.includes(i))return;const n=l.user_permissions.indexOf(i);n===-1?l.user_permissions.push(i):l.user_permissions.splice(n,1)},D=()=>{r.permissions.forEach(i=>{!x.value.includes(i.name)&&!l.user_permissions.includes(i.name)&&l.user_permissions.push(i.name)})},N=()=>{l.user_permissions=[]},Y=i=>{r.permissions.filter(d=>d.name.startsWith(i+".")).map(d=>d.name).forEach(d=>{!l.user_permissions.includes(d)&&!x.value.includes(d)&&l.user_permissions.push(d)})},B=i=>{l.user_permissions=l.user_permissions.filter(n=>!n.startsWith(i+"."))},H=V(()=>{const i=v.value.trim()?r.permissions.filter(d=>d.name.toLowerCase().includes(v.value.toLowerCase())):r.permissions,n={};return i.forEach(d=>{const P=d.name.split(".")[0];n[P]||(n[P]=[]),n[P].push(d)}),n}),b=i=>i==="tenant-settings"?"Tenant Settings":i==="repair-orders"?"Repair Orders":i==="safety-data"?"Safety Data":i==="miles-driven"?"Miles Driven":i==="support-tickets"?"Support Tickets":i==="sms-coaching"?"SMS Coaching":i==="support-responses"?"Support Responses":i==="receive_updates"?"General":i.charAt(0).toUpperCase()+i.slice(1),m=i=>{const n=i.split(".");return n.length>1?n[1].charAt(0).toUpperCase()+n[1].slice(1).replace(/-/g," "):i};return(i,n)=>(a(),c("div",We,[s("div",{class:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:n[0]||(n[0]=()=>g("close"))}),s("div",Xe,[s("div",Ye,[s("div",Ke,[s("h2",qe,[t(e(ue),{class:"h-5 w-5 mr-2 text-primary"}),f(" "+y(k.user?"Edit User":"Create User"),1)]),t(e(h),{variant:"ghost",size:"icon",onClick:n[1]||(n[1]=()=>g("close"))},{default:u(()=>[t(e(I),{class:"h-5 w-5"})]),_:1})]),s("form",{onSubmit:ee(_,["prevent"]),class:"space-y-4"},[s("div",Je,[s("div",Qe,[t(e(j),{for:"name",class:"flex items-center"},{default:u(()=>n[12]||(n[12]=[s("span",null,"Name",-1),s("span",{class:"text-destructive ml-1"},"*",-1)])),_:1}),t(e(M),{id:"name",modelValue:e(l).name,"onUpdate:modelValue":n[2]||(n[2]=d=>e(l).name=d),placeholder:"Enter name",class:F(["w-full",{"border-destructive":e(l).errors.name}])},null,8,["modelValue","class"]),t(U,{message:e(l).errors.name},null,8,["message"])]),s("div",Ze,[t(e(j),{for:"email",class:"flex items-center"},{default:u(()=>n[13]||(n[13]=[s("span",null,"Email",-1),s("span",{class:"text-destructive ml-1"},"*",-1)])),_:1}),t(e(M),{id:"email",modelValue:e(l).email,"onUpdate:modelValue":n[3]||(n[3]=d=>e(l).email=d),type:"email",placeholder:"Enter email",class:F(["w-full",{"border-destructive":e(l).errors.email}])},null,8,["modelValue","class"]),t(U,{message:e(l).errors.email},null,8,["message"])]),s("div",es,[t(e(j),{for:"password",class:"flex items-center"},{default:u(()=>[n[14]||(n[14]=s("span",null,"Password",-1)),k.user?$("",!0):(a(),c("span",ss,"*"))]),_:1}),s("div",ts,[t(e(M),{id:"password",modelValue:e(l).password,"onUpdate:modelValue":n[4]||(n[4]=d=>e(l).password=d),type:w.value?"text":"password",placeholder:"Enter password",class:F(["w-full pr-10",{"border-destructive":e(l).errors.password}])},null,8,["modelValue","type","class"]),s("button",{type:"button",onClick:n[5]||(n[5]=d=>w.value=!w.value),class:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"},[w.value?(a(),S(e(ce),{key:1,class:"h-5 w-5"})):(a(),S(e(me),{key:0,class:"h-5 w-5"}))])]),t(U,{message:e(l).errors.password},null,8,["message"])]),k.isSuperAdmin?(a(),c("div",ns,[t(e(j),{for:"tenant"},{default:u(()=>n[15]||(n[15]=[f("Company Name")])),_:1}),ie(s("select",{id:"tenant","onUpdate:modelValue":n[6]||(n[6]=d=>e(l).tenant_id=d),class:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"},[n[16]||(n[16]=s("option",{value:null},"None",-1)),(a(!0),c(z,null,T(k.tenants,d=>(a(),c("option",{value:d.id,key:d.id},y(d.name),9,ls))),128))],512),[[oe,e(l).tenant_id]]),t(U,{message:e(l).errors.tenant_id},null,8,["message"])])):$("",!0)]),s("div",is,[s("div",os,[s("div",rs,[t(e(j),{class:"flex items-center"},{default:u(()=>[t(e(se),{class:"h-4 w-4 mr-1 text-primary"}),n[17]||(n[17]=s("span",null,"Roles",-1)),t(e(R),{variant:"outline",class:"ml-2"},{default:u(()=>[f(y(e(l).roles.length)+" selected",1)]),_:1})]),_:1})]),s("div",as,[s("div",ds,[s("div",us,[t(e(K),{class:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),t(e(M),{modelValue:o.value,"onUpdate:modelValue":n[7]||(n[7]=d=>o.value=d),placeholder:"Search roles...",class:"w-full pl-9"},null,8,["modelValue"])]),o.value?(a(),S(e(h),{key:0,type:"button",variant:"ghost",size:"icon",onClick:n[8]||(n[8]=d=>o.value=""),class:"absolute right-2 top-2"},{default:u(()=>[t(e(I),{class:"h-4 w-4"})]),_:1})):$("",!0)])]),s("div",ms,[(a(!0),c(z,null,T(p.value,d=>(a(),c("div",{key:d.id,class:"flex items-center py-1 px-2 hover:bg-muted/50 rounded transition-colors"},[t(e(J),{id:`role-${d.id}`,checked:e(l).roles.includes(d.id),"onUpdate:checked":O=>C(d.id),class:"mr-2"},null,8,["id","checked","onUpdate:checked"]),t(e(j),{for:`role-${d.id}`,class:"cursor-pointer"},{default:u(()=>[f(y(d.name),1)]),_:2},1032,["for"])]))),128)),p.value.length===0?(a(),c("div",cs,[t(e(q),{class:"h-8 w-8 mb-2"}),n[18]||(n[18]=s("p",null,"No roles match your search",-1))])):$("",!0)]),t(U,{message:e(l).errors.roles},null,8,["message"])]),s("div",ps,[s("div",fs,[t(e(j),{class:"flex items-center"},{default:u(()=>[t(e(pe),{class:"h-4 w-4 mr-1 text-primary"}),n[19]||(n[19]=s("span",null,"Permissions",-1)),t(e(R),{variant:"outline",class:"ml-2"},{default:u(()=>[f(y(L.value)+" selected",1)]),_:1})]),_:1}),s("div",vs,[t(e(h),{type:"button",variant:"outline",size:"sm",onClick:D,class:"text-xs"},{default:u(()=>n[20]||(n[20]=[f(" Select All ")])),_:1}),t(e(h),{type:"button",variant:"outline",size:"sm",onClick:N,class:"text-xs"},{default:u(()=>n[21]||(n[21]=[f(" Clear All ")])),_:1})])]),s("div",gs,[s("div",xs,[s("div",bs,[t(e(K),{class:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),t(e(M),{modelValue:v.value,"onUpdate:modelValue":n[9]||(n[9]=d=>v.value=d),placeholder:"Search permissions...",class:"w-full pl-9"},null,8,["modelValue"])]),v.value?(a(),S(e(h),{key:0,type:"button",variant:"ghost",size:"icon",onClick:n[10]||(n[10]=d=>v.value=""),class:"absolute right-2 top-2"},{default:u(()=>[t(e(I),{class:"h-4 w-4"})]),_:1})):$("",!0)])]),s("div",hs,[(a(!0),c(z,null,T(H.value,(d,O)=>(a(),c("div",{key:O,class:"mb-4"},[s("div",_s,[s("div",ys,[t(e(te),{class:"h-4 w-4 mr-1 text-muted-foreground"}),f(" "+y(b(O))+" ",1),t(e(R),{variant:"secondary",class:"ml-2"},{default:u(()=>[f(y(d.length),1)]),_:2},1024)]),s("div",ks,[t(e(h),{type:"button",variant:"ghost",size:"sm",onClick:P=>Y(O),class:"text-xs h-6 px-2"},{default:u(()=>n[22]||(n[22]=[f(" Select All ")])),_:2},1032,["onClick"]),t(e(h),{type:"button",variant:"ghost",size:"sm",onClick:P=>B(O),class:"text-xs h-6 px-2"},{default:u(()=>n[23]||(n[23]=[f(" Clear ")])),_:2},1032,["onClick"])])]),(a(!0),c(z,null,T(d,P=>(a(),c("div",{key:P.id,class:"flex items-center py-1 px-2 hover:bg-muted/50 rounded transition-colors"},[t(e(J),{id:`permission-${P.name}`,checked:e(l).user_permissions.includes(P.name),"onUpdate:checked":gt=>E(P.name),disabled:x.value.includes(P.name),class:"mr-2"},null,8,["id","checked","onUpdate:checked","disabled"]),t(e(j),{for:`permission-${P.name}`,class:"cursor-pointer text-sm"},{default:u(()=>[f(y(m(P.name))+" ",1),x.value.includes(P.name)?(a(),c("span",$s," inherited ")):$("",!0)]),_:2},1032,["for"])]))),128))]))),128)),Object.keys(H.value).length===0?(a(),c("div",ws,[t(e(q),{class:"h-8 w-8 mb-2"}),n[24]||(n[24]=s("p",null,"No permissions match your search",-1))])):$("",!0)]),t(U,{message:e(l).errors.user_permissions},null,8,["message"])])]),s("div",Cs,[t(e(h),{type:"button",onClick:n[11]||(n[11]=()=>g("close")),variant:"outline"},{default:u(()=>n[25]||(n[25]=[f(" Cancel ")])),_:1}),t(e(h),{type:"submit",disabled:e(l).processing},{default:u(()=>[e(l).processing?(a(),S(e(ne),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):$("",!0),f(" "+y(e(l).processing?"Saving...":"Save"),1)]),_:1},8,["disabled"])])],32)])])]))}}),Ss={class:"w-full overflow-x-auto"},As={class:"rounded-md border"},zs={class:"w-full caption-bottom text-sm"},Ts={class:"[&_tr:last-child]:border-0"},Ps={class:"p-4 align-middle font-medium"},js={class:"p-4 align-middle"},Es={class:"p-4 align-middle"},Us={class:"p-4 align-middle text-right"},Ls={class:"flex justify-end space-x-2"},Ds={key:0,class:"mt-6 flex justify-center"},Vs={class:"flex flex-wrap items-center gap-1 justify-center"},Tt={__name:"TenantList",props:{tenants:{type:Object,default:()=>({data:[],links:[]})}},setup(k){const A=k,r={"America/New_York":"Eastern Time (ET)","America/Chicago":"Central Time (CT)","America/Denver":"Mountain Time (MT)","America/Los_Angeles":"Pacific Time (PT)","America/Anchorage":"Alaska Time (AKT)","Pacific/Honolulu":"Hawaii Time (HAST)","America/Phoenix":"Arizona Time (no DST)","America/Indiana/Indianapolis":"Eastern Time (Indiana)"},g=v=>r[v]||v,l=V(()=>Array.isArray(A.tenants)?A.tenants:A.tenants.data||[]),o=v=>{v&&Q.get(v,{},{only:["tenants"]})};return(v,w)=>(a(),c("div",Ss,[s("div",As,[s("table",zs,[w[2]||(w[2]=s("thead",{class:"[&_tr]:border-b"},[s("tr",{class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},[s("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Company Name"),s("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Slug"),s("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Timezone"),s("th",{class:"h-12 px-4 text-right pr-16 align-middle font-medium text-muted-foreground"},"Actions")])],-1)),s("tbody",Ts,[(a(!0),c(z,null,T(l.value,p=>(a(),c("tr",{key:p.id,class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},[s("td",Ps,y(p.name),1),s("td",js,y(p.slug),1),s("td",Es,y(g(p.timezone)),1),s("td",Us,[s("div",Ls,[t(e(h),{onClick:L=>v.$emit("edit",p),variant:"outline",size:"sm"},{default:u(()=>w[0]||(w[0]=[f(" Edit ")])),_:2},1032,["onClick"]),t(e(h),{onClick:L=>v.$emit("delete",p),variant:"destructive",size:"sm"},{default:u(()=>w[1]||(w[1]=[f(" Delete ")])),_:2},1032,["onClick"])])])]))),128))])])]),k.tenants.links?(a(),c("div",Ds,[s("nav",Vs,[(a(!0),c(z,null,T(k.tenants.links,p=>(a(),S(e(h),{key:p.label,onClick:L=>o(p.url),disabled:!p.url,variant:p.active?"default":"outline",size:"sm",class:"min-w-[40px]",innerHTML:p.label},null,8,["onClick","disabled","variant","innerHTML"]))),128))])])):$("",!0)]))}},Ms={class:"fixed inset-0 z-50"},Os={class:"absolute inset-0 flex items-center justify-center p-2 sm:p-4"},Rs={class:"bg-background p-6 rounded-lg shadow-xl w-full max-w-md overflow-y-auto max-h-[90vh] animate-in fade-in zoom-in-95 duration-200 border border-border"},Ns={class:"flex justify-between items-center mb-4"},Hs={class:"text-2xl font-bold text-foreground"},Gs={class:"space-y-2"},Is={key:0,class:"space-y-2"},Bs={class:"space-y-2"},Fs=["value"],Ws={class:"flex justify-end space-x-3 pt-4"},Pt=X({__name:"TenantForm",props:{tenant:{type:Object,default:null}},emits:["close","saved"],setup(k,{emit:A}){const r=k,g=A,l={"America/New_York":"Eastern Time (ET)","America/Chicago":"Central Time (CT)","America/Denver":"Mountain Time (MT)","America/Los_Angeles":"Pacific Time (PT)","America/Anchorage":"Alaska Time (AKT)","Pacific/Honolulu":"Hawaii Time (HAST)","America/Phoenix":"Arizona Time (no DST)","America/Indiana/Indianapolis":"Eastern Time (Indiana)"},o=W({name:r.tenant?r.tenant.name:"",slug:r.tenant?r.tenant.slug:"",timezone:r.tenant?r.tenant.timezone:"America/Indiana/Indianapolis"});Z(()=>r.tenant,w=>{w?(o.name=w.name,o.slug=w.slug,o.timezone=w.timezone):(o.name="",o.slug="",o.timezone="America/Indiana/Indianapolis")},{immediate:!0});const v=()=>{r.tenant?o.put(route("admin.tenants.update",r.tenant),{onSuccess:()=>{g("saved")}}):o.post(route("admin.tenants.store"),{onSuccess:()=>{g("saved")}})};return(w,p)=>{const L=le("X"),x=le("Loader2");return a(),c("div",Ms,[p[9]||(p[9]=s("div",{class:"absolute inset-0 bg-black/50 backdrop-blur-sm"},null,-1)),s("div",Os,[s("div",Rs,[s("div",Ns,[s("h2",Hs,y(k.tenant?"Edit Company":"Create Company"),1),t(e(h),{variant:"ghost",size:"icon",onClick:p[0]||(p[0]=()=>g("close"))},{default:u(()=>[t(L,{class:"h-5 w-5"})]),_:1})]),s("form",{onSubmit:ee(v,["prevent"]),class:"space-y-4"},[s("div",Gs,[t(e(j),{for:"name"},{default:u(()=>p[5]||(p[5]=[f("Company Name")])),_:1}),t(e(M),{id:"name",modelValue:e(o).name,"onUpdate:modelValue":p[1]||(p[1]=_=>e(o).name=_),placeholder:"Enter company name",class:"w-full"},null,8,["modelValue"]),t(U,{message:e(o).errors.name},null,8,["message"])]),k.tenant?(a(),c("div",Is,[t(e(j),{for:"slug"},{default:u(()=>p[6]||(p[6]=[f("Slug")])),_:1}),t(e(M),{id:"slug",modelValue:e(o).slug,"onUpdate:modelValue":p[2]||(p[2]=_=>e(o).slug=_),placeholder:"Enter company slug",class:"w-full"},null,8,["modelValue"]),t(U,{message:e(o).errors.slug},null,8,["message"])])):$("",!0),s("div",Bs,[t(e(j),{for:"timezone"},{default:u(()=>p[7]||(p[7]=[f("Timezone")])),_:1}),ie(s("select",{id:"timezone","onUpdate:modelValue":p[3]||(p[3]=_=>e(o).timezone=_),class:"mt-1 block w-full rounded-md border border-input bg-background px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50"},[(a(),c(z,null,T(l,(_,C)=>s("option",{key:C,value:C},y(_),9,Fs)),64))],512),[[oe,e(o).timezone]]),t(U,{message:e(o).errors.timezone},null,8,["message"])]),s("div",Ws,[t(e(h),{type:"button",onClick:p[4]||(p[4]=()=>g("close")),variant:"outline"},{default:u(()=>p[8]||(p[8]=[f(" Cancel ")])),_:1}),t(e(h),{type:"submit",disabled:e(o).processing},{default:u(()=>[e(o).processing?(a(),S(x,{key:0,class:"mr-2 h-4 w-4 animate-spin"})):$("",!0),f(" "+y(e(o).processing?"Saving...":"Save"),1)]),_:1},8,["disabled"])])],32)])])])}}}),Xs={class:"fixed inset-0 z-50"},Ys={class:"absolute inset-0 flex items-center justify-center p-2 sm:p-4"},Ks={class:"bg-background p-4 sm:p-6 rounded-lg shadow-xl w-full max-w-sm sm:max-w-md md:max-w-lg overflow-y-auto max-h-[95vh] animate-in fade-in zoom-in-95 duration-200 border border-border"},qs={class:"flex justify-between items-center mb-4"},Js={class:"text-xl sm:text-2xl font-bold text-foreground flex items-center"},Qs={class:"space-y-2"},Zs={class:"space-y-2"},et={class:"flex justify-between items-center"},st={class:"flex space-x-2"},tt={class:"relative"},nt={class:"flex items-center space-x-2"},lt={class:"relative w-full"},it={class:"h-48 sm:h-56 md:h-64 border rounded-md p-2 overflow-y-auto"},ot={class:"flex items-center justify-between mb-1"},rt={class:"font-medium text-sm text-foreground flex items-center"},at={class:"flex space-x-1"},dt={key:0,class:"flex flex-col items-center justify-center h-full text-muted-foreground"},ut={class:"flex justify-end space-x-3 pt-4"},jt=X({__name:"RoleForm",props:{role:{type:Object,default:null},permissions:{type:Array,default:()=>[]},isSuperAdmin:{type:Boolean,default:!1},tenantSlug:{type:String,default:null}},emits:["saved","close"],setup(k,{emit:A}){var B,H;const r=A,g=k,{tenantSlug:l}=g,o=W({name:g.role?g.role.name:"",permissions:((H=(B=g.role)==null?void 0:B.permissions)==null?void 0:H.map(b=>b.name))||[]}),v=G(""),w=V(()=>o.permissions.length),p=V(()=>{const b=v.value.trim()?g.permissions.filter(i=>i.name.toLowerCase().includes(v.value.toLowerCase())):g.permissions,m={};return b.forEach(i=>{const d=i.name.split(".")[0];m[d]||(m[d]=[]),m[d].push(i)}),m}),L=b=>b==="tenant-settings"?"Tenant Settings":b==="repair-orders"?"Repair Orders":b==="safety-data"?"Safety Data":b==="miles-driven"?"Miles Driven":b==="support-tickets"?"Support Tickets":b==="sms-coaching"?"SMS Coaching":b==="support-responses"?"Support Responses":b==="receive_updates"?"General":b.charAt(0).toUpperCase()+b.slice(1),x=b=>{const m=b.split(".");return m.length>1?m[1].charAt(0).toUpperCase()+m[1].slice(1).replace(/-/g," "):b};Z(()=>g.role,b=>{var m;b?(o.name=b.name,o.permissions=((m=b.permissions)==null?void 0:m.map(i=>i.name))||[]):(o.name="",o.permissions=[])},{immediate:!0});const _=b=>{const m=o.permissions.indexOf(b);m===-1?o.permissions.push(b):o.permissions.splice(m,1)},C=()=>{o.permissions=g.permissions.map(b=>b.name)},E=()=>{o.permissions=[]},D=b=>{g.permissions.filter(i=>i.name.startsWith(b+".")).map(i=>i.name).forEach(i=>{o.permissions.includes(i)||o.permissions.push(i)})},N=b=>{o.permissions=o.permissions.filter(m=>!m.startsWith(b+"."))},Y=()=>{g.role?g.isSuperAdmin?o.put(route("admin.roles.update",g.role.id),{onSuccess:()=>{r("saved")}}):o.put(route("roles.update",[l,g.role.id]),{onSuccess:()=>{r("saved")}}):g.isSuperAdmin?o.post(route("admin.roles.store"),{onSuccess:()=>{r("saved")}}):o.post(route("roles.store",l),{onSuccess:()=>{r("saved")}})};return(b,m)=>(a(),c("div",Xs,[m[13]||(m[13]=s("div",{class:"absolute inset-0 bg-black/50 backdrop-blur-sm"},null,-1)),s("div",Ys,[s("div",Ks,[s("div",qs,[s("h2",Js,[t(e(se),{class:"h-5 w-5 mr-2 text-primary"}),f(" "+y(k.role?"Edit Role":"Create Role"),1)]),t(e(h),{variant:"ghost",size:"icon",onClick:m[0]||(m[0]=()=>r("close"))},{default:u(()=>[t(e(I),{class:"h-5 w-5"})]),_:1})]),s("form",{onSubmit:ee(Y,["prevent"]),class:"space-y-4"},[s("div",Qs,[t(e(j),{for:"name",class:"flex items-center"},{default:u(()=>m[5]||(m[5]=[s("span",null,"Role Name",-1),s("span",{class:"text-destructive ml-1"},"*",-1)])),_:1}),t(e(M),{id:"name",modelValue:e(o).name,"onUpdate:modelValue":m[1]||(m[1]=i=>e(o).name=i),placeholder:"Enter role name",class:F(["w-full",{"border-destructive":e(o).errors.name}]),autofocus:""},null,8,["modelValue","class"]),t(U,{message:e(o).errors.name},null,8,["message"])]),s("div",Zs,[s("div",et,[t(e(j),{class:"flex items-center"},{default:u(()=>[m[6]||(m[6]=s("span",null,"Permissions",-1)),t(e(R),{variant:"outline",class:"ml-2"},{default:u(()=>[f(y(w.value)+" selected",1)]),_:1})]),_:1}),s("div",st,[t(e(h),{type:"button",variant:"outline",size:"sm",onClick:C,class:"text-xs"},{default:u(()=>m[7]||(m[7]=[f(" Select All ")])),_:1}),t(e(h),{type:"button",variant:"outline",size:"sm",onClick:E,class:"text-xs"},{default:u(()=>m[8]||(m[8]=[f(" Clear All ")])),_:1})])]),s("div",tt,[s("div",nt,[s("div",lt,[t(e(K),{class:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),t(e(M),{modelValue:v.value,"onUpdate:modelValue":m[2]||(m[2]=i=>v.value=i),placeholder:"Search permissions...",class:"w-full pl-9"},null,8,["modelValue"])]),v.value?(a(),S(e(h),{key:0,type:"button",variant:"ghost",size:"icon",onClick:m[3]||(m[3]=i=>v.value=""),class:"absolute right-2 top-2"},{default:u(()=>[t(e(I),{class:"h-4 w-4"})]),_:1})):$("",!0)])]),s("div",it,[(a(!0),c(z,null,T(p.value,(i,n)=>(a(),c("div",{key:n,class:"mb-4"},[s("div",ot,[s("div",rt,[t(e(te),{class:"h-4 w-4 mr-1 text-muted-foreground"}),f(" "+y(L(n))+" ",1),t(e(R),{variant:"secondary",class:"ml-2"},{default:u(()=>[f(y(i.length),1)]),_:2},1024)]),s("div",at,[t(e(h),{type:"button",variant:"ghost",size:"sm",onClick:d=>D(n),class:"text-xs h-6 px-2"},{default:u(()=>m[9]||(m[9]=[f(" Select All ")])),_:2},1032,["onClick"]),t(e(h),{type:"button",variant:"ghost",size:"sm",onClick:d=>N(n),class:"text-xs h-6 px-2"},{default:u(()=>m[10]||(m[10]=[f(" Clear ")])),_:2},1032,["onClick"])])]),(a(!0),c(z,null,T(i,d=>(a(),c("div",{key:d.id,class:"flex items-center py-1 px-2 hover:bg-muted/50 rounded transition-colors"},[t(e(J),{id:`permission-${d.name}`,checked:e(o).permissions.includes(d.name),"onUpdate:checked":O=>_(d.name),class:"mr-2"},null,8,["id","checked","onUpdate:checked"]),t(e(j),{for:`permission-${d.name}`,class:"cursor-pointer text-sm"},{default:u(()=>[f(y(x(d.name)),1)]),_:2},1032,["for"])]))),128))]))),128)),Object.keys(p.value).length===0?(a(),c("div",dt,[t(e(q),{class:"h-8 w-8 mb-2"}),m[11]||(m[11]=s("p",null,"No permissions match your search",-1))])):$("",!0)]),t(U,{message:e(o).errors.permissions},null,8,["message"])]),s("div",ut,[t(e(h),{type:"button",onClick:m[4]||(m[4]=()=>r("close")),variant:"outline"},{default:u(()=>m[12]||(m[12]=[f(" Cancel ")])),_:1}),t(e(h),{type:"submit",disabled:e(o).processing},{default:u(()=>[e(o).processing?(a(),S(e(ne),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):$("",!0),f(" "+y(e(o).processing?"Saving...":"Save"),1)]),_:1},8,["disabled"])])],32)])])]))}}),mt={class:"fixed inset-0 flex items-center justify-center bg-black/50 backdrop-blur-sm z-50 p-4"},ct={class:"bg-background p-6 rounded-lg shadow-xl w-full max-w-md animate-in fade-in zoom-in-95 duration-200 border border-border"},pt={class:"flex flex-col space-y-4"},ft={class:"text-muted-foreground"},vt={class:"flex justify-end space-x-3 pt-2"},Et=X({__name:"ConfirmDeleteModal",props:{message:{type:String,default:"Are you sure you want to delete this item?"},deleteUrl:{type:String,required:!0},tenantSlug:{type:String,default:null}},emits:["cancel","confirmed"],setup(k,{emit:A}){const r=k,g=A,l=W({}),o=()=>{l.delete(r.deleteUrl,{onSuccess:()=>{g("confirmed")}})},v=()=>{g("cancel")};return(w,p)=>(a(),c("div",mt,[s("div",ct,[s("div",pt,[p[1]||(p[1]=s("h2",{class:"text-xl font-bold text-foreground"},"Confirm Deletion",-1)),s("p",ft,y(k.message),1),s("div",vt,[t(e(h),{type:"button",onClick:v,variant:"outline"},{default:u(()=>p[0]||(p[0]=[f(" Cancel ")])),_:1}),t(e(h),{type:"button",variant:"destructive",onClick:o,disabled:e(l).processing},{default:u(()=>[e(l).processing?(a(),S(e(ne),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):$("",!0),f(" "+y(e(l).processing?"Deleting...":"Delete"),1)]),_:1},8,["disabled"])])])])]))}});export{St as _,At as a,Tt as b,zt as c,Pt as d,jt as e,Et as f};
