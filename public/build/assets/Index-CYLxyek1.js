import{d as Ct,w as De,L as u,e as o,X as t,k as y,l,f as s,S as i,D as Y,Y as K,u as a,M as w,N as U,U as c,P as _e,c as A,b2 as J,a1 as Dt,r as S,A as qe,bW as St,b as C,K as $t,bF as Nt}from"./vendor-C-CW143M.js";import{x as we,a as Tt,g as At,W}from"./vendor-vue-o4TX1eGc.js";import{_ as Se}from"./Input.vue_vue_type_script_setup_true_lang-taOxs2kk.js";import{_}from"./Button.vue_vue_type_script_setup_true_lang-B-CPTRto.js";import{_ as Ft}from"./Checkbox.vue_vue_type_script_setup_true_lang-ChpjAJsN.js";import{_ as O}from"./Label.vue_vue_type_script_setup_true_lang-CZjK18aI.js";import{_ as N}from"./Icon.vue_vue_type_script_setup_true_lang-B7IfTNIf.js";import{_ as Vt}from"./Badge.vue_vue_type_script_setup_true_lang-Cb4j4dNt.js";import{_ as Ve,a as Me,b as oe,c as Z,d as je,e as Q}from"./TableRow.vue_vue_type_script_setup_true_lang-D19AmMrD.js";import{_ as ce}from"./Card.vue_vue_type_script_setup_true_lang-Cp4wUgFE.js";import{_ as Mt}from"./CardHeader.vue_vue_type_script_setup_true_lang-CNgbOXgy.js";import{_ as jt}from"./CardTitle.vue_vue_type_script_setup_true_lang-BcA2pWrU.js";import{_ as pe}from"./CardContent.vue_vue_type_script_setup_true_lang-DxPj8Tg7.js";import{b as ve,_ as ye,a as ge}from"./DialogDescription.vue_vue_type_script_setup_true_lang-DjSCH9m8.js";import{_ as xe,a as be}from"./DialogTitle.vue_vue_type_script_setup_true_lang-BSj40beh.js";import{_ as Ae}from"./DialogFooter.vue_vue_type_script_setup_true_lang-RSN6g_4k.js";import{b as Oe,_ as Ee,a as Ue}from"./AlertDescription.vue_vue_type_script_setup_true_lang-Bni7FoRm.js";import{_ as Ot}from"./AppLayout.vue_vue_type_script_setup_true_lang-D6CqwD6B.js";import"./vendor-axios-xsH4HHeE.js";import"./utils-CmSxFldp.js";import"./vendor-ui-DUlj4Wsf.js";import"./vendor-icons-Dyo-jBRF.js";import"./useInitials-DzeGKvtI.js";import"./app-B_vN6s90.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-C-8K70bD.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Et={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Ut={key:0,class:"col-span-full"},zt={class:"relative"},Pt=["value"],Rt={class:"col-span-full"},Bt={class:"relative"},Lt={class:"relative"},It={class:"relative"},Wt=["value"],Yt={class:"relative"},qt={class:"flex items-center space-x-2"},Ht={class:"flex-col space-y-2 sm:space-y-0 sm:flex-row sm:justify-end sm:space-x-2 pt-4 border-t flex"},Gt=Ct({__name:"DelayForm",props:{delay:{type:Object,default:null},delayCodes:{type:Array,default:()=>[]},tenants:{type:Array,default:()=>[]},isSuperAdmin:{type:Boolean,default:!1},tenantSlug:{type:String,default:null}},emits:["close"],setup(v,{emit:d}){var F,z,q,M,ee,te,H;const k=v,j=d,p=we({id:(F=k.delay)==null?void 0:F.id,tenant_id:k.isSuperAdmin?(z=k.delay)==null?void 0:z.tenant_id:null,date:((q=k.delay)==null?void 0:q.date)||"",driver_name:((M=k.delay)==null?void 0:M.driver_name)||"",delay_type:((ee=k.delay)==null?void 0:ee.delay_type)||"origin",delay_category:((te=k.delay)==null?void 0:te.delay_category)||"1_60",delay_code_id:((H=k.delay)==null?void 0:H.delay_code_id)||null,disputed:k.delay&&k.delay.disputed!==null?parseInt(k.delay.disputed)===1:!1,driver_controllable:k.delay&&k.delay.driver_controllable!==null?parseInt(k.delay.driver_controllable)===1:null});De(()=>k.delay,D=>{D?(p.id=D.id,p.tenant_id=D.tenant_id,p.date=D.date,p.driver_name=D.driver_name,p.delay_type=D.delay_type,p.delay_category=D.delay_category,p.delay_code_id=D.delay_code_id,p.disputed=D.disputed!==null?parseInt(D.disputed)===1:!1,p.driver_controllable=D.driver_controllable!==null?parseInt(D.driver_controllable)===1:null):p.reset()},{immediate:!0});const V=()=>{const D=!!p.id,f=k.isSuperAdmin?D?"ontime.update.admin":"ontime.store.admin":D?"ontime.update":"ontime.store",m=k.isSuperAdmin?D?{delay:p.id}:{}:D?{tenantSlug:k.tenantSlug,delay:p.id}:{tenantSlug:k.tenantSlug};p[D?"put":"post"](route(f,m),{onSuccess:()=>j("close")})};return(D,f)=>(o(),u("form",{onSubmit:_e(V,["prevent"]),class:"space-y-6"},[t("div",Et,[v.isSuperAdmin?(o(),u("div",Ut,[l(O,null,{default:s(()=>f[9]||(f[9]=[i("Company Name")])),_:1}),t("div",zt,[Y(t("select",{"onUpdate:modelValue":f[0]||(f[0]=m=>a(p).tenant_id=m),class:"flex h-10 w-full items-center rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 appearance-none"},[f[10]||(f[10]=t("option",{value:null,disabled:""},"Select Company",-1)),(o(!0),u(w,null,U(v.tenants,m=>(o(),u("option",{key:m.id,value:m.id},c(m.name),9,Pt))),128))],512),[[K,a(p).tenant_id]]),f[11]||(f[11]=t("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[t("svg",{class:"h-4 w-4 opacity-50",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])],-1))])])):y("",!0),t("div",Rt,[l(O,null,{default:s(()=>f[12]||(f[12]=[i("Date")])),_:1}),l(Se,{type:"date",modelValue:a(p).date,"onUpdate:modelValue":f[1]||(f[1]=m=>a(p).date=m),class:"w-full"},null,8,["modelValue"])]),t("div",null,[l(O,null,{default:s(()=>f[13]||(f[13]=[i("Driver Name")])),_:1}),l(Se,{modelValue:a(p).driver_name,"onUpdate:modelValue":f[2]||(f[2]=m=>a(p).driver_name=m),class:"w-full"},null,8,["modelValue"])]),t("div",null,[l(O,null,{default:s(()=>f[14]||(f[14]=[i("Delay Type")])),_:1}),t("div",Bt,[Y(t("select",{"onUpdate:modelValue":f[3]||(f[3]=m=>a(p).delay_type=m),class:"flex h-10 w-full items-center rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 appearance-none"},f[15]||(f[15]=[t("option",{value:"origin"},"Origin",-1),t("option",{value:"destination"},"Destination",-1)]),512),[[K,a(p).delay_type]]),f[16]||(f[16]=t("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[t("svg",{class:"h-4 w-4 opacity-50",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])],-1))])]),t("div",null,[l(O,null,{default:s(()=>f[17]||(f[17]=[i("Delay Category")])),_:1}),t("div",Lt,[Y(t("select",{"onUpdate:modelValue":f[4]||(f[4]=m=>a(p).delay_category=m),class:"flex h-10 w-full items-center rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 appearance-none"},f[18]||(f[18]=[t("option",{value:"1_60"},"1–60 min",-1),t("option",{value:"61_240"},"61–240 min",-1),t("option",{value:"241_600"},"241–600 min",-1),t("option",{value:"601_plus"},"601+ min",-1)]),512),[[K,a(p).delay_category]]),f[19]||(f[19]=t("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[t("svg",{class:"h-4 w-4 opacity-50",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])],-1))])]),t("div",null,[l(O,null,{default:s(()=>f[20]||(f[20]=[i("Delay Code")])),_:1}),t("div",It,[Y(t("select",{"onUpdate:modelValue":f[5]||(f[5]=m=>a(p).delay_code_id=m),class:"flex h-10 w-full items-center rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 appearance-none"},[(o(!0),u(w,null,U(v.delayCodes,m=>(o(),u("option",{key:m.id,value:m.id},c(m.code),9,Wt))),128))],512),[[K,a(p).delay_code_id]]),f[21]||(f[21]=t("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[t("svg",{class:"h-4 w-4 opacity-50",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])],-1))])]),t("div",null,[l(O,null,{default:s(()=>f[22]||(f[22]=[i("Driver Controllable")])),_:1}),t("div",Yt,[Y(t("select",{"onUpdate:modelValue":f[6]||(f[6]=m=>a(p).driver_controllable=m),class:"flex h-10 w-full items-center rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 appearance-none"},f[23]||(f[23]=[t("option",{value:null},"N/A",-1),t("option",{value:!0},"Yes",-1),t("option",{value:!1},"No",-1)]),512),[[K,a(p).driver_controllable]]),f[24]||(f[24]=t("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[t("svg",{class:"h-4 w-4 opacity-50",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])],-1))])]),t("div",qt,[l(Ft,{modelValue:a(p).disputed,"onUpdate:modelValue":f[7]||(f[7]=m=>a(p).disputed=m),id:"disputed"},null,8,["modelValue"]),l(O,{for:"disputed"},{default:s(()=>f[25]||(f[25]=[i("Disputed")])),_:1})])]),t("div",Ht,[l(_,{type:"button",onClick:f[8]||(f[8]=m=>j("close")),variant:"outline",class:"w-full sm:w-auto"},{default:s(()=>f[26]||(f[26]=[i(" Cancel ")])),_:1}),l(_,{type:"submit",disabled:a(p).processing,class:"w-full sm:w-auto"},{default:s(()=>[i(c(a(p).id?"Update":"Create"),1)]),_:1},8,["disabled"])])],32))}}),Kt={class:"bg-background rounded-lg border shadow-sm p-2 md:p-4 lg:p-6 flex flex-col items-center justify-center"},Qt={class:"text-base font-semibold mb-2 text-foreground"},Xt={__name:"TotalLateStops",props:{title:{type:String,required:!0},value:{type:[Number,String],required:!0}},setup(v){const d=v,k=A(()=>d.value===null||d.value===void 0||d.value===""?"No Data":d.value),j=A(()=>{const p=Number(d.value);return d.title.toLowerCase().includes("total")&&p>0});return(p,V)=>(o(),u("div",Kt,[t("h3",Qt,c(v.title),1),t("p",{class:J(["text-2xl font-bold",j.value?"text-red-600":"text-primary"])},c(k.value),3)]))}},Zt={class:"bg-background rounded-lg border shadow-sm p-2 md:p-4"},Jt={class:"text-base text-center font-semibold mb-2 md:mb-4"},el={key:0,class:"text-center text-sm py-4 text-primary font-medium"},tl={class:"space-y-3"},ll={class:"text-sm"},sl={__name:"BottomDrivers",props:{title:{type:String,default:"Bottom 5 Drivers"},drivers:{type:Array,default:()=>[]},delayType:{type:String,default:""},totalDelays:{type:Number,default:-1}},setup(v){const d=v,k=j=>{const p=["#ef4444","#f97316","#f59e0b","#84cc16","#10b981"],F=[...d.drivers].sort((z,q)=>q.total_penalty-z.total_penalty).map(z=>z.total_penalty).indexOf(j);return p[F]||"#6b7280"};return(j,p)=>(o(),u("div",Zt,[t("h3",Jt,c(v.title),1),v.drivers.length===0?(o(),u("div",el,[v.totalDelays===0?(o(),u(w,{key:0},[v.delayType==="origin"?(o(),u(w,{key:0},[i(" No origin delays recorded. You're on track for Fantastic+ ! ")],64)):v.delayType==="destination"?(o(),u(w,{key:1},[i(" No destination delays recorded. You're on track for Fantastic+ ! ")],64)):(o(),u(w,{key:2},[i(" No delays recorded. You're on track for Fantastic+ ! ")],64))],64)):(o(),u(w,{key:1},[i(" No delays recorded. You're on track for Fantastic+ ! ")],64))])):(o(),u(w,{key:1},[p[0]||(p[0]=t("div",{class:"flex justify-between items-center mb-2"},[t("span",{class:"text-base mb-2 font-medium"},"Driver Name"),t("span",{class:"text-base mb-2 font-medium"},"Total Penalty")],-1)),t("div",tl,[(o(!0),u(w,null,U(v.drivers,(V,F)=>(o(),u("div",{key:F,class:"flex justify-between items-center"},[t("span",ll,c(V.driver_name),1),t("span",{class:"text-sm font-medium",style:Dt({color:k(V.total_penalty)})},c(V.total_penalty),5)]))),128))])],64))]))}},al={class:"bg-background rounded-lg border shadow-sm p-2 md:p-4"},nl={class:"text-base text-center font-semibold mb-2 md:mb-4"},ol={class:"h-64"},rl={__name:"LineChart",props:{title:{type:String,default:"On-Time Score"},chartData:{type:Object,default:()=>({labels:[],datasets:[]})},averageOntime:{type:Number,default:null}},setup(v){const d=v,k=S(null);let j=null;const p=()=>{if(j&&j.destroy(),!k.value)return;const V=k.value.getContext("2d"),F=[];d.chartData.datasets.forEach(M=>{M.data&&M.data.length&&F.push(...M.data)});const z=F.length>0?Math.min(...F):0,q=F.length>0?Math.max(...F):100;j=new St(V,{type:"line",data:d.chartData,options:{responsive:!0,maintainAspectRatio:!1,layout:{padding:{left:15,right:15,top:10,bottom:10}},plugins:{legend:{position:!1},tooltip:{callbacks:{label:function(M){const ee=M.raw||0,te=d.averageOntime||0,H=d.chartData.dateRangeLabel||"selected period",D=Number(te).toFixed(2);return[`On-Time Score: ${ee}`,`Average Score Over ${H}: ${D}`]}}}},scales:{y:{beginAtZero:!(z>10),min:Math.max(Math.floor(z-5),0),max:Math.min(102,Math.ceil(q+5)),ticks:{stepSize:2.5,padding:10,font:{size:11},callback:function(M){return M<=100?M:""}},grid:{drawBorder:!0,color:"rgba(200, 200, 200, 0.2)"}},x:{ticks:{padding:10,font:{size:11}},grid:{drawBorder:!0,color:"rgba(200, 200, 200, 0.2)"}}}}})};return qe(()=>{p()}),De(()=>d.chartData,()=>{p()},{deep:!0}),(V,F)=>(o(),u("div",al,[t("h3",nl,c(v.title),1),t("div",ol,[t("canvas",{ref_key:"chartCanvas",ref:k},null,512)])]))}},dl={class:"space-y-2 md:space-y-4 lg:space-y-6 mb-2 md:mb-4 lg:mb-6"},il={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-2 md:gap-4"},ul={class:"grid grid-cols-1 lg:grid-cols-4 gap-2 md:gap-4 lg:gap-6"},ml={key:1,class:"bg-background rounded-lg border shadow-sm p-4 md:p-6 lg:col-span-3 md:col-span-2 transition-all duration-300 hover:shadow-md flex flex-col justify-center"},fl={class:"flex flex-col sm:flex-row items-center justify-center sm:justify-around gap-3 mb-4"},cl={class:"text-xs text-muted-foreground text-center mt-2"},pl={key:2,class:"bg-background rounded-lg border shadow-sm p-4 md:p-6 lg:col-span-3 md:col-span-2 transition-all duration-300 hover:shadow-md flex flex-col justify-center items-center"},vl={class:"flex flex-col items-center justify-center gap-3 mb-4"},yl={__name:"OnTimeDashboard",props:{metricsData:{type:Object,default:()=>({})},driversData:{type:Array,default:()=>[]},chartData:{type:Object,default:()=>({})},averageOntime:{type:Number,default:null},currentDateFilter:{type:String,default:null},delayType:{type:String,default:"all"}},setup(v){const d=v,k=A(()=>d.metricsData&&d.metricsData.by_category?[{title:"Total Delayed Stops",value:d.metricsData.totalDelays},{title:"Delayed for 1-60 Minutes",value:d.metricsData.between1_60Count},{title:"Delayed for 61-240 Minutes",value:d.metricsData.between61_240Count},{title:"Delayed for 241-600 Minutes",value:d.metricsData.between241_600Count},{title:"Delayed for +601 Minutes",value:d.metricsData.moreThan601Count}]:[]),j=A(()=>d.driversData&&d.driversData.length?d.driversData:[]),p=A(()=>d.chartData&&Object.keys(d.chartData).length?d.chartData:{}),V=A(()=>{var m;return((m=d.metricsData)==null?void 0:m.totalDelays)||0}),F=A(()=>!d.chartData||!d.chartData.labels?!1:d.chartData.labels.length>1),z=A(()=>{var m,h,G,le;return((le=(G=(h=(m=d.chartData)==null?void 0:m.datasets)==null?void 0:h[0])==null?void 0:G.data)==null?void 0:le.length)>0}),q=A(()=>z.value?d.chartData.datasets[0].data[0]:0),M=A(()=>{const m=q.value;return m>=98?"fantastic_plus":m>=95?"fantastic":m>=90?"good":m>=85?"fair":"poor"}),ee=m=>m==null?"0%":`${Math.round(parseFloat(m))}%`,te=m=>{if(!m)return"Not Available";switch(m){case"fantastic_plus":return"Fantastic +";case"fantastic":return"Fantastic";case"good":return"Good";case"fair":return"Fair";case"poor":return"Poor";default:return m}},H=m=>{if(!m)return"outline";switch(m){case"fantastic_plus":return"fantastic-plus";case"fantastic":return"fantastic";case"good":return"good";case"fair":return"fair";case"poor":return"poor";default:return"outline"}},D=m=>{if(!m)return"text-gray-600";switch(m){case"fantastic_plus":return"text-green-600";case"fantastic":return"text-emerald-600";case"good":return"text-blue-600";case"fair":return"text-amber-600";case"poor":return"text-red-600";default:return"text-indigo-600"}},f=m=>{if(!m)return"";switch(m){case"fantastic_plus":return"Outstanding performance with exceptional on-time rate";case"fantastic":return"Excellent performance with very high on-time rate";case"good":return"Solid performance with good on-time rate";case"fair":return"Acceptable performance with room for improvement";case"poor":return"Performance needs significant improvement";default:return""}};return(m,h)=>(o(),u("div",dl,[t("div",il,[(o(!0),u(w,null,U(k.value,(G,le)=>(o(),C(Xt,{key:le,title:G.title,value:G.value,class:"transition-all duration-300 hover:shadow-md"},null,8,["title","value"]))),128))]),t("div",ul,[l(sl,{title:"Bottom 5 Drivers",drivers:j.value,delayType:v.delayType,totalDelays:V.value,class:J({"lg:col-span-1":F.value,"lg:col-span-1 md:col-span-1":!F.value,"transition-all duration-300 hover:shadow-md":!0})},null,8,["drivers","delayType","totalDelays","class"]),d.currentDateFilter!="Yesterday"&&F.value?(o(),C(rl,{key:0,title:"On-Time Score",chartData:p.value,averageOntime:v.averageOntime,class:"lg:col-span-3 md:col-span-2 transition-all duration-300 hover:shadow-md"},null,8,["chartData","averageOntime"])):y("",!0),!F.value&&z.value?(o(),u("div",ml,[h[0]||(h[0]=t("h3",{class:"text-base md:text-lg text-center font-semibold mb-4"},"On-Time Score",-1)),t("div",fl,[t("div",{class:J(["text-4xl md:text-5xl font-bold text-center",D(M.value)])},c(ee(q.value)),3),l(a(Vt),{variant:H(M.value),class:"text-xs md:text-sm px-3 py-1"},{default:s(()=>[i(c(te(M.value)),1)]),_:1},8,["variant"])]),t("p",cl,c(f(M.value)),1)])):y("",!0),z.value?y("",!0):(o(),u("div",pl,[h[3]||(h[3]=t("h3",{class:"text-base md:text-lg text-center font-semibold mb-4"},"On-Time Score",-1)),t("div",vl,[l(N,{name:"chart_bar",class:"h-16 w-16 text-muted-foreground/50"}),h[1]||(h[1]=t("div",{class:"text-lg font-medium text-center text-primary"}," No data available ",-1)),h[2]||(h[2]=t("p",{class:"text-sm text-primary/70 text-center max-w-md"}," There is no on-time data available for the selected time period. Try selecting a different date range or check back later. ",-1))])]))])]))}},gl={class:"w-full md:max-w-2xl lg:max-w-3xl xl:max-w-6xl lg:mx-auto m-0 p-2 md:p-4 lg:p-6 space-y-2 md:space-y-4 lg:space-y-6"},xl={class:"mb-2 flex flex-col items-center justify-between px-2 sm:flex-row md:mb-4 lg:mb-6"},bl={class:"flex flex-wrap gap-3 ml-3"},_l=["action"],wl={class:"flex flex-col items-center gap-2 md:items-start"},kl={class:"flex flex-wrap gap-1 md:gap-2"},hl={key:0,class:"text-sm text-muted-foreground"},Cl={key:0},Dl={key:1},Sl={key:2},$l={key:3,class:"ml-1"},Nl={class:"flex items-center justify-between"},Tl={class:"flex items-center gap-2"},Al={key:0,class:"ml-4 flex flex-wrap gap-2"},Fl={key:0,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},Vl={key:1,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},Ml={key:2,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},jl={key:3,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},Ol={key:4,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},El={key:5,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},Ul={class:"flex flex-col justify-between gap-1 md:gap-4"},zl={class:"grid w-full grid-cols-1 gap-1 sm:grid-cols-3 md:gap-4"},Pl=["value"],Rl={class:"flex justify-end space-x-2"},Bl={class:"overflow-x-auto"},Ll={class:"flex items-center justify-center"},Il=["checked"],Wl={class:"flex items-center"},Yl={key:2,class:"ml-2"},ql={key:0,class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Hl={key:1,class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Gl={key:3,class:"ml-2 opacity-50"},Kl=["value"],Ql={key:0,class:"ml-1 text-xs text-red-500"},Xl={class:"flex justify-end space-x-2"},Zl={key:0,class:"border-t bg-muted/20 px-4 py-3"},Jl={class:"flex flex-col items-center justify-between gap-2 sm:flex-row"},es={class:"text-sm text-muted-foreground"},ts={class:"flex w-full flex-col items-center gap-2 sm:w-auto sm:flex-row sm:gap-4"},ls={class:"flex items-center gap-2"},ss={class:"flex flex-wrap"},as=["innerHTML"],ns={class:"max-h-[75vh] space-y-4 overflow-y-auto p-4 sm:p-6"},os={class:"flex items-center justify-between"},rs={class:"max-h-[400px] overflow-y-auto rounded-md border"},ds={key:0,class:"rounded-md border py-8 text-center text-xs text-muted-foreground sm:text-sm"},is={key:1,class:"divide-y"},us=["onClick"],ms={class:"text-xs font-medium sm:text-sm"},fs={key:0,class:"ml-2 text-[0.65rem] text-red-500 sm:text-xs"},cs={key:0,class:"mt-1 text-xs text-muted-foreground sm:text-sm"},ps={class:"flex space-x-1 opacity-0 transition-opacity group-hover:opacity-100"},vs={key:0,class:"space-y-4 rounded-md border p-4"},ys={class:"text-sm font-medium sm:text-base"},gs={class:"space-y-3"},xs={class:"flex justify-end space-x-2"},bs={class:"flex items-center gap-2"},_s={class:"flex-1 overflow-y-auto px-4 sm:px-6 py-4"},ws={key:0},ks={class:"space-y-4"},hs={class:"cursor-pointer mt-3"},Cs=["disabled"],Ds={key:0,class:"mt-3 text-xs text-primary font-medium"},Ss={class:"flex items-center gap-2 text-sm text-muted-foreground"},$s=["href"],Ns={key:0,class:"flex items-center justify-center gap-2 p-4"},Ts={key:1,class:"space-y-4"},As={key:0,class:"rounded-lg border p-3"},Fs={class:"flex items-center justify-between"},Vs={class:"text-xs text-muted-foreground"},Ms={class:"mt-2 flex flex-wrap gap-2"},js={class:"grid grid-cols-3 gap-4"},Os={class:"text-2xl font-bold"},Es={class:"text-2xl font-bold text-green-600"},Us={class:"text-2xl font-bold text-red-600"},zs={key:2},Ps={class:"flex items-center justify-between mb-3"},Rs={class:"text-lg font-semibold text-red-600 flex items-center gap-2"},Bs={class:"border rounded-lg overflow-hidden"},Ls={class:"max-h-96 overflow-y-auto"},Is={class:"flex flex-wrap gap-x-3 gap-y-1"},Ws={class:"font-medium text-foreground"},Ys={key:0,class:"italic text-muted-foreground"},qs={class:"space-y-1"},Hs={key:0,class:"text-xs text-muted-foreground"},Gs={key:3},Ks={class:"text-lg font-semibold text-green-600 flex items-center gap-2 mb-3"},Qs={class:"border rounded-lg overflow-hidden"},Xs={class:"flex flex-wrap gap-x-3 gap-y-1"},Zs={class:"font-medium"},Js={key:0,class:"italic text-muted-foreground"},ea={class:"border-t p-4 flex justify-end gap-3"},ta={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},Na={__name:"Index",props:{delays:{type:Object,default:()=>({data:[],links:[]})},tenantSlug:{type:String,default:null},delay_codes:{type:Array,default:()=>[]},tenants:{type:Array,default:()=>[]},isSuperAdmin:{type:Boolean,default:!1},dateRange:{type:Object,default:null},dateFilter:{type:String,default:"yesterday"},weekNumber:{type:Number,default:null},startWeekNumber:{type:Number,default:null},endWeekNumber:{type:Number,default:null},year:{type:Number,default:null},delay_breakdown:{type:Object,default:null},line_chart_data:{type:Array,default:()=>[]},average_ontime:{type:Number,default:null},filters:{type:Object,default:()=>({search:"",delayCode:"",delayCategory:"",delayType:"",disputed:"",controllable:""})},permissions:Array},setup(v){var Ye;const d=v,k=Tt();qe(()=>{const n=e=>e.preventDefault();window.addEventListener("dragover",n),window.addEventListener("drop",n),$t(()=>{window.removeEventListener("dragover",n),window.removeEventListener("drop",n)})});const j=S(null),p=S(!1);let V=0;function F(){V+=1,p.value=!0}function z(){p.value=!0}function q(){V-=1,V<=0&&(V=0,p.value=!1)}function M(n){var b,r;V=0,p.value=!1;const e=(r=(b=n.dataTransfer)==null?void 0:b.files)==null?void 0:r[0];e&&Ie(e)}function ee(n){var b;const e=(b=n.target.files)==null?void 0:b[0];e&&(Ie(e),n.target.value="")}const te=[{title:d.tenantSlug?"Dashboard":"Admin Dashboard",href:d.tenantSlug?route("dashboard",{tenantSlug:d.tenantSlug}):route("admin.dashboard")},{title:"On-Time",href:d.tenantSlug?route("ontime.index",{tenantSlug:d.tenantSlug}):route("ontime.index.admin")}],H=S(!1),D=S(!1),f=S(null),m=S(""),h=S(""),G=S(!1),le=S(null),B=S([]),ke=S(!1),ze=S(null),he=S(!1),$=S(null),ae=S(!1),ne=S(!1),re=S(!1),de=S(!1),L=S(null),se=S({code:"",description:""}),Ce=S(!1),Fe=S(null),ie=S("date"),ue=S("desc"),x=S({...d.filters}),me=S(((Ye=d.delays)==null?void 0:Ye.per_page)||10),R=S(d.dateFilter||"full"),Pe=A(()=>(R.value==="yesterday"||R.value==="current-week")&&d.weekNumber&&d.year?`Week ${d.weekNumber}, ${d.year}`:(R.value==="6w"||R.value==="quarterly")&&d.startWeekNumber&&d.endWeekNumber&&d.year?`Weeks ${d.startWeekNumber}-${d.endWeekNumber}, ${d.year}`:""),$e=["date","delay_type","driver_name","delay_category","delay_code","disputed","driver_controllable"],I=A(()=>d.permissions.map(n=>n.name)),He=A(()=>x.value.search||x.value.delayCode||x.value.delayCategory||x.value.disputed||x.value.delayType||x.value.controllable),Ge=n=>{if(!n)return"";const e=typeof n=="string"?parseInt(n,10):n,b=d.delay_codes.find(r=>r.id===e);return b?b.code:""},fe=A(()=>{var e;let n=[...((e=d.delays)==null?void 0:e.data)||[]];return n.sort((b,r)=>{var T,P;let g,E;return ie.value==="delay_code"?(g=((T=b.delay_code)==null?void 0:T.code)||"",E=((P=r.delay_code)==null?void 0:P.code)||""):(g=b[ie.value],E=r[ie.value]),g===null?1:E===null?-1:(typeof g=="string"&&(g=g.toLowerCase(),E=E.toLowerCase()),g<E?ue.value==="asc"?-1:1:g>E?ue.value==="asc"?1:-1:0)}),n}),Ke=A(()=>(d.delay_codes||[]).filter(n=>!n.deleted_at));function Qe(n){ie.value===n?ue.value=ue.value==="asc"?"desc":"asc":(ie.value=n,ue.value="asc")}function Ne(n){if(!n)return"";const e=n.split("-");if(e.length!==3)return n;const[b,r,g]=e;return`${Number(r)}/${Number(g)}/${b}`}function Re(n){if(!n)return"—";switch(n){case"1_120":return"1-120 mins";case"121_600":return"121-600 mins";case"601_plus":return"601+ mins";case"1_60":return"1-60 mins";case"61_240":return"61-240 mins";case"241_600":return"241-600 mins";default:return n}}function Be(){const n=d.tenantSlug?route("ontime.index",{tenantSlug:d.tenantSlug}):route("ontime.index.admin");W.get(n,{...x.value,perPage:me.value,dateFilter:R.value})}function Xe(){x.value={search:"",delayCode:"",delayCategory:"",delayType:"",disputed:"",controllable:""},Be()}function Ze(){const n=d.tenantSlug?route("ontime.index",{tenantSlug:d.tenantSlug}):route("ontime.index.admin");W.get(n,{...x.value,perPage:me.value,dateFilter:R.value})}function Te(n){R.value=n;const e=d.tenantSlug?route("ontime.index",{tenantSlug:d.tenantSlug}):route("ontime.index.admin");W.get(e,{...x.value,perPage:me.value,dateFilter:n})}function Je(n){if(!n)return;const e=new URL(n),b=e.origin+e.pathname;W.get(b,{...x.value,perPage:me.value,dateFilter:R.value,page:e.searchParams.get("page")||1})}const Le=(n=null)=>{f.value=n,H.value=!0},et=n=>{le.value=n,G.value=!0},tt=n=>{const e=we({}),b=d.isSuperAdmin?"ontime.destroy.admin":"ontime.destroy",r=d.isSuperAdmin?{delay:n}:{tenantSlug:d.tenantSlug,delay:n};e.delete(route(b,r),{preserveScroll:!0,onSuccess:()=>{m.value="Delay record deleted successfully.",G.value=!1,le.value=null},onError:()=>{h.value="Failed to delete delay record."}})},lt=A(()=>fe.value.length>0&&B.value.length===fe.value.length);function st(n){n.target.checked?B.value=fe.value.map(e=>e.id):B.value=[]}function at(){B.value.length>0&&(ke.value=!0)}function nt(){const n=we({ids:B.value}),e=d.isSuperAdmin?"ontime.destroyBulk.admin":"ontime.destroyBulk",b=d.isSuperAdmin?{}:{tenantSlug:d.tenantSlug};n.delete(route(e,b),{preserveScroll:!0,onSuccess:()=>{m.value=`${B.value.length} delay records deleted successfully.`,B.value=[],ke.value=!1,W.reload()},onError:()=>{h.value="Failed to delete selected delays."}})}function ot(){var n,e;if((((n=d.delays)==null?void 0:n.data)||[]).length===0){h.value="No delay data found to export.";return}(e=ze.value)==null||e.submit()}const rt=A(()=>d.tenantSlug?route("ontime.export",{tenantSlug:d.tenantSlug}):route("ontime.export.admin")),dt=A(()=>"/storage/upload-data-temps/Delays Template.csv");function Ie(n){if(!n)return;if(!(n.type==="text/csv"||n.name.toLowerCase().endsWith(".csv")||n.type==="")){h.value="Please upload a valid CSV file.",setTimeout(()=>h.value="",4e3);return}ae.value=!0;const b=new FormData;b.append("file",n);const r=d.isSuperAdmin?route("ontime.validateImport.admin"):route("ontime.validateImport",{tenantSlug:d.tenantSlug});W.post(r,b,{forceFormData:!0,preserveScroll:!0,only:["flash"],onFinish:()=>{ae.value=!1},onError:()=>{ae.value=!1,h.value="Failed to validate CSV file"}})}function it(){var e;if(!$.value||$.value.header_error||(((e=$.value.summary)==null?void 0:e.invalid)??0)>0)return;ne.value=!0;const n=d.isSuperAdmin?route("ontime.confirmImport.admin"):route("ontime.confirmImport",{tenantSlug:d.tenantSlug});W.post(n,{},{preserveScroll:!0,onSuccess:()=>{var b;m.value=`Successfully imported ${((b=$.value.summary)==null?void 0:b.valid)??0} delays`,We()},onError:()=>{h.value="Failed to import delays"},onFinish:()=>{ne.value=!1}})}function ut(){const n=d.isSuperAdmin?route("ontime.downloadErrorReport.admin"):route("ontime.downloadErrorReport",{tenantSlug:d.tenantSlug});window.location.href=n}function We(){he.value=!1,$.value=null,ae.value=!1,ne.value=!1,p.value=!1,V=0,j.value&&(j.value.value="")}De(()=>{var n;return(n=k.props.flash)==null?void 0:n.importValidation},n=>{if(n){if(n.results){$.value=n.results,n.header_error&&($.value.header_error=n.header_error),he.value=!0;return}n.message&&(h.value=n.message)}},{immediate:!0});const mt=()=>{D.value=!0,de.value=!1,L.value=null},ft=()=>{se.value={code:"",description:""},L.value=null,de.value=!0},ct=n=>{se.value={code:n.code,description:n.description||""},L.value=n.id,de.value=!0},pt=()=>{de.value=!1,L.value=null},vt=n=>{Fe.value=n,Ce.value=!0},yt=n=>{n&&W.delete(route("delay_codes.destroy.admin",n),{onSuccess:()=>{Ce.value=!1,Fe.value=null,m.value="Delay code deleted successfully",W.reload({only:["delay_codes"]})},onError:()=>{h.value="Failed to delete delay code."}})},gt=()=>{const n=we({code:se.value.code,description:se.value.description}),e=L.value?d.isSuperAdmin?"delay_codes.update.admin":"delay_codes.update":d.isSuperAdmin?"delay_codes.store.admin":"delay_codes.store",b=L.value?d.isSuperAdmin?{id:L.value}:{tenantSlug:d.tenantSlug,id:L.value}:d.isSuperAdmin?{}:{tenantSlug:d.tenantSlug};(L.value?n.put:n.post).call(n,route(e,b),{onSuccess:()=>{m.value=L.value?"Delay code updated successfully.":"Delay code created successfully.",de.value=!1,L.value=null,W.reload({only:["delay_codes"]})},onError:()=>{h.value="Failed to save delay code."}})},xt=n=>{we({}).post(route(d.isSuperAdmin?"delay_codes.restore.admin":"delay_codes.restore",{id:n}),{onSuccess:()=>{m.value="Delay code restored successfully.",W.reload({only:["delay_codes"]})},onError:()=>{h.value="Failed to restore delay code."}})},bt=n=>{we({}).delete(route(d.isSuperAdmin?"delay_codes.forceDelete.admin":"delay_codes.forceDelete",{id:n}),{onSuccess:()=>{m.value="Delay code permanently deleted successfully.",W.reload({only:["delay_codes"]})},onError:()=>{h.value="Failed to permanently delete delay code."}})},_t=A(()=>{var b,r;if(!((b=d.delay_breakdown)!=null&&b.by_category))return null;const n=d.delay_breakdown.by_category,e=(r=d.filters)==null?void 0:r.delayType;return e?{moreThan601Count:n[`category_601_plus_${e}_count`]||"0",between1_60Count:n[`category_1_60_${e}_count`]||"0",between61_240Count:n[`category_61_240_${e}_count`]||"0",between241_600Count:n[`category_241_600_${e}_count`]||"0",totalDelays:n[`total_${e}_delays`]||"0",by_category:!0}:{between1_120Count:n.category_1_120_count||"0",between121_600Count:n.category_121_600_count||"0",moreThan601Count:n.category_601_plus_count||"0",between1_60Count:n.category_1_60_count||"0",between61_240Count:n.category_61_240_count||"0",between241_600Count:n.category_241_600_count||"0",totalDelays:n.total_delays||"0",by_category:!0}}),wt=A(()=>{var n,e,b,r,g,E,T,P;return((n=d.filters)==null?void 0:n.delayType)==="origin"?((b=(e=d.delay_breakdown)==null?void 0:e.bottom_five_drivers)==null?void 0:b.origin)||[]:((r=d.filters)==null?void 0:r.delayType)==="destination"?((E=(g=d.delay_breakdown)==null?void 0:g.bottom_five_drivers)==null?void 0:E.destination)||[]:((P=(T=d.delay_breakdown)==null?void 0:T.bottom_five_drivers)==null?void 0:P.total)||[]}),kt=A(()=>!d.line_chart_data||d.line_chart_data.length===0?{labels:[],datasets:[{label:"On-Time Performance",data:[],borderColor:"#3b82f6",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.3,fill:!1}]}:{labels:d.line_chart_data.map(n=>n.date),datasets:[{label:"On-Time Performance",data:d.line_chart_data.map(n=>n.onTimePerformance),borderColor:"#3b82f6",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.3,fill:!1}]});return De(m,n=>{n&&setTimeout(()=>m.value="",5e3)}),De(h,n=>{n&&setTimeout(()=>h.value="",5e3)}),(n,e)=>(o(),C(Ot,{breadcrumbs:te,tenantSlug:v.tenantSlug,permissions:d.permissions},{default:s(()=>{var b;return[l(a(At),{title:"On-Time"}),t("div",gl,[m.value?(o(),C(a(Oe),{key:0,variant:"success"},{default:s(()=>[l(a(Ee),null,{default:s(()=>e[33]||(e[33]=[i("Success")])),_:1}),l(a(Ue),null,{default:s(()=>[i(c(m.value),1)]),_:1})]),_:1})):y("",!0),h.value?(o(),C(a(Oe),{key:1,variant:"destructive"},{default:s(()=>[l(a(Ee),null,{default:s(()=>e[34]||(e[34]=[i("Error")])),_:1}),l(a(Ue),null,{default:s(()=>[i(c(h.value),1)]),_:1})]),_:1})):y("",!0),t("div",xl,[e[39]||(e[39]=t("h1",{class:"text-lg font-bold text-gray-800 dark:text-gray-200 md:text-xl lg:text-2xl"}," On-Time Management ",-1)),t("div",bl,[I.value.includes("delays.create")?(o(),C(_,{key:0,class:"px-2 py-0 md:px-4 md:py-2",onClick:e[0]||(e[0]=r=>Le()),variant:"default"},{default:s(()=>[l(N,{name:"plus",class:"mr-1 h-4 w-4 md:mr-2"}),e[35]||(e[35]=i(" Add Delay "))]),_:1})):y("",!0),B.value.length>0&&I.value.includes("delays.delete")?(o(),C(_,{key:1,class:"px-2 py-0 md:px-4 md:py-2",onClick:e[1]||(e[1]=r=>at()),variant:"destructive"},{default:s(()=>[l(N,{name:"trash",class:"mr-1 h-4 w-4 md:mr-2"}),i(" Delete Selected ("+c(B.value.length)+") ",1)]),_:1})):y("",!0),I.value.includes("delays.import")?(o(),C(_,{key:2,onClick:e[2]||(e[2]=r=>he.value=!0),variant:"secondary",class:"px-2 py-0 md:px-4 md:py-2 shadow-sm hover:shadow transition-all"},{default:s(()=>[l(N,{name:"upload",class:"mr-1 h-4 w-4 md:mr-2"}),e[36]||(e[36]=i(" Import CSV "))]),_:1})):y("",!0),I.value.includes("delays.export")?(o(),C(_,{key:3,class:"px-2 py-0 md:px-4 md:py-2",onClick:_e(ot,["prevent"]),variant:"outline"},{default:s(()=>[l(N,{name:"download",class:"mr-1 h-4 w-4 md:mr-2"}),e[37]||(e[37]=i(" Download CSV "))]),_:1})):y("",!0),v.isSuperAdmin?(o(),C(_,{key:4,class:"px-2 py-0 md:px-4 md:py-2",onClick:e[3]||(e[3]=r=>mt()),variant:"outline"},{default:s(()=>[l(N,{name:"settings",class:"mr-1 h-4 w-4 md:mr-2"}),e[38]||(e[38]=i(" Manage Delay Codes "))]),_:1})):y("",!0)])]),t("form",{ref_key:"exportForm",ref:ze,action:rt.value,method:"GET",class:"hidden"},null,8,_l),l(a(ce),null,{default:s(()=>[l(a(pe),{class:"p-2 md:p-4 lg:p-6"},{default:s(()=>[t("div",wl,[t("div",kl,[l(_,{onClick:e[4]||(e[4]=r=>Te("yesterday")),variant:"outline",size:"sm",class:J({"border-primary bg-primary/10 text-primary":R.value==="yesterday"})},{default:s(()=>e[40]||(e[40]=[i(" Yesterday ")])),_:1},8,["class"]),l(_,{onClick:e[5]||(e[5]=r=>Te("current-week")),variant:"outline",size:"sm",class:J({"border-primary bg-primary/10 text-primary":R.value==="current-week"})},{default:s(()=>e[41]||(e[41]=[i(" WTD ")])),_:1},8,["class"]),l(_,{onClick:e[6]||(e[6]=r=>Te("6w")),variant:"outline",size:"sm",class:J({"border-primary bg-primary/10 text-primary":R.value==="6w"})},{default:s(()=>e[42]||(e[42]=[i(" T6W ")])),_:1},8,["class"]),l(_,{onClick:e[7]||(e[7]=r=>Te("quarterly")),variant:"outline",size:"sm",class:J({"border-primary bg-primary/10 text-primary":R.value==="quarterly"})},{default:s(()=>e[43]||(e[43]=[i(" Quarterly ")])),_:1},8,["class"])]),v.dateRange?(o(),u("div",hl,[R.value==="yesterday"&&v.dateRange.start?(o(),u("span",Cl," Showing data from "+c(Ne(v.dateRange.start)),1)):v.dateRange.start&&v.dateRange.end?(o(),u("span",Dl," Showing data from "+c(Ne(v.dateRange.start))+" to "+c(Ne(v.dateRange.end)),1)):(o(),u("span",Sl,c(v.dateRange.label),1)),Pe.value?(o(),u("span",$l,"("+c(Pe.value)+")",1)):y("",!0)])):y("",!0)])]),_:1})]),_:1}),l(a(ce),null,{default:s(()=>[l(a(Mt),{class:"p-2 md:p-4 lg:p-6"},{default:s(()=>[t("div",Nl,[t("div",Tl,[l(a(jt),{class:"text-lg md:text-xl lg:text-2xl"},{default:s(()=>e[44]||(e[44]=[i("Filters")])),_:1}),!re.value&&He.value?(o(),u("div",Al,[x.value.search?(o(),u("div",Fl," Search: "+c(x.value.search),1)):y("",!0),x.value.delayCode?(o(),u("div",Vl," Code: "+c(Ge(x.value.delayCode)),1)):y("",!0),x.value.delayCategory?(o(),u("div",Ml," Category: "+c(Re(x.value.delayCategory)),1)):y("",!0),x.value.delayType?(o(),u("div",jl," Type: "+c(x.value.delayType==="origin"?"Origin":"Destination"),1)):y("",!0),x.value.disputed?(o(),u("div",Ol," Disputed: "+c(x.value.disputed==="true"?"Yes":"No"),1)):y("",!0),x.value.controllable?(o(),u("div",El," Driver Controllable: "+c(x.value.controllable==="true"?"Yes":x.value.controllable==="false"?"No":"N/A"),1)):y("",!0)])):y("",!0)]),l(_,{variant:"ghost",size:"sm",onClick:e[8]||(e[8]=r=>re.value=!re.value)},{default:s(()=>[i(c(re.value?"Hide Filters":"Show Filters")+" ",1),l(N,{name:re.value?"chevron-up":"chevron-down",class:"ml-2 h-4 w-4"},null,8,["name"])]),_:1})])]),_:1}),re.value?(o(),C(a(pe),{key:0,class:"p-2 md:p-4 lg:p-6"},{default:s(()=>[t("div",Ul,[t("div",zl,[t("div",null,[l(a(O),{for:"search"},{default:s(()=>e[45]||(e[45]=[i("Search")])),_:1}),l(a(Se),{class:"h-9 px-1 py-1 md:px-2 md:py-1 lg:h-10 lg:px-3 lg:py-2",id:"search",modelValue:x.value.search,"onUpdate:modelValue":e[9]||(e[9]=r=>x.value.search=r),type:"text",placeholder:"Search by driver..."},null,8,["modelValue"])]),t("div",null,[l(a(O),{for:"delayCode"},{default:s(()=>e[46]||(e[46]=[i("Delay Code")])),_:1}),Y(t("select",{id:"delayCode","onUpdate:modelValue":e[10]||(e[10]=r=>x.value.delayCode=r),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},[e[47]||(e[47]=t("option",{value:""},"All Codes",-1)),(o(!0),u(w,null,U(v.delay_codes,r=>(o(),u("option",{key:r.id,value:r.id},c(r.code),9,Pl))),128))],512),[[K,x.value.delayCode]])]),t("div",null,[l(a(O),{for:"delayCategory"},{default:s(()=>e[48]||(e[48]=[i("Delay Category")])),_:1}),Y(t("select",{id:"delayCategory","onUpdate:modelValue":e[11]||(e[11]=r=>x.value.delayCategory=r),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},e[49]||(e[49]=[t("option",{value:""},"All Categories",-1),t("option",{value:"1_60"},"1-60 mins",-1),t("option",{value:"61_240"},"61-240 mins",-1),t("option",{value:"241_600"},"241-600 mins",-1),t("option",{value:"601_plus"},"601+ mins",-1)]),512),[[K,x.value.delayCategory]])]),t("div",null,[l(a(O),{for:"delayType"},{default:s(()=>e[50]||(e[50]=[i("Delay Type")])),_:1}),Y(t("select",{id:"delayType","onUpdate:modelValue":e[12]||(e[12]=r=>x.value.delayType=r),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},e[51]||(e[51]=[t("option",{value:""},"All Types",-1),t("option",{value:"origin"},"Origin",-1),t("option",{value:"destination"},"Destination",-1)]),512),[[K,x.value.delayType]])]),t("div",null,[l(a(O),{for:"disputed"},{default:s(()=>e[52]||(e[52]=[i("Disputed Status")])),_:1}),Y(t("select",{id:"disputed","onUpdate:modelValue":e[13]||(e[13]=r=>x.value.disputed=r),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},e[53]||(e[53]=[t("option",{value:""},"All",-1),t("option",{value:"true"},"Disputed",-1),t("option",{value:"false"},"Not Disputed",-1)]),512),[[K,x.value.disputed]])]),t("div",null,[l(a(O),{for:"controllable"},{default:s(()=>e[54]||(e[54]=[i("Driver Controllable")])),_:1}),Y(t("select",{id:"controllable","onUpdate:modelValue":e[14]||(e[14]=r=>x.value.controllable=r),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},e[55]||(e[55]=[t("option",{value:""},"All",-1),t("option",{value:"true"},"Yes",-1),t("option",{value:"false"},"No",-1),t("option",{value:"NA"},"N/A",-1)]),512),[[K,x.value.controllable]])])]),t("div",Rl,[l(_,{onClick:Xe,variant:"ghost",size:"sm"},{default:s(()=>[l(N,{name:"rotate_ccw",class:"mr-2 h-4 w-4"}),e[56]||(e[56]=i(" Reset Filters "))]),_:1}),l(_,{onClick:Be,variant:"default",size:"sm"},{default:s(()=>[l(N,{name:"filter",class:"mr-2 h-4 w-4"}),e[57]||(e[57]=i(" Apply Filters "))]),_:1})])])]),_:1})):y("",!0)]),_:1}),v.isSuperAdmin?y("",!0):(o(),C(yl,{key:2,metricsData:_t.value,driversData:wt.value,chartData:kt.value,averageOntime:v.average_ontime,currentDateFilter:(b=d.dateRange)==null?void 0:b.label,delayType:x.value.delayType},null,8,["metricsData","driversData","chartData","averageOntime","currentDateFilter","delayType"])),l(a(ce),{class:"mx-auto max-w-[95vw] overflow-x-auto md:max-w-[64vw] lg:max-w-full"},{default:s(()=>[l(a(pe),{class:"p-0"},{default:s(()=>[t("div",Bl,[l(a(Ve),{class:"relative h-[500px] overflow-auto"},{default:s(()=>[l(a(Me),null,{default:s(()=>[l(a(oe),{class:"sticky top-0 z-10 border-b bg-background hover:bg-background"},{default:s(()=>[I.value.includes("delays.delete")?(o(),C(a(Z),{key:0,class:"w-[50px]"},{default:s(()=>[t("div",Ll,[t("input",{type:"checkbox",onChange:st,checked:lt.value,class:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"},null,40,Il)])]),_:1})):y("",!0),v.isSuperAdmin?(o(),C(a(Z),{key:1},{default:s(()=>e[58]||(e[58]=[i("Company Name")])),_:1})):y("",!0),(o(),u(w,null,U($e,r=>l(a(Z),{key:r,class:"cursor-pointer",onClick:g=>Qe(r)},{default:s(()=>[t("div",Wl,[r==="delay_category"?(o(),u(w,{key:0},[i(" Delay ")],64)):(o(),u(w,{key:1},[i(c(r.replace(/_/g," ").split(" ").map(g=>g.charAt(0).toUpperCase()+g.slice(1)).join(" ")),1)],64)),ie.value===r?(o(),u("div",Yl,[ue.value==="asc"?(o(),u("svg",ql,e[59]||(e[59]=[t("path",{d:"M8 15l4-4 4 4"},null,-1)]))):(o(),u("svg",Hl,e[60]||(e[60]=[t("path",{d:"M16 9l-4 4-4-4"},null,-1)])))])):(o(),u("div",Gl,e[61]||(e[61]=[t("svg",{class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M8 10l4-4 4 4"}),t("path",{d:"M16 14l-4 4-4-4"})],-1)])))])]),_:2},1032,["onClick"])),64)),I.value.includes("delays.delete")||I.value.includes("delays.update")?(o(),C(a(Z),{key:2,class:"text-right"},{default:s(()=>e[62]||(e[62]=[i("Actions")])),_:1})):y("",!0)]),_:1})]),_:1}),l(a(je),null,{default:s(()=>[fe.value.length===0?(o(),C(a(oe),{key:0},{default:s(()=>[l(a(Q),{colspan:v.isSuperAdmin?$e.length+2:$e.length+1,class:"py-8 text-center text-primary font-medium"},{default:s(()=>e[63]||(e[63]=[i(" No delays found matching your criteria ")])),_:1},8,["colspan"])]),_:1})):y("",!0),(o(!0),u(w,null,U(fe.value,r=>(o(),C(a(oe),{key:r.id,class:"hover:bg-muted/50"},{default:s(()=>[I.value.includes("delays.delete")?(o(),C(a(Q),{key:0,class:"text-center"},{default:s(()=>[Y(t("input",{type:"checkbox",value:r.id,"onUpdate:modelValue":e[15]||(e[15]=g=>B.value=g),class:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"},null,8,Kl),[[Nt,B.value]])]),_:2},1024)):y("",!0),v.isSuperAdmin?(o(),C(a(Q),{key:1},{default:s(()=>{var g;return[i(c(((g=r.tenant)==null?void 0:g.name)||"—"),1)]}),_:2},1024)):y("",!0),(o(),u(w,null,U($e,g=>l(a(Q),{key:g,class:"whitespace-nowrap"},{default:s(()=>{var E,T;return[g==="date"?(o(),u(w,{key:0},[i(c(Ne(r[g])),1)],64)):g==="disputed"?(o(),u(w,{key:1},[i(c(r[g]?"Yes":"No"),1)],64)):g==="driver_controllable"?(o(),u(w,{key:2},[i(c(r[g]===null?"N/A":r[g]?"Yes":"No"),1)],64)):g==="delay_code"?(o(),u(w,{key:3},[i(c(((E=r.delay_code)==null?void 0:E.code)||"—")+" ",1),(T=r.delay_code)!=null&&T.deleted_at?(o(),u("span",Ql,"(Deleted Code)")):y("",!0)],64)):g==="delay_category"?(o(),u(w,{key:4},[i(c(Re(r.delay_category)),1)],64)):(o(),u(w,{key:5},[i(c(r[g]),1)],64))]}),_:2},1024)),64)),I.value.includes("delays.update")||I.value.includes("delays.delete")?(o(),C(a(Q),{key:2,class:"text-right"},{default:s(()=>[t("div",Xl,[I.value.includes("delays.update")?(o(),C(_,{key:0,onClick:g=>Le(r),variant:"warning",size:"sm"},{default:s(()=>[l(N,{name:"pencil",class:"mr-1 h-4 w-4"}),e[64]||(e[64]=i(" Edit "))]),_:2},1032,["onClick"])):y("",!0),I.value.includes("delays.delete")?(o(),C(_,{key:1,onClick:g=>et(r.id),variant:"destructive",size:"sm"},{default:s(()=>[l(N,{name:"trash",class:"mr-1 h-4 w-4"}),e[65]||(e[65]=i(" Delete "))]),_:2},1032,["onClick"])):y("",!0)])]),_:2},1024)):y("",!0)]),_:2},1024))),128))]),_:1})]),_:1})]),v.delays.links?(o(),u("div",Zl,[t("div",Jl,[t("div",es," Showing "+c(fe.value.length)+" of "+c(v.delays.data.length)+" entries ",1),t("div",ts,[t("div",ls,[l(a(O),{for:"perPage",class:"text-sm"},{default:s(()=>e[66]||(e[66]=[i("Per page:")])),_:1}),Y(t("select",{id:"perPage","onUpdate:modelValue":e[16]||(e[16]=r=>me.value=r),onChange:Ze,class:"h-8 rounded-md border border-input bg-background px-2 py-1 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"},e[67]||(e[67]=[t("option",{value:"10"},"10",-1),t("option",{value:"25"},"25",-1),t("option",{value:"50"},"50",-1),t("option",{value:"100"},"100",-1)]),544),[[K,me.value]])]),t("div",ss,[(o(!0),u(w,null,U(v.delays.links,r=>(o(),C(_,{key:r.label,onClick:g=>Je(r.url),disabled:!r.url,variant:"ghost",size:"sm",class:J(["mx-1",{"border-primary bg-primary/10 text-primary":r.active}])},{default:s(()=>[t("span",{innerHTML:r.label},null,8,as)]),_:2},1032,["onClick","disabled","class"]))),128))])])])])):y("",!0)]),_:1})]),_:1}),l(a(ve),{open:H.value,"onUpdate:open":e[18]||(e[18]=r=>H.value=r)},{default:s(()=>[l(a(ye),{class:"max-w-[95vw] sm:max-w-[90vw] md:max-w-4xl"},{default:s(()=>[l(a(xe),{class:"px-4 sm:px-6"},{default:s(()=>[l(a(be),{class:"text-lg sm:text-xl"},{default:s(()=>[i(c(f.value?"Edit":"Add")+" Delay",1)]),_:1}),l(a(ge),{class:"text-xs sm:text-sm"},{default:s(()=>[i(" Fill in the details to "+c(f.value?"update":"create")+" a delay record. ",1)]),_:1})]),_:1}),l(Gt,{delay:f.value,"delay-codes":Ke.value,tenants:v.tenants,"is-super-admin":v.isSuperAdmin,"tenant-slug":v.tenantSlug,onClose:e[17]||(e[17]=r=>H.value=!1),class:"max-h-[75vh] overflow-y-auto p-4 sm:p-6"},null,8,["delay","delay-codes","tenants","is-super-admin","tenant-slug"])]),_:1})]),_:1},8,["open"]),l(a(ve),{open:D.value,"onUpdate:open":e[22]||(e[22]=r=>D.value=r)},{default:s(()=>[l(a(ye),{class:"max-w-[95vw] sm:max-w-[90vw] md:max-w-2xl"},{default:s(()=>[l(a(xe),{class:"px-4 sm:px-6"},{default:s(()=>[l(a(be),{class:"text-lg sm:text-xl"},{default:s(()=>e[68]||(e[68]=[i("Manage Delay Codes")])),_:1}),l(a(ge),{class:"text-xs sm:text-sm"},{default:s(()=>e[69]||(e[69]=[i(" Create and manage delay codes for your organization. ")])),_:1})]),_:1}),t("div",ns,[t("div",os,[e[71]||(e[71]=t("h3",{class:"text-sm font-medium sm:text-base"},"Current Delay Codes",-1)),l(_,{onClick:ft,size:"sm",variant:"outline",class:"h-8 px-3 text-xs sm:h-9 sm:px-4 sm:text-sm"},{default:s(()=>[l(N,{name:"plus",class:"mr-1 h-3 w-3 sm:h-3.5 sm:w-3.5"}),e[70]||(e[70]=i(" Add New Code "))]),_:1})]),t("div",rs,[!v.delay_codes||v.delay_codes.length===0?(o(),u("div",ds," No delay codes found ")):(o(),u("div",is,[(o(!0),u(w,null,U(v.delay_codes,r=>(o(),u("div",{key:r.id,class:"group flex items-center justify-between p-3 hover:bg-muted/50"},[t("div",{class:"flex-1 cursor-pointer",onClick:g=>ct(r)},[t("div",ms,[i(c(r.code)+" ",1),r.deleted_at?(o(),u("span",fs,"(Deleted)")):y("",!0)]),r.description?(o(),u("div",cs,c(r.description),1)):y("",!0)],8,us),t("div",ps,[v.isSuperAdmin?(o(),u(w,{key:0},[r.deleted_at?(o(),u(w,{key:0},[l(_,{onClick:g=>xt(r.id),size:"sm",variant:"outline",class:"h-8 px-2 text-xs sm:h-9 sm:px-3 sm:text-sm"},{default:s(()=>[l(N,{name:"refresh",class:"mr-1 h-3 w-3 sm:h-3 sm:w-3"}),e[72]||(e[72]=i(" Restore "))]),_:2},1032,["onClick"]),l(_,{onClick:g=>bt(r.id),size:"sm",variant:"destructive",class:"h-8 px-2 text-xs sm:h-9 sm:px-3 sm:text-sm"},{default:s(()=>[l(N,{name:"trash",class:"mr-1 h-3 w-3 sm:h-3 sm:w-3"}),e[73]||(e[73]=i(" Delete "))]),_:2},1032,["onClick"])],64)):(o(),C(_,{key:1,onClick:g=>vt(r.id),size:"sm",variant:"destructive",class:"h-8 px-2 text-xs sm:h-9 sm:px-3 sm:text-sm"},{default:s(()=>[l(N,{name:"trash",class:"mr-1 h-3 w-3 sm:h-3 sm:w-3"}),e[74]||(e[74]=i(" Delete "))]),_:2},1032,["onClick"]))],64)):y("",!0)])]))),128))]))]),de.value?(o(),u("div",vs,[t("h3",ys,c(L.value?"Edit":"Add")+" Delay Code ",1),t("div",gs,[t("div",null,[l(a(O),{for:"code",class:"text-xs sm:text-sm"},{default:s(()=>e[75]||(e[75]=[i("Code")])),_:1}),l(a(Se),{id:"code",modelValue:se.value.code,"onUpdate:modelValue":e[19]||(e[19]=r=>se.value.code=r),placeholder:"Enter code",class:"h-9 text-xs sm:h-10 sm:text-sm"},null,8,["modelValue"])]),t("div",null,[l(a(O),{for:"description",class:"text-xs sm:text-sm"},{default:s(()=>e[76]||(e[76]=[i("Description")])),_:1}),l(a(Se),{id:"description",modelValue:se.value.description,"onUpdate:modelValue":e[20]||(e[20]=r=>se.value.description=r),placeholder:"Enter description",class:"h-9 text-xs sm:h-10 sm:text-sm"},null,8,["modelValue"])]),t("div",xs,[l(_,{onClick:pt,variant:"ghost",size:"sm",class:"h-8 px-3 text-xs sm:h-9 sm:px-4 sm:text-sm"},{default:s(()=>e[77]||(e[77]=[i("Cancel")])),_:1}),l(_,{onClick:gt,variant:"default",size:"sm",class:"h-8 px-3 text-xs sm:h-9 sm:px-4 sm:text-sm"},{default:s(()=>e[78]||(e[78]=[i("Save")])),_:1})])])])):y("",!0)]),l(a(Ae),{class:"px-4 sm:px-6"},{default:s(()=>[l(_,{onClick:e[21]||(e[21]=r=>D.value=!1),variant:"outline",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:s(()=>e[79]||(e[79]=[i("Close")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),l(a(ve),{open:Ce.value,"onUpdate:open":e[25]||(e[25]=r=>Ce.value=r)},{default:s(()=>[l(a(ye),{class:"max-w-[95vw] sm:max-w-md"},{default:s(()=>[l(a(xe),{class:"px-4 sm:px-6"},{default:s(()=>[l(a(be),{class:"text-lg sm:text-xl"},{default:s(()=>e[80]||(e[80]=[i("Confirm Deletion")])),_:1}),l(a(ge),{class:"text-xs sm:text-sm"},{default:s(()=>e[81]||(e[81]=[i(" Are you sure you want to delete this delay code? This action cannot be undone. ")])),_:1})]),_:1}),l(a(Ae),{class:"px-4 sm:px-6"},{default:s(()=>[l(_,{type:"button",onClick:e[23]||(e[23]=r=>Ce.value=!1),variant:"outline",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:s(()=>e[82]||(e[82]=[i(" Cancel ")])),_:1}),l(_,{type:"button",onClick:e[24]||(e[24]=r=>yt(Fe.value)),variant:"destructive",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:s(()=>e[83]||(e[83]=[i(" Delete ")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),l(a(ve),{open:G.value,"onUpdate:open":e[28]||(e[28]=r=>G.value=r)},{default:s(()=>[l(a(ye),{class:"max-w-[95vw] sm:max-w-md"},{default:s(()=>[l(a(xe),{class:"px-4 sm:px-6"},{default:s(()=>[l(a(be),{class:"text-lg sm:text-xl"},{default:s(()=>e[84]||(e[84]=[i("Confirm Deletion")])),_:1}),l(a(ge),{class:"text-xs sm:text-sm"},{default:s(()=>e[85]||(e[85]=[i(" Are you sure you want to delete this delay record? This action cannot be undone. ")])),_:1})]),_:1}),l(a(Ae),{class:"px-4 sm:px-6"},{default:s(()=>[l(_,{type:"button",onClick:e[26]||(e[26]=r=>G.value=!1),variant:"outline",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:s(()=>e[86]||(e[86]=[i(" Cancel ")])),_:1}),l(_,{type:"button",onClick:e[27]||(e[27]=r=>tt(le.value)),variant:"destructive",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:s(()=>e[87]||(e[87]=[i(" Delete ")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),l(a(ve),{open:ke.value,"onUpdate:open":e[31]||(e[31]=r=>ke.value=r)},{default:s(()=>[l(a(ye),{class:"max-w-[95vw] sm:max-w-md"},{default:s(()=>[l(a(xe),{class:"px-4 sm:px-6"},{default:s(()=>[l(a(be),{class:"text-lg sm:text-xl"},{default:s(()=>e[88]||(e[88]=[i("Confirm Bulk Deletion")])),_:1}),l(a(ge),{class:"text-xs sm:text-sm"},{default:s(()=>[i(" Are you sure you want to delete "+c(B.value.length)+" delay records? This action cannot be undone. ",1)]),_:1})]),_:1}),l(a(Ae),{class:"px-4 sm:px-6"},{default:s(()=>[l(_,{type:"button",onClick:e[29]||(e[29]=r=>ke.value=!1),variant:"outline",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:s(()=>e[89]||(e[89]=[i(" Cancel ")])),_:1}),l(_,{type:"button",onClick:e[30]||(e[30]=r=>nt()),variant:"destructive",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:s(()=>e[90]||(e[90]=[i(" Delete Selected ")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"])]),l(a(ve),{open:he.value,"onUpdate:open":e[32]||(e[32]=r=>he.value=r)},{default:s(()=>[l(a(ye),{class:"max-w-[95vw] sm:max-w-[90vw] md:max-w-5xl max-h-[90vh] overflow-hidden flex flex-col"},{default:s(()=>{var r,g,E;return[l(a(xe),{class:"px-4 sm:px-6 border-b pb-3"},{default:s(()=>[t("div",bs,[l(N,{name:"upload",class:"h-5 w-5 text-primary"}),l(a(be),{class:"text-lg sm:text-xl font-semibold"},{default:s(()=>e[91]||(e[91]=[i(" Import Delays ")])),_:1})]),l(a(ge),{class:"text-xs sm:text-sm mt-1 text-muted-foreground"},{default:s(()=>e[92]||(e[92]=[i(" Upload a CSV file to import delays. The file will be validated before import. ")])),_:1})]),_:1}),t("div",_s,[$.value?(o(),u("div",Ts,[(r=$.value.headers)!=null&&r.length?(o(),u("div",As,[t("div",Fs,[e[97]||(e[97]=t("div",{class:"text-sm font-semibold"},"CSV Headers",-1)),t("div",Vs,c($.value.headers.length)+" columns ",1)]),t("div",Ms,[(o(!0),u(w,null,U($.value.headers,T=>(o(),u("span",{key:T,class:"rounded-full bg-muted px-2 py-0.5 text-xs"},c(T),1))),128))])])):y("",!0),t("div",js,[l(a(ce),{class:"border-2"},{default:s(()=>[l(a(pe),{class:"p-4 text-center"},{default:s(()=>[t("div",Os,c($.value.summary.total),1),e[98]||(e[98]=t("div",{class:"text-sm text-muted-foreground"},"Total Rows",-1))]),_:1})]),_:1}),l(a(ce),{class:"border-2 border-green-500/50 bg-green-50 dark:bg-green-900/10"},{default:s(()=>[l(a(pe),{class:"p-4 text-center"},{default:s(()=>[t("div",Es,c($.value.summary.valid),1),e[99]||(e[99]=t("div",{class:"text-sm text-muted-foreground"},"Valid",-1))]),_:1})]),_:1}),l(a(ce),{class:"border-2 border-red-500/50 bg-red-50 dark:bg-red-900/10"},{default:s(()=>[l(a(pe),{class:"p-4 text-center"},{default:s(()=>[t("div",Us,c($.value.summary.invalid),1),e[100]||(e[100]=t("div",{class:"text-sm text-muted-foreground"},"Invalid",-1))]),_:1})]),_:1})]),$.value.header_error?(o(),C(a(Oe),{key:1,variant:"destructive"},{default:s(()=>[l(a(Ee),{class:"flex items-center gap-2"},{default:s(()=>[l(N,{name:"alert_circle",class:"h-5 w-5"}),e[101]||(e[101]=i(" Header Error "))]),_:1}),l(a(Ue),null,{default:s(()=>[i(c($.value.header_error),1)]),_:1})]),_:1})):y("",!0),(g=$.value.invalid)!=null&&g.length?(o(),u("div",zs,[t("div",Ps,[t("h3",Rs,[l(N,{name:"alert-triangle",class:"h-5 w-5"}),i(" Validation Errors ("+c($.value.invalid.length)+") ",1)]),l(_,{onClick:ut,variant:"outline",size:"sm",class:"flex items-center gap-2"},{default:s(()=>[l(N,{name:"download",class:"h-4 w-4"}),e[102]||(e[102]=i(" Download Error Report "))]),_:1})]),t("div",Bs,[t("div",Ls,[l(a(Ve),null,{default:s(()=>[l(a(Me),{class:"sticky top-0 bg-background"},{default:s(()=>[l(a(oe),null,{default:s(()=>[l(a(Z),{class:"w-20"},{default:s(()=>e[103]||(e[103]=[i("Row #")])),_:1}),l(a(Z),null,{default:s(()=>e[104]||(e[104]=[i("Preview")])),_:1}),l(a(Z),null,{default:s(()=>e[105]||(e[105]=[i("Errors")])),_:1})]),_:1})]),_:1}),l(a(je),null,{default:s(()=>[(o(!0),u(w,null,U($.value.invalid,T=>(o(),C(a(oe),{key:T.rowNumber,class:"hover:bg-muted/50"},{default:s(()=>[l(a(Q),{class:"font-medium"},{default:s(()=>[i(c(T.rowNumber),1)]),_:2},1024),l(a(Q),{class:"text-sm text-muted-foreground"},{default:s(()=>{var P;return[t("div",Is,[(o(!0),u(w,null,U(T.preview||[],X=>(o(),u("span",{key:X.key,class:"whitespace-nowrap"},[t("span",Ws,c(X.label)+":",1),i(" "+c(X.value),1)]))),128)),(P=T.preview)!=null&&P.length?y("",!0):(o(),u("span",Ys,"—"))])]}),_:2},1024),l(a(Q),null,{default:s(()=>{var P;return[t("div",qs,[(o(!0),u(w,null,U(T.errors||[],(X,ht)=>(o(),u("div",{key:ht,class:"text-xs text-red-600 flex items-start gap-1"},[l(N,{name:"x-circle",class:"h-3 w-3 mt-0.5 flex-shrink-0"}),t("span",null,c(X),1)]))),128)),(P=T.errors)!=null&&P.length?y("",!0):(o(),u("div",Hs," — "))])]}),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])])])):y("",!0),(E=$.value.valid)!=null&&E.length?(o(),u("div",Gs,[t("h3",Ks,[l(N,{name:"check-circle",class:"h-5 w-5"}),i(" Valid Rows ("+c($.value.valid.length)+") ",1)]),e[108]||(e[108]=t("div",{class:"text-sm text-muted-foreground mb-2"}," Showing first 5 valid rows ",-1)),t("div",Qs,[l(a(Ve),null,{default:s(()=>[l(a(Me),null,{default:s(()=>[l(a(oe),null,{default:s(()=>[l(a(Z),null,{default:s(()=>e[106]||(e[106]=[i("Row #")])),_:1}),l(a(Z),null,{default:s(()=>e[107]||(e[107]=[i("Preview")])),_:1})]),_:1})]),_:1}),l(a(je),null,{default:s(()=>[(o(!0),u(w,null,U($.value.valid.slice(0,5),T=>(o(),C(a(oe),{key:T.rowNumber},{default:s(()=>[l(a(Q),{class:"font-medium"},{default:s(()=>[i(c(T.rowNumber),1)]),_:2},1024),l(a(Q),{class:"text-sm"},{default:s(()=>{var P;return[t("div",Xs,[(o(!0),u(w,null,U(T.preview||[],X=>(o(),u("span",{key:X.key,class:"whitespace-nowrap"},[t("span",Zs,c(X.label)+":",1),i(" "+c(X.value),1)]))),128)),(P=T.preview)!=null&&P.length?y("",!0):(o(),u("span",Js,"—"))])]}),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])])):y("",!0)])):(o(),u("div",ws,[t("div",ks,[t("div",{class:J(["flex flex-col items-center justify-center border-2 border-dashed rounded-lg p-8 bg-muted/20 transition-colors",{"border-primary bg-primary/5":p.value,"opacity-60 pointer-events-none":ae.value}]),onDragenter:_e(F,["prevent"]),onDragover:_e(z,["prevent"]),onDragleave:_e(q,["prevent"]),onDrop:_e(M,["prevent"])},[l(N,{name:"file-spreadsheet",class:"h-12 w-12 text-muted-foreground mb-3"}),e[94]||(e[94]=t("div",{class:"text-center"},[t("div",{class:"text-sm font-medium"},[t("span",{class:"text-primary"},"Drag & drop"),i(" your CSV here ")]),t("p",{class:"text-xs text-muted-foreground mt-1"},"or")],-1)),t("label",hs,[e[93]||(e[93]=t("span",{class:"text-sm font-medium text-primary hover:underline"}," Choose CSV file ",-1)),t("input",{ref_key:"importFileInput",ref:j,type:"file",class:"hidden",onChange:ee,accept:".csv,text/csv",disabled:ae.value},null,40,Cs)]),e[95]||(e[95]=t("p",{class:"text-xs text-muted-foreground mt-2"},"CSV only",-1)),p.value?(o(),u("div",Ds," Drop file to validate ")):y("",!0)],34),t("div",Ss,[l(N,{name:"info",class:"h-4 w-4"}),t("a",{href:dt.value,download:"",class:"text-primary hover:underline"}," Download CSV Template ",8,$s)]),ae.value?(o(),u("div",Ns,e[96]||(e[96]=[t("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"},null,-1),t("span",{class:"text-sm text-muted-foreground"},"Validating CSV file...",-1)]))):y("",!0)])]))]),t("div",ea,[l(_,{onClick:We,variant:"outline",disabled:ne.value},{default:s(()=>e[109]||(e[109]=[i(" Close ")])),_:1},8,["disabled"]),$.value&&$.value.summary.valid>0?(o(),C(_,{key:0,onClick:it,variant:"default",disabled:ne.value||$.value.summary.invalid>0||!!$.value.header_error,class:"flex items-center gap-2"},{default:s(()=>[ne.value?(o(),u("div",ta)):(o(),C(N,{key:1,name:"check",class:"h-4 w-4"})),i(" "+c(ne.value?"Importing...":`Import ${$.value.summary.valid} Rows`),1)]),_:1},8,["disabled"])):y("",!0)])]}),_:1})]),_:1},8,["open"])]}),_:1},8,["tenantSlug","permissions"]))}};export{Na as default};
