import{g as Y,W as Z}from"./vendor-vue-BsCVk3W_.js";import{_ as X}from"./AppLayout.vue_vue_type_script_setup_true_lang-wR8_mEPh.js";import{_ as k}from"./Icon.vue_vue_type_script_setup_true_lang-Cf3euL4G.js";import{_ as F}from"./Badge.vue_vue_type_script_setup_true_lang-MdQcxSLl.js";import{d as V,c as R,F as S,e as m,X as e,U as o,aj as P,r as A,E as O,H as E,O as I,z as i,f as d,S as b,u as c,i as J,w as K,b as $,C as ee,Y as te,y as ae}from"./vendor--q1ey8Ib.js";import{_ as se,a as re,b as Q,c as L,d as ne,e as z}from"./TableRow.vue_vue_type_script_setup_true_lang-CyEhCbZI.js";import{_ as U}from"./Button.vue_vue_type_script_setup_true_lang-CURKxeic.js";import{_ as oe}from"./Card.vue_vue_type_script_setup_true_lang-D6lnctxv.js";import{_ as ie}from"./CardHeader.vue_vue_type_script_setup_true_lang-D36Fjuw_.js";import{_ as le}from"./CardTitle.vue_vue_type_script_setup_true_lang-C7T0BrR7.js";import{_ as ce}from"./CardContent.vue_vue_type_script_setup_true_lang-Bg8Ud8NP.js";import{_ as de}from"./Input.vue_vue_type_script_setup_true_lang-D2siHqHg.js";import{c as ue}from"./utils-tTsIgFyK.js";import"./vendor-axios-xsH4HHeE.js";import"./vendor-ui-VCcvGdtT.js";import"./useInitials-DzeGKvtI.js";import"./app-CDLfz5Ol.js";import"./vendor-icons-Cd5utPp1.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-Dc8NxSZT.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const me={class:"mb-6"},fe=V({__name:"DashboardHeader",props:{operationalExcellenceScore:{type:String,default:"Not Available"}},setup(a){const f=a,u=R(()=>{switch(f.operationalExcellenceScore){case"Fantastic +":return"text-green-600";case"Fantastic":return"text-emerald-600";case"Good":return"text-blue-600";case"Fair":return"text-amber-600";case"Poor":return"text-red-600";default:return"text-gray-600"}});return(y,p)=>(m(),S("div",me,[e("h2",{class:P(["text-4xl font-bold tracking-tight",[u.value,"transition-colors duration-300"]])},o(a.operationalExcellenceScore),3)]))}}),ve={class:"mb-6"},ge={class:"border-b"},pe={class:"flex -mb-px space-x-8"},xe=["onClick"],be={key:0,class:"mt-2 text-sm text-muted-foreground"},ye={key:0,class:"ml-1"},we=V({__name:"TimePeriodTabs",props:{dateRangeText:{type:String,default:""},weekNumber:{type:Number,default:null},startWeekNumber:{type:Number,default:null},endWeekNumber:{type:Number,default:null},year:{type:Number,default:null},activeTabId:{type:String,default:"yesterday"}},emits:["tab-change"],setup(a,{emit:f}){const u=a,y=[{id:"yesterday",label:"Yesterday"},{id:"current-week",label:"WTD"},{id:"t6w",label:"T6W Scores"},{id:"quarterly",label:"Quarterly Scores"}],p=A(u.activeTabId),_=f,v=R(()=>(p.value==="yesterday"||p.value==="current-week")&&u.weekNumber&&u.year?`Week ${u.weekNumber}, ${u.year}`:(p.value==="t6w"||p.value==="quarterly")&&u.startWeekNumber&&u.endWeekNumber&&u.year?`Weeks ${u.startWeekNumber}-${u.endWeekNumber}, ${u.year}`:""),x=T=>{p.value=T,_("tab-change",T)};return(T,w)=>(m(),S("div",ve,[e("div",ge,[e("div",pe,[(m(),S(E,null,I(y,N=>e("button",{key:N.id,onClick:D=>x(N.id),class:P(["py-2 px-1 border-b-2 text-sm font-medium transition-colors",p.value===N.id?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground hover:border-muted-foreground"])},o(N.label),11,xe)),64))])]),a.dateRangeText?(m(),S("div",be,[e("span",null,o(a.dateRangeText),1),v.value?(m(),S("span",ye,"("+o(v.value)+")",1)):O("",!0)])):O("",!0)]))}}),_e={class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6 mb-6"},he={class:"bg-card rounded-lg border shadow-sm p-4"},De={class:"flex items-center justify-between gap-3 mb-4"},ke={class:"space-y-2 text-sm max-h-40 overflow-y-auto"},$e={class:"bg-card rounded-lg border shadow-sm p-4"},Se={class:"flex items-center justify-between gap-3 mb-4"},Ne={class:"space-y-2 text-sm max-h-40 overflow-y-auto"},je={class:"bg-card rounded-lg border shadow-sm p-4"},Re={class:"flex items-center justify-between gap-3 mb-4"},Ce={class:"text-sm mb-2 space-y-2"},Te={class:"flex justify-between"},Be={class:"flex justify-between"},Fe={class:"flex justify-between"},Me={class:"flex justify-between"},Pe={class:"bg-card rounded-lg border shadow-sm p-4"},Ae={class:"flex items-center justify-between gap-3 mb-4"},Oe={class:"space-y-2 text-sm"},Ve={class:"flex justify-between items-center"},We={class:"flex items-center gap-2"},ze={class:"w-12 text-right"},Ee={class:"w-16 text-right"},Ie={class:"flex justify-between items-center"},Ge={class:"flex items-center gap-2"},qe={class:"w-12 text-right"},Le={class:"w-16 text-right"},Ue={class:"flex justify-between items-center"},He={class:"flex items-center gap-2"},Ke={class:"w-12 text-right"},Qe={class:"w-16 text-right"},Ye={class:"flex justify-between items-center"},Ze={class:"flex items-center gap-2"},Xe={class:"w-12 text-right"},Je={class:"w-16 text-right"},et={class:"flex justify-between items-center"},tt={class:"flex items-center gap-2"},at={class:"w-12 text-right"},st={class:"w-16 text-right"},rt={class:"text-sm text-muted-foreground mt-3"},nt=V({__name:"PerformanceCards",props:{performanceData:{type:Object,default:()=>({})},performanceRatings:{type:Object,default:()=>({})},safetyData:{type:Object,default:()=>({})},delayBreakdowns:{type:Array,default:()=>[]},rejectionBreakdowns:{type:Array,default:()=>[]},maintenanceBreakdowns:{type:Object,default:()=>({})}},setup(a){const f=a,u=R(()=>[...f.delayBreakdowns].sort((t,s)=>s.total_delays-t.total_delays).slice(0,3)),y=R(()=>[...f.rejectionBreakdowns].sort((t,s)=>s.total_rejections-t.total_rejections).slice(0,3)),p=t=>t==null?"0%":`${Math.round(parseFloat(t))}%`,_=t=>(typeof t=="string"&&(t=parseFloat(t)),t==null||isNaN(t)?"0":Math.round(t).toString()),v=t=>(typeof t=="string"&&(t=parseFloat(t)),t==null||isNaN(t)?"0.00":t.toFixed(2)),x=t=>(typeof t=="string"&&(t=parseFloat(t)),t==null||isNaN(t)?"0.00":t.toFixed(2)),T=t=>{if(!t)return"Not Available";switch(t){case"gold":return"Gold Tier";case"silver":return"Silver Tier";case"not_eligible":return"Not Eligible";case"fantastic_plus":return"Fantastic +";case"fantastic":return"Fantastic";case"good":return"Good";case"fair":return"Fair";case"poor":return"Poor";default:return t}},w=t=>{if(!t)return"outline";switch(t){case"gold":return"gold";case"silver":return"silver";case"not_eligible":return"not-eligible";case"fantastic_plus":return"fantastic-plus";case"fantastic":return"fantastic";case"good":return"good";case"fair":return"fair";case"poor":return"poor";default:return"outline"}},N=t=>t?t==="Gold Tier"?"gold":t==="Silver Tier"?"silver":t==="Not Eligible"?"not-eligible":"outline":"outline",D=R(()=>{var g;if(!((g=f.safetyData)!=null&&g.ratings))return null;const t=f.safetyData.ratings,s={gold:3,silver:2,not_eligible:1},C=["traffic_light_violation","speeding_violations","following_distance","driver_distraction","sign_violations"];let h="gold";for(const l of C)t[l]&&s[t[l]]<s[h]&&(h=t[l]);switch(h){case"gold":return"Gold Tier";case"silver":return"Silver Tier";case"not_eligible":return"Not Eligible";default:return"Not Available"}}),M=t=>{if(!t)return"text-gray-600";switch(t){case"gold":return"text-amber-600";case"silver":return"text-slate-600";case"not_eligible":return"text-red-600";case"fantastic_plus":return"text-green-600";case"fantastic":return"text-emerald-600";case"good":return"text-blue-600";case"fair":return"text-amber-600";case"poor":return"text-red-600";default:return"text-indigo-600"}},G=t=>t>=900?"text-green-600":t>=750?"text-emerald-600":t>=600?"text-blue-600":"text-red-600";return(t,s)=>{var C,h,g,l,r;return m(),S("div",_e,[e("div",he,[s[0]||(s[0]=e("h3",{class:"text-base font-semibold mb-1"},"Acceptance",-1)),s[1]||(s[1]=e("div",{class:"text-xs text-muted-foreground mb-1"},"Total Score",-1)),e("div",De,[e("div",{class:P(["text-4xl font-bold",M(a.performanceRatings.average_acceptance)])},o(p(a.performanceData.average_acceptance)),3),i(c(F),{variant:w(a.performanceRatings.average_acceptance),class:"text-xs"},{default:d(()=>[b(o(T(a.performanceRatings.average_acceptance)),1)]),_:1},8,["variant"])]),s[2]||(s[2]=e("div",{class:"text-sm mb-2 flex justify-between"},[e("span",{class:"font-semibold"},"Rejections by Reason"),e("span",{class:"font-semibold"},"Total")],-1)),e("div",ke,[(m(!0),S(E,null,I(y.value,(n,j)=>(m(),S("div",{key:j,class:"flex justify-between"},[e("span",null,o(n.reason_code),1),e("span",null,o(n.total_rejections),1)]))),128))])]),e("div",$e,[s[3]||(s[3]=e("h3",{class:"text-base font-semibold mb-1"},"On-Time",-1)),s[4]||(s[4]=e("div",{class:"text-xs text-muted-foreground mb-1"},"Total Score",-1)),e("div",Se,[e("div",{class:P(["text-4xl font-bold",M(a.performanceRatings.average_on_time)])},o(p(a.performanceData.average_on_time)),3),i(c(F),{variant:w(a.performanceRatings.average_on_time),class:"text-xs"},{default:d(()=>[b(o(T(a.performanceRatings.average_on_time)),1)]),_:1},8,["variant"])]),s[5]||(s[5]=e("div",{class:"text-sm mb-2 flex justify-between"},[e("span",{class:"font-semibold"},"Delays by Reason"),e("span",{class:"font-semibold"},"Total")],-1)),e("div",Ne,[(m(!0),S(E,null,I(u.value,(n,j)=>(m(),S("div",{key:j,class:"flex justify-between"},[e("span",null,o(n.code),1),e("span",null,o(n.total_delays),1)]))),128))])]),e("div",je,[s[10]||(s[10]=e("h3",{class:"text-base font-semibold mb-1"},"Maintenance",-1)),s[11]||(s[11]=e("div",{class:"text-xs text-muted-foreground mb-1"},"MVtS Score",-1)),e("div",Re,[e("div",{class:P(["text-4xl font-bold",M(a.performanceRatings.average_maintenance_variance_to_spend)])},o(p(a.performanceData.average_maintenance_variance_to_spend)),3),i(c(F),{variant:w(a.performanceRatings.average_maintenance_variance_to_spend),class:"text-xs"},{default:d(()=>[b(o(T(a.performanceRatings.average_maintenance_variance_to_spend)),1)]),_:1},8,["variant"])]),e("div",Ce,[e("div",Te,[s[6]||(s[6]=e("span",null,"Cost per mile",-1)),e("span",null,"$"+o(x(a.maintenanceBreakdowns.qs_cpm)),1)]),e("div",Be,[s[7]||(s[7]=e("span",null,"Num of WOs",-1)),e("span",null,o(a.maintenanceBreakdowns.total_repair_orders),1)]),e("div",Fe,[s[8]||(s[8]=e("span",null,"Current Costs",-1)),e("span",null,"$"+o(x(a.maintenanceBreakdowns.total_invoice_amount)),1)]),e("div",Me,[s[9]||(s[9]=e("span",null,"Missing Invoices",-1)),e("span",null,o(a.maintenanceBreakdowns.missing_invoices_count||0),1)])])]),e("div",Pe,[s[17]||(s[17]=e("h3",{class:"text-base font-semibold mb-1"},"Netradyne Alerts Bonus Criteria",-1)),s[18]||(s[18]=e("div",{class:"text-xs text-muted-foreground mb-1"},"Green Zone Score",-1)),e("div",Ae,[e("div",{class:P(["text-4xl font-bold",G(a.safetyData.average_driver_score)])},o(_(a.safetyData.average_driver_score||"N/A")),3),i(c(F),{variant:N(D.value),class:"text-xs"},{default:d(()=>[b(o(T(D.value)),1)]),_:1},8,["variant"])]),s[19]||(s[19]=e("div",{class:"flex justify-between items-center text-sm font-semibold mb-2"},[e("span",null,"Alert Type"),e("div",{class:"flex items-center gap-2"},[e("span",{class:"w-12 text-right"},"Total"),e("span",{class:"w-16 text-right"},"P1KH")])],-1)),e("div",Oe,[e("div",Ve,[s[12]||(s[12]=e("span",null,"Distracted Driving",-1)),e("div",We,[e("span",ze,o(_(a.safetyData.driver_distraction)),1),e("span",Ee,o(v((C=a.safetyData.rates)==null?void 0:C.driver_distraction)),1)])]),e("div",Ie,[s[13]||(s[13]=e("span",null,"Speeding",-1)),e("div",Ge,[e("span",qe,o(_(a.safetyData.speeding_violations)),1),e("span",Le,o(v((h=a.safetyData.rates)==null?void 0:h.speeding_violations)),1)])]),e("div",Ue,[s[14]||(s[14]=e("span",null,"Sign Violation",-1)),e("div",He,[e("span",Ke,o(_(a.safetyData.sign_violations)),1),e("span",Qe,o(v((g=a.safetyData.rates)==null?void 0:g.sign_violations)),1)])]),e("div",Ye,[s[15]||(s[15]=e("span",null,"Traffic Light Violation",-1)),e("div",Ze,[e("span",Xe,o(_(a.safetyData.traffic_light_violation)),1),e("span",Je,o(v((l=a.safetyData.rates)==null?void 0:l.traffic_light_violation)),1)])]),e("div",et,[s[16]||(s[16]=e("span",null,"Following Distance",-1)),e("div",tt,[e("span",at,o(_(a.safetyData.following_distance)),1),e("span",st,o(v((r=a.safetyData.rates)==null?void 0:r.following_distance)),1)])])]),e("div",rt,[e("div",null,"Total Hours Analyzed: "+o(_(a.safetyData.total_hours||0)),1)])])])}}}),ot={class:"bg-card rounded-lg border shadow-sm p-6 mb-6"},it={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},lt={class:"p-4 border rounded-lg"},ct={class:"flex items-center justify-between gap-3 mb-3"},dt={class:"p-4 border rounded-lg"},ut={class:"flex items-center justify-between gap-3 mb-3"},mt={class:"p-4 border rounded-lg"},ft={class:"flex items-center justify-between gap-3 mb-3"},vt=V({__name:"AdditionalMetricsCard",props:{performanceData:{type:Object,default:()=>({})},performanceRatings:{type:Object,default:()=>({})}},setup(a){const f=v=>v==null?"0":Math.round(parseFloat(v)).toString(),u=v=>{if(v==null)return"0";const x=parseFloat(v);return isNaN(x)?"0":x.toFixed(2).replace(/\.?0+$/,"")},y=v=>{if(!v)return"Not Available";switch(v){case"fantastic_plus":return"Fantastic +";case"fantastic":return"Fantastic";case"good":return"Good";case"fair":return"Fair";case"poor":return"Poor";default:return v.charAt(0).toUpperCase()+v.slice(1).replace(/_/g," ")}},p=v=>{if(!v)return"outline";switch(v){case"fantastic_plus":return"fantastic-plus";case"fantastic":return"fantastic";case"good":return"good";case"fair":return"fair";case"poor":return"poor";default:return"outline"}},_=v=>{if(!v)return"text-gray-600";switch(v){case"fantastic_plus":return"text-green-600";case"fantastic":return"text-emerald-600";case"good":return"text-blue-600";case"fair":return"text-amber-600";case"poor":return"text-red-600";default:return"text-indigo-600"}};return(v,x)=>(m(),S("div",ot,[x[6]||(x[6]=e("h3",{class:"text-xl font-semibold mb-4"},"Additional Performance Metrics For T6W",-1)),e("div",it,[e("div",lt,[x[0]||(x[0]=e("h4",{class:"text-lg font-medium mb-2"},"VCR-P",-1)),x[1]||(x[1]=e("div",{class:"text-sm text-muted-foreground mb-1"},"Count",-1)),e("div",ct,[e("div",{class:P(["text-3xl font-bold",_(a.performanceRatings.vcr_preventable)])},o(u(a.performanceData.vcr_preventable)),3),i(c(F),{variant:p(a.performanceRatings.vcr_preventable),class:"text-xs"},{default:d(()=>[b(o(y(a.performanceRatings.vcr_preventable)),1)]),_:1},8,["variant"])])]),e("div",dt,[x[2]||(x[2]=e("h4",{class:"text-lg font-medium mb-2"},"VMCR-P",-1)),x[3]||(x[3]=e("div",{class:"text-sm text-muted-foreground mb-1"},"Count",-1)),e("div",ut,[e("div",{class:P(["text-3xl font-bold",_(a.performanceRatings.vmcr_p)])},o(f(a.performanceData.vmcr_p)),3),i(c(F),{variant:p(a.performanceRatings.vmcr_p),class:"text-xs"},{default:d(()=>[b(o(y(a.performanceRatings.vmcr_p)),1)]),_:1},8,["variant"])])]),e("div",mt,[x[4]||(x[4]=e("h4",{class:"text-lg font-medium mb-2"},"Open BOC",-1)),x[5]||(x[5]=e("div",{class:"text-sm text-muted-foreground mb-1"},"Count",-1)),e("div",ft,[e("div",{class:P(["text-3xl font-bold",_(a.performanceRatings.open_boc)])},o(f(a.performanceData.open_boc)),3),i(c(F),{variant:p(a.performanceRatings.open_boc),class:"text-xs"},{default:d(()=>[b(o(y(a.performanceRatings.open_boc)),1)]),_:1},8,["variant"])])])])]))}}),gt=V({__name:"CardDescription",props:{class:{}},setup(a){const f=a;return(u,y)=>(m(),S("p",{class:P(c(ue)("text-sm text-muted-foreground",f.class))},[J(u.$slots,"default")],2))}}),pt={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-2"},xt={class:"flex items-center gap-2"},bt={class:"relative w-full md:w-auto"},yt={class:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"},wt={class:"overflow-x-auto"},_t={class:"flex items-center gap-1"},ht={class:"flex items-center justify-end gap-1"},Dt={class:"flex items-center justify-end gap-1"},kt={class:"flex items-center justify-end gap-1"},$t={class:"flex flex-col items-center justify-center gap-2"},St={key:0},Nt={key:1},jt={class:"border-t bg-muted/20 px-4 py-3 flex flex-col sm:flex-row justify-between items-center gap-2"},Rt={class:"flex items-center gap-4 text-sm text-muted-foreground"},Ct={class:"flex items-center gap-1"},Tt={class:"flex items-center gap-1"},Bt={class:"relative"},Ft=["value"],Mt={class:"flex space-x-1"},Pt=V({__name:"DriverPerformanceTable",props:{driversData:{type:Array,default:()=>[]}},setup(a){const f=a,u=A(""),y=A("overall_score"),p=A("desc"),_=l=>{y.value===l?p.value=p.value==="asc"?"desc":"asc":(y.value=l,p.value=l==="driver_name"?"asc":"desc")},v=()=>{u.value="",y.value="overall_score",p.value="desc",w.value=1,N.value=10},x=R(()=>{if(!f.driversData||f.driversData.length===0)return[];if(!u.value)return f.driversData;const l=u.value.toLowerCase();return f.driversData.filter(r=>r.driver_name.toLowerCase().includes(l))}),T=R(()=>x.value.length===0?[]:[...x.value].sort((l,r)=>{const n=l[y.value],j=r[y.value];return typeof n=="string"?p.value==="asc"?n.localeCompare(j):j.localeCompare(n):p.value==="asc"?n-j:j-n})),w=A(1),N=A(10);K([y,p,u],()=>{w.value=1}),K(N,()=>{w.value=1});const D=R(()=>T.value.length),M=R(()=>Math.max(1,Math.ceil(D.value/N.value)));K([M,w],()=>{w.value>M.value&&(w.value=M.value)});const G=R(()=>{const l=M.value,r=w.value;if(l<=5)return Array.from({length:l},(B,H)=>H+1);let n=[1,l];const j=[r-1,r,r+1].filter(B=>B>1&&B<l);n.push(...j),n=[...new Set(n)].sort((B,H)=>B-H);const W=[];let q=0;for(const B of n)B-q>1&&W.push(-1),W.push(B),q=B;return W}),t=R(()=>(w.value-1)*N.value),s=R(()=>Math.min(t.value+N.value,D.value)),C=R(()=>T.value.slice(t.value,s.value)),h=l=>l>=75?"success":l>=50?"midRange":"destructive",g=l=>l>=900?"success":l>=750?"midRange":l>=600?"warning":"destructive";return(l,r)=>(m(),$(c(oe),{class:"shadow-sm border bg-card"},{default:d(()=>[i(c(ie),{class:"p-4 border-b"},{default:d(()=>[e("div",pt,[e("div",null,[i(c(le),{class:"text-lg font-semibold flex items-center gap-2"},{default:d(()=>[i(k,{name:"users",class:"h-5 w-5 text-primary"}),r[9]||(r[9]=b(" Driver Performance "))]),_:1}),i(gt,null,{default:d(()=>r[10]||(r[10]=[b("Overall driver performance metrics")])),_:1})]),e("div",xt,[e("div",bt,[e("div",yt,[i(k,{name:"search",class:"h-4 w-4 text-muted-foreground"})]),i(c(de),{modelValue:u.value,"onUpdate:modelValue":r[0]||(r[0]=n=>u.value=n),placeholder:"Search drivers...",class:"pl-10 w-full md:w-[200px]"},null,8,["modelValue"])]),i(c(U),{variant:"outline",size:"sm",onClick:v,class:"hidden md:flex items-center gap-1"},{default:d(()=>[i(k,{name:"rotate-ccw",class:"h-4 w-4"}),r[11]||(r[11]=b(" Reset "))]),_:1})])])]),_:1}),i(c(ce),{class:"p-0"},{default:d(()=>[e("div",wt,[i(c(se),{class:"relative h-[400px] overflow-auto"},{default:d(()=>[i(c(re),null,{default:d(()=>[i(c(Q),{class:"sticky top-0 z-10 border-b bg-background hover:bg-background"},{default:d(()=>[i(c(L),{class:"w-12 text-center"},{default:d(()=>r[12]||(r[12]=[e("div",{class:"flex items-center justify-center"}," # ",-1)])),_:1}),i(c(L),{onClick:r[1]||(r[1]=n=>_("driver_name")),class:"cursor-pointer whitespace-nowrap"},{default:d(()=>[e("div",_t,[r[13]||(r[13]=b(" Driver Name ")),y.value==="driver_name"?(m(),$(k,{key:0,name:p.value==="asc"?"arrow-up":"arrow-down",class:"h-4 w-4"},null,8,["name"])):(m(),$(k,{key:1,name:"arrow-up-down",class:"h-4 w-4 opacity-50"}))])]),_:1}),i(c(L),{onClick:r[2]||(r[2]=n=>_("acceptance_score")),class:"cursor-pointer text-right whitespace-nowrap"},{default:d(()=>[e("div",ht,[r[14]||(r[14]=b(" Acceptance ")),y.value==="acceptance_score"?(m(),$(k,{key:0,name:p.value==="asc"?"arrow-up":"arrow-down",class:"h-4 w-4"},null,8,["name"])):(m(),$(k,{key:1,name:"arrow-up-down",class:"h-4 w-4 opacity-50"}))])]),_:1}),i(c(L),{onClick:r[3]||(r[3]=n=>_("on_time_score")),class:"cursor-pointer text-right whitespace-nowrap"},{default:d(()=>[e("div",Dt,[r[15]||(r[15]=b(" On-Time ")),y.value==="on_time_score"?(m(),$(k,{key:0,name:p.value==="asc"?"arrow-up":"arrow-down",class:"h-4 w-4"},null,8,["name"])):(m(),$(k,{key:1,name:"arrow-up-down",class:"h-4 w-4 opacity-50"}))])]),_:1}),i(c(L),{onClick:r[4]||(r[4]=n=>_("safety_score")),class:"cursor-pointer text-right whitespace-nowrap"},{default:d(()=>[e("div",kt,[r[16]||(r[16]=b(" Green Zone Score ")),y.value==="safety_score"?(m(),$(k,{key:0,name:p.value==="asc"?"arrow-up":"arrow-down",class:"h-4 w-4"},null,8,["name"])):(m(),$(k,{key:1,name:"arrow-up-down",class:"h-4 w-4 opacity-50"}))])]),_:1})]),_:1})]),_:1}),i(c(ne),null,{default:d(()=>[(m(!0),S(E,null,I(C.value,(n,j)=>(m(),$(c(Q),{key:n.driver_name,class:"hover:bg-muted/20 transition-colors"},{default:d(()=>[i(c(z),{class:"text-center"},{default:d(()=>[i(c(F),{variant:"outline",class:"min-w-[28px] justify-center"},{default:d(()=>[b(o(t.value+j+1),1)]),_:2},1024)]),_:2},1024),i(c(z),{class:"font-medium"},{default:d(()=>[b(o(n.driver_name),1)]),_:2},1024),i(c(z),{class:"text-right"},{default:d(()=>[i(c(F),{variant:h(n.acceptance_score)},{default:d(()=>[b(o(Math.round(n.acceptance_score))+"% ",1)]),_:2},1032,["variant"])]),_:2},1024),i(c(z),{class:"text-right"},{default:d(()=>[i(c(F),{variant:h(n.on_time_score)},{default:d(()=>[b(o(Math.round(n.on_time_score))+"% ",1)]),_:2},1032,["variant"])]),_:2},1024),i(c(z),{class:"text-right"},{default:d(()=>[i(c(F),{variant:g(n.raw_safety_score)},{default:d(()=>[b(o(Math.round(n.raw_safety_score)),1)]),_:2},1032,["variant"])]),_:2},1024)]),_:2},1024))),128)),x.value.length===0?(m(),$(c(Q),{key:0},{default:d(()=>[i(c(z),{colspan:"6",class:"text-center py-8 text-muted-foreground"},{default:d(()=>[e("div",$t,[i(k,{name:"users-x",class:"h-10 w-10 opacity-50"}),u.value?(m(),S("p",St,'No drivers found matching "'+o(u.value)+'"',1)):(m(),S("p",Nt,"No driver performance data available for the selected period.")),u.value?(m(),$(c(U),{key:2,variant:"outline",size:"sm",onClick:r[5]||(r[5]=n=>u.value="")},{default:d(()=>r[17]||(r[17]=[b(" Clear search ")])),_:1})):O("",!0)])]),_:1})]),_:1})):O("",!0)]),_:1})]),_:1})]),e("div",jt,[e("div",Rt,[e("span",Ct,[i(k,{name:"list",class:"h-4 w-4"}),b(" Showing "+o(t.value+1)+"-"+o(s.value)+" of "+o(D.value)+" drivers ",1)]),e("span",Tt,[i(k,{name:"layout-grid",class:"h-4 w-4"}),r[18]||(r[18]=b(" Per page: "))]),e("div",Bt,[ee(e("select",{"onUpdate:modelValue":r[6]||(r[6]=n=>N.value=n),class:"h-8 appearance-none rounded-md border bg-background px-2 py-1 text-sm focus:ring-2 focus:ring-ring"},[(m(),S(E,null,I([5,10,20,50],n=>e("option",{key:n,value:n},o(n),9,Ft)),64))],512),[[te,N.value,void 0,{number:!0}]]),r[19]||(r[19]=e("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[e("svg",{class:"h-4 w-4 opacity-50",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])],-1))])]),e("div",Mt,[i(c(U),{size:"sm",variant:"ghost",onClick:r[7]||(r[7]=n=>w.value--),disabled:w.value===1,class:"flex items-center gap-1"},{default:d(()=>[i(k,{name:"chevron-left",class:"h-4 w-4"}),r[20]||(r[20]=b(" Prev "))]),_:1},8,["disabled"]),(m(!0),S(E,null,I(G.value,n=>(m(),$(c(U),{key:n,size:"sm",variant:"ghost",onClick:j=>n!==-1?w.value=n:null,class:P({"border-primary bg-primary/10 text-primary font-medium":n===w.value,"opacity-50 pointer-events-none":n===-1})},{default:d(()=>[b(o(n===-1?"...":n),1)]),_:2},1032,["onClick","class"]))),128)),i(c(U),{size:"sm",variant:"ghost",onClick:r[8]||(r[8]=n=>w.value++),disabled:w.value===M.value,class:"flex items-center gap-1"},{default:d(()=>[r[21]||(r[21]=b(" Next ")),i(k,{name:"chevron-right",class:"h-4 w-4"})]),_:1},8,["disabled"])])])]),_:1})]),_:1}))}}),At={class:"container w-full md:max-w-2xl lg:max-w-3xl xl:max-w-6xl lg:mx-auto m-0 p-2 md:p-4 lg:p-6 space-y-2 md:space-y-4 lg:space-y-6"},Ot={class:"flex items-center justify-between mb-6"},Vt={class:"h-auto"},Wt={class:"bg-card rounded-lg border shadow-sm p-3 sm:p-4 h-16 sm:h-20"},zt={class:"flex items-center justify-between h-full"},Et={class:"text-xl sm:text-2xl font-bold text-indigo-600"},la=V({__name:"Summary",props:{tenantSlug:String,summaries:Object,delayBreakdowns:Object,rejectionBreakdowns:Object,maintenanceBreakdowns:Object,dateFilter:String,dateRange:Object,driversOverallPerformance:Object,milesDriven:Number,permissions:Array},setup(a){const f=a;A("on-time");const u=A(f.dateFilter||"t6w"),y=A(null),p=A(null);ae(()=>{});const _=R(()=>{const s={yesterday:"yesterday","current-week":"current_week",t6w:"rolling_6_weeks",quarterly:"quarterly"}[u.value]||u.value;return N(s)}),v=t=>{u.value=t,Z.visit(route("dashboard",{tenantSlug:f.tenantSlug,dateFilter:t,minInvoiceAmount:y.value||null,outstandingDate:p.value||null}),{only:["summaries","delayBreakdowns","rejectionBreakdowns","maintenanceBreakdowns","dateFilter","dateRange","milesDriven","driversOverallPerformance"]})},x=[{title:f.tenantSlug?"Dashboard":"Admin Dashboard",href:f.tenantSlug?route("dashboard",{tenantSlug:f.tenantSlug}):route("admin.dashboard")},{title:"Performance Summary",href:route("dashboard",{tenantSlug:f.tenantSlug})}],T=R(()=>{var t,s;return(s=(t=f.summaries)==null?void 0:t.performance)!=null&&s.last_updated?w(new Date(f.summaries.performance.last_updated)):w(new Date)}),w=t=>new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(t),N=t=>{var C,h;if((h=(C=f.summaries)==null?void 0:C[t])!=null&&h.date_range){const g=new Date(f.summaries[t].date_range.start+"T12:00:00"),l=new Date(f.summaries[t].date_range.end+"T12:00:00");return`${D(g)} - ${D(l)}`}const s=new Date;switch(t){case"yesterday":{const g=new Date(s);return g.setDate(g.getDate()-1),D(g)}case"current_week":{const g=new Date(s);g.setDate(s.getDate()-s.getDay());const l=new Date(g);return l.setDate(g.getDate()+6),`${D(g)} - ${D(l)}`}case"rolling_6_weeks":{const g=new Date(s);g.setDate(s.getDate()-s.getDay()+6);const l=new Date(g);return l.setDate(g.getDate()-6*7+1),`${D(l)} - ${D(g)}`}case"quarterly":{const g=new Date(s),l=new Date(s);return l.setMonth(l.getMonth()-3),`${D(l)} - ${D(g)}`}default:return""}},D=t=>new Intl.DateTimeFormat("en-US",{month:"numeric",day:"numeric",year:"numeric"}).format(t),M=t=>t==null?"0":new Intl.NumberFormat().format(Math.round(t)),G=R(()=>{var g,l;if(!((l=(g=f.summaries)==null?void 0:g.performance)!=null&&l.ratings))return"Not Available";const t=f.summaries.performance.ratings,s={fantastic_plus:5,fantastic:4,good:3,fair:2,poor:1},C=["average_acceptance","average_on_time","average_maintenance_variance_to_spend","open_boc","vcr_preventable","vmcr_p"];let h="fantastic_plus";for(const r of C)t[r]&&s[t[r]]<s[h]&&(h=t[r]);switch(h){case"fantastic_plus":return"Fantastic +";case"fantastic":return"Fantastic";case"good":return"Good";case"fair":return"Fair";case"poor":return"Poor";default:return"Not Available"}});return(t,s)=>(m(),$(X,{breadcrumbs:x,tenantSlug:a.tenantSlug,permissions:f.permissions},{default:d(()=>{var C,h,g,l,r,n,j,W,q,B;return[i(c(Y),{title:"Performance Summary Dashboard"}),e("div",At,[e("div",Ot,[s[0]||(s[0]=e("h1",{class:"text-2xl font-bold"},null,-1)),i(c(F),{variant:"outline",class:"text-sm"},{default:d(()=>[i(k,{name:"calendar",class:"mr-1 h-4 w-4"}),b(" Last updated: "+o(T.value),1)]),_:1})]),i(fe,{operationalExcellenceScore:G.value},null,8,["operationalExcellenceScore"]),i(we,{onTabChange:v,dateRangeText:_.value,weekNumber:(C=a.dateRange)==null?void 0:C.weekNumber,startWeekNumber:(h=a.dateRange)==null?void 0:h.startWeekNumber,endWeekNumber:(g=a.dateRange)==null?void 0:g.endWeekNumber,year:(l=a.dateRange)==null?void 0:l.year,activeTabId:u.value},null,8,["dateRangeText","weekNumber","startWeekNumber","endWeekNumber","year","activeTabId"]),a.summaries?(m(),$(nt,{key:0,performanceData:((r=a.summaries.performance)==null?void 0:r.data)||{},performanceRatings:((n=a.summaries.performance)==null?void 0:n.ratings)||{},safetyData:a.summaries.safety||{},delayBreakdowns:((j=a.delayBreakdowns)==null?void 0:j.by_code)||[],rejectionBreakdowns:((W=a.rejectionBreakdowns)==null?void 0:W.by_reason)||[],maintenanceBreakdowns:a.maintenanceBreakdowns||{},milesDriven:a.milesDriven},null,8,["performanceData","performanceRatings","safetyData","delayBreakdowns","rejectionBreakdowns","maintenanceBreakdowns","milesDriven"])):O("",!0),e("div",Vt,[a.driversOverallPerformance?(m(),$(Pt,{key:0,driversData:a.driversOverallPerformance.drivers||[]},null,8,["driversData"])):O("",!0)]),a.summaries?(m(),$(vt,{key:1,performanceData:((q=a.summaries.performance)==null?void 0:q.data)||{},performanceRatings:((B=a.summaries.performance)==null?void 0:B.ratings)||{}},null,8,["performanceData","performanceRatings"])):O("",!0),e("div",Wt,[e("div",zt,[s[1]||(s[1]=e("h3",{class:"text-base font-semibold"},"Miles Driven",-1)),e("div",Et,o(M(a.milesDriven))+" Mile ",1)])])])]}),_:1},8,["tenantSlug","permissions"]))}});export{la as default};
