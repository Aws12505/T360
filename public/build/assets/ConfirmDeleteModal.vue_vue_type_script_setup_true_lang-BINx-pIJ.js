import{_ as b}from"./Button.vue_vue_type_script_setup_true_lang-B9WZ-5fZ.js";import{S as oe,W as Z,x as X}from"./vendor-vue-BInP8APy.js";import{c as T,F as p,e as i,X as s,E as k,H as z,O as P,U as y,b as C,f as u,S as f,u as e,z as n,r as H,d as q,w as I,G as ee,aj as W,C as re,Y as ie,ak as ne}from"./vendor-DrR5RGOb.js";import{_ as M}from"./Badge.vue_vue_type_script_setup_true_lang-gLGZkSRc.js";import{d as se,a1 as te,J as ae,N as de,aa as ue,X as B,E as ce,a as me,S as Y,p as K,y as pe,L as le}from"./vendor-icons-DimsVR8r.js";import{_ as O}from"./Input.vue_vue_type_script_setup_true_lang-CfJsKr1D.js";import{_ as U}from"./Label.vue_vue_type_script_setup_true_lang-G5SND9_d.js";import{_ as Q}from"./Checkbox.vue_vue_type_script_setup_true_lang-Do6ACixq.js";import{_ as V}from"./InputError.vue_vue_type_script_setup_true_lang-DJFUZLlW.js";const fe={class:"w-full overflow-x-auto"},ve={class:"rounded-md border"},ge={class:"w-full caption-bottom text-sm"},xe={class:"[&_tr]:border-b"},be={class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},he={key:0,class:"h-12 px-4 text-right align-middle font-medium text-muted-foreground"},_e={class:"[&_tr:last-child]:border-0"},ye={class:"p-4 align-middle font-medium"},ke={class:"p-4 align-middle"},$e={key:0,class:"p-4 align-middle text-right"},we={class:"flex justify-end space-x-2"},Ce={key:0,class:"mt-6 flex justify-center"},Se={class:"flex flex-wrap items-center gap-1 justify-center"},$t={__name:"UserList",props:{users:Object,isSuperAdmin:{type:Boolean,default:!1},permissions:Array},setup(_){const S=_,r=T(()=>S.permissions.map(t=>t.name)),v=t=>{t&&Z.get(t,{},{only:["users"]})};return(t,a)=>(i(),p("div",fe,[s("div",ve,[s("table",ge,[s("thead",xe,[s("tr",be,[a[0]||(a[0]=s("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Name",-1)),a[1]||(a[1]=s("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Email",-1)),r.value.includes("users.update")||r.value.includes("users.delete")?(i(),p("th",he,"Actions")):k("",!0)])]),s("tbody",_e,[(i(!0),p(z,null,P(_.users.data,c=>(i(),p("tr",{key:c.id,class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},[s("td",ye,y(c.name),1),s("td",ke,y(c.email),1),r.value.includes("users.update")||r.value.includes("users.delete")?(i(),p("td",$e,[s("div",we,[r.value.includes("users.update")?(i(),C(e(b),{key:0,onClick:h=>t.$emit("edit",c),variant:"outline",size:"sm"},{default:u(()=>a[2]||(a[2]=[f(" Edit ")])),_:2},1032,["onClick"])):k("",!0),r.value.includes("users.delete")?(i(),C(e(b),{key:1,onClick:h=>t.$emit("delete",c),variant:"destructive",size:"sm"},{default:u(()=>a[3]||(a[3]=[f(" Delete ")])),_:2},1032,["onClick"])):k("",!0),_.isSuperAdmin?(i(),C(e(oe),{key:2,href:t.route("impersonate.start",c.id),as:"button"},{default:u(()=>[n(e(b),{variant:"secondary",size:"sm"},{default:u(()=>a[4]||(a[4]=[f(" Impersonate ")])),_:1})]),_:2},1032,["href"])):k("",!0)])])):k("",!0)]))),128))])])]),_.users.links?(i(),p("div",Ce,[s("nav",Se,[(i(!0),p(z,null,P(_.users.links,c=>(i(),C(e(b),{key:c.label,onClick:h=>v(c.url),disabled:!c.url,variant:c.active?"default":"outline",size:"sm",class:"min-w-[40px]",innerHTML:c.label},null,8,["onClick","disabled","variant","innerHTML"]))),128))])])):k("",!0)]))}},Ae={class:"w-full overflow-x-auto"},je={class:"rounded-md border"},ze={class:"w-full caption-bottom text-sm"},Pe={class:"[&_tr]:border-b bg-muted/50"},Ue={class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},Ee={key:0,class:"h-12 px-4 text-right align-middle font-medium text-muted-foreground"},Le={class:"[&_tr:last-child]:border-0"},Ve={class:"p-4 align-middle font-medium"},Te={class:"flex items-center"},Oe={class:"p-4 align-middle"},Re={class:"flex flex-wrap gap-1"},De={class:"mb-2 w-full"},Me={key:0,class:"w-full"},Ne={class:"text-xs font-semibold text-muted-foreground mb-1 flex items-center"},Ge={class:"flex flex-wrap gap-1 ml-4"},He={key:0,class:"p-4 align-middle text-right"},Be={class:"flex justify-end space-x-2"},Fe={key:0,class:"mt-6 flex justify-center"},We={class:"flex flex-wrap items-center gap-1 justify-center"},wt={__name:"RoleList",props:{roles:Object,permissions:Array},setup(_){const S=_,r=T(()=>S.permissions.map(g=>g.name)),v=H([]),t=g=>{const $=v.value.indexOf(g);$===-1?v.value.push(g):v.value.splice($,1)},a=g=>g.length,c=g=>{g&&Z.get(g,{},{only:["roles"]})},h=g=>{const $={};return g.forEach(w=>{const L=w.name.split(".")[0];$[L]||($[L]=[]),$[L].push(w)}),$},A=g=>g==="tenant-settings"?"Tenant Settings":g==="repair-orders"?"Repair Orders":g==="safety-data"?"Safety Data":g==="miles-driven"?"Miles Driven":g==="support-tickets"?"Support Tickets":g==="sms-coaching"?"SMS Coaching":g==="support-responses"?"Support Responses":g.charAt(0).toUpperCase()+g.slice(1),R=g=>{const $=g.split(".");return $.length>1?$[1].charAt(0).toUpperCase()+$[1].slice(1).replace(/-/g," "):g};return(g,$)=>(i(),p("div",Ae,[s("div",je,[s("table",ze,[s("thead",Pe,[s("tr",Ue,[$[0]||($[0]=s("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Role Name",-1)),$[1]||($[1]=s("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Permissions",-1)),r.value.includes("roles.update")||r.value.includes("roles.delete")?(i(),p("th",Ee,"Actions")):k("",!0)])]),s("tbody",Le,[(i(!0),p(z,null,P(_.roles.data,w=>(i(),p("tr",{key:w.id,class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},[s("td",Ve,[s("div",Te,[n(e(se),{class:"h-4 w-4 mr-2 text-primary"}),f(" "+y(w.name),1)])]),s("td",Oe,[s("div",Re,[s("div",De,[n(e(M),{variant:"outline",class:"mr-2"},{default:u(()=>[f(y(a(w.permissions))+" permissions ",1)]),_:2},1024),n(e(b),{variant:"ghost",size:"sm",onClick:E=>t(w.id),class:"text-xs"},{default:u(()=>[f(y(v.value.includes(w.id)?"Hide details":"Show details"),1)]),_:2},1032,["onClick"])]),v.value.includes(w.id)?(i(),p("div",Me,[(i(!0),p(z,null,P(h(w.permissions),(E,L)=>(i(),p("span",{key:L,class:"inline-flex flex-col mb-2 w-full"},[s("span",Ne,[n(e(te),{class:"h-3 w-3 mr-1"}),f(" "+y(A(L))+" ",1),n(e(M),{variant:"secondary",class:"ml-2"},{default:u(()=>[f(y(E.length),1)]),_:2},1024)]),s("div",Ge,[(i(!0),p(z,null,P(E,N=>(i(),p("span",{key:N.id,class:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-muted text-muted-foreground"},y(R(N.name)),1))),128))])]))),128))])):k("",!0)])]),r.value.includes("roles.update")||r.value.includes("roles.delete")?(i(),p("td",He,[s("div",Be,[r.value.includes("roles.update")?(i(),C(e(b),{key:0,onClick:E=>g.$emit("edit",w),variant:"outline",size:"sm",class:"flex items-center"},{default:u(()=>[n(e(ae),{class:"h-3.5 w-3.5 mr-1"}),$[2]||($[2]=f(" Edit "))]),_:2},1032,["onClick"])):k("",!0),r.value.includes("roles.delete")?(i(),C(e(b),{key:1,onClick:E=>g.$emit("delete",w),variant:"destructive",size:"sm",class:"flex items-center"},{default:u(()=>[n(e(de),{class:"h-3.5 w-3.5 mr-1"}),$[3]||($[3]=f(" Delete "))]),_:2},1032,["onClick"])):k("",!0)])])):k("",!0)]))),128))])])]),_.roles.links?(i(),p("div",Fe,[s("nav",We,[(i(!0),p(z,null,P(_.roles.links,w=>(i(),C(e(b),{key:w.label,onClick:E=>c(w.url),disabled:!w.url,variant:w.active?"default":"outline",size:"sm",class:"min-w-[40px]",innerHTML:w.label},null,8,["onClick","disabled","variant","innerHTML"]))),128))])])):k("",!0)]))}},Xe={class:"fixed inset-0 z-[100]"},qe={class:"absolute inset-0 flex items-center justify-center p-2 sm:p-4"},Je={class:"bg-background p-4 sm:p-6 rounded-lg shadow-xl w-full sm:max-w-lg md:max-w-2xl lg:max-w-4xl overflow-y-auto max-h-[95vh] animate-in fade-in zoom-in-95 duration-200 border border-border"},Ye={class:"flex justify-between items-center mb-4"},Ke={class:"text-xl sm:text-2xl font-bold text-foreground flex items-center"},Qe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ze={class:"space-y-2"},Ie={class:"space-y-2"},es={class:"space-y-2 md:col-span-2"},ss={key:0,class:"text-destructive ml-1"},ts={class:"relative"},ls={key:0,class:"space-y-2 md:col-span-2"},ns=["value"],os={class:"grid grid-cols-1 md:grid-cols-2 gap-4 pt-2"},rs={class:"space-y-2"},is={class:"flex justify-between items-center"},as={class:"relative"},ds={class:"flex items-center space-x-2"},us={class:"relative w-full"},cs={class:"h-60 border rounded-md p-2 overflow-y-auto"},ms={key:0,class:"flex flex-col items-center justify-center h-full text-muted-foreground"},ps={class:"space-y-2"},fs={class:"flex justify-between items-center"},vs={class:"flex space-x-2"},gs={class:"relative"},xs={class:"flex items-center space-x-2"},bs={class:"relative w-full"},hs={class:"h-60 border rounded-md p-2 overflow-y-auto"},_s={class:"flex items-center justify-between mb-1"},ys={class:"font-medium text-sm text-foreground flex items-center"},ks={class:"flex space-x-1"},$s={key:0,class:"ml-2 text-xs px-2 py-0.5 rounded-full border border-gray-200 bg-gray-100 dark:border-gray-700 dark:bg-gray-800 text-gray-600 dark:text-gray-300"},ws={key:0,class:"flex flex-col items-center justify-center h-full text-muted-foreground"},Cs={class:"flex justify-end space-x-3 pt-4"},Ct=q({__name:"UserForm",props:{user:{type:Object,default:null},tenants:{type:Array,default:()=>[]},roles:{type:Array,default:()=>[]},permissions:{type:Array,default:()=>[]},isSuperAdmin:{type:Boolean,default:!1},tenantSlug:{type:String,default:null}},emits:["close","saved"],setup(_,{emit:S}){const r=_,v=S,t=X({name:r.user?r.user.name:"",email:r.user?r.user.email:"",password:r.user?r.user.password:"",tenant_id:r.user?r.user.tenant_id:r.tenants.length?r.tenants[0].id:null,roles:r.user&&r.user.roles?r.user.roles.map(o=>o.id):[],user_permissions:r.user&&r.user.permissions?r.user.permissions.map(o=>o.name):[]}),a=H(""),c=H(""),h=H(!1),A=T(()=>{if(!a.value.trim())return r.roles;const o=a.value.toLowerCase();return r.roles.filter(l=>l.name.toLowerCase().includes(o))}),R=T(()=>t.user_permissions.length);T(()=>{if(!c.value.trim())return r.permissions;const o=c.value.toLowerCase();return r.permissions.filter(l=>l.name.toLowerCase().includes(o))});const g=T(()=>{const o=new Set;return r.roles.forEach(l=>{t.roles.includes(l.id)&&l.permissions&&l.permissions.forEach(d=>{o.add(d.name)})}),Array.from(o)});I(()=>r.user,o=>{o?(t.name=o.name,t.email=o.email,t.password=o.password,t.tenant_id=o.tenant_id,t.roles=o.roles?o.roles.map(l=>l.id):[],t.user_permissions=o.permissions?o.permissions.map(l=>l.name):[]):(t.name="",t.email="",t.password="",t.tenant_id=r.tenants.length?r.tenants[0].id:null,t.roles=[],t.user_permissions=[])},{immediate:!0});const $=()=>{r.user?r.isSuperAdmin?t.put(route("admin.users.update",r.user),{onSuccess:()=>{v("saved")}}):t.put(route("users.update",[r.tenantSlug,r.user]),{onSuccess:()=>{v("saved")}}):r.isSuperAdmin?t.post(route("admin.users.store"),{onSuccess:()=>{v("saved")}}):t.post(route("users.store",r.tenantSlug),{onSuccess:()=>{v("saved")}})},w=o=>{const l=t.roles.indexOf(o);l===-1?t.roles.push(o):t.roles.splice(l,1)},E=o=>{if(g.value.includes(o))return;const l=t.user_permissions.indexOf(o);l===-1?t.user_permissions.push(o):t.user_permissions.splice(l,1)},L=()=>{r.permissions.forEach(o=>{!g.value.includes(o.name)&&!t.user_permissions.includes(o.name)&&t.user_permissions.push(o.name)})},N=()=>{t.user_permissions=[]},J=o=>{r.permissions.filter(d=>d.name.startsWith(o+".")).map(d=>d.name).forEach(d=>{!t.user_permissions.includes(d)&&!g.value.includes(d)&&t.user_permissions.push(d)})},F=o=>{t.user_permissions=t.user_permissions.filter(l=>!l.startsWith(o+"."))},G=T(()=>{const o=c.value.trim()?r.permissions.filter(d=>d.name.toLowerCase().includes(c.value.toLowerCase())):r.permissions,l={};return o.forEach(d=>{const j=d.name.split(".")[0];l[j]||(l[j]=[]),l[j].push(d)}),l}),x=o=>o==="tenant-settings"?"Tenant Settings":o==="repair-orders"?"Repair Orders":o==="safety-data"?"Safety Data":o==="miles-driven"?"Miles Driven":o==="support-tickets"?"Support Tickets":o==="sms-coaching"?"SMS Coaching":o==="support-responses"?"Support Responses":o==="receive_updates"?"General":o.charAt(0).toUpperCase()+o.slice(1),m=o=>{const l=o.split(".");return l.length>1?l[1].charAt(0).toUpperCase()+l[1].slice(1).replace(/-/g," "):o};return(o,l)=>(i(),p("div",Xe,[s("div",{class:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:l[0]||(l[0]=()=>v("close"))}),s("div",qe,[s("div",Je,[s("div",Ye,[s("h2",Ke,[n(e(ue),{class:"h-5 w-5 mr-2 text-primary"}),f(" "+y(_.user?"Edit User":"Create User"),1)]),n(e(b),{variant:"ghost",size:"icon",onClick:l[1]||(l[1]=()=>v("close"))},{default:u(()=>[n(e(B),{class:"h-5 w-5"})]),_:1})]),s("form",{onSubmit:ee($,["prevent"]),class:"space-y-4"},[s("div",Qe,[s("div",Ze,[n(e(U),{for:"name",class:"flex items-center"},{default:u(()=>l[12]||(l[12]=[s("span",null,"Name",-1),s("span",{class:"text-destructive ml-1"},"*",-1)])),_:1}),n(e(O),{id:"name",modelValue:e(t).name,"onUpdate:modelValue":l[2]||(l[2]=d=>e(t).name=d),placeholder:"Enter name",class:W(["w-full",{"border-destructive":e(t).errors.name}])},null,8,["modelValue","class"]),n(V,{message:e(t).errors.name},null,8,["message"])]),s("div",Ie,[n(e(U),{for:"email",class:"flex items-center"},{default:u(()=>l[13]||(l[13]=[s("span",null,"Email",-1),s("span",{class:"text-destructive ml-1"},"*",-1)])),_:1}),n(e(O),{id:"email",modelValue:e(t).email,"onUpdate:modelValue":l[3]||(l[3]=d=>e(t).email=d),type:"email",placeholder:"Enter email",class:W(["w-full",{"border-destructive":e(t).errors.email}])},null,8,["modelValue","class"]),n(V,{message:e(t).errors.email},null,8,["message"])]),s("div",es,[n(e(U),{for:"password",class:"flex items-center"},{default:u(()=>[l[14]||(l[14]=s("span",null,"Password",-1)),_.user?k("",!0):(i(),p("span",ss,"*"))]),_:1}),s("div",ts,[n(e(O),{id:"password",modelValue:e(t).password,"onUpdate:modelValue":l[4]||(l[4]=d=>e(t).password=d),type:h.value?"text":"password",placeholder:"Enter password",class:W(["w-full pr-10",{"border-destructive":e(t).errors.password}])},null,8,["modelValue","type","class"]),s("button",{type:"button",onClick:l[5]||(l[5]=d=>h.value=!h.value),class:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"},[h.value?(i(),C(e(me),{key:1,class:"h-5 w-5"})):(i(),C(e(ce),{key:0,class:"h-5 w-5"}))])]),n(V,{message:e(t).errors.password},null,8,["message"])]),_.isSuperAdmin?(i(),p("div",ls,[n(e(U),{for:"tenant"},{default:u(()=>l[15]||(l[15]=[f("Company Name")])),_:1}),re(s("select",{id:"tenant","onUpdate:modelValue":l[6]||(l[6]=d=>e(t).tenant_id=d),class:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"},[l[16]||(l[16]=s("option",{value:null},"None",-1)),(i(!0),p(z,null,P(_.tenants,d=>(i(),p("option",{value:d.id,key:d.id},y(d.name),9,ns))),128))],512),[[ie,e(t).tenant_id]]),n(V,{message:e(t).errors.tenant_id},null,8,["message"])])):k("",!0)]),s("div",os,[s("div",rs,[s("div",is,[n(e(U),{class:"flex items-center"},{default:u(()=>[n(e(se),{class:"h-4 w-4 mr-1 text-primary"}),l[17]||(l[17]=s("span",null,"Roles",-1)),n(e(M),{variant:"outline",class:"ml-2"},{default:u(()=>[f(y(e(t).roles.length)+" selected",1)]),_:1})]),_:1})]),s("div",as,[s("div",ds,[s("div",us,[n(e(Y),{class:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),n(e(O),{modelValue:a.value,"onUpdate:modelValue":l[7]||(l[7]=d=>a.value=d),placeholder:"Search roles...",class:"w-full pl-9"},null,8,["modelValue"])]),a.value?(i(),C(e(b),{key:0,type:"button",variant:"ghost",size:"icon",onClick:l[8]||(l[8]=d=>a.value=""),class:"absolute right-2 top-2"},{default:u(()=>[n(e(B),{class:"h-4 w-4"})]),_:1})):k("",!0)])]),s("div",cs,[(i(!0),p(z,null,P(A.value,d=>(i(),p("div",{key:d.id,class:"flex items-center py-1 px-2 hover:bg-muted/50 rounded transition-colors"},[n(e(Q),{id:`role-${d.id}`,checked:e(t).roles.includes(d.id),"onUpdate:checked":D=>w(d.id),class:"mr-2"},null,8,["id","checked","onUpdate:checked"]),n(e(U),{for:`role-${d.id}`,class:"cursor-pointer"},{default:u(()=>[f(y(d.name),1)]),_:2},1032,["for"])]))),128)),A.value.length===0?(i(),p("div",ms,[n(e(K),{class:"h-8 w-8 mb-2"}),l[18]||(l[18]=s("p",null,"No roles match your search",-1))])):k("",!0)]),n(V,{message:e(t).errors.roles},null,8,["message"])]),s("div",ps,[s("div",fs,[n(e(U),{class:"flex items-center"},{default:u(()=>[n(e(pe),{class:"h-4 w-4 mr-1 text-primary"}),l[19]||(l[19]=s("span",null,"Permissions",-1)),n(e(M),{variant:"outline",class:"ml-2"},{default:u(()=>[f(y(R.value)+" selected",1)]),_:1})]),_:1}),s("div",vs,[n(e(b),{type:"button",variant:"outline",size:"sm",onClick:L,class:"text-xs"},{default:u(()=>l[20]||(l[20]=[f(" Select All ")])),_:1}),n(e(b),{type:"button",variant:"outline",size:"sm",onClick:N,class:"text-xs"},{default:u(()=>l[21]||(l[21]=[f(" Clear All ")])),_:1})])]),s("div",gs,[s("div",xs,[s("div",bs,[n(e(Y),{class:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),n(e(O),{modelValue:c.value,"onUpdate:modelValue":l[9]||(l[9]=d=>c.value=d),placeholder:"Search permissions...",class:"w-full pl-9"},null,8,["modelValue"])]),c.value?(i(),C(e(b),{key:0,type:"button",variant:"ghost",size:"icon",onClick:l[10]||(l[10]=d=>c.value=""),class:"absolute right-2 top-2"},{default:u(()=>[n(e(B),{class:"h-4 w-4"})]),_:1})):k("",!0)])]),s("div",hs,[(i(!0),p(z,null,P(G.value,(d,D)=>(i(),p("div",{key:D,class:"mb-4"},[s("div",_s,[s("div",ys,[n(e(te),{class:"h-4 w-4 mr-1 text-muted-foreground"}),f(" "+y(x(D))+" ",1),n(e(M),{variant:"secondary",class:"ml-2"},{default:u(()=>[f(y(d.length),1)]),_:2},1024)]),s("div",ks,[n(e(b),{type:"button",variant:"ghost",size:"sm",onClick:j=>J(D),class:"text-xs h-6 px-2"},{default:u(()=>l[22]||(l[22]=[f(" Select All ")])),_:2},1032,["onClick"]),n(e(b),{type:"button",variant:"ghost",size:"sm",onClick:j=>F(D),class:"text-xs h-6 px-2"},{default:u(()=>l[23]||(l[23]=[f(" Clear ")])),_:2},1032,["onClick"])])]),(i(!0),p(z,null,P(d,j=>(i(),p("div",{key:j.id,class:"flex items-center py-1 px-2 hover:bg-muted/50 rounded transition-colors"},[n(e(Q),{id:`permission-${j.name}`,checked:e(t).user_permissions.includes(j.name),"onUpdate:checked":pt=>E(j.name),disabled:g.value.includes(j.name),class:"mr-2"},null,8,["id","checked","onUpdate:checked","disabled"]),n(e(U),{for:`permission-${j.name}`,class:"cursor-pointer text-sm"},{default:u(()=>[f(y(m(j.name))+" ",1),g.value.includes(j.name)?(i(),p("span",$s," inherited ")):k("",!0)]),_:2},1032,["for"])]))),128))]))),128)),Object.keys(G.value).length===0?(i(),p("div",ws,[n(e(K),{class:"h-8 w-8 mb-2"}),l[24]||(l[24]=s("p",null,"No permissions match your search",-1))])):k("",!0)]),n(V,{message:e(t).errors.user_permissions},null,8,["message"])])]),s("div",Cs,[n(e(b),{type:"button",onClick:l[11]||(l[11]=()=>v("close")),variant:"outline"},{default:u(()=>l[25]||(l[25]=[f(" Cancel ")])),_:1}),n(e(b),{type:"submit",disabled:e(t).processing},{default:u(()=>[e(t).processing?(i(),C(e(le),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):k("",!0),f(" "+y(e(t).processing?"Saving...":"Save"),1)]),_:1},8,["disabled"])])],32)])])]))}}),Ss={class:"w-full overflow-x-auto"},As={class:"rounded-md border"},js={class:"w-full caption-bottom text-sm"},zs={class:"[&_tr:last-child]:border-0"},Ps={class:"p-4 align-middle font-medium"},Us={class:"p-4 align-middle"},Es={class:"p-4 align-middle text-right"},Ls={class:"flex justify-end space-x-2"},Vs={key:0,class:"mt-6 flex justify-center"},Ts={class:"flex flex-wrap items-center gap-1 justify-center"},St={__name:"TenantList",props:{tenants:{type:Object,default:()=>({data:[],links:[]})}},setup(_){const S=_,r=Array.isArray(S.tenants)?S.tenants:S.tenants.data||[],v=t=>{t&&Z.get(t,{},{only:["tenants"]})};return(t,a)=>(i(),p("div",Ss,[s("div",As,[s("table",js,[a[2]||(a[2]=s("thead",{class:"[&_tr]:border-b"},[s("tr",{class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},[s("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Company Name"),s("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Slug"),s("th",{class:"h-12 px-4 text-right pr-16 align-middle font-medium text-muted-foreground"},"Actions")])],-1)),s("tbody",zs,[(i(!0),p(z,null,P(e(r),c=>(i(),p("tr",{key:c.id,class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},[s("td",Ps,y(c.name),1),s("td",Us,y(c.slug),1),s("td",Es,[s("div",Ls,[n(e(b),{onClick:h=>t.$emit("edit",c),variant:"outline",size:"sm"},{default:u(()=>a[0]||(a[0]=[f(" Edit ")])),_:2},1032,["onClick"]),n(e(b),{onClick:h=>t.$emit("delete",c),variant:"destructive",size:"sm"},{default:u(()=>a[1]||(a[1]=[f(" Delete ")])),_:2},1032,["onClick"])])])]))),128))])])]),_.tenants.links?(i(),p("div",Vs,[s("nav",Ts,[(i(!0),p(z,null,P(_.tenants.links,c=>(i(),C(e(b),{key:c.label,onClick:h=>v(c.url),disabled:!c.url,variant:c.active?"default":"outline",size:"sm",class:"min-w-[40px]",innerHTML:c.label},null,8,["onClick","disabled","variant","innerHTML"]))),128))])])):k("",!0)]))}},Os={class:"fixed inset-0 z-50"},Rs={class:"absolute inset-0 flex items-center justify-center p-2 sm:p-4"},Ds={class:"bg-background p-6 rounded-lg shadow-xl w-full max-w-md overflow-y-auto max-h-[90vh] animate-in fade-in zoom-in-95 duration-200 border border-border"},Ms={class:"flex justify-between items-center mb-4"},Ns={class:"text-2xl font-bold text-foreground"},Gs={class:"space-y-2"},Hs={key:0,class:"space-y-2"},Bs={class:"flex justify-end space-x-3 pt-4"},At=q({__name:"TenantForm",props:{tenant:{type:Object,default:null}},emits:["close","saved"],setup(_,{emit:S}){const r=_,v=S,t=X({name:r.tenant?r.tenant.name:"",slug:r.tenant?r.tenant.slug:""});I(()=>r.tenant,c=>{c?(t.name=c.name,t.slug=c.slug):(t.name="",t.slug="")},{immediate:!0});const a=()=>{r.tenant?t.put(route("admin.tenants.update",r.tenant),{onSuccess:()=>{v("saved")}}):t.post(route("admin.tenants.store"),{onSuccess:()=>{v("saved")}})};return(c,h)=>{const A=ne("X"),R=ne("Loader2");return i(),p("div",Os,[h[7]||(h[7]=s("div",{class:"absolute inset-0 bg-black/50 backdrop-blur-sm"},null,-1)),s("div",Rs,[s("div",Ds,[s("div",Ms,[s("h2",Ns,y(_.tenant?"Edit Company":"Create Company"),1),n(e(b),{variant:"ghost",size:"icon",onClick:h[0]||(h[0]=()=>v("close"))},{default:u(()=>[n(A,{class:"h-5 w-5"})]),_:1})]),s("form",{onSubmit:ee(a,["prevent"]),class:"space-y-4"},[s("div",Gs,[n(e(U),{for:"name"},{default:u(()=>h[4]||(h[4]=[f("Company Name")])),_:1}),n(e(O),{id:"name",modelValue:e(t).name,"onUpdate:modelValue":h[1]||(h[1]=g=>e(t).name=g),placeholder:"Enter company name",class:"w-full"},null,8,["modelValue"]),n(V,{message:e(t).errors.name},null,8,["message"])]),_.tenant?(i(),p("div",Hs,[n(e(U),{for:"slug"},{default:u(()=>h[5]||(h[5]=[f("Slug")])),_:1}),n(e(O),{id:"slug",modelValue:e(t).slug,"onUpdate:modelValue":h[2]||(h[2]=g=>e(t).slug=g),placeholder:"Enter company slug",class:"w-full"},null,8,["modelValue"]),n(V,{message:e(t).errors.slug},null,8,["message"])])):k("",!0),s("div",Bs,[n(e(b),{type:"button",onClick:h[3]||(h[3]=()=>v("close")),variant:"outline"},{default:u(()=>h[6]||(h[6]=[f(" Cancel ")])),_:1}),n(e(b),{type:"submit",disabled:e(t).processing},{default:u(()=>[e(t).processing?(i(),C(R,{key:0,class:"mr-2 h-4 w-4 animate-spin"})):k("",!0),f(" "+y(e(t).processing?"Saving...":"Save"),1)]),_:1},8,["disabled"])])],32)])])])}}}),Fs={class:"fixed inset-0 z-50"},Ws={class:"absolute inset-0 flex items-center justify-center p-2 sm:p-4"},Xs={class:"bg-background p-4 sm:p-6 rounded-lg shadow-xl w-full max-w-sm sm:max-w-md md:max-w-lg overflow-y-auto max-h-[95vh] animate-in fade-in zoom-in-95 duration-200 border border-border"},qs={class:"flex justify-between items-center mb-4"},Js={class:"text-xl sm:text-2xl font-bold text-foreground flex items-center"},Ys={class:"space-y-2"},Ks={class:"space-y-2"},Qs={class:"flex justify-between items-center"},Zs={class:"flex space-x-2"},Is={class:"relative"},et={class:"flex items-center space-x-2"},st={class:"relative w-full"},tt={class:"h-48 sm:h-56 md:h-64 border rounded-md p-2 overflow-y-auto"},lt={class:"flex items-center justify-between mb-1"},nt={class:"font-medium text-sm text-foreground flex items-center"},ot={class:"flex space-x-1"},rt={key:0,class:"flex flex-col items-center justify-center h-full text-muted-foreground"},it={class:"flex justify-end space-x-3 pt-4"},jt=q({__name:"RoleForm",props:{role:{type:Object,default:null},permissions:{type:Array,default:()=>[]},isSuperAdmin:{type:Boolean,default:!1},tenantSlug:{type:String,default:null}},emits:["saved","close"],setup(_,{emit:S}){var F,G;const r=S,v=_,{tenantSlug:t}=v,a=X({name:v.role?v.role.name:"",permissions:((G=(F=v.role)==null?void 0:F.permissions)==null?void 0:G.map(x=>x.name))||[]}),c=H(""),h=T(()=>a.permissions.length),A=T(()=>{const x=c.value.trim()?v.permissions.filter(o=>o.name.toLowerCase().includes(c.value.toLowerCase())):v.permissions,m={};return x.forEach(o=>{const d=o.name.split(".")[0];m[d]||(m[d]=[]),m[d].push(o)}),m}),R=x=>x==="tenant-settings"?"Tenant Settings":x==="repair-orders"?"Repair Orders":x==="safety-data"?"Safety Data":x==="miles-driven"?"Miles Driven":x==="support-tickets"?"Support Tickets":x==="sms-coaching"?"SMS Coaching":x==="support-responses"?"Support Responses":x==="receive_updates"?"General":x.charAt(0).toUpperCase()+x.slice(1),g=x=>{const m=x.split(".");return m.length>1?m[1].charAt(0).toUpperCase()+m[1].slice(1).replace(/-/g," "):x};I(()=>v.role,x=>{var m;x?(a.name=x.name,a.permissions=((m=x.permissions)==null?void 0:m.map(o=>o.name))||[]):(a.name="",a.permissions=[])},{immediate:!0});const $=x=>{const m=a.permissions.indexOf(x);m===-1?a.permissions.push(x):a.permissions.splice(m,1)},w=()=>{a.permissions=v.permissions.map(x=>x.name)},E=()=>{a.permissions=[]},L=x=>{v.permissions.filter(o=>o.name.startsWith(x+".")).map(o=>o.name).forEach(o=>{a.permissions.includes(o)||a.permissions.push(o)})},N=x=>{a.permissions=a.permissions.filter(m=>!m.startsWith(x+"."))},J=()=>{v.role?v.isSuperAdmin?a.put(route("admin.roles.update",v.role.id),{onSuccess:()=>{r("saved")}}):a.put(route("roles.update",[t,v.role.id]),{onSuccess:()=>{r("saved")}}):v.isSuperAdmin?a.post(route("admin.roles.store"),{onSuccess:()=>{r("saved")}}):a.post(route("roles.store",t),{onSuccess:()=>{r("saved")}})};return(x,m)=>(i(),p("div",Fs,[m[13]||(m[13]=s("div",{class:"absolute inset-0 bg-black/50 backdrop-blur-sm"},null,-1)),s("div",Ws,[s("div",Xs,[s("div",qs,[s("h2",Js,[n(e(se),{class:"h-5 w-5 mr-2 text-primary"}),f(" "+y(_.role?"Edit Role":"Create Role"),1)]),n(e(b),{variant:"ghost",size:"icon",onClick:m[0]||(m[0]=()=>r("close"))},{default:u(()=>[n(e(B),{class:"h-5 w-5"})]),_:1})]),s("form",{onSubmit:ee(J,["prevent"]),class:"space-y-4"},[s("div",Ys,[n(e(U),{for:"name",class:"flex items-center"},{default:u(()=>m[5]||(m[5]=[s("span",null,"Role Name",-1),s("span",{class:"text-destructive ml-1"},"*",-1)])),_:1}),n(e(O),{id:"name",modelValue:e(a).name,"onUpdate:modelValue":m[1]||(m[1]=o=>e(a).name=o),placeholder:"Enter role name",class:W(["w-full",{"border-destructive":e(a).errors.name}]),autofocus:""},null,8,["modelValue","class"]),n(V,{message:e(a).errors.name},null,8,["message"])]),s("div",Ks,[s("div",Qs,[n(e(U),{class:"flex items-center"},{default:u(()=>[m[6]||(m[6]=s("span",null,"Permissions",-1)),n(e(M),{variant:"outline",class:"ml-2"},{default:u(()=>[f(y(h.value)+" selected",1)]),_:1})]),_:1}),s("div",Zs,[n(e(b),{type:"button",variant:"outline",size:"sm",onClick:w,class:"text-xs"},{default:u(()=>m[7]||(m[7]=[f(" Select All ")])),_:1}),n(e(b),{type:"button",variant:"outline",size:"sm",onClick:E,class:"text-xs"},{default:u(()=>m[8]||(m[8]=[f(" Clear All ")])),_:1})])]),s("div",Is,[s("div",et,[s("div",st,[n(e(Y),{class:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),n(e(O),{modelValue:c.value,"onUpdate:modelValue":m[2]||(m[2]=o=>c.value=o),placeholder:"Search permissions...",class:"w-full pl-9"},null,8,["modelValue"])]),c.value?(i(),C(e(b),{key:0,type:"button",variant:"ghost",size:"icon",onClick:m[3]||(m[3]=o=>c.value=""),class:"absolute right-2 top-2"},{default:u(()=>[n(e(B),{class:"h-4 w-4"})]),_:1})):k("",!0)])]),s("div",tt,[(i(!0),p(z,null,P(A.value,(o,l)=>(i(),p("div",{key:l,class:"mb-4"},[s("div",lt,[s("div",nt,[n(e(te),{class:"h-4 w-4 mr-1 text-muted-foreground"}),f(" "+y(R(l))+" ",1),n(e(M),{variant:"secondary",class:"ml-2"},{default:u(()=>[f(y(o.length),1)]),_:2},1024)]),s("div",ot,[n(e(b),{type:"button",variant:"ghost",size:"sm",onClick:d=>L(l),class:"text-xs h-6 px-2"},{default:u(()=>m[9]||(m[9]=[f(" Select All ")])),_:2},1032,["onClick"]),n(e(b),{type:"button",variant:"ghost",size:"sm",onClick:d=>N(l),class:"text-xs h-6 px-2"},{default:u(()=>m[10]||(m[10]=[f(" Clear ")])),_:2},1032,["onClick"])])]),(i(!0),p(z,null,P(o,d=>(i(),p("div",{key:d.id,class:"flex items-center py-1 px-2 hover:bg-muted/50 rounded transition-colors"},[n(e(Q),{id:`permission-${d.name}`,checked:e(a).permissions.includes(d.name),"onUpdate:checked":D=>$(d.name),class:"mr-2"},null,8,["id","checked","onUpdate:checked"]),n(e(U),{for:`permission-${d.name}`,class:"cursor-pointer text-sm"},{default:u(()=>[f(y(g(d.name)),1)]),_:2},1032,["for"])]))),128))]))),128)),Object.keys(A.value).length===0?(i(),p("div",rt,[n(e(K),{class:"h-8 w-8 mb-2"}),m[11]||(m[11]=s("p",null,"No permissions match your search",-1))])):k("",!0)]),n(V,{message:e(a).errors.permissions},null,8,["message"])]),s("div",it,[n(e(b),{type:"button",onClick:m[4]||(m[4]=()=>r("close")),variant:"outline"},{default:u(()=>m[12]||(m[12]=[f(" Cancel ")])),_:1}),n(e(b),{type:"submit",disabled:e(a).processing},{default:u(()=>[e(a).processing?(i(),C(e(le),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):k("",!0),f(" "+y(e(a).processing?"Saving...":"Save"),1)]),_:1},8,["disabled"])])],32)])])]))}}),at={class:"fixed inset-0 flex items-center justify-center bg-black/50 backdrop-blur-sm z-50 p-4"},dt={class:"bg-background p-6 rounded-lg shadow-xl w-full max-w-md animate-in fade-in zoom-in-95 duration-200 border border-border"},ut={class:"flex flex-col space-y-4"},ct={class:"text-muted-foreground"},mt={class:"flex justify-end space-x-3 pt-2"},zt=q({__name:"ConfirmDeleteModal",props:{message:{type:String,default:"Are you sure you want to delete this item?"},deleteUrl:{type:String,required:!0},tenantSlug:{type:String,default:null}},emits:["cancel","confirmed"],setup(_,{emit:S}){const r=_,v=S,t=X({}),a=()=>{t.delete(r.deleteUrl,{onSuccess:()=>{v("confirmed")}})},c=()=>{v("cancel")};return(h,A)=>(i(),p("div",at,[s("div",dt,[s("div",ut,[A[1]||(A[1]=s("h2",{class:"text-xl font-bold text-foreground"},"Confirm Deletion",-1)),s("p",ct,y(_.message),1),s("div",mt,[n(e(b),{type:"button",onClick:c,variant:"outline"},{default:u(()=>A[0]||(A[0]=[f(" Cancel ")])),_:1}),n(e(b),{type:"button",variant:"destructive",onClick:a,disabled:e(t).processing},{default:u(()=>[e(t).processing?(i(),C(e(le),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):k("",!0),f(" "+y(e(t).processing?"Deleting...":"Delete"),1)]),_:1},8,["disabled"])])])])]))}});export{$t as _,wt as a,St as b,Ct as c,At as d,jt as e,zt as f};
