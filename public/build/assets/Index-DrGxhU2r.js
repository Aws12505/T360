import{c as X,r as _,w as Ce,A as Je,K as Ze,b as x,e as i,f as a,l as s,X as n,u as t,k as p,S as o,U as d,P as Ve,L as c,b2 as J,M as N,N as $,D as le,bF as Ne,Y as $e}from"./vendor-C-CW143M.js";import{_ as k}from"./Icon.vue_vue_type_script_setup_true_lang-B7IfTNIf.js";import{_ as fe,a as ve,b as B,c as M,d as xe,e as y}from"./TableRow.vue_vue_type_script_setup_true_lang-D19AmMrD.js";import{_ as g}from"./Button.vue_vue_type_script_setup_true_lang-B-CPTRto.js";import{_ as Z}from"./Card.vue_vue_type_script_setup_true_lang-Cp4wUgFE.js";import{_ as ee}from"./CardContent.vue_vue_type_script_setup_true_lang-DxPj8Tg7.js";import{b as ne,_ as re,a as oe}from"./DialogDescription.vue_vue_type_script_setup_true_lang-DjSCH9m8.js";import{_ as ie,a as de}from"./DialogTitle.vue_vue_type_script_setup_true_lang-BSj40beh.js";import{_ as _e}from"./DialogFooter.vue_vue_type_script_setup_true_lang-RSN6g_4k.js";import{_ as P}from"./Label.vue_vue_type_script_setup_true_lang-CZjK18aI.js";import{_ as R}from"./Input.vue_vue_type_script_setup_true_lang-taOxs2kk.js";import{b as ge,_ as ye,a as be}from"./AlertDescription.vue_vue_type_script_setup_true_lang-Bni7FoRm.js";import{_ as et}from"./AppLayout.vue_vue_type_script_setup_true_lang-D9jrdhXX.js";import{a as tt,x as ue,g as st,W as te}from"./vendor-vue-o4TX1eGc.js";import"./utils-CmSxFldp.js";import"./vendor-icons-Dyo-jBRF.js";import"./vendor-ui-DUlj4Wsf.js";import"./useInitials-DzeGKvtI.js";import"./app-ChvJRkE5.js";import"./vendor-axios-xsH4HHeE.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-C-8K70bD.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const at={class:"w-full md:max-w-2xl lg:max-w-3xl xl:max-w-6xl lg:mx-auto m-0 p-2 md:p-4 lg:p-6 space-y-2 md:space-y-4 lg:space-y-6"},lt={class:"w-full md:max-w-xl lg:max-w-2xl xl:max-w-6xl m-auto pt-2 space-y-2 md:space-y-4 lg:space-y-6"},nt={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-2"},rt={class:"flex flex-wrap gap-3"},ot={class:"flex flex-col items-center md:items-start gap-2"},it={class:"flex flex-wrap gap-1 md:gap-2"},dt={key:0,class:"text-sm text-muted-foreground"},ut={key:0},mt={key:1},ct={key:2},pt={key:3,class:"ml-1"},ft={class:"overflow-x-auto"},vt={class:"flex items-center justify-center"},xt=["checked"],_t={class:"flex items-center"},gt=["title"],yt={key:0,class:"ml-2"},bt={key:0,class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},wt={key:1,class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},kt={key:1,class:"ml-2 opacity-50"},ht=["value"],St={class:"text-xs italic text-gray-500 whitespace-normal"},Ct={class:"text-xs italic text-gray-500 whitespace-normal"},Vt={class:"text-xs italic text-gray-500 whitespace-normal"},Nt={class:"text-xs italic text-gray-500 whitespace-normal"},$t={class:"text-xs italic text-gray-500 whitespace-normal"},Pt={class:"text-xs italic text-gray-500 whitespace-normal"},Dt={class:"text-xs italic text-gray-500 whitespace-normal"},Mt={class:"flex space-x-2"},Ft={key:0,class:"border-t bg-muted/20 px-4 py-3"},At={class:"flex flex-col sm:flex-row justify-between items-center gap-2"},Tt={class:"flex items-center gap-4 text-sm text-muted-foreground"},Rt={class:"flex flex-col sm:flex-row items-center gap-2 sm:gap-4 w-full sm:w-auto"},Ut=["value"],Et={class:"flex flex-wrap"},Ot=["innerHTML"],Bt={key:0,class:"col-span-2"},jt={class:"relative mt-1"},It=["value"],Wt={class:"col-span-2 sm:col-span-1"},qt={class:"col-span-2 sm:col-span-1"},Lt={class:"col-span-2 sm:col-span-1"},zt={class:"col-span-2 sm:col-span-1"},Ht={class:"col-span-2 sm:col-span-1"},Yt={class:"col-span-2 sm:col-span-1"},Gt={class:"col-span-2 sm:col-span-1"},Kt={class:"col-span-2 sm:col-span-1"},Qt={class:"col-span-2 flex items-center gap-2"},Xt={class:"flex items-center gap-2"},Jt={class:"flex-1 overflow-y-auto px-4 sm:px-6 py-4"},Zt={key:0},es={class:"space-y-4"},ts={class:"flex flex-col items-center justify-center border-2 border-dashed rounded-lg p-8 bg-muted/20"},ss={class:"cursor-pointer"},as=["disabled"],ls={class:"flex items-center gap-2 text-sm text-muted-foreground"},ns=["href"],rs={key:0,class:"flex items-center justify-center gap-2 p-4"},os={key:1,class:"space-y-4"},is={key:0,class:"rounded-lg border p-3"},ds={class:"flex items-center justify-between"},us={class:"text-xs text-muted-foreground"},ms={class:"mt-2 flex flex-wrap gap-2"},cs={class:"grid grid-cols-3 gap-4"},ps={class:"text-2xl font-bold"},fs={class:"text-2xl font-bold text-green-600"},vs={class:"text-2xl font-bold text-red-600"},xs={key:2},_s={class:"flex items-center justify-between mb-3"},gs={class:"text-lg font-semibold text-red-600 flex items-center gap-2"},ys={class:"border rounded-lg overflow-hidden"},bs={class:"max-h-96 overflow-y-auto"},ws={class:"flex flex-wrap gap-x-3 gap-y-1"},ks={class:"font-medium text-foreground"},hs={key:0,class:"italic text-muted-foreground"},Ss={class:"space-y-1"},Cs={key:0,class:"text-xs text-muted-foreground"},Vs={key:3},Ns={class:"text-lg font-semibold text-green-600 flex items-center gap-2 mb-3"},$s={class:"border rounded-lg overflow-hidden"},Ps={class:"flex flex-wrap gap-x-3 gap-y-1"},Ds={class:"font-medium"},Ms={key:0,class:"italic text-muted-foreground"},Fs={class:"border-t p-4 flex justify-end gap-3"},As={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},sa={__name:"Index",props:{performances:{type:Object,default:()=>({data:[],links:[]})},tenantSlug:{type:String,default:null},SuperAdmin:{type:Boolean,default:!1},tenants:{type:Array,default:()=>[]},dateFilter:{type:String,default:"yesterday"},dateRange:{type:Object,default:()=>({label:"All Time"})},perPage:{type:Number,default:10},weekNumber:{type:Number,default:null},startWeekNumber:{type:Number,default:null},endWeekNumber:{type:Number,default:null},year:{type:Number,default:null},permissions:Array},setup(b){const u=b,we=X(()=>(h.value==="yesterday"||h.value==="current-week")&&u.weekNumber&&u.year?`Week ${u.weekNumber}, ${u.year}`:(h.value==="6w"||h.value==="quarterly")&&u.startWeekNumber&&u.endWeekNumber&&u.year?`Weeks ${u.startWeekNumber}-${u.endWeekNumber}, ${u.year}`:""),U=_(""),F=_(""),W=_(!1),me=_("Create Performance"),q=_("Create"),h=_(u.dateFilter||"full"),L=_(u.perPage||10),S=_([]),z=_(!1),H=_(!1),Y=_(null),ce=_(null),Pe=tt(),G=_(!1),f=_(null),j=_(!1),A=_(!1);function De(r){if(r){const e=new URL(r);e.searchParams.set("perPage",L.value),e.searchParams.set("dateFilter",h.value),te.get(e.href,{},{only:["performances"]})}}const K=_("date"),I=_("desc");_({search:"",dateFrom:"",dateTo:""});const Me=[{title:u.tenantSlug?"Dashboard":"Admin Dashboard",href:u.tenantSlug?route("dashboard",{tenantSlug:u.tenantSlug}):route("admin.dashboard")},{title:"Performance",href:u.tenantSlug?route("performance.index",{tenantSlug:u.tenantSlug}):route("performance.index.admin")}],pe=["date","acceptance","on_time_to_origin","on_time_to_destination","on_time","maintenance_variance_to_spend","open_boc","meets_safety_bonus_criteria","vcr_preventable","vmcr_p"],m=ue({tenant_id:null,date:"",acceptance:"",on_time_to_origin:"",on_time_to_destination:"",maintenance_variance_to_spend:"",open_boc:"",meets_safety_bonus_criteria:!1,vcr_preventable:"",vmcr_p:"",id:null}),Fe=ue({});ue({csv_file:null});const E=X(()=>{let r=[...u.performances.data];return r.sort((e,l)=>{let v=e[K.value],V=l[K.value];return v===null?1:V===null?-1:(typeof v=="string"&&(v=v.toLowerCase(),V=V.toLowerCase()),v<V?I.value==="asc"?-1:1:v>V?I.value==="asc"?1:-1:0)}),r});function Ae(r){K.value===r?I.value=I.value==="asc"?"desc":"asc":(K.value=r,I.value="asc")}function se(r){h.value=r;const e=u.tenantSlug?route("performance.index",{tenantSlug:u.tenantSlug}):route("performance.index.admin");te.get(e,{dateFilter:r,perPage:L.value},{preserveState:!0})}function Te(){const r=q.value==="Create",e=r?u.SuperAdmin?route("performance.store.admin"):route("performance.store",u.tenantSlug):u.SuperAdmin?route("performance.update.admin",[m.id]):route("performance.update",[u.tenantSlug,m.id]);m[r?"post":"put"](e,{onSuccess:()=>{F.value=r?"Performance created successfully.":"Performance updated successfully.",ke()},onError:()=>{alert("Something went wrong.")}})}function Re(){var e,l;if(E.value.length===0){U.value="No data available to export",setTimeout(()=>{U.value=""},3e3);return}const r=u.SuperAdmin?route("performance.export.admin"):route("performance.export",u.tenantSlug);(e=ce.value)==null||e.setAttribute("action",r),(l=ce.value)==null||l.submit()}Ce(F,r=>{r&&setTimeout(()=>{F.value=""},5e3)});function ae(r){if(!r)return"";const e=new Date(r+"T12:00:00"),l=e.getMonth()+1,v=e.getDate(),V=e.getFullYear();return`${l}/${v}/${V}`}function Ue(){me.value="Create Performance",q.value="Create",m.reset(),m.clearErrors(),u.SuperAdmin&&u.tenants.length>0&&(m.tenant_id=""),W.value=!0}function Ee(r){me.value="Edit Performance",q.value="Update",m.reset(),m.clearErrors(),m.id=r.id,m.tenant_id=r.tenant_id,m.date=r.date,m.acceptance=r.acceptance,m.on_time_to_origin=r.on_time_to_origin,m.on_time_to_destination=r.on_time_to_destination,m.maintenance_variance_to_spend=r.maintenance_variance_to_spend,m.open_boc=r.open_boc,m.meets_safety_bonus_criteria=r.meets_safety_bonus_criteria,m.vcr_preventable=r.vcr_preventable,m.vmcr_p=r.vmcr_p,W.value=!0}function ke(){W.value=!1,m.reset(),m.clearErrors()}function Oe(r){Y.value=r,H.value=!0}function Be(){if(!Y.value)return;const r=u.SuperAdmin?route("performance.destroy.admin",[Y.value]):route("performance.destroy",[u.tenantSlug,Y.value]);Fe.delete(r,{onSuccess:()=>{F.value="Performance deleted successfully.",H.value=!1,Y.value=null},onError:()=>{alert("Failed to delete performance record.")}})}const je=X(()=>E.value.length>0&&S.value.length===E.value.length);function Ie(r){r.target.checked?S.value=E.value.map(e=>e.id):S.value=[]}function We(){S.value.length>0&&(z.value=!0)}function qe(){const r=ue({ids:S.value}),e=u.SuperAdmin?"performance.destroyBulk.admin":"performance.destroyBulk",l=u.SuperAdmin?{}:{tenantSlug:u.tenantSlug};r.delete(route(e,l),{preserveScroll:!0,onSuccess:()=>{F.value=`${S.value.length} performance records deleted successfully.`,S.value=[],z.value=!1},onError:v=>{console.error(v)}})}const O=r=>{if(!r)return"Not Available";switch(r){case"gold":return"Gold Tier";case"silver":return"Silver Tier";case"not_eligible":return"Not Eligible";case"fantastic_plus":return"Fantastic +";case"fantastic":return"Fantastic";case"good":return"Good";case"fair":return"Fair";case"poor":return"Poor";default:return r}},he=_(!1),Le=X(()=>"/storage/upload-data-temps/Performances Template.csv");Je(()=>{const r=e=>{he.value&&!e.target.closest(".relative")&&(he.value=!1)};document.addEventListener("click",r),Ze(()=>{document.removeEventListener("click",r)})});const ze=r=>({on_time_to_origin:"OTO",on_time_to_destination:"OTD",maintenance_variance_to_spend:"MVtS",open_boc:"Open BOC",vcr_preventable:"VCR-P",vmcr_p:"VMCR-P"})[r]||r.replace(/_/g," ").split(" ").map(l=>l.charAt(0).toUpperCase()+l.slice(1)).join(" "),He=r=>({on_time_to_origin:"On Time to Origin",on_time_to_destination:"On Time to Destination",maintenance_variance_to_spend:"Maintenance Variance to Spend",open_boc:"Open BOC",vcr_preventable:"VCR Preventable",vmcr_p:"VMCR P"})[r]||r.replace(/_/g," ").split(" ").map(l=>l.charAt(0).toUpperCase()+l.slice(1)).join(" ");function Ye(){const r=u.tenantSlug?route("performance.index",{tenantSlug:u.tenantSlug}):route("performance.index.admin");te.get(r,{dateFilter:h.value,perPage:L.value},{preserveState:!0})}const Q=r=>{if(r==null)return"—";const e=typeof r=="string"?parseFloat(r):r;return Number.isInteger(e)||e.toFixed(2).endsWith(".00")?Math.floor(e):e.toFixed(2).endsWith("0")?e.toFixed(1):e.toFixed(2)},C=X(()=>u.permissions.map(r=>r.name));function Ge(r){var w;const e=r.target,l=(w=e.files)==null?void 0:w[0];if(!l)return;j.value=!0;const v=new FormData;v.append("file",l);const V=u.tenantSlug?route("performance.validateImport",{tenantSlug:u.tenantSlug}):route("performance.validateImport.admin");te.post(V,v,{forceFormData:!0,preserveScroll:!0,only:["flash"],onFinish:()=>{j.value=!1},onError:()=>{j.value=!1,U.value="Failed to validate CSV file"}}),e.value=""}function Ke(){if(!f.value||f.value.summary.invalid>0)return;A.value=!0;const r=u.tenantSlug?route("performance.confirmImport",{tenantSlug:u.tenantSlug}):route("performance.confirmImport.admin");te.post(r,{},{preserveScroll:!0,onSuccess:()=>{A.value=!1,F.value=`Successfully imported ${f.value.summary.valid} performances`,Se()},onError:()=>{A.value=!1,U.value="Failed to import performances"}})}function Qe(){const r=u.tenantSlug?route("performance.downloadErrorReport",{tenantSlug:u.tenantSlug}):route("performance.downloadErrorReport.admin");window.location.href=r}function Se(){G.value=!1,f.value=null,j.value=!1,A.value=!1}return Ce(()=>{var r;return(r=Pe.props.flash)==null?void 0:r.importValidation},r=>{if(r){if(r.results){f.value=r.results,r.header_error&&(f.value.header_error=r.header_error),G.value=!0;return}r.message&&(U.value=r.message)}},{immediate:!0}),(r,e)=>(i(),x(et,{breadcrumbs:Me,tenantSlug:b.tenantSlug,permissions:u.permissions},{default:a(()=>[s(t(st),{title:"Performance"}),n("div",at,[F.value?(i(),x(t(ge),{key:0,variant:"success"},{default:a(()=>[s(t(ye),null,{default:a(()=>e[25]||(e[25]=[o("Success")])),_:1}),s(t(be),null,{default:a(()=>[o(d(F.value),1)]),_:1})]),_:1})):p("",!0),U.value?(i(),x(t(ge),{key:1,variant:"destructive"},{default:a(()=>[s(t(ye),null,{default:a(()=>e[26]||(e[26]=[o("Error")])),_:1}),s(t(be),null,{default:a(()=>[o(d(U.value),1)]),_:1})]),_:1})):p("",!0),n("div",lt,[n("div",nt,[e[30]||(e[30]=n("h1",{class:"text-lg md:text-xl lg:text-2xl font-bold text-gray-800 dark:text-gray-200"}," Performance Management ",-1)),n("div",rt,[C.value.includes("performance.create")?(i(),x(t(g),{key:0,class:"px-2 py-0 md:px-4 md:py-2",onClick:Ue,variant:"default"},{default:a(()=>[s(k,{name:"plus",class:"mr-1 h-4 w-4 md:mr-2"}),e[27]||(e[27]=o(" Create New Performance "))]),_:1})):p("",!0),S.value.length>0&&C.value.includes("performance.delete")?(i(),x(t(g),{key:1,class:"px-2 py-0 md:px-4 md:py-2",onClick:e[0]||(e[0]=l=>We()),variant:"destructive"},{default:a(()=>[s(k,{name:"trash",class:"mr-1 h-4 w-4 md:mr-2"}),o(" Delete Selected ("+d(S.value.length)+") ",1)]),_:1})):p("",!0),C.value.includes("performance.import")?(i(),x(t(g),{key:2,onClick:e[1]||(e[1]=l=>G.value=!0),variant:"secondary",class:"px-2 py-0 md:px-4 md:py-2 shadow-sm hover:shadow transition-all"},{default:a(()=>[s(k,{name:"upload",class:"mr-1 h-4 w-4 md:mr-2"}),e[28]||(e[28]=o(" Import CSV "))]),_:1})):p("",!0),C.value.includes("performance.export")?(i(),x(t(g),{key:3,class:"px-2 py-0 md:px-4 md:py-2",onClick:Ve(Re,["prevent"]),variant:"outline"},{default:a(()=>[s(k,{name:"download",class:"mr-1 h-4 w-4 md:mr-2"}),e[29]||(e[29]=o(" Download CSV "))]),_:1})):p("",!0)])])]),s(t(Z),null,{default:a(()=>[s(t(ee),{class:"p-2 md:p-4 lg:p-6"},{default:a(()=>[n("div",ot,[n("div",it,[s(t(g),{onClick:e[2]||(e[2]=l=>se("yesterday")),variant:"outline",size:"sm",class:J({"border-primary bg-primary/10 text-primary":h.value==="yesterday"})},{default:a(()=>e[31]||(e[31]=[o(" Yesterday ")])),_:1},8,["class"]),s(t(g),{onClick:e[3]||(e[3]=l=>se("current-week")),variant:"outline",size:"sm",class:J({"border-primary bg-primary/10 text-primary":h.value==="current-week"})},{default:a(()=>e[32]||(e[32]=[o(" WTD ")])),_:1},8,["class"]),s(t(g),{onClick:e[4]||(e[4]=l=>se("6w")),variant:"outline",size:"sm",class:J({"border-primary bg-primary/10 text-primary":h.value==="6w"})},{default:a(()=>e[33]||(e[33]=[o(" T6W ")])),_:1},8,["class"]),s(t(g),{onClick:e[5]||(e[5]=l=>se("quarterly")),variant:"outline",size:"sm",class:J({"border-primary bg-primary/10 text-primary":h.value==="quarterly"})},{default:a(()=>e[34]||(e[34]=[o(" Quarterly ")])),_:1},8,["class"])]),b.dateRange?(i(),c("div",dt,[h.value==="yesterday"&&b.dateRange.start?(i(),c("span",ut," Showing data from "+d(ae(b.dateRange.start)),1)):b.dateRange.start&&b.dateRange.end?(i(),c("span",mt," Showing data from "+d(ae(b.dateRange.start))+" to "+d(ae(b.dateRange.end)),1)):(i(),c("span",ct,d(b.dateRange.label),1)),we.value?(i(),c("span",pt,"("+d(we.value)+")",1)):p("",!0)])):p("",!0)])]),_:1})]),_:1}),s(t(Z),{class:"mx-auto max-w-[95vw] md:max-w-[64vw] lg:max-w-full overflow-x-auto"},{default:a(()=>[s(t(ee),{class:"p-0"},{default:a(()=>[n("div",ft,[s(t(fe),{class:"relative h-[600px] overflow-auto"},{default:a(()=>[s(t(ve),null,{default:a(()=>[s(t(B),{class:"sticky top-0 z-10 border-b bg-background hover:bg-background"},{default:a(()=>[C.value.includes("performance.delete")?(i(),x(t(M),{key:0,class:"w-[50px]"},{default:a(()=>[n("div",vt,[n("input",{type:"checkbox",onChange:Ie,checked:je.value,class:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"},null,40,xt)])]),_:1})):p("",!0),b.SuperAdmin?(i(),x(t(M),{key:1},{default:a(()=>e[35]||(e[35]=[o("Company Name")])),_:1})):p("",!0),(i(),c(N,null,$(pe,l=>s(t(M),{key:l,class:"cursor-pointer",onClick:v=>Ae(l)},{default:a(()=>[n("div",_t,[n("span",{title:He(l)},d(ze(l)),9,gt),K.value===l?(i(),c("div",yt,[I.value==="asc"?(i(),c("svg",bt,e[36]||(e[36]=[n("path",{d:"M8 15l4-4 4 4"},null,-1)]))):(i(),c("svg",wt,e[37]||(e[37]=[n("path",{d:"M16 9l-4 4-4-4"},null,-1)])))])):(i(),c("div",kt,e[38]||(e[38]=[n("svg",{class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[n("path",{d:"M8 10l4-4 4 4"}),n("path",{d:"M16 14l-4 4-4-4"})],-1)])))])]),_:2},1032,["onClick"])),64)),C.value.includes("performance.update")||C.value.includes("performance.delete")?(i(),x(t(M),{key:2},{default:a(()=>e[39]||(e[39]=[o("Actions")])),_:1})):p("",!0)]),_:1})]),_:1}),s(t(xe),null,{default:a(()=>[E.value.length===0?(i(),x(t(B),{key:0},{default:a(()=>[s(t(y),{colspan:b.SuperAdmin?pe.length+3:pe.length+2,class:"py-8 text-center"},{default:a(()=>e[40]||(e[40]=[o(" No performance records found matching your criteria ")])),_:1},8,["colspan"])]),_:1})):p("",!0),(i(!0),c(N,null,$(E.value,l=>(i(),x(t(B),{key:l.id,class:"hover:bg-muted/50"},{default:a(()=>[C.value.includes("performance.delete")?(i(),x(t(y),{key:0,class:"text-center"},{default:a(()=>[le(n("input",{type:"checkbox",value:l.id,"onUpdate:modelValue":e[6]||(e[6]=v=>S.value=v),class:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"},null,8,ht),[[Ne,S.value]])]),_:2},1024)):p("",!0),b.SuperAdmin?(i(),x(t(y),{key:1,class:"min-w-[120px]"},{default:a(()=>{var v;return[o(d(((v=l.tenant)==null?void 0:v.name)??"—"),1)]}),_:2},1024)):p("",!0),s(t(y),{class:"min-w-[100px]"},{default:a(()=>[o(d(ae(l.date)),1)]),_:2},1024),s(t(y),{class:"min-w-[120px]"},{default:a(()=>[n("div",null,d(Q(l.acceptance))+"%",1),n("div",St," ("+d(O(l.acceptance_rating))+") ",1)]),_:2},1024),s(t(y),{class:"min-w-[120px]"},{default:a(()=>[o(d(Q(l.on_time_to_origin))+"%",1)]),_:2},1024),s(t(y),{class:"min-w-[120px]"},{default:a(()=>[o(d(Q(l.on_time_to_destination))+"%",1)]),_:2},1024),s(t(y),{class:"min-w-[120px]"},{default:a(()=>[n("div",null,d(Q(l.on_time))+"%",1),n("div",Ct," ("+d(O(l.on_time_rating))+") ",1)]),_:2},1024),s(t(y),{class:"min-w-[140px]"},{default:a(()=>[n("div",null,d(Q(l.maintenance_variance_to_spend))+"%",1),n("div",Vt," ("+d(O(l.maintenance_variance_to_spend_rating))+") ",1)]),_:2},1024),s(t(y),{class:"min-w-[120px]"},{default:a(()=>[n("div",null,d(l.open_boc),1),n("div",Nt," ("+d(O(l.open_boc_rating))+") ",1)]),_:2},1024),s(t(y),{class:"min-w-[140px]"},{default:a(()=>[n("div",null,d(l.meets_safety_bonus_criteria?"Yes":"No"),1),n("div",$t," ("+d(O(l.meets_safety_bonus_criteria_rating))+") ",1)]),_:2},1024),s(t(y),{class:"min-w-[120px]"},{default:a(()=>[n("div",null,d(l.vcr_preventable),1),n("div",Pt," ("+d(O(l.vcr_preventable_rating))+") ",1)]),_:2},1024),s(t(y),{class:"min-w-[120px]"},{default:a(()=>[n("div",null,d(l.vmcr_p),1),n("div",Dt," ("+d(O(l.vmcr_p_rating))+") ",1)]),_:2},1024),C.value.includes("performance.update")||C.value.includes("performance.delete")?(i(),x(t(y),{key:2,class:"min-w-[120px]"},{default:a(()=>[n("div",Mt,[C.value.includes("performance.update")?(i(),x(t(g),{key:0,onClick:v=>Ee(l),variant:"warning",size:"sm"},{default:a(()=>[s(k,{name:"pencil",class:"mr-1 h-4 w-4"}),e[41]||(e[41]=o(" Edit "))]),_:2},1032,["onClick"])):p("",!0),C.value.includes("performance.delete")?(i(),x(t(g),{key:1,onClick:v=>Oe(l.id),variant:"destructive",size:"sm"},{default:a(()=>[s(k,{name:"trash",class:"mr-1 h-4 w-4"}),e[42]||(e[42]=o(" Delete "))]),_:2},1032,["onClick"])):p("",!0)])]),_:2},1024)):p("",!0)]),_:2},1024))),128))]),_:1})]),_:1})]),b.performances.links?(i(),c("div",Ft,[n("div",At,[n("div",Tt,[n("span",null,"Showing "+d(E.value.length)+" of "+d(b.performances.data.length)+" entries",1),n("div",Rt,[e[43]||(e[43]=n("span",{class:"text-sm"},"Show:",-1)),le(n("select",{"onUpdate:modelValue":e[7]||(e[7]=l=>L.value=l),onChange:Ye,class:"h-8 rounded-md border border-input bg-background px-2 py-1 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2"},[(i(),c(N,null,$([10,25,50,100],l=>n("option",{key:l,value:l},d(l),9,Ut)),64))],544),[[$e,L.value]])])]),n("div",Et,[(i(!0),c(N,null,$(b.performances.links,l=>(i(),x(t(g),{key:l.label,onClick:v=>De(l.url),disabled:!l.url,variant:"ghost",size:"sm",class:J(["mx-1",{"border-primary bg-primary/10 text-primary":l.active}])},{default:a(()=>[n("span",{innerHTML:l.label},null,8,Ot)]),_:2},1032,["onClick","disabled","class"]))),128))])])])):p("",!0)]),_:1})]),_:1}),s(t(ne),{open:W.value,"onUpdate:open":e[18]||(e[18]=l=>W.value=l)},{default:a(()=>[s(t(re),{class:"max-w-[95vw] sm:max-w-[90vw] md:max-w-4xl"},{default:a(()=>[s(t(ie),{class:"px-4 sm:px-6"},{default:a(()=>[s(t(de),{class:"text-lg sm:text-xl"},{default:a(()=>[o(d(me.value),1)]),_:1}),s(t(oe),{class:"text-xs sm:text-sm"},{default:a(()=>[o(" Fill in the details to "+d(q.value.toLowerCase())+" a performance record. ",1)]),_:1})]),_:1}),n("form",{onSubmit:Ve(Te,["prevent"]),class:"grid max-h-[75vh] grid-cols-1 gap-2 overflow-y-auto p-4 sm:grid-cols-2 sm:gap-3 sm:p-6"},[b.SuperAdmin?(i(),c("div",Bt,[s(t(P),{for:"tenant",class:"text-xs sm:text-sm"},{default:a(()=>e[44]||(e[44]=[o("Company Name")])),_:1}),n("div",jt,[le(n("select",{id:"tenant","onUpdate:modelValue":e[8]||(e[8]=l=>t(m).tenant_id=l),required:"",class:"flex h-9 w-full appearance-none items-center rounded-md border border-input bg-background px-3 py-1 text-xs ring-offset-background focus:outline-none focus:ring-1 focus:ring-ring focus:ring-offset-1 disabled:cursor-not-allowed disabled:opacity-50 sm:h-10 sm:text-sm"},[e[45]||(e[45]=n("option",{disabled:"",value:""},"Select a Company",-1)),(i(!0),c(N,null,$(b.tenants,l=>(i(),c("option",{key:l.id,value:l.id},d(l.name),9,It))),128))],512),[[$e,t(m).tenant_id]]),e[46]||(e[46]=n("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-2 text-gray-700"},[n("svg",{class:"h-3 w-3 opacity-50 sm:h-4 sm:w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[n("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])],-1))])])):p("",!0),n("div",Wt,[s(t(P),{for:"date",class:"text-xs sm:text-sm"},{default:a(()=>e[47]||(e[47]=[o("Date")])),_:1}),s(t(R),{id:"date",modelValue:t(m).date,"onUpdate:modelValue":e[9]||(e[9]=l=>t(m).date=l),type:"date",required:"",class:"h-9 px-3 py-1 text-xs sm:h-10 sm:text-sm"},null,8,["modelValue"])]),n("div",qt,[s(t(P),{for:"acceptance",class:"text-xs sm:text-sm"},{default:a(()=>e[48]||(e[48]=[o("Acceptance")])),_:1}),s(t(R),{id:"acceptance",modelValue:t(m).acceptance,"onUpdate:modelValue":e[10]||(e[10]=l=>t(m).acceptance=l),type:"number",step:"0.01",required:"",class:"h-9 px-3 py-1 text-xs sm:h-10 sm:text-sm"},null,8,["modelValue"])]),n("div",Lt,[s(t(P),{for:"on_time_to_origin",class:"text-xs sm:text-sm"},{default:a(()=>e[49]||(e[49]=[o("On Time to Origin")])),_:1}),s(t(R),{id:"on_time_to_origin",modelValue:t(m).on_time_to_origin,"onUpdate:modelValue":e[11]||(e[11]=l=>t(m).on_time_to_origin=l),type:"number",step:"0.01",required:"",class:"h-9 px-3 py-1 text-xs sm:h-10 sm:text-sm"},null,8,["modelValue"])]),n("div",zt,[s(t(P),{for:"on_time_to_destination",class:"text-xs sm:text-sm"},{default:a(()=>e[50]||(e[50]=[o("On Time to Destination")])),_:1}),s(t(R),{id:"on_time_to_destination",modelValue:t(m).on_time_to_destination,"onUpdate:modelValue":e[12]||(e[12]=l=>t(m).on_time_to_destination=l),type:"number",step:"0.01",required:"",class:"h-9 px-3 py-1 text-xs sm:h-10 sm:text-sm"},null,8,["modelValue"])]),n("div",Ht,[s(t(P),{for:"maintenance_variance_to_spend",class:"text-xs sm:text-sm"},{default:a(()=>e[51]||(e[51]=[o("Maintenance Variance to Spend")])),_:1}),s(t(R),{id:"maintenance_variance_to_spend",modelValue:t(m).maintenance_variance_to_spend,"onUpdate:modelValue":e[13]||(e[13]=l=>t(m).maintenance_variance_to_spend=l),type:"number",step:"0.001",required:"",class:"h-9 px-3 py-1 text-xs sm:h-10 sm:text-sm"},null,8,["modelValue"])]),n("div",Yt,[s(t(P),{for:"open_boc",class:"text-xs sm:text-sm"},{default:a(()=>e[52]||(e[52]=[o("Open BOC")])),_:1}),s(t(R),{id:"open_boc",modelValue:t(m).open_boc,"onUpdate:modelValue":e[14]||(e[14]=l=>t(m).open_boc=l),type:"number",step:"1",required:"",class:"h-9 px-3 py-1 text-xs sm:h-10 sm:text-sm"},null,8,["modelValue"])]),n("div",Gt,[s(t(P),{for:"vcr_preventable",class:"text-xs sm:text-sm"},{default:a(()=>e[53]||(e[53]=[o("VCR Preventable")])),_:1}),s(t(R),{id:"vcr_preventable",modelValue:t(m).vcr_preventable,"onUpdate:modelValue":e[15]||(e[15]=l=>t(m).vcr_preventable=l),type:"number",step:"1",required:"",class:"h-9 px-3 py-1 text-xs sm:h-10 sm:text-sm"},null,8,["modelValue"])]),n("div",Kt,[s(t(P),{for:"vmcr_p",class:"text-xs sm:text-sm"},{default:a(()=>e[54]||(e[54]=[o("VMCR P")])),_:1}),s(t(R),{id:"vmcr_p",modelValue:t(m).vmcr_p,"onUpdate:modelValue":e[16]||(e[16]=l=>t(m).vmcr_p=l),type:"number",step:"1",required:"",class:"h-9 px-3 py-1 text-xs sm:h-10 sm:text-sm"},null,8,["modelValue"])]),n("div",Qt,[le(n("input",{id:"meets_safety_bonus_criteria","onUpdate:modelValue":e[17]||(e[17]=l=>t(m).meets_safety_bonus_criteria=l),type:"checkbox",class:"h-3.5 w-3.5 rounded border-gray-300 text-primary focus:ring-1 focus:ring-primary sm:h-4 sm:w-4"},null,512),[[Ne,t(m).meets_safety_bonus_criteria]]),s(t(P),{for:"meets_safety_bonus_criteria",class:"text-xs sm:text-sm"},{default:a(()=>e[55]||(e[55]=[o("Meets Safety Bonus Criteria")])),_:1})]),s(t(_e),{class:"col-span-2 mt-3 flex flex-col gap-2 sm:flex-row sm:gap-3"},{default:a(()=>[s(t(g),{type:"button",onClick:ke,variant:"outline",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:a(()=>e[56]||(e[56]=[o(" Cancel ")])),_:1}),s(t(g),{type:"submit",variant:"default",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:a(()=>[o(d(q.value),1)]),_:1})]),_:1})],32)]),_:1})]),_:1},8,["open"]),s(t(ne),{open:H.value,"onUpdate:open":e[20]||(e[20]=l=>H.value=l)},{default:a(()=>[s(t(re),{class:"max-w-[95vw] sm:max-w-md"},{default:a(()=>[s(t(ie),{class:"px-4 sm:px-6"},{default:a(()=>[s(t(de),{class:"text-lg sm:text-xl"},{default:a(()=>e[57]||(e[57]=[o("Confirm Deletion")])),_:1}),s(t(oe),{class:"text-xs sm:text-sm"},{default:a(()=>e[58]||(e[58]=[o(" Are you sure you want to delete this performance record? This action cannot be undone. ")])),_:1})]),_:1}),s(t(_e),{class:"px-4 sm:px-6"},{default:a(()=>[s(t(g),{type:"button",onClick:e[19]||(e[19]=l=>H.value=!1),variant:"outline",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:a(()=>e[59]||(e[59]=[o(" Cancel ")])),_:1}),s(t(g),{type:"button",onClick:Be,variant:"destructive",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:a(()=>e[60]||(e[60]=[o(" Delete ")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),s(t(ne),{open:z.value,"onUpdate:open":e[23]||(e[23]=l=>z.value=l)},{default:a(()=>[s(t(re),{class:"max-w-[95vw] sm:max-w-md"},{default:a(()=>[s(t(ie),{class:"px-4 sm:px-6"},{default:a(()=>[s(t(de),{class:"text-lg sm:text-xl"},{default:a(()=>e[61]||(e[61]=[o("Confirm Bulk Deletion")])),_:1}),s(t(oe),{class:"text-xs sm:text-sm"},{default:a(()=>[o(" Are you sure you want to delete "+d(S.value.length)+" performance records? This action cannot be undone. ",1)]),_:1})]),_:1}),s(t(_e),{class:"px-4 sm:px-6"},{default:a(()=>[s(t(g),{type:"button",onClick:e[21]||(e[21]=l=>z.value=!1),variant:"outline",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:a(()=>e[62]||(e[62]=[o(" Cancel ")])),_:1}),s(t(g),{type:"button",onClick:e[22]||(e[22]=l=>qe()),variant:"destructive",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:a(()=>e[63]||(e[63]=[o(" Delete Selected ")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),s(t(ne),{open:G.value,"onUpdate:open":e[24]||(e[24]=l=>G.value=l)},{default:a(()=>[s(t(re),{class:"max-w-[95vw] sm:max-w-[90vw] md:max-w-5xl max-h-[90vh] overflow-hidden flex flex-col"},{default:a(()=>{var l,v,V;return[s(t(ie),{class:"px-4 sm:px-6 border-b pb-3"},{default:a(()=>[n("div",Xt,[s(k,{name:"upload",class:"h-5 w-5 text-primary"}),s(t(de),{class:"text-lg sm:text-xl font-semibold"},{default:a(()=>e[64]||(e[64]=[o(" Import Rejections ")])),_:1})]),s(t(oe),{class:"text-xs sm:text-sm mt-1 text-muted-foreground"},{default:a(()=>e[65]||(e[65]=[o(" Upload a CSV file to import rejections. The file will be validated before import. ")])),_:1})]),_:1}),n("div",Jt,[f.value?(i(),c("div",os,[(l=f.value.headers)!=null&&l.length?(i(),c("div",is,[n("div",ds,[e[69]||(e[69]=n("div",{class:"text-sm font-semibold"},"CSV Headers",-1)),n("div",us,d(f.value.headers.length)+" columns ",1)]),n("div",ms,[(i(!0),c(N,null,$(f.value.headers,w=>(i(),c("span",{key:w,class:"rounded-full bg-muted px-2 py-0.5 text-xs"},d(w),1))),128))])])):p("",!0),n("div",cs,[s(t(Z),{class:"border-2"},{default:a(()=>[s(t(ee),{class:"p-4 text-center"},{default:a(()=>[n("div",ps,d(f.value.summary.total),1),e[70]||(e[70]=n("div",{class:"text-sm text-muted-foreground"},"Total Rows",-1))]),_:1})]),_:1}),s(t(Z),{class:"border-2 border-green-500/50 bg-green-50 dark:bg-green-900/10"},{default:a(()=>[s(t(ee),{class:"p-4 text-center"},{default:a(()=>[n("div",fs,d(f.value.summary.valid),1),e[71]||(e[71]=n("div",{class:"text-sm text-muted-foreground"},"Valid",-1))]),_:1})]),_:1}),s(t(Z),{class:"border-2 border-red-500/50 bg-red-50 dark:bg-red-900/10"},{default:a(()=>[s(t(ee),{class:"p-4 text-center"},{default:a(()=>[n("div",vs,d(f.value.summary.invalid),1),e[72]||(e[72]=n("div",{class:"text-sm text-muted-foreground"},"Invalid",-1))]),_:1})]),_:1})]),f.value.header_error?(i(),x(t(ge),{key:1,variant:"destructive"},{default:a(()=>[s(t(ye),{class:"flex items-center gap-2"},{default:a(()=>[s(k,{name:"alert_circle",class:"h-5 w-5"}),e[73]||(e[73]=o(" Header Error "))]),_:1}),s(t(be),null,{default:a(()=>[o(d(f.value.header_error),1)]),_:1})]),_:1})):p("",!0),(v=f.value.invalid)!=null&&v.length?(i(),c("div",xs,[n("div",_s,[n("h3",gs,[s(k,{name:"alert-triangle",class:"h-5 w-5"}),o(" Validation Errors ("+d(f.value.invalid.length)+") ",1)]),s(t(g),{onClick:Qe,variant:"outline",size:"sm",class:"flex items-center gap-2"},{default:a(()=>[s(k,{name:"download",class:"h-4 w-4"}),e[74]||(e[74]=o(" Download Error Report "))]),_:1})]),n("div",ys,[n("div",bs,[s(t(fe),null,{default:a(()=>[s(t(ve),{class:"sticky top-0 bg-background"},{default:a(()=>[s(t(B),null,{default:a(()=>[s(t(M),{class:"w-20"},{default:a(()=>e[75]||(e[75]=[o("Row #")])),_:1}),s(t(M),null,{default:a(()=>e[76]||(e[76]=[o("Preview")])),_:1}),s(t(M),null,{default:a(()=>e[77]||(e[77]=[o("Errors")])),_:1})]),_:1})]),_:1}),s(t(xe),null,{default:a(()=>[(i(!0),c(N,null,$(f.value.invalid,w=>(i(),x(t(B),{key:w.rowNumber,class:"hover:bg-muted/50"},{default:a(()=>[s(t(y),{class:"font-medium"},{default:a(()=>[o(d(w.rowNumber),1)]),_:2},1024),s(t(y),{class:"text-sm text-muted-foreground"},{default:a(()=>{var T;return[n("div",ws,[(i(!0),c(N,null,$(w.preview||[],D=>(i(),c("span",{key:D.key,class:"whitespace-nowrap"},[n("span",ks,d(D.label)+": ",1),o(" "+d(D.value),1)]))),128)),(T=w.preview)!=null&&T.length?p("",!0):(i(),c("span",hs," — "))])]}),_:2},1024),s(t(y),null,{default:a(()=>{var T;return[n("div",Ss,[(i(!0),c(N,null,$(w.errors||[],(D,Xe)=>(i(),c("div",{key:Xe,class:"text-xs text-red-600 flex items-start gap-1"},[s(k,{name:"x-circle",class:"h-3 w-3 mt-0.5 flex-shrink-0"}),n("span",null,d(D),1)]))),128)),(T=w.errors)!=null&&T.length?p("",!0):(i(),c("div",Cs," — "))])]}),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])])])):p("",!0),(V=f.value.valid)!=null&&V.length?(i(),c("div",Vs,[n("h3",Ns,[s(k,{name:"check-circle",class:"h-5 w-5"}),o(" Valid Rows ("+d(f.value.valid.length)+") ",1)]),e[80]||(e[80]=n("div",{class:"text-sm text-muted-foreground mb-2"}," Showing first 5 valid rows ",-1)),n("div",$s,[s(t(fe),null,{default:a(()=>[s(t(ve),null,{default:a(()=>[s(t(B),null,{default:a(()=>[s(t(M),null,{default:a(()=>e[78]||(e[78]=[o("Row #")])),_:1}),s(t(M),null,{default:a(()=>e[79]||(e[79]=[o("Preview")])),_:1})]),_:1})]),_:1}),s(t(xe),null,{default:a(()=>[(i(!0),c(N,null,$(f.value.valid.slice(0,5),w=>(i(),x(t(B),{key:w.rowNumber},{default:a(()=>[s(t(y),{class:"font-medium"},{default:a(()=>[o(d(w.rowNumber),1)]),_:2},1024),s(t(y),{class:"text-sm"},{default:a(()=>{var T;return[n("div",Ps,[(i(!0),c(N,null,$(w.preview||[],D=>(i(),c("span",{key:D.key,class:"whitespace-nowrap"},[n("span",Ds,d(D.label)+":",1),o(" "+d(D.value),1)]))),128)),(T=w.preview)!=null&&T.length?p("",!0):(i(),c("span",Ms," — "))])]}),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])])):p("",!0)])):(i(),c("div",Zt,[n("div",es,[n("div",ts,[s(k,{name:"file-spreadsheet",class:"h-12 w-12 text-muted-foreground mb-3"}),n("label",ss,[e[66]||(e[66]=n("span",{class:"text-sm font-medium text-primary hover:underline"}," Choose CSV file ",-1)),n("input",{type:"file",class:"hidden",onChange:Ge,accept:".csv",disabled:j.value},null,40,as)]),e[67]||(e[67]=n("p",{class:"text-xs text-muted-foreground mt-2"},"or drag and drop",-1))]),n("div",ls,[s(k,{name:"info",class:"h-4 w-4"}),n("a",{href:Le.value,download:"",class:"text-primary hover:underline"}," Download CSV Template ",8,ns)]),j.value?(i(),c("div",rs,e[68]||(e[68]=[n("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"},null,-1),n("span",{class:"text-sm text-muted-foreground"},"Validating CSV file...",-1)]))):p("",!0)])]))]),n("div",Fs,[s(t(g),{onClick:Se,variant:"outline",disabled:A.value},{default:a(()=>e[81]||(e[81]=[o(" Close ")])),_:1},8,["disabled"]),f.value&&f.value.summary.valid>0?(i(),x(t(g),{key:0,onClick:Ke,variant:"default",disabled:A.value||f.value.summary.invalid>0||!!f.value.header_error,class:"flex items-center gap-2"},{default:a(()=>[A.value?(i(),c("div",As)):(i(),x(k,{key:1,name:"check",class:"h-4 w-4"})),o(" "+d(A.value?"Importing...":`Import ${f.value.summary.valid} Rows`),1)]),_:1},8,["disabled"])):p("",!0)])]}),_:1})]),_:1},8,["open"]),n("form",{ref_key:"exportForm",ref:ce,method:"GET",class:"hidden"},null,512)])]),_:1},8,["tenantSlug","permissions"]))}};export{sa as default};
