import{d as lt,w as pe,F as c,e as r,X as t,E as x,z as a,f as s,S as i,C as E,Y as L,u as o,H as k,O as W,U as y,G as De,c as T,aj as I,a3 as at,r as S,y as Se,am as st,b as C,N as nt,ai as ot}from"./vendor-Bl7QtHDZ.js";import{x as K,g as rt,W as Y}from"./vendor-vue-CegDyOO_.js";import{_ as de}from"./Input.vue_vue_type_script_setup_true_lang-DqmS51Fd.js";import{_}from"./Button.vue_vue_type_script_setup_true_lang-CmY1RpaM.js";import{_ as dt}from"./Checkbox.vue_vue_type_script_setup_true_lang-C-_iCp7E.js";import{_ as O}from"./Label.vue_vue_type_script_setup_true_lang-B8UEvjKs.js";import{_ as V}from"./Icon.vue_vue_type_script_setup_true_lang-BJi62zlW.js";import{_ as it}from"./Badge.vue_vue_type_script_setup_true_lang-DAxI-zSb.js";import{_ as ut,a as mt,b as ve,c as ce,d as ct,e as le}from"./TableRow.vue_vue_type_script_setup_true_lang-KQhoIeb8.js";import{_ as ye}from"./Card.vue_vue_type_script_setup_true_lang-1bmPyW_M.js";import{_ as ft}from"./CardHeader.vue_vue_type_script_setup_true_lang-ClIdJ-mv.js";import{_ as pt}from"./CardTitle.vue_vue_type_script_setup_true_lang-XdmNMyNj.js";import{_ as ge}from"./CardContent.vue_vue_type_script_setup_true_lang-OyO0HbpV.js";import{d as ae,_ as se,a as ne,b as oe,c as re}from"./DialogDescription.vue_vue_type_script_setup_true_lang-DgoW0lMR.js";import{_ as fe}from"./DialogFooter.vue_vue_type_script_setup_true_lang-s8KRtoEt.js";import{b as ke,_ as he,a as Ce}from"./AlertDescription.vue_vue_type_script_setup_true_lang-BVCBG5Mg.js";import{_ as vt}from"./AppLayout.vue_vue_type_script_setup_true_lang-B3VuTBxW.js";import"./vendor-axios-xsH4HHeE.js";import"./utils-DnnPsXYS.js";import"./vendor-ui-B_LrUle4.js";import"./vendor-icons-coAGW0bc.js";import"./useInitials-DzeGKvtI.js";import"./app-CPpeenTW.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BGaPs1OX.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const yt={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},gt={key:0,class:"col-span-full"},xt={class:"relative"},bt=["value"],_t={class:"col-span-full"},wt={class:"relative"},kt={class:"relative"},ht={class:"relative"},Ct=["value"],Dt={class:"relative"},St={class:"flex items-center space-x-2"},$t={class:"flex-col space-y-2 sm:space-y-0 sm:flex-row sm:justify-end sm:space-x-2 pt-4 border-t flex"},Tt=lt({__name:"DelayForm",props:{delay:{type:Object,default:null},delayCodes:{type:Array,default:()=>[]},tenants:{type:Array,default:()=>[]},isSuperAdmin:{type:Boolean,default:!1},tenantSlug:{type:String,default:null}},emits:["close"],setup(f,{emit:n}){var D,h,M,$,q,A,P;const b=f,j=n,p=K({id:(D=b.delay)==null?void 0:D.id,tenant_id:b.isSuperAdmin?(h=b.delay)==null?void 0:h.tenant_id:null,date:((M=b.delay)==null?void 0:M.date)||"",driver_name:(($=b.delay)==null?void 0:$.driver_name)||"",delay_type:((q=b.delay)==null?void 0:q.delay_type)||"origin",delay_category:((A=b.delay)==null?void 0:A.delay_category)||"1_120",delay_code_id:((P=b.delay)==null?void 0:P.delay_code_id)||null,disputed:b.delay&&b.delay.disputed!==null?parseInt(b.delay.disputed)===1:!1,driver_controllable:b.delay&&b.delay.driver_controllable!==null?parseInt(b.delay.driver_controllable)===1:null});pe(()=>b.delay,w=>{w?(p.id=w.id,p.tenant_id=w.tenant_id,p.date=w.date,p.driver_name=w.driver_name,p.delay_type=w.delay_type,p.delay_category=w.delay_category,p.delay_code_id=w.delay_code_id,p.disputed=w.disputed!==null?parseInt(w.disputed)===1:!1,p.driver_controllable=w.driver_controllable!==null?parseInt(w.driver_controllable)===1:null):p.reset()},{immediate:!0});const F=()=>{const w=!!p.id,m=b.isSuperAdmin?w?"ontime.update.admin":"ontime.store.admin":w?"ontime.update":"ontime.store",u=b.isSuperAdmin?w?{delay:p.id}:{}:w?{tenantSlug:b.tenantSlug,delay:p.id}:{tenantSlug:b.tenantSlug};p[w?"put":"post"](route(m,u),{onSuccess:()=>j("close")})};return(w,m)=>(r(),c("form",{onSubmit:De(F,["prevent"]),class:"space-y-6"},[t("div",yt,[f.isSuperAdmin?(r(),c("div",gt,[a(O,null,{default:s(()=>m[9]||(m[9]=[i("Company Name")])),_:1}),t("div",xt,[E(t("select",{"onUpdate:modelValue":m[0]||(m[0]=u=>o(p).tenant_id=u),class:"flex h-10 w-full items-center rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 appearance-none"},[m[10]||(m[10]=t("option",{value:null,disabled:""},"Select Company",-1)),(r(!0),c(k,null,W(f.tenants,u=>(r(),c("option",{key:u.id,value:u.id},y(u.name),9,bt))),128))],512),[[L,o(p).tenant_id]]),m[11]||(m[11]=t("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[t("svg",{class:"h-4 w-4 opacity-50",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])],-1))])])):x("",!0),t("div",_t,[a(O,null,{default:s(()=>m[12]||(m[12]=[i("Date")])),_:1}),a(de,{type:"date",modelValue:o(p).date,"onUpdate:modelValue":m[1]||(m[1]=u=>o(p).date=u),class:"w-full"},null,8,["modelValue"])]),t("div",null,[a(O,null,{default:s(()=>m[13]||(m[13]=[i("Driver Name")])),_:1}),a(de,{modelValue:o(p).driver_name,"onUpdate:modelValue":m[2]||(m[2]=u=>o(p).driver_name=u),class:"w-full"},null,8,["modelValue"])]),t("div",null,[a(O,null,{default:s(()=>m[14]||(m[14]=[i("Delay Type")])),_:1}),t("div",wt,[E(t("select",{"onUpdate:modelValue":m[3]||(m[3]=u=>o(p).delay_type=u),class:"flex h-10 w-full items-center rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 appearance-none"},m[15]||(m[15]=[t("option",{value:"origin"},"Origin",-1),t("option",{value:"destination"},"Destination",-1)]),512),[[L,o(p).delay_type]]),m[16]||(m[16]=t("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[t("svg",{class:"h-4 w-4 opacity-50",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])],-1))])]),t("div",null,[a(O,null,{default:s(()=>m[17]||(m[17]=[i("Delay Category")])),_:1}),t("div",kt,[E(t("select",{"onUpdate:modelValue":m[4]||(m[4]=u=>o(p).delay_category=u),class:"flex h-10 w-full items-center rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 appearance-none"},m[18]||(m[18]=[t("option",{value:"1_120"},"1–120 min",-1),t("option",{value:"121_600"},"121–600 min",-1),t("option",{value:"601_plus"},"601+ min",-1)]),512),[[L,o(p).delay_category]]),m[19]||(m[19]=t("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[t("svg",{class:"h-4 w-4 opacity-50",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])],-1))])]),t("div",null,[a(O,null,{default:s(()=>m[20]||(m[20]=[i("Delay Code")])),_:1}),t("div",ht,[E(t("select",{"onUpdate:modelValue":m[5]||(m[5]=u=>o(p).delay_code_id=u),class:"flex h-10 w-full items-center rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 appearance-none"},[(r(!0),c(k,null,W(f.delayCodes,u=>(r(),c("option",{key:u.id,value:u.id},y(u.code),9,Ct))),128))],512),[[L,o(p).delay_code_id]]),m[21]||(m[21]=t("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[t("svg",{class:"h-4 w-4 opacity-50",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])],-1))])]),t("div",null,[a(O,null,{default:s(()=>m[22]||(m[22]=[i("Driver Controllable")])),_:1}),t("div",Dt,[E(t("select",{"onUpdate:modelValue":m[6]||(m[6]=u=>o(p).driver_controllable=u),class:"flex h-10 w-full items-center rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 appearance-none"},m[23]||(m[23]=[t("option",{value:null},"N/A",-1),t("option",{value:!0},"Yes",-1),t("option",{value:!1},"No",-1)]),512),[[L,o(p).driver_controllable]]),m[24]||(m[24]=t("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[t("svg",{class:"h-4 w-4 opacity-50",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])],-1))])]),t("div",St,[a(dt,{checked:o(p).disputed,"onUpdate:checked":m[7]||(m[7]=u=>o(p).disputed=u),id:"disputed"},null,8,["checked"]),a(O,{for:"disputed"},{default:s(()=>m[25]||(m[25]=[i("Disputed")])),_:1})])]),t("div",$t,[a(_,{type:"button",onClick:m[8]||(m[8]=u=>j("close")),variant:"outline",class:"w-full sm:w-auto"},{default:s(()=>m[26]||(m[26]=[i(" Cancel ")])),_:1}),a(_,{type:"submit",disabled:o(p).processing,class:"w-full sm:w-auto"},{default:s(()=>[i(y(o(p).id?"Update":"Create"),1)]),_:1},8,["disabled"])])],32))}}),Nt={class:"bg-background rounded-lg border shadow-sm p-2 md:p-4 lg:p-6 flex flex-col items-center justify-center"},At={class:"text-base font-semibold mb-2 text-foreground"},Ft={__name:"TotalLateStops",props:{title:{type:String,required:!0},value:{type:[Number,String],required:!0}},setup(f){const n=f,b=T(()=>n.value===null||n.value===void 0||n.value===""?"No Data":n.value),j=T(()=>{const p=Number(n.value);return n.title.toLowerCase().includes("total")&&p>0});return(p,F)=>(r(),c("div",Nt,[t("h3",At,y(f.title),1),t("p",{class:I(["text-2xl font-bold",j.value?"text-red-600":"text-primary"])},y(b.value),3)]))}},Ot={class:"bg-background rounded-lg border shadow-sm p-2 md:p-4"},Mt={class:"text-base text-center font-semibold mb-2 md:mb-4"},Ut={key:0,class:"text-center text-sm py-4 text-primary font-medium"},Vt={class:"space-y-3"},jt={class:"text-sm"},zt={__name:"BottomDrivers",props:{title:{type:String,default:"Bottom 5 Drivers"},drivers:{type:Array,default:()=>[]},delayType:{type:String,default:""},totalDelays:{type:Number,default:-1}},setup(f){const n=f,b=j=>{const p=["#ef4444","#f97316","#f59e0b","#84cc16","#10b981"],D=[...n.drivers].sort((h,M)=>M.total_penalty-h.total_penalty).map(h=>h.total_penalty).indexOf(j);return p[D]||"#6b7280"};return(j,p)=>(r(),c("div",Ot,[t("h3",Mt,y(f.title),1),f.drivers.length===0?(r(),c("div",Ut,[f.totalDelays===0?(r(),c(k,{key:0},[f.delayType==="origin"?(r(),c(k,{key:0},[i(" No origin delays recorded. You're on track for Fantastic+ ! ")],64)):f.delayType==="destination"?(r(),c(k,{key:1},[i(" No destination delays recorded. You're on track for Fantastic+ ! ")],64)):(r(),c(k,{key:2},[i(" No delays recorded. You're on track for Fantastic+ ! ")],64))],64)):(r(),c(k,{key:1},[i(" No delays recorded. You're on track for Fantastic+ ! ")],64))])):(r(),c(k,{key:1},[p[0]||(p[0]=t("div",{class:"flex justify-between items-center mb-2"},[t("span",{class:"text-base mb-2 font-medium"},"Driver Name"),t("span",{class:"text-base mb-2 font-medium"},"Total Penalty")],-1)),t("div",Vt,[(r(!0),c(k,null,W(f.drivers,(F,D)=>(r(),c("div",{key:D,class:"flex justify-between items-center"},[t("span",jt,y(F.driver_name),1),t("span",{class:"text-sm font-medium",style:at({color:b(F.total_penalty)})},y(F.total_penalty),5)]))),128))])],64))]))}},Pt={class:"bg-background rounded-lg border shadow-sm p-2 md:p-4"},Bt={class:"text-base text-center font-semibold mb-2 md:mb-4"},Et={class:"h-64"},Rt={__name:"LineChart",props:{title:{type:String,default:"On-Time Score"},chartData:{type:Object,default:()=>({labels:[],datasets:[]})},averageOntime:{type:Number,default:null}},setup(f){const n=f,b=S(null);let j=null;const p=()=>{if(j&&j.destroy(),!b.value)return;const F=b.value.getContext("2d"),D=[];n.chartData.datasets.forEach($=>{$.data&&$.data.length&&D.push(...$.data)});const h=D.length>0?Math.min(...D):0,M=D.length>0?Math.max(...D):100;j=new st(F,{type:"line",data:n.chartData,options:{responsive:!0,maintainAspectRatio:!1,layout:{padding:{left:15,right:15,top:10,bottom:10}},plugins:{legend:{position:!1},tooltip:{callbacks:{label:function($){const q=$.raw||0,A=n.averageOntime||0,P=n.chartData.dateRangeLabel||"selected period",w=Number(A).toFixed(2);return[`On-Time Score: ${q}`,`Average Score Over ${P}: ${w}`]}}}},scales:{y:{beginAtZero:!(h>10),min:Math.max(Math.floor(h-5),0),max:Math.min(102,Math.ceil(M+5)),ticks:{stepSize:2.5,padding:10,font:{size:11},callback:function($){return $<=100?$:""}},grid:{drawBorder:!0,color:"rgba(200, 200, 200, 0.2)"}},x:{ticks:{padding:10,font:{size:11}},grid:{drawBorder:!0,color:"rgba(200, 200, 200, 0.2)"}}}}})};return Se(()=>{p()}),pe(()=>n.chartData,()=>{p()},{deep:!0}),(F,D)=>(r(),c("div",Pt,[t("h3",Bt,y(f.title),1),t("div",Et,[t("canvas",{ref_key:"chartCanvas",ref:b},null,512)])]))}},Lt={class:"space-y-2 md:space-y-4 lg:space-y-6 mb-2 md:mb-4 lg:mb-6"},Yt={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-2 md:gap-4"},Wt={class:"grid grid-cols-1 lg:grid-cols-4 gap-2 md:gap-4 lg:gap-6"},qt={key:1,class:"bg-background rounded-lg border shadow-sm p-4 md:p-6 lg:col-span-3 md:col-span-2 transition-all duration-300 hover:shadow-md flex flex-col justify-center"},It={class:"flex flex-col sm:flex-row items-center justify-center sm:justify-around gap-3 mb-4"},Ht={class:"text-xs text-muted-foreground text-center mt-2"},Gt={key:2,class:"bg-background rounded-lg border shadow-sm p-4 md:p-6 lg:col-span-3 md:col-span-2 transition-all duration-300 hover:shadow-md flex flex-col justify-center items-center"},Qt={class:"flex flex-col items-center justify-center gap-3 mb-4"},Xt={__name:"OnTimeDashboard",props:{metricsData:{type:Object,default:()=>({})},driversData:{type:Array,default:()=>[]},chartData:{type:Object,default:()=>({})},averageOntime:{type:Number,default:null},currentDateFilter:{type:String,default:null},delayType:{type:String,default:"all"}},setup(f){const n=f,b=T(()=>n.metricsData&&n.metricsData.by_category?[{title:"Total Delayed Stops",value:n.metricsData.totalDelays},{title:"Delayed for 1-120 Minutes",value:n.metricsData.between1_120Count},{title:"Delayed for 121-600 Minutes",value:n.metricsData.between121_600Count},{title:"Delayed for +601 Minutes",value:n.metricsData.moreThan601Count}]:[]),j=T(()=>n.driversData&&n.driversData.length?n.driversData:[]),p=T(()=>n.chartData&&Object.keys(n.chartData).length?n.chartData:{}),F=T(()=>{var u;return((u=n.metricsData)==null?void 0:u.totalDelays)||0}),D=T(()=>!n.chartData||!n.chartData.labels?!1:n.chartData.labels.length>1),h=T(()=>{var u,N,R,H;return((H=(R=(N=(u=n.chartData)==null?void 0:u.datasets)==null?void 0:N[0])==null?void 0:R.data)==null?void 0:H.length)>0}),M=T(()=>h.value?n.chartData.datasets[0].data[0]:0),$=T(()=>{const u=M.value;return u>=98?"fantastic_plus":u>=95?"fantastic":u>=90?"good":u>=85?"fair":"poor"}),q=u=>u==null?"0%":`${Math.round(parseFloat(u))}%`,A=u=>{if(!u)return"Not Available";switch(u){case"fantastic_plus":return"Fantastic +";case"fantastic":return"Fantastic";case"good":return"Good";case"fair":return"Fair";case"poor":return"Poor";default:return u}},P=u=>{if(!u)return"outline";switch(u){case"fantastic_plus":return"fantastic-plus";case"fantastic":return"fantastic";case"good":return"good";case"fair":return"fair";case"poor":return"poor";default:return"outline"}},w=u=>{if(!u)return"text-gray-600";switch(u){case"fantastic_plus":return"text-green-600";case"fantastic":return"text-emerald-600";case"good":return"text-blue-600";case"fair":return"text-amber-600";case"poor":return"text-red-600";default:return"text-indigo-600"}},m=u=>{if(!u)return"";switch(u){case"fantastic_plus":return"Outstanding performance with exceptional on-time rate";case"fantastic":return"Excellent performance with very high on-time rate";case"good":return"Solid performance with good on-time rate";case"fair":return"Acceptable performance with room for improvement";case"poor":return"Performance needs significant improvement";default:return""}};return(u,N)=>(r(),c("div",Lt,[t("div",Yt,[(r(!0),c(k,null,W(b.value,(R,H)=>(r(),C(Ft,{key:H,title:R.title,value:R.value,class:"transition-all duration-300 hover:shadow-md"},null,8,["title","value"]))),128))]),t("div",Wt,[a(zt,{title:"Bottom 5 Drivers",drivers:j.value,delayType:f.delayType,totalDelays:F.value,class:I({"lg:col-span-1":D.value,"lg:col-span-1 md:col-span-1":!D.value,"transition-all duration-300 hover:shadow-md":!0})},null,8,["drivers","delayType","totalDelays","class"]),n.currentDateFilter!="Yesterday"&&D.value?(r(),C(Rt,{key:0,title:"On-Time Score",chartData:p.value,averageOntime:f.averageOntime,class:"lg:col-span-3 md:col-span-2 transition-all duration-300 hover:shadow-md"},null,8,["chartData","averageOntime"])):x("",!0),!D.value&&h.value?(r(),c("div",qt,[N[0]||(N[0]=t("h3",{class:"text-base md:text-lg text-center font-semibold mb-4"},"On-Time Score",-1)),t("div",It,[t("div",{class:I(["text-4xl md:text-5xl font-bold text-center",w($.value)])},y(q(M.value)),3),a(o(it),{variant:P($.value),class:"text-xs md:text-sm px-3 py-1"},{default:s(()=>[i(y(A($.value)),1)]),_:1},8,["variant"])]),t("p",Ht,y(m($.value)),1)])):x("",!0),h.value?x("",!0):(r(),c("div",Gt,[N[3]||(N[3]=t("h3",{class:"text-base md:text-lg text-center font-semibold mb-4"},"On-Time Score",-1)),t("div",Qt,[a(V,{name:"chart_bar",class:"h-16 w-16 text-muted-foreground/50"}),N[1]||(N[1]=t("div",{class:"text-lg font-medium text-center text-primary"}," No data available ",-1)),N[2]||(N[2]=t("p",{class:"text-sm text-primary/70 text-center max-w-md"}," There is no on-time data available for the selected time period. Try selecting a different date range or check back later. ",-1))])]))])]))}},Zt={class:"w-full md:max-w-2xl lg:max-w-3xl xl:max-w-6xl lg:mx-auto m-0 p-2 md:p-4 lg:p-6 space-y-2 md:space-y-4 lg:space-y-6"},Jt={class:"mb-2 flex flex-col items-center justify-between px-2 sm:flex-row md:mb-4 lg:mb-6"},Kt={class:"flex flex-wrap gap-3 ml-3"},el={class:"relative"},tl={key:1,class:"absolute right-0 z-10 mt-1 w-48 rounded-md border bg-background shadow-lg"},ll={class:"py-1"},al={class:"block cursor-pointer px-4 py-2 text-sm hover:bg-muted"},sl=["href"],nl=["action"],ol={class:"flex flex-col items-center gap-2 md:items-start"},rl={class:"flex flex-wrap gap-1 md:gap-2"},dl={key:0,class:"text-sm text-muted-foreground"},il={key:0},ul={key:1},ml={key:2},cl={key:3,class:"ml-1"},fl={class:"flex items-center justify-between"},pl={class:"flex items-center gap-2"},vl={key:0,class:"ml-4 flex flex-wrap gap-2"},yl={key:0,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},gl={key:1,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},xl={key:2,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},bl={key:3,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},_l={key:4,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},wl={key:5,class:"inline-flex items-center rounded-full bg-muted px-2.5 py-0.5 text-xs font-semibold"},kl={class:"flex flex-col justify-between gap-1 md:gap-4"},hl={class:"grid w-full grid-cols-1 gap-1 sm:grid-cols-3 md:gap-4"},Cl=["value"],Dl={class:"flex justify-end space-x-2"},Sl={class:"overflow-x-auto"},$l={class:"flex items-center justify-center"},Tl=["checked"],Nl={class:"flex items-center"},Al={key:2,class:"ml-2"},Fl={key:0,class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Ol={key:1,class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Ml={key:3,class:"ml-2 opacity-50"},Ul=["value"],Vl={key:0,class:"ml-1 text-xs text-red-500"},jl={class:"flex space-x-2"},zl={key:0,class:"border-t bg-muted/20 px-4 py-3"},Pl={class:"flex flex-col items-center justify-between gap-2 sm:flex-row"},Bl={class:"text-sm text-muted-foreground"},El={class:"flex w-full flex-col items-center gap-2 sm:w-auto sm:flex-row sm:gap-4"},Rl={class:"flex items-center gap-2"},Ll={class:"flex flex-wrap"},Yl=["innerHTML"],Wl={class:"max-h-[75vh] space-y-4 overflow-y-auto p-4 sm:p-6"},ql={class:"flex items-center justify-between"},Il={class:"max-h-[400px] overflow-y-auto rounded-md border"},Hl={key:0,class:"rounded-md border py-8 text-center text-xs text-muted-foreground sm:text-sm"},Gl={key:1,class:"divide-y"},Ql=["onClick"],Xl={class:"text-xs font-medium sm:text-sm"},Zl={key:0,class:"ml-2 text-[0.65rem] text-red-500 sm:text-xs"},Jl={key:0,class:"mt-1 text-xs text-muted-foreground sm:text-sm"},Kl={class:"flex space-x-1 opacity-0 transition-opacity group-hover:opacity-100"},ea={key:0,class:"space-y-4 rounded-md border p-4"},ta={class:"text-sm font-medium sm:text-base"},la={class:"space-y-3"},aa={class:"flex justify-end space-x-2"},Na={__name:"Index",props:{delays:{type:Object,default:()=>({data:[],links:[]})},tenantSlug:{type:String,default:null},delay_codes:Array,tenants:{type:Array,default:()=>[]},isSuperAdmin:{type:Boolean,default:!1},dateRange:{type:Object,default:null},dateFilter:{type:String,default:"yesterday"},weekNumber:{type:Number,default:null},startWeekNumber:{type:Number,default:null},endWeekNumber:{type:Number,default:null},year:{type:Number,default:null},delay_breakdown:{type:Object,default:null},line_chart_data:{type:Object,default:null},average_ontime:{type:Number},filters:{type:Object,default:()=>({search:"",delayCode:"",delayCategory:"",delayType:"",disputed:"",driverControllable:""})},permissions:Array},setup(f){const n=f,b=T(()=>(z.value==="yesterday"||z.value==="current-week")&&n.weekNumber&&n.year?`Week ${n.weekNumber}, ${n.year}`:(z.value==="6w"||z.value==="quarterly")&&n.startWeekNumber&&n.endWeekNumber&&n.year?`Weeks ${n.startWeekNumber}-${n.endWeekNumber}, ${n.year}`:""),j=[{title:n.tenantSlug?"Dashboard":"Admin Dashboard",href:n.tenantSlug?route("dashboard",{tenantSlug:n.tenantSlug}):route("admin.dashboard")},{title:"On-Time",href:n.tenantSlug?route("ontime.index",{tenantSlug:n.tenantSlug}):route("ontime.index.admin")}],p=S(!1),F=S(!1),D=S(null),h=S(""),M=S(""),$=S(!1),q=S(null),A=S([]),P=S(!1),w=S(null),m=S(!1),u=S(null),N=S({code:"",description:""}),R=S(!1),H=S(null),G=S("date"),Q=S("desc"),g=S({...n.filters}),ie=["date","delay_type","driver_name","delay_category","delay_code","disputed","driver_controllable"],X=T(()=>{let d=[...n.delays.data];return d.sort((e,l)=>{var te,we;let v,U;return G.value==="delay_code"?(v=((te=e.delay_code)==null?void 0:te.code)||"",U=((we=l.delay_code)==null?void 0:we.code)||""):(v=e[G.value],U=l[G.value]),v===null?1:U===null?-1:(typeof v=="string"&&(v=v.toLowerCase(),U=U.toLowerCase()),v<U?Q.value==="asc"?-1:1:v>U?Q.value==="asc"?1:-1:0)}),d}),$e=T(()=>n.delay_codes.filter(d=>!d.deleted_at));function Te(d){G.value===d?Q.value=Q.value==="asc"?"desc":"asc":(G.value=d,Q.value="asc")}function xe(){const d=n.tenantSlug?route("ontime.index",{tenantSlug:n.tenantSlug}):route("ontime.index.admin");Y.get(d,{...g.value,perPage:Z.value,dateFilter:z.value})}function Ne(){g.value={search:"",dateFrom:"",dateTo:"",delayCode:"",delayCategory:"",delayType:"",disputed:"",controllable:""},xe()}const Z=S(n.delays.per_page||10),z=S(n.dateFilter||"full");function Ae(){const d=n.tenantSlug?route("ontime.index",{tenantSlug:n.tenantSlug}):route("ontime.index.admin");Y.get(d,{...g.value,perPage:Z.value,dateFilter:z.value})}function ue(d){z.value=d;const e=n.tenantSlug?route("ontime.index",{tenantSlug:n.tenantSlug}):route("ontime.index.admin");Y.get(e,{...g.value,perPage:Z.value,dateFilter:d})}function Fe(d){if(d){const e=new URL(d),l=e.origin+e.pathname;Y.get(l,{...g.value,perPage:Z.value,dateFilter:z.value,page:e.searchParams.get("page")||1})}}function me(d){if(!d)return"";const e=d.split("-");if(e.length!==3)return d;const[l,v,U]=e;return`${Number(v)}/${Number(U)}/${l}`}const be=(d=null)=>{D.value=d,p.value=!0},Oe=d=>{q.value=d,$.value=!0},Me=()=>{F.value=!0,m.value=!1,u.value=null},Ue=()=>{N.value={code:"",description:""},u.value=null,m.value=!0},Ve=d=>{N.value={code:d.code,description:d.description||""},u.value=d.id,m.value=!0},je=()=>{m.value=!1,u.value=null},ze=d=>{H.value=d,R.value=!0},J=S(!1),Pe=T(()=>g.value.search||g.value.dateFrom||g.value.dateTo||g.value.delayCode||g.value.delayCategory||g.value.disputed||g.value.delayType||g.value.controllable),Be=d=>{if(!d)return"";const e=n.delay_codes.find(l=>l.id===parseInt(d));return e?e.code:""},Ee=async d=>{try{await Y.delete(route("delay_codes.destroy.admin",d),{onSuccess:()=>{R.value=!1,h.value="Delay code deleted successfully"}})}catch(e){console.error("Error deleting delay code:",e)}};function _e(d){if(!d)return"—";switch(d){case"1_120":return"1-120 mins";case"121_600":return"121-600 mins";case"601_plus":return"601+ mins";default:return d}}const Re=()=>{const d=K({code:N.value.code,description:N.value.description}),e=u.value?n.isSuperAdmin?"delay_codes.update.admin":"delay_codes.update":n.isSuperAdmin?"delay_codes.store.admin":"delay_codes.store",l=u.value?n.isSuperAdmin?{id:u.value}:{tenantSlug:n.tenantSlug,id:u.value}:n.isSuperAdmin?{}:{tenantSlug:n.tenantSlug};(u.value?d.put:d.post).call(d,route(e,l),{onSuccess:()=>{h.value=u.value?"Delay code updated successfully.":"Delay code created successfully.",m.value=!1,u.value=null,Y.reload({only:["delay_codes"]})},onError:U=>{console.error(U)}})},Le=d=>{K({}).post(route(n.isSuperAdmin?"delay_codes.restore.admin":"delay_codes.restore",{id:d}),{onSuccess:()=>{h.value="Delay code restored successfully.",Y.reload({only:["delay_codes"]})},onError:l=>{console.error(l)}})},Ye=d=>{K({}).delete(route(n.isSuperAdmin?"delay_codes.forceDelete.admin":"delay_codes.forceDelete",{id:d}),{onSuccess:()=>{h.value="Delay code permanently deleted successfully.",Y.reload({only:["delay_codes"]})},onError:l=>{console.error(l)}})},We=d=>{const e=K({}),l=n.isSuperAdmin?"ontime.destroy.admin":"ontime.destroy",v=n.isSuperAdmin?{delay:d}:{tenantSlug:n.tenantSlug,delay:d};e.delete(route(l,v),{preserveScroll:!0,onSuccess:()=>{h.value="Delay record deleted successfully.",$.value=!1}})};pe(h,d=>{d&&setTimeout(()=>{h.value=""},5e3)}),n.flash&&n.flash.error&&(M.value=n.flash.error),pe(M,d=>{d&&setTimeout(()=>{M.value=""},5e3)});const qe=T(()=>{var l;if(!((l=n.delay_breakdown)!=null&&l.by_category))return null;const d=n.delay_breakdown.by_category,e=n.filters.delayType;return e?{between1_120Count:d[`category_1_120_${e}_count`]||"0",between121_600Count:d[`category_121_600_${e}_count`]||"0",moreThan601Count:d[`category_601_plus_${e}_count`]||"0",totalDelays:d[`total_${e}_delays`]||"0",by_category:!0}:{between1_120Count:d.category_1_120_count||"0",between121_600Count:d.category_121_600_count||"0",moreThan601Count:d.category_601_plus_count||"0",totalDelays:d.total_delays||"0",by_category:!0}}),Ie=T(()=>{var d,e,l;return n.filters.delayType=="origin"?((d=n.delay_breakdown)==null?void 0:d.bottom_five_drivers.origin)||[]:n.filters.delayType=="destination"?((e=n.delay_breakdown)==null?void 0:e.bottom_five_drivers.destination)||[]:((l=n.delay_breakdown)==null?void 0:l.bottom_five_drivers.total)||[]}),He=T(()=>!n.line_chart_data||n.line_chart_data.length===0?{labels:[],datasets:[{label:"On-Time Performance",data:[],borderColor:"#3b82f6",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.3,fill:!1}]}:{labels:n.line_chart_data.map(d=>d.date),datasets:[{label:"On-Time Performance",data:n.line_chart_data.map(d=>d.onTimePerformance),borderColor:"#3b82f6",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.3,fill:!1}]}),Ge=T(()=>X.value.length>0&&A.value.length===X.value.length);T(()=>n.delays.data&&n.delays.data.length>0);function Qe(d){d.target.checked?A.value=X.value.map(e=>e.id):A.value=[]}function Xe(){A.value.length>0&&(P.value=!0)}function Ze(){const d=K({ids:A.value}),e=n.isSuperAdmin?"ontime.destroyBulk.admin":"ontime.destroyBulk",l=n.isSuperAdmin?{}:{tenantSlug:n.tenantSlug};d.delete(route(e,l),{preserveScroll:!0,onSuccess:()=>{h.value=`${A.value.length} delay records deleted successfully.`,A.value=[],P.value=!1,Y.reload()},onError:v=>{console.error(v)}})}function Je(d){const e=d.target.files[0];if(!e)return;const l=new FormData;l.append("csv_file",e);const v=n.isSuperAdmin?route("ontime.import.admin"):route("ontime.import",{tenantSlug:n.tenantSlug});Y.post(v,l,{onSuccess:()=>{h.value="Delays imported successfully",d.target.value=""},onError:U=>{console.error(U),d.target.value=""}})}function Ke(){if(n.delays.data.length===0){M.value="No delay data found to export.";return}w.value&&w.value.submit()}const et=T(()=>n.tenantSlug?route("ontime.export",{tenantSlug:n.tenantSlug}):route("ontime.export.admin")),ee=S(!1),tt=T(()=>"/storage/upload-data-temps/Delays Template.csv");Se(()=>{const d=e=>{ee.value&&!e.target.closest(".relative")&&(ee.value=!1)};document.addEventListener("click",d),nt(()=>{document.removeEventListener("click",d)})});const B=T(()=>n.permissions.map(d=>d.name));return(d,e)=>(r(),C(vt,{breadcrumbs:j,tenantSlug:f.tenantSlug,permissions:n.permissions},{default:s(()=>[a(o(rt),{title:"On-Time"}),t("div",Zt,[h.value?(r(),C(o(ke),{key:0,variant:"success"},{default:s(()=>[a(o(he),null,{default:s(()=>e[32]||(e[32]=[i("Success")])),_:1}),a(o(Ce),null,{default:s(()=>[i(y(h.value),1)]),_:1})]),_:1})):x("",!0),M.value?(r(),C(o(ke),{key:1,variant:"destructive"},{default:s(()=>[a(o(he),null,{default:s(()=>e[33]||(e[33]=[i("Error")])),_:1}),a(o(Ce),null,{default:s(()=>[i(y(M.value),1)]),_:1})]),_:1})):x("",!0),t("div",Jt,[e[39]||(e[39]=t("h1",{class:"text-lg font-bold md:text-xl lg:text-2xl"},"On-Time Management",-1)),t("div",Kt,[B.value.includes("delays.create")?(r(),C(_,{key:0,class:"px-2 py-0 md:px-4 md:py-2",onClick:e[0]||(e[0]=l=>be()),variant:"default"},{default:s(()=>[a(V,{name:"plus",class:"mr-1 h-4 w-4 md:mr-2"}),e[34]||(e[34]=i(" Add Delay "))]),_:1})):x("",!0),A.value.length>0&&B.value.includes("delays.delete")?(r(),C(_,{key:1,class:"px-2 py-0 md:px-4 md:py-2",onClick:e[1]||(e[1]=l=>Xe()),variant:"destructive"},{default:s(()=>[a(V,{name:"trash",class:"mr-1 h-4 w-4 md:mr-2"}),i(" Delete Selected ("+y(A.value.length)+") ",1)]),_:1})):x("",!0),t("div",el,[B.value.includes("delays.import")?(r(),C(_,{key:0,class:"px-2 py-0 md:px-4 md:py-2",onClick:e[2]||(e[2]=l=>ee.value=!ee.value),variant:"secondary"},{default:s(()=>[a(V,{name:"upload",class:"mr-1 h-4 w-4 md:mr-2"}),e[35]||(e[35]=i(" Upload CSV ")),a(V,{name:"chevron-down",class:"ml-2 h-4 w-4"})]),_:1})):x("",!0),ee.value?(r(),c("div",tl,[t("div",ll,[t("label",al,[e[36]||(e[36]=t("span",null,"Upload CSV File",-1)),t("input",{type:"file",class:"hidden",onChange:Je,accept:".csv"},null,32)]),t("a",{href:tt.value,download:"Delays Template.csv",class:"block px-4 py-2 text-sm hover:bg-muted"}," Download Template ",8,sl)])])):x("",!0)]),B.value.includes("delays.export")?(r(),C(_,{key:2,class:"px-2 py-0 md:px-4 md:py-2",onClick:De(Ke,["prevent"]),variant:"outline"},{default:s(()=>[a(V,{name:"download",class:"mr-1 h-4 w-4 md:mr-2"}),e[37]||(e[37]=i(" Download CSV "))]),_:1})):x("",!0),f.isSuperAdmin?(r(),C(_,{key:3,class:"px-2 py-0 md:px-4 md:py-2",onClick:e[3]||(e[3]=l=>Me()),variant:"outline"},{default:s(()=>[a(V,{name:"settings",class:"mr-1 h-4 w-4 md:mr-2"}),e[38]||(e[38]=i(" Manage Delay Codes "))]),_:1})):x("",!0)])]),t("form",{ref_key:"exportForm",ref:w,action:et.value,method:"GET",class:"hidden"},null,8,nl),a(o(ye),null,{default:s(()=>[a(o(ge),{class:"p-2 md:p-4 lg:p-6"},{default:s(()=>[t("div",ol,[t("div",rl,[a(_,{onClick:e[4]||(e[4]=l=>ue("yesterday")),variant:"outline",size:"sm",class:I({"border-primary bg-primary/10 text-primary":z.value==="yesterday"})},{default:s(()=>e[40]||(e[40]=[i(" Yesterday ")])),_:1},8,["class"]),a(_,{onClick:e[5]||(e[5]=l=>ue("current-week")),variant:"outline",size:"sm",class:I({"border-primary bg-primary/10 text-primary":z.value==="current-week"})},{default:s(()=>e[41]||(e[41]=[i(" WTD ")])),_:1},8,["class"]),a(_,{onClick:e[6]||(e[6]=l=>ue("6w")),variant:"outline",size:"sm",class:I({"border-primary bg-primary/10 text-primary":z.value==="6w"})},{default:s(()=>e[42]||(e[42]=[i(" T6W ")])),_:1},8,["class"]),a(_,{onClick:e[7]||(e[7]=l=>ue("quarterly")),variant:"outline",size:"sm",class:I({"border-primary bg-primary/10 text-primary":z.value==="quarterly"})},{default:s(()=>e[43]||(e[43]=[i(" Quarterly ")])),_:1},8,["class"])]),f.dateRange?(r(),c("div",dl,[z.value==="yesterday"&&f.dateRange.start?(r(),c("span",il," Showing data from "+y(me(f.dateRange.start)),1)):f.dateRange.start&&f.dateRange.end?(r(),c("span",ul," Showing data from "+y(me(f.dateRange.start))+" to "+y(me(f.dateRange.end)),1)):(r(),c("span",ml,y(f.dateRange.label),1)),b.value?(r(),c("span",cl,"("+y(b.value)+")",1)):x("",!0)])):x("",!0)])]),_:1})]),_:1}),a(o(ye),null,{default:s(()=>[a(o(ft),{class:"p-2 md:p-4 lg:p-6"},{default:s(()=>[t("div",fl,[t("div",pl,[a(o(pt),{class:"text-lg md:text-xl lg:text-2xl"},{default:s(()=>e[44]||(e[44]=[i("Filters")])),_:1}),!J.value&&Pe.value?(r(),c("div",vl,[g.value.search?(r(),c("div",yl," Search: "+y(g.value.search),1)):x("",!0),g.value.delayCode?(r(),c("div",gl," Code: "+y(Be(g.value.delayCode)),1)):x("",!0),g.value.delayCategory?(r(),c("div",xl," Category: "+y(_e(g.value.delayCategory)),1)):x("",!0),g.value.delayType?(r(),c("div",bl," Type: "+y(g.value.delayType==="origin"?"Origin":"Destination"),1)):x("",!0),g.value.disputed?(r(),c("div",_l," Disputed: "+y(g.value.disputed==="true"?"Yes":"No"),1)):x("",!0),g.value.controllable?(r(),c("div",wl," Driver Controllable: "+y(g.value.controllable==="true"?"Yes":g.value.controllable==="false"?"No":"N/A"),1)):x("",!0)])):x("",!0)]),a(_,{variant:"ghost",size:"sm",onClick:e[8]||(e[8]=l=>J.value=!J.value)},{default:s(()=>[i(y(J.value?"Hide Filters":"Show Filters")+" ",1),a(V,{name:J.value?"chevron-up":"chevron-down",class:"ml-2 h-4 w-4"},null,8,["name"])]),_:1})])]),_:1}),J.value?(r(),C(o(ge),{key:0,class:"p-2 md:p-4 lg:p-6"},{default:s(()=>[t("div",kl,[t("div",hl,[t("div",null,[a(o(O),{for:"search"},{default:s(()=>e[45]||(e[45]=[i("Search")])),_:1}),a(o(de),{class:"h-9 px-1 py-1 md:px-2 md:py-1 lg:h-10 lg:px-3 lg:py-2",id:"search",modelValue:g.value.search,"onUpdate:modelValue":e[9]||(e[9]=l=>g.value.search=l),type:"text",placeholder:"Search by driver..."},null,8,["modelValue"])]),t("div",null,[a(o(O),{for:"delayCode"},{default:s(()=>e[46]||(e[46]=[i("Delay Code")])),_:1}),E(t("select",{id:"delayCode","onUpdate:modelValue":e[10]||(e[10]=l=>g.value.delayCode=l),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},[e[47]||(e[47]=t("option",{value:""},"All Codes",-1)),(r(!0),c(k,null,W(f.delay_codes,l=>(r(),c("option",{key:l.id,value:l.id},y(l.code),9,Cl))),128))],512),[[L,g.value.delayCode]])]),t("div",null,[a(o(O),{for:"delayCategory"},{default:s(()=>e[48]||(e[48]=[i("Delay Category")])),_:1}),E(t("select",{id:"delayCategory","onUpdate:modelValue":e[11]||(e[11]=l=>g.value.delayCategory=l),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},e[49]||(e[49]=[t("option",{value:""},"All Categories",-1),t("option",{value:"1_120"},"1-120 mins",-1),t("option",{value:"121_600"},"121-600 mins",-1),t("option",{value:"601_plus"},"601+ mins",-1)]),512),[[L,g.value.delayCategory]])]),t("div",null,[a(o(O),{for:"delayType"},{default:s(()=>e[50]||(e[50]=[i("Delay Type")])),_:1}),E(t("select",{id:"delayType","onUpdate:modelValue":e[12]||(e[12]=l=>g.value.delayType=l),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},e[51]||(e[51]=[t("option",{value:""},"All Types",-1),t("option",{value:"origin"},"Origin",-1),t("option",{value:"destination"},"Destination",-1)]),512),[[L,g.value.delayType]])]),t("div",null,[a(o(O),{for:"disputed"},{default:s(()=>e[52]||(e[52]=[i("Disputed Status")])),_:1}),E(t("select",{id:"disputed","onUpdate:modelValue":e[13]||(e[13]=l=>g.value.disputed=l),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},e[53]||(e[53]=[t("option",{value:""},"All",-1),t("option",{value:"true"},"Disputed",-1),t("option",{value:"false"},"Not Disputed",-1)]),512),[[L,g.value.disputed]])]),t("div",null,[a(o(O),{for:"controllable"},{default:s(()=>e[54]||(e[54]=[i("Driver Controllable")])),_:1}),E(t("select",{id:"controllable","onUpdate:modelValue":e[14]||(e[14]=l=>g.value.controllable=l),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},e[55]||(e[55]=[t("option",{value:""},"All",-1),t("option",{value:"true"},"Yes",-1),t("option",{value:"false"},"No",-1),t("option",{value:"NA"},"N/A",-1)]),512),[[L,g.value.controllable]])])]),t("div",Dl,[a(_,{onClick:Ne,variant:"ghost",size:"sm"},{default:s(()=>[a(V,{name:"rotate_ccw",class:"mr-2 h-4 w-4"}),e[56]||(e[56]=i(" Reset Filters "))]),_:1}),a(_,{onClick:xe,variant:"default",size:"sm"},{default:s(()=>[a(V,{name:"filter",class:"mr-2 h-4 w-4"}),e[57]||(e[57]=i(" Apply Filters "))]),_:1})])])]),_:1})):x("",!0)]),_:1}),f.isSuperAdmin?x("",!0):(r(),C(Xt,{key:2,metricsData:qe.value,driversData:Ie.value,chartData:He.value,averageOntime:f.average_ontime,currentDateFilter:n.dateRange.label,delayType:g.value.delayType},null,8,["metricsData","driversData","chartData","averageOntime","currentDateFilter","delayType"])),a(o(ye),{class:"mx-auto max-w-[95vw] overflow-x-auto md:max-w-[64vw] lg:max-w-full"},{default:s(()=>[a(o(ge),{class:"p-0"},{default:s(()=>[t("div",Sl,[a(o(ut),{class:"relative h-[500px] overflow-auto"},{default:s(()=>[a(o(mt),null,{default:s(()=>[a(o(ve),{class:"sticky top-0 z-10 border-b bg-background hover:bg-background"},{default:s(()=>[B.value.includes("delays.delete")?(r(),C(o(ce),{key:0,class:"w-[50px]"},{default:s(()=>[t("div",$l,[t("input",{type:"checkbox",onChange:Qe,checked:Ge.value,class:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"},null,40,Tl)])]),_:1})):x("",!0),f.isSuperAdmin?(r(),C(o(ce),{key:1},{default:s(()=>e[58]||(e[58]=[i("Company Name")])),_:1})):x("",!0),(r(),c(k,null,W(ie,l=>a(o(ce),{key:l,class:"cursor-pointer",onClick:v=>Te(l)},{default:s(()=>[t("div",Nl,[l==="delay_category"?(r(),c(k,{key:0},[i(" Delay ")],64)):(r(),c(k,{key:1},[i(y(l.replace(/_/g," ").split(" ").map(v=>v.charAt(0).toUpperCase()+v.slice(1)).join(" ")),1)],64)),G.value===l?(r(),c("div",Al,[Q.value==="asc"?(r(),c("svg",Fl,e[59]||(e[59]=[t("path",{d:"M8 15l4-4 4 4"},null,-1)]))):(r(),c("svg",Ol,e[60]||(e[60]=[t("path",{d:"M16 9l-4 4-4-4"},null,-1)])))])):(r(),c("div",Ml,e[61]||(e[61]=[t("svg",{class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M8 10l4-4 4 4"}),t("path",{d:"M16 14l-4 4-4-4"})],-1)])))])]),_:2},1032,["onClick"])),64)),B.value.includes("delays.delete")||B.value.includes("delays.update")?(r(),C(o(ce),{key:2,class:"text-right"},{default:s(()=>e[62]||(e[62]=[i("Actions")])),_:1})):x("",!0)]),_:1})]),_:1}),a(o(ct),null,{default:s(()=>[X.value.length===0?(r(),C(o(ve),{key:0},{default:s(()=>[a(o(le),{colspan:f.isSuperAdmin?ie.length+2:ie.length+1,class:"py-8 text-center text-primary font-medium"},{default:s(()=>e[63]||(e[63]=[i(" No delays found matching your criteria ")])),_:1},8,["colspan"])]),_:1})):x("",!0),(r(!0),c(k,null,W(X.value,l=>(r(),C(o(ve),{key:l.id,class:"hover:bg-muted/50"},{default:s(()=>[B.value.includes("delays.delete")?(r(),C(o(le),{key:0,class:"text-center"},{default:s(()=>[E(t("input",{type:"checkbox",value:l.id,"onUpdate:modelValue":e[15]||(e[15]=v=>A.value=v),class:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"},null,8,Ul),[[ot,A.value]])]),_:2},1024)):x("",!0),f.isSuperAdmin?(r(),C(o(le),{key:1},{default:s(()=>{var v;return[i(y(((v=l.tenant)==null?void 0:v.name)||"—"),1)]}),_:2},1024)):x("",!0),(r(),c(k,null,W(ie,v=>a(o(le),{key:v,class:"whitespace-nowrap"},{default:s(()=>{var U,te;return[v==="date"?(r(),c(k,{key:0},[i(y(me(l[v])),1)],64)):v==="disputed"?(r(),c(k,{key:1},[i(y(l[v]?"Yes":"No"),1)],64)):v==="driver_controllable"?(r(),c(k,{key:2},[i(y(l[v]===null?"N/A":l[v]?"Yes":"No"),1)],64)):v==="delay_code"?(r(),c(k,{key:3},[i(y(((U=l.delay_code)==null?void 0:U.code)||"—")+" ",1),(te=l.delay_code)!=null&&te.deleted_at?(r(),c("span",Vl,"(Deleted Code)")):x("",!0)],64)):v==="delay_category"?(r(),c(k,{key:4},[i(y(_e(l.delay_category)),1)],64)):(r(),c(k,{key:5},[i(y(l[v]),1)],64))]}),_:2},1024)),64)),B.value.includes("delays.udpate")||B.value.includes("delays.delete")?(r(),C(o(le),{key:2},{default:s(()=>[t("div",jl,[B.value.includes("delays.update")?(r(),C(_,{key:0,onClick:v=>be(l),variant:"warning",size:"sm"},{default:s(()=>[a(V,{name:"pencil",class:"mr-1 h-4 w-4"}),e[64]||(e[64]=i(" Edit "))]),_:2},1032,["onClick"])):x("",!0),B.value.includes("delays.delete")?(r(),C(_,{key:1,onClick:v=>Oe(l.id),variant:"destructive",size:"sm"},{default:s(()=>[a(V,{name:"trash",class:"mr-1 h-4 w-4"}),e[65]||(e[65]=i(" Delete "))]),_:2},1032,["onClick"])):x("",!0)])]),_:2},1024)):x("",!0)]),_:2},1024))),128))]),_:1})]),_:1})]),f.delays.links?(r(),c("div",zl,[t("div",Pl,[t("div",Bl," Showing "+y(X.value.length)+" of "+y(f.delays.data.length)+" entries ",1),t("div",El,[t("div",Rl,[a(o(O),{for:"perPage",class:"text-sm"},{default:s(()=>e[66]||(e[66]=[i("Per page:")])),_:1}),E(t("select",{id:"perPage","onUpdate:modelValue":e[16]||(e[16]=l=>Z.value=l),onChange:Ae,class:"h-8 rounded-md border border-input bg-background px-2 py-1 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"},e[67]||(e[67]=[t("option",{value:"10"},"10",-1),t("option",{value:"25"},"25",-1),t("option",{value:"50"},"50",-1),t("option",{value:"100"},"100",-1)]),544),[[L,Z.value]])]),t("div",Ll,[(r(!0),c(k,null,W(f.delays.links,l=>(r(),C(_,{key:l.label,onClick:v=>Fe(l.url),disabled:!l.url,variant:"ghost",size:"sm",class:I(["mx-1",{"border-primary bg-primary/10 text-primary":l.active}])},{default:s(()=>[t("span",{innerHTML:l.label},null,8,Yl)]),_:2},1032,["onClick","disabled","class"]))),128))])])])])):x("",!0)]),_:1})]),_:1}),a(o(ae),{open:p.value,"onUpdate:open":e[18]||(e[18]=l=>p.value=l)},{default:s(()=>[a(o(se),{class:"max-w-[95vw] sm:max-w-[90vw] md:max-w-4xl"},{default:s(()=>[a(o(ne),{class:"px-4 sm:px-6"},{default:s(()=>[a(o(oe),{class:"text-lg sm:text-xl"},{default:s(()=>[i(y(D.value?"Edit":"Add")+" Delay",1)]),_:1}),a(o(re),{class:"text-xs sm:text-sm"},{default:s(()=>[i(" Fill in the details to "+y(D.value?"update":"create")+" a delay record. ",1)]),_:1})]),_:1}),a(Tt,{delay:D.value,"delay-codes":$e.value,tenants:f.tenants,"is-super-admin":f.isSuperAdmin,"tenant-slug":f.tenantSlug,onClose:e[17]||(e[17]=l=>p.value=!1),class:"max-h-[75vh] overflow-y-auto p-4 sm:p-6"},null,8,["delay","delay-codes","tenants","is-super-admin","tenant-slug"])]),_:1})]),_:1},8,["open"]),a(o(ae),{open:F.value,"onUpdate:open":e[22]||(e[22]=l=>F.value=l)},{default:s(()=>[a(o(se),{class:"max-w-[95vw] sm:max-w-[90vw] md:max-w-2xl"},{default:s(()=>[a(o(ne),{class:"px-4 sm:px-6"},{default:s(()=>[a(o(oe),{class:"text-lg sm:text-xl"},{default:s(()=>e[68]||(e[68]=[i("Manage Delay Codes")])),_:1}),a(o(re),{class:"text-xs sm:text-sm"},{default:s(()=>e[69]||(e[69]=[i(" Create and manage delay codes for your organization. ")])),_:1})]),_:1}),t("div",Wl,[t("div",ql,[e[71]||(e[71]=t("h3",{class:"text-sm font-medium sm:text-base"},"Current Delay Codes",-1)),a(_,{onClick:Ue,size:"sm",variant:"outline",class:"h-8 px-3 text-xs sm:h-9 sm:px-4 sm:text-sm"},{default:s(()=>[a(V,{name:"plus",class:"mr-1 h-3 w-3 sm:h-3.5 sm:w-3.5"}),e[70]||(e[70]=i(" Add New Code "))]),_:1})]),t("div",Il,[!f.delay_codes||f.delay_codes.length===0?(r(),c("div",Hl," No delay codes found ")):(r(),c("div",Gl,[(r(!0),c(k,null,W(f.delay_codes,l=>(r(),c("div",{key:l.id,class:"group flex items-center justify-between p-3 hover:bg-muted/50"},[t("div",{class:"flex-1 cursor-pointer",onClick:v=>Ve(l)},[t("div",Xl,[i(y(l.code)+" ",1),l.deleted_at?(r(),c("span",Zl,"(Deleted)")):x("",!0)]),l.description?(r(),c("div",Jl,y(l.description),1)):x("",!0)],8,Ql),t("div",Kl,[f.isSuperAdmin?(r(),c(k,{key:0},[l.deleted_at?(r(),c(k,{key:0},[a(_,{onClick:v=>Le(l.id),size:"sm",variant:"outline",class:"h-8 px-2 text-xs sm:h-9 sm:px-3 sm:text-sm"},{default:s(()=>[a(V,{name:"refresh",class:"mr-1 h-3 w-3 sm:h-3 sm:w-3"}),e[72]||(e[72]=i(" Restore "))]),_:2},1032,["onClick"]),a(_,{onClick:v=>Ye(l.id),size:"sm",variant:"destructive",class:"h-8 px-2 text-xs sm:h-9 sm:px-3 sm:text-sm"},{default:s(()=>[a(V,{name:"trash",class:"mr-1 h-3 w-3 sm:h-3 sm:w-3"}),e[73]||(e[73]=i(" Delete "))]),_:2},1032,["onClick"])],64)):(r(),C(_,{key:1,onClick:v=>ze(l.id),size:"sm",variant:"destructive",class:"h-8 px-2 text-xs sm:h-9 sm:px-3 sm:text-sm"},{default:s(()=>[a(V,{name:"trash",class:"mr-1 h-3 w-3 sm:h-3 sm:w-3"}),e[74]||(e[74]=i(" Delete "))]),_:2},1032,["onClick"]))],64)):x("",!0)])]))),128))]))]),m.value?(r(),c("div",ea,[t("h3",ta,y(u.value?"Edit":"Add")+" Delay Code",1),t("div",la,[t("div",null,[a(o(O),{for:"code",class:"text-xs sm:text-sm"},{default:s(()=>e[75]||(e[75]=[i("Code")])),_:1}),a(o(de),{id:"code",modelValue:N.value.code,"onUpdate:modelValue":e[19]||(e[19]=l=>N.value.code=l),placeholder:"Enter code",class:"h-9 text-xs sm:h-10 sm:text-sm"},null,8,["modelValue"])]),t("div",null,[a(o(O),{for:"description",class:"text-xs sm:text-sm"},{default:s(()=>e[76]||(e[76]=[i("Description")])),_:1}),a(o(de),{id:"description",modelValue:N.value.description,"onUpdate:modelValue":e[20]||(e[20]=l=>N.value.description=l),placeholder:"Enter description",class:"h-9 text-xs sm:h-10 sm:text-sm"},null,8,["modelValue"])]),t("div",aa,[a(_,{onClick:je,variant:"ghost",size:"sm",class:"h-8 px-3 text-xs sm:h-9 sm:px-4 sm:text-sm"},{default:s(()=>e[77]||(e[77]=[i("Cancel")])),_:1}),a(_,{onClick:Re,variant:"default",size:"sm",class:"h-8 px-3 text-xs sm:h-9 sm:px-4 sm:text-sm"},{default:s(()=>e[78]||(e[78]=[i("Save")])),_:1})])])])):x("",!0)]),a(o(fe),{class:"px-4 sm:px-6"},{default:s(()=>[a(_,{onClick:e[21]||(e[21]=l=>F.value=!1),variant:"outline",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:s(()=>e[79]||(e[79]=[i("Close")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),a(o(ae),{open:R.value,"onUpdate:open":e[25]||(e[25]=l=>R.value=l)},{default:s(()=>[a(o(se),{class:"max-w-[95vw] sm:max-w-md"},{default:s(()=>[a(o(ne),{class:"px-4 sm:px-6"},{default:s(()=>[a(o(oe),{class:"text-lg sm:text-xl"},{default:s(()=>e[80]||(e[80]=[i("Confirm Deletion")])),_:1}),a(o(re),{class:"text-xs sm:text-sm"},{default:s(()=>e[81]||(e[81]=[i(" Are you sure you want to delete this delay code? This action cannot be undone. ")])),_:1})]),_:1}),a(o(fe),{class:"px-4 sm:px-6"},{default:s(()=>[a(_,{type:"button",onClick:e[23]||(e[23]=l=>R.value=!1),variant:"outline",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:s(()=>e[82]||(e[82]=[i(" Cancel ")])),_:1}),a(_,{type:"button",onClick:e[24]||(e[24]=l=>Ee(H.value)),variant:"destructive",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:s(()=>e[83]||(e[83]=[i(" Delete ")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),a(o(ae),{open:$.value,"onUpdate:open":e[28]||(e[28]=l=>$.value=l)},{default:s(()=>[a(o(se),{class:"max-w-[95vw] sm:max-w-md"},{default:s(()=>[a(o(ne),{class:"px-4 sm:px-6"},{default:s(()=>[a(o(oe),{class:"text-lg sm:text-xl"},{default:s(()=>e[84]||(e[84]=[i("Confirm Deletion")])),_:1}),a(o(re),{class:"text-xs sm:text-sm"},{default:s(()=>e[85]||(e[85]=[i(" Are you sure you want to delete this delay record? This action cannot be undone. ")])),_:1})]),_:1}),a(o(fe),{class:"px-4 sm:px-6"},{default:s(()=>[a(_,{type:"button",onClick:e[26]||(e[26]=l=>$.value=!1),variant:"outline",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:s(()=>e[86]||(e[86]=[i(" Cancel ")])),_:1}),a(_,{type:"button",onClick:e[27]||(e[27]=l=>We(q.value)),variant:"destructive",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:s(()=>e[87]||(e[87]=[i(" Delete ")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),a(o(ae),{open:P.value,"onUpdate:open":e[31]||(e[31]=l=>P.value=l)},{default:s(()=>[a(o(se),{class:"max-w-[95vw] sm:max-w-md"},{default:s(()=>[a(o(ne),{class:"px-4 sm:px-6"},{default:s(()=>[a(o(oe),{class:"text-lg sm:text-xl"},{default:s(()=>e[88]||(e[88]=[i("Confirm Bulk Deletion")])),_:1}),a(o(re),{class:"text-xs sm:text-sm"},{default:s(()=>[i(" Are you sure you want to delete "+y(A.value.length)+" delay records? This action cannot be undone. ",1)]),_:1})]),_:1}),a(o(fe),{class:"px-4 sm:px-6"},{default:s(()=>[a(_,{type:"button",onClick:e[29]||(e[29]=l=>P.value=!1),variant:"outline",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:s(()=>e[89]||(e[89]=[i(" Cancel ")])),_:1}),a(_,{type:"button",onClick:e[30]||(e[30]=l=>Ze()),variant:"destructive",class:"h-9 px-4 py-1 text-xs sm:h-10 sm:text-sm"},{default:s(()=>e[90]||(e[90]=[i(" Delete Selected ")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]),_:1},8,["tenantSlug","permissions"]))}};export{Na as default};
